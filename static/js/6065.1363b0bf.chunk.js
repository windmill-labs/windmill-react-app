"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[6065],{6065:(e,t,i)=>{i.r(t),i.d(t,{ALWAYS_SYNC_GLOBAL_EVENTS:()=>s.h,AbstractHeaderCellCtrl:()=>s.i,AdvancedFilterModule:()=>me,AgAbstractField:()=>s.j,AgAbstractLabel:()=>s.k,AgAutocomplete:()=>s.l,AgCheckbox:()=>s.m,AgDialog:()=>s.n,AgGroupComponent:()=>s.o,AgInputDateField:()=>s.p,AgInputNumberField:()=>s.q,AgInputRange:()=>s.r,AgInputTextArea:()=>s.s,AgInputTextField:()=>s.t,AgMenuItemComponent:()=>s.u,AgMenuItemRenderer:()=>s.v,AgMenuList:()=>s.w,AgMenuPanel:()=>s.x,AgPanel:()=>s.y,AgPickerField:()=>s.z,AgPromise:()=>s.D,AgPromiseStatus:()=>s.F,AgRadioButton:()=>s.H,AgRichSelect:()=>s.J,AgSelect:()=>s.K,AgSlider:()=>s.L,AgStackComponentsRegistry:()=>s.N,AgToggleButton:()=>s.Q,AlignedGridsService:()=>s.S,AnimateShowChangeCellRenderer:()=>s.T,AnimateSlideCellRenderer:()=>s.U,AnimationFrameService:()=>s.V,AutoScrollService:()=>s.W,AutoWidthCalculator:()=>s.X,Autowired:()=>s.A,BarColumnLabelPlacement:()=>s.Y,BaseComponentWrapper:()=>s.Z,Bean:()=>s._,BeanStub:()=>s.B,Beans:()=>s.$,BodyDropPivotTarget:()=>s.a0,BodyDropTarget:()=>s.a1,CellComp:()=>s.a2,CellCtrl:()=>s.a3,CellNavigationService:()=>s.a4,CellPositionUtils:()=>s.a5,CellRangeType:()=>s.a6,ChangedPath:()=>s.a7,CheckboxCellEditor:()=>s.a8,CheckboxCellRenderer:()=>s.a9,CheckboxSelectionComponent:()=>s.aa,ClientSideRowModelSteps:()=>s.ab,ClipboardModule:()=>Qa,ColDefUtil:()=>s.ac,Column:()=>s.ad,ColumnApi:()=>s.ae,ColumnFactory:()=>s.af,ColumnGroup:()=>s.ag,ColumnKeyCreator:()=>s.ah,ColumnModel:()=>s.ai,ColumnUtils:()=>s.aj,ColumnsToolPanelModule:()=>On,Component:()=>s.ak,ComponentUtil:()=>s.al,Context:()=>s.am,CssClassApplier:()=>s.an,CssClassManager:()=>s.ao,CtrlsService:()=>s.ap,DataTypeService:()=>s.aq,DateCellEditor:()=>s.ar,DateFilter:()=>s.as,DateStringCellEditor:()=>s.at,DisplayedGroupCreator:()=>s.au,DragAndDropService:()=>s.av,DragService:()=>s.aw,DragSourceType:()=>s.ax,EnterpriseCoreModule:()=>E,Environment:()=>s.ay,EventService:()=>s.az,Events:()=>s.aA,ExcelExportModule:()=>Gd,ExcelFactoryMode:()=>s.E,ExpansionService:()=>s.aB,ExpressionService:()=>s.aC,FilterManager:()=>s.aD,FiltersToolPanelModule:()=>th,FloatingFilterMapper:()=>s.aE,FocusService:()=>s.aF,GROUP_AUTO_COLUMN_ID:()=>s.aG,Grid:()=>s.aH,GridApi:()=>s.aI,GridBodyComp:()=>s.aJ,GridBodyCtrl:()=>s.aK,GridChartsModule:()=>Ha,GridComp:()=>s.aL,GridCoreCreator:()=>s.aM,GridCtrl:()=>s.aN,GridHeaderComp:()=>s.aO,GridHeaderCtrl:()=>s.aP,GridOptionsService:()=>s.aQ,GroupCellRenderer:()=>s.aR,GroupCellRendererCtrl:()=>s.aS,GroupInstanceIdCreator:()=>s.aT,HeaderCellCtrl:()=>s.aU,HeaderFilterCellComp:()=>s.aV,HeaderFilterCellCtrl:()=>s.aW,HeaderGroupCellCtrl:()=>s.aX,HeaderNavigationDirection:()=>s.aY,HeaderNavigationService:()=>s.aZ,HeaderPositionUtils:()=>s.a_,HeaderRowComp:()=>s.a$,HeaderRowContainerComp:()=>s.b0,HeaderRowContainerCtrl:()=>s.b1,HeaderRowCtrl:()=>s.b2,HeaderRowType:()=>s.b3,HorizontalDirection:()=>s.b4,HorizontalResizeService:()=>s.b5,KeyCode:()=>s.b6,LargeTextCellEditor:()=>s.b7,LayoutCssClasses:()=>s.b8,LicenseManager:()=>y,LocaleService:()=>s.b9,Logger:()=>s.ba,LoggerFactory:()=>s.bb,ManagedFocusFeature:()=>s.bc,MasterDetailModule:()=>uh,MenuModule:()=>Vh,MenuService:()=>s.bd,ModuleNames:()=>s.M,ModuleRegistry:()=>s.e,MouseEventService:()=>s.be,MoveColumnFeature:()=>s.bf,MultiFilter:()=>Zh,MultiFilterModule:()=>Qh,NavigationService:()=>s.bg,NumberCellEditor:()=>s.bh,NumberFilter:()=>s.bi,NumberSequence:()=>s.bj,Optional:()=>s.O,PaginationProxy:()=>s.bk,PillDragComp:()=>s.bl,PillDropZonePanel:()=>s.bm,PinnedRowModel:()=>s.bn,PivotDropZonePanel:()=>Fo,PopupComponent:()=>s.bo,PopupEditorWrapper:()=>s.bp,PopupService:()=>s.bq,PositionableFeature:()=>s.br,PostConstruct:()=>s.a,PreConstruct:()=>s.P,PreDestroy:()=>s.b,PrimaryColsPanel:()=>Dn,PropertyKeys:()=>s.bs,ProvidedColumnGroup:()=>s.bt,ProvidedFilter:()=>s.bu,Qualifier:()=>s.bv,QuerySelector:()=>s.bw,RangeSelectionModule:()=>ke,RefSelector:()=>s.R,ResizeObserverService:()=>s.bx,RichSelectModule:()=>tc,RowAnimationCssClasses:()=>s.by,RowContainerComp:()=>s.bz,RowContainerCtrl:()=>s.bA,RowContainerName:()=>s.bB,RowContainerType:()=>s.bC,RowCtrl:()=>s.bD,RowGroupDropZonePanel:()=>Po,RowGroupingModule:()=>No,RowHighlightPosition:()=>s.bE,RowNode:()=>s.bF,RowNodeBlock:()=>s.bG,RowNodeBlockLoader:()=>s.bH,RowNodeSorter:()=>s.bI,RowPositionUtils:()=>s.bJ,RowRenderer:()=>s.bK,ScalarFilter:()=>s.bL,ScrollVisibleService:()=>s.bM,SelectCellEditor:()=>s.bN,SelectableService:()=>s.bO,SelectionHandleType:()=>s.bP,ServerSideRowModelModule:()=>Lc,ServerSideTransactionResultStatus:()=>s.bQ,SetFilter:()=>Yc,SetFilterModule:()=>Qc,SetLeftFeature:()=>s.bR,SideBarModule:()=>on,SimpleFilter:()=>s.bS,SortController:()=>s.bT,SortIndicatorComp:()=>s.bU,SparklinesModule:()=>np,StandardMenuFactory:()=>s.bV,StatusBarModule:()=>yp,StylingService:()=>s.bW,TabGuardClassNames:()=>s.bX,TabGuardComp:()=>s.bY,TabGuardCtrl:()=>s.bZ,TabbedLayout:()=>s.b_,TemplateService:()=>s.b$,TextCellEditor:()=>s.c0,TextFilter:()=>s.c1,TextFloatingFilter:()=>s.c2,Timer:()=>s.c3,ToolPanelColDefService:()=>rn,TooltipFeature:()=>s.c4,TooltipStateManager:()=>s.c5,TouchListener:()=>s.c6,UserComponentFactory:()=>s.c7,UserComponentRegistry:()=>s.c8,ValueCache:()=>s.c9,ValueFormatterService:()=>s.ca,ValueParserService:()=>s.cb,ValueService:()=>s.cc,ValuesDropZonePanel:()=>ko,VanillaFrameworkOverrides:()=>s.cd,VerticalDirection:()=>s.ce,ViewportRowModelModule:()=>Ap,VirtualList:()=>s.cf,VirtualListDragFeature:()=>s.cg,_:()=>s.ch,__FORCE_MODULE_DETECTION_AG_GRID_CORE_EXT:()=>Wa,agCharts:()=>Ka,createGrid:()=>s.ci,exportMultipleSheetsAsExcel:()=>Nd,getMultipleSheetsAsExcel:()=>Od,getRowContainerTypeForName:()=>s.cj});var s=i(1971),r=i(341),a=Object.defineProperty,o=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,l=Object.prototype.hasOwnProperty,d=(e,t)=>{for(var i in t)a(e,i,{get:t[i],enumerable:!0})},h=(e,t,i,s)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of n(t))!l.call(e,r)&&r!==i&&a(e,r,{get:()=>t[r],enumerable:!(s=o(t,r))||s.enumerable});return e},c=(e,t,i)=>(h(e,t,"default"),i&&h(i,t,"default")),u=(e,t,i,s)=>{for(var r,n=s>1?void 0:s?o(t,i):t,l=e.length-1;l>=0;l--)(r=e[l])&&(n=(s?r(t,i,n):r(n))||n);return s&&n&&a(t,i,n),n},p={};d(p,{ALWAYS_SYNC_GLOBAL_EVENTS:()=>s.h,AbstractHeaderCellCtrl:()=>s.i,AdvancedFilterModule:()=>me,AgAbstractField:()=>s.j,AgAbstractLabel:()=>s.k,AgAutocomplete:()=>s.l,AgCheckbox:()=>s.m,AgDialog:()=>s.n,AgGroupComponent:()=>s.o,AgInputDateField:()=>s.p,AgInputNumberField:()=>s.q,AgInputRange:()=>s.r,AgInputTextArea:()=>s.s,AgInputTextField:()=>s.t,AgMenuItemComponent:()=>s.u,AgMenuItemRenderer:()=>s.v,AgMenuList:()=>s.w,AgMenuPanel:()=>s.x,AgPanel:()=>s.y,AgPickerField:()=>s.z,AgPromise:()=>s.D,AgPromiseStatus:()=>s.F,AgRadioButton:()=>s.H,AgRichSelect:()=>s.J,AgSelect:()=>s.K,AgSlider:()=>s.L,AgStackComponentsRegistry:()=>s.N,AgToggleButton:()=>s.Q,AlignedGridsService:()=>s.S,AnimateShowChangeCellRenderer:()=>s.T,AnimateSlideCellRenderer:()=>s.U,AnimationFrameService:()=>s.V,AutoScrollService:()=>s.W,AutoWidthCalculator:()=>s.X,Autowired:()=>s.A,BarColumnLabelPlacement:()=>s.Y,BaseComponentWrapper:()=>s.Z,Bean:()=>s._,BeanStub:()=>s.B,Beans:()=>s.$,BodyDropPivotTarget:()=>s.a0,BodyDropTarget:()=>s.a1,CellComp:()=>s.a2,CellCtrl:()=>s.a3,CellNavigationService:()=>s.a4,CellPositionUtils:()=>s.a5,CellRangeType:()=>s.a6,ChangedPath:()=>s.a7,CheckboxCellEditor:()=>s.a8,CheckboxCellRenderer:()=>s.a9,CheckboxSelectionComponent:()=>s.aa,ClientSideRowModelSteps:()=>s.ab,ClipboardModule:()=>Qa,ColDefUtil:()=>s.ac,Column:()=>s.ad,ColumnApi:()=>s.ae,ColumnFactory:()=>s.af,ColumnGroup:()=>s.ag,ColumnKeyCreator:()=>s.ah,ColumnModel:()=>s.ai,ColumnUtils:()=>s.aj,ColumnsToolPanelModule:()=>On,Component:()=>s.ak,ComponentUtil:()=>s.al,Context:()=>s.am,CssClassApplier:()=>s.an,CssClassManager:()=>s.ao,CtrlsService:()=>s.ap,DataTypeService:()=>s.aq,DateCellEditor:()=>s.ar,DateFilter:()=>s.as,DateStringCellEditor:()=>s.at,DisplayedGroupCreator:()=>s.au,DragAndDropService:()=>s.av,DragService:()=>s.aw,DragSourceType:()=>s.ax,EnterpriseCoreModule:()=>E,Environment:()=>s.ay,EventService:()=>s.az,Events:()=>s.aA,ExcelExportModule:()=>Gd,ExcelFactoryMode:()=>s.E,ExpansionService:()=>s.aB,ExpressionService:()=>s.aC,FilterManager:()=>s.aD,FiltersToolPanelModule:()=>th,FloatingFilterMapper:()=>s.aE,FocusService:()=>s.aF,GROUP_AUTO_COLUMN_ID:()=>s.aG,Grid:()=>s.aH,GridApi:()=>s.aI,GridBodyComp:()=>s.aJ,GridBodyCtrl:()=>s.aK,GridChartsModule:()=>Ha,GridComp:()=>s.aL,GridCoreCreator:()=>s.aM,GridCtrl:()=>s.aN,GridHeaderComp:()=>s.aO,GridHeaderCtrl:()=>s.aP,GridOptionsService:()=>s.aQ,GroupCellRenderer:()=>s.aR,GroupCellRendererCtrl:()=>s.aS,GroupInstanceIdCreator:()=>s.aT,HeaderCellCtrl:()=>s.aU,HeaderFilterCellComp:()=>s.aV,HeaderFilterCellCtrl:()=>s.aW,HeaderGroupCellCtrl:()=>s.aX,HeaderNavigationDirection:()=>s.aY,HeaderNavigationService:()=>s.aZ,HeaderPositionUtils:()=>s.a_,HeaderRowComp:()=>s.a$,HeaderRowContainerComp:()=>s.b0,HeaderRowContainerCtrl:()=>s.b1,HeaderRowCtrl:()=>s.b2,HeaderRowType:()=>s.b3,HorizontalDirection:()=>s.b4,HorizontalResizeService:()=>s.b5,KeyCode:()=>s.b6,LargeTextCellEditor:()=>s.b7,LayoutCssClasses:()=>s.b8,LicenseManager:()=>y,LocaleService:()=>s.b9,Logger:()=>s.ba,LoggerFactory:()=>s.bb,ManagedFocusFeature:()=>s.bc,MasterDetailModule:()=>uh,MenuModule:()=>Vh,MenuService:()=>s.bd,ModuleNames:()=>s.M,ModuleRegistry:()=>s.e,MouseEventService:()=>s.be,MoveColumnFeature:()=>s.bf,MultiFilter:()=>Zh,MultiFilterModule:()=>Qh,NavigationService:()=>s.bg,NumberCellEditor:()=>s.bh,NumberFilter:()=>s.bi,NumberSequence:()=>s.bj,Optional:()=>s.O,PaginationProxy:()=>s.bk,PillDragComp:()=>s.bl,PillDropZonePanel:()=>s.bm,PinnedRowModel:()=>s.bn,PivotDropZonePanel:()=>Fo,PopupComponent:()=>s.bo,PopupEditorWrapper:()=>s.bp,PopupService:()=>s.bq,PositionableFeature:()=>s.br,PostConstruct:()=>s.a,PreConstruct:()=>s.P,PreDestroy:()=>s.b,PrimaryColsPanel:()=>Dn,PropertyKeys:()=>s.bs,ProvidedColumnGroup:()=>s.bt,ProvidedFilter:()=>s.bu,Qualifier:()=>s.bv,QuerySelector:()=>s.bw,RangeSelectionModule:()=>ke,RefSelector:()=>s.R,ResizeObserverService:()=>s.bx,RichSelectModule:()=>tc,RowAnimationCssClasses:()=>s.by,RowContainerComp:()=>s.bz,RowContainerCtrl:()=>s.bA,RowContainerName:()=>s.bB,RowContainerType:()=>s.bC,RowCtrl:()=>s.bD,RowGroupDropZonePanel:()=>Po,RowGroupingModule:()=>No,RowHighlightPosition:()=>s.bE,RowNode:()=>s.bF,RowNodeBlock:()=>s.bG,RowNodeBlockLoader:()=>s.bH,RowNodeSorter:()=>s.bI,RowPositionUtils:()=>s.bJ,RowRenderer:()=>s.bK,ScalarFilter:()=>s.bL,ScrollVisibleService:()=>s.bM,SelectCellEditor:()=>s.bN,SelectableService:()=>s.bO,SelectionHandleType:()=>s.bP,ServerSideRowModelModule:()=>Lc,ServerSideTransactionResultStatus:()=>s.bQ,SetFilter:()=>Yc,SetFilterModule:()=>Qc,SetLeftFeature:()=>s.bR,SideBarModule:()=>on,SimpleFilter:()=>s.bS,SortController:()=>s.bT,SortIndicatorComp:()=>s.bU,SparklinesModule:()=>np,StandardMenuFactory:()=>s.bV,StatusBarModule:()=>yp,StylingService:()=>s.bW,TabGuardClassNames:()=>s.bX,TabGuardComp:()=>s.bY,TabGuardCtrl:()=>s.bZ,TabbedLayout:()=>s.b_,TemplateService:()=>s.b$,TextCellEditor:()=>s.c0,TextFilter:()=>s.c1,TextFloatingFilter:()=>s.c2,Timer:()=>s.c3,ToolPanelColDefService:()=>rn,TooltipFeature:()=>s.c4,TooltipStateManager:()=>s.c5,TouchListener:()=>s.c6,UserComponentFactory:()=>s.c7,UserComponentRegistry:()=>s.c8,ValueCache:()=>s.c9,ValueFormatterService:()=>s.ca,ValueParserService:()=>s.cb,ValueService:()=>s.cc,ValuesDropZonePanel:()=>ko,VanillaFrameworkOverrides:()=>s.cd,VerticalDirection:()=>s.ce,ViewportRowModelModule:()=>Ap,VirtualList:()=>s.cf,VirtualListDragFeature:()=>s.cg,_:()=>s.ch,__FORCE_MODULE_DETECTION_AG_GRID_CORE_EXT:()=>Wa,agCharts:()=>Ka,createGrid:()=>s.ci,exportMultipleSheetsAsExcel:()=>Nd,getMultipleSheetsAsExcel:()=>Od,getRowContainerTypeForName:()=>s.cj});var g=class{constructor(){this.ieCompatibility=!1}init(){this.ieCompatibility="5d41402abc4b2a76b9719d911017c592"!=this.md5("hello")}md5cycle(e,t){let i=e[0],s=e[1],r=e[2],a=e[3];i=this.ff(i,s,r,a,t[0],7,-680876936),a=this.ff(a,i,s,r,t[1],12,-389564586),r=this.ff(r,a,i,s,t[2],17,606105819),s=this.ff(s,r,a,i,t[3],22,-1044525330),i=this.ff(i,s,r,a,t[4],7,-176418897),a=this.ff(a,i,s,r,t[5],12,1200080426),r=this.ff(r,a,i,s,t[6],17,-1473231341),s=this.ff(s,r,a,i,t[7],22,-45705983),i=this.ff(i,s,r,a,t[8],7,1770035416),a=this.ff(a,i,s,r,t[9],12,-1958414417),r=this.ff(r,a,i,s,t[10],17,-42063),s=this.ff(s,r,a,i,t[11],22,-1990404162),i=this.ff(i,s,r,a,t[12],7,1804603682),a=this.ff(a,i,s,r,t[13],12,-40341101),r=this.ff(r,a,i,s,t[14],17,-1502002290),s=this.ff(s,r,a,i,t[15],22,1236535329),i=this.gg(i,s,r,a,t[1],5,-165796510),a=this.gg(a,i,s,r,t[6],9,-1069501632),r=this.gg(r,a,i,s,t[11],14,643717713),s=this.gg(s,r,a,i,t[0],20,-373897302),i=this.gg(i,s,r,a,t[5],5,-701558691),a=this.gg(a,i,s,r,t[10],9,38016083),r=this.gg(r,a,i,s,t[15],14,-660478335),s=this.gg(s,r,a,i,t[4],20,-405537848),i=this.gg(i,s,r,a,t[9],5,568446438),a=this.gg(a,i,s,r,t[14],9,-1019803690),r=this.gg(r,a,i,s,t[3],14,-187363961),s=this.gg(s,r,a,i,t[8],20,1163531501),i=this.gg(i,s,r,a,t[13],5,-1444681467),a=this.gg(a,i,s,r,t[2],9,-51403784),r=this.gg(r,a,i,s,t[7],14,1735328473),s=this.gg(s,r,a,i,t[12],20,-1926607734),i=this.hh(i,s,r,a,t[5],4,-378558),a=this.hh(a,i,s,r,t[8],11,-2022574463),r=this.hh(r,a,i,s,t[11],16,1839030562),s=this.hh(s,r,a,i,t[14],23,-35309556),i=this.hh(i,s,r,a,t[1],4,-1530992060),a=this.hh(a,i,s,r,t[4],11,1272893353),r=this.hh(r,a,i,s,t[7],16,-155497632),s=this.hh(s,r,a,i,t[10],23,-1094730640),i=this.hh(i,s,r,a,t[13],4,681279174),a=this.hh(a,i,s,r,t[0],11,-358537222),r=this.hh(r,a,i,s,t[3],16,-722521979),s=this.hh(s,r,a,i,t[6],23,76029189),i=this.hh(i,s,r,a,t[9],4,-640364487),a=this.hh(a,i,s,r,t[12],11,-421815835),r=this.hh(r,a,i,s,t[15],16,530742520),s=this.hh(s,r,a,i,t[2],23,-995338651),i=this.ii(i,s,r,a,t[0],6,-198630844),a=this.ii(a,i,s,r,t[7],10,1126891415),r=this.ii(r,a,i,s,t[14],15,-1416354905),s=this.ii(s,r,a,i,t[5],21,-57434055),i=this.ii(i,s,r,a,t[12],6,1700485571),a=this.ii(a,i,s,r,t[3],10,-1894986606),r=this.ii(r,a,i,s,t[10],15,-1051523),s=this.ii(s,r,a,i,t[1],21,-2054922799),i=this.ii(i,s,r,a,t[8],6,1873313359),a=this.ii(a,i,s,r,t[15],10,-30611744),r=this.ii(r,a,i,s,t[6],15,-1560198380),s=this.ii(s,r,a,i,t[13],21,1309151649),i=this.ii(i,s,r,a,t[4],6,-145523070),a=this.ii(a,i,s,r,t[11],10,-1120210379),r=this.ii(r,a,i,s,t[2],15,718787259),s=this.ii(s,r,a,i,t[9],21,-343485551),e[0]=this.add32(i,e[0]),e[1]=this.add32(s,e[1]),e[2]=this.add32(r,e[2]),e[3]=this.add32(a,e[3])}cmn(e,t,i,s,r,a){return t=this.add32(this.add32(t,e),this.add32(s,a)),this.add32(t<<r|t>>>32-r,i)}ff(e,t,i,s,r,a,o){return this.cmn(t&i|~t&s,e,t,r,a,o)}gg(e,t,i,s,r,a,o){return this.cmn(t&s|i&~s,e,t,r,a,o)}hh(e,t,i,s,r,a,o){return this.cmn(t^i^s,e,t,r,a,o)}ii(e,t,i,s,r,a,o){return this.cmn(i^(t|~s),e,t,r,a,o)}md51(e){const t=e.length,i=[1732584193,-271733879,-1732584194,271733878];let s;for(s=64;s<=e.length;s+=64)this.md5cycle(i,this.md5blk(e.substring(s-64,s)));e=e.substring(s-64);const r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(s=0;s<e.length;s++)r[s>>2]|=e.charCodeAt(s)<<(s%4<<3);if(r[s>>2]|=128<<(s%4<<3),s>55)for(this.md5cycle(i,r),s=0;s<16;s++)r[s]=0;return r[14]=8*t,this.md5cycle(i,r),i}md5blk(e){const t=[];for(let i=0;i<64;i+=4)t[i>>2]=e.charCodeAt(i)+(e.charCodeAt(i+1)<<8)+(e.charCodeAt(i+2)<<16)+(e.charCodeAt(i+3)<<24);return t}rhex(e){const t="0123456789abcdef".split("");let i="",s=0;for(;s<4;s++)i+=t[e>>8*s+4&15]+t[e>>8*s&15];return i}hex(e){for(let t=0;t<e.length;t++)e[t]=this.rhex(e[t]);return e.join("")}md5(e){return this.hex(this.md51(e))}add32(e,t){return this.ieCompatibility?this.add32Compat(e,t):this.add32Std(e,t)}add32Std(e,t){return e+t&4294967295}add32Compat(e,t){const i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}};function m(e){return null==e||0===e.length}var v={"01":"GRID","02":"CHARTS","0102":"BOTH"},C=class e{constructor(e){this.watermarkMessage=void 0,this.totalMessageLength=124,this.document=e,this.md5=new g,this.md5.init()}validateLicense(){const t=this.getLicenseDetails(e.licenseKey),i=`AG Grid ${"BOTH"===t.currentLicenseType?"and AG Charts ":""}Enterprise`,s=void 0===t.suppliedLicenseType?"":`AG ${"BOTH"===t.suppliedLicenseType?"Grid and AG Charts":"GRID"===t.suppliedLicenseType?"Grid":"Charts"} Enterprise`;if(t.missing)(!this.isWebsiteUrl()||this.isForceWatermark())&&this.outputMissingLicenseKey(i);else if(t.expired){const r=e.getGridReleaseDate(),a=e.formatDate(r);this.outputExpiredKey(t.expiry,a,i,s)}else t.valid?t.isTrial&&t.trialExpired&&this.outputExpiredTrialKey(t.expiry,i,s):this.outputInvalidLicenseKey(!!t.incorrectLicenseType,i,s)}static extractExpiry(t){const i=t.substring(t.lastIndexOf("_")+1,t.length);return new Date(parseInt(e.decode(i),10))}static extractLicenseComponents(t){let i=t.replace(/[\u200B-\u200D\uFEFF]/g,"");if(i=i.replace(/\r?\n|\r/g,""),t.length<=32)return{md5:null,license:t,version:null,isTrial:null};const s=i.length-32,r=i.substring(s),a=i.substring(0,s),[o,n,l]=e.extractBracketedInformation(i);return{md5:r,license:a,version:o,isTrial:n,type:l}}getLicenseDetails(t){const i=e.chartsLicenseManager?"BOTH":"GRID";if(m(t))return{licenseKey:t,valid:!1,missing:!0,currentLicenseType:i};const s=e.getGridReleaseDate(),{md5:r,license:a,version:o,isTrial:n,type:l}=e.extractLicenseComponents(t);let d,h,c,u=r===this.md5.md5(a)&&-1===t.indexOf("For_Trialing_ag-Grid_Only"),p=null,g=!1;function C(){d=p<new Date,h=void 0}if(u&&(p=e.extractExpiry(a),u=!isNaN(p.getTime()),u))switch(h=s>p,o){case"legacy":case"2":n&&C();break;case"3":m(l)?u=!1:(c=l,l!==v["01"]&&l!==v["0102"]||"BOTH"===i&&"BOTH"!==c?(u=!1,g=!0):n&&C())}return u?{licenseKey:t,valid:u,expiry:e.formatDate(p),expired:h,version:o,isTrial:n,trialExpired:d,incorrectLicenseType:g,currentLicenseType:i,suppliedLicenseType:c}:{licenseKey:t,valid:u,incorrectLicenseType:g,currentLicenseType:i,suppliedLicenseType:c}}isDisplayWatermark(){return this.isForceWatermark()||!this.isLocalhost()&&!this.isWebsiteUrl()&&!m(this.watermarkMessage)}getWatermarkMessage(){return this.watermarkMessage||""}getHostname(){const e=(this.document.defaultView||window).location,{hostname:t=""}=e;return t}isForceWatermark(){const e=(this.document.defaultView||window).location,{pathname:t}=e;return!!t&&-1!==t.indexOf("forceWatermark")}isWebsiteUrl(){return null!==this.getHostname().match(/^((?:[\w-]+\.)?ag-grid\.com)$/)}isLocalhost(){return null!==this.getHostname().match(/^(?:127\.0\.0\.1|localhost)$/)}static formatDate(e){const t=e.getDate(),i=e.getMonth(),s=e.getFullYear();return t+" "+["January","February","March","April","May","June","July","August","September","October","November","December"][i]+" "+s}static getGridReleaseDate(){return new Date(parseInt(e.decode(e.RELEASE_INFORMATION),10))}static decode(t){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let s,r,a,o,n,l,d,h="",c=0;const u=t.replace(/[^A-Za-z0-9+/=]/g,"");for(;c<u.length;)o=i.indexOf(u.charAt(c++)),n=i.indexOf(u.charAt(c++)),l=i.indexOf(u.charAt(c++)),d=i.indexOf(u.charAt(c++)),s=o<<2|n>>4,r=(15&n)<<4|l>>2,a=(3&l)<<6|d,h+=String.fromCharCode(s),64!=l&&(h+=String.fromCharCode(r)),64!=d&&(h+=String.fromCharCode(a));return h=e.utf8_decode(h),h}static utf8_decode(e){e=e.replace(/rn/g,"n");let t="";for(let i=0;i<e.length;i++){const s=e.charCodeAt(i);s<128?t+=String.fromCharCode(s):s>127&&s<2048?(t+=String.fromCharCode(s>>6|192),t+=String.fromCharCode(63&s|128)):(t+=String.fromCharCode(s>>12|224),t+=String.fromCharCode(s>>6&63|128),t+=String.fromCharCode(63&s|128))}return t}static setChartsLicenseManager(e){this.chartsLicenseManager=e}static setLicenseKey(e){this.licenseKey=e,this.chartsLicenseManager&&this.chartsLicenseManager.setLicenseKey(e,!0)}static extractBracketedInformation(e){if(!e.includes("["))return["legacy",!1,void 0];const t=e.match(/\[(.*?)\]/g).map((e=>e.replace("[","").replace("]","")));if(!t||0===t.length)return["legacy",!1,void 0];const i=1===t.filter((e=>"TRIAL"===e)).length,s=t.filter((e=>0===e.indexOf("v")))[0];return[s?s.replace("v",""):"legacy",i,v[t.filter((e=>v[e]))[0]]]}centerPadAndOutput(e){const t=this.totalMessageLength-e.length;console.error(e.padStart(t/2+e.length,"*").padEnd(this.totalMessageLength,"*"))}padAndOutput(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";console.error(e.padEnd(this.totalMessageLength-i.length,t)+i)}outputInvalidLicenseKey(e,t,i){e?(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${t} License `),this.centerPadAndOutput(" Incompatible License Key "),this.padAndOutput(`* Your license key is for ${i} only and does not cover you for ${t}.`," ","*"),this.padAndOutput("* Please contact info@ag-grid.com to obtain a combined license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")):(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${t} License `),this.centerPadAndOutput(" Invalid License Key "),this.padAndOutput("* Your license key is not valid - please contact info@ag-grid.com to obtain a valid license."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="Invalid License"}outputExpiredTrialKey(e,t,i){this.centerPadAndOutput(""),this.centerPadAndOutput(` ${t} License `),this.centerPadAndOutput(" Trial Period Expired. "),this.padAndOutput(`* Your trial only license for ${i} expired on ${e}.`," ","*"),this.padAndOutput("* Please email info@ag-grid.com to purchase a license."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput(""),this.watermarkMessage="Trial Period Expired"}outputMissingLicenseKey(e){this.centerPadAndOutput(""),this.centerPadAndOutput(` ${e} License `),this.centerPadAndOutput(" License Key Not Found "),this.padAndOutput(`* All ${e} features are unlocked for trial.`," ","*"),this.padAndOutput("* If you want to hide the watermark please email info@ag-grid.com for a trial license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput(""),this.watermarkMessage="For Trial Use Only"}outputExpiredKey(e,t,i,s){this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Incompatible Software Version "),this.padAndOutput(`* Your license key works with versions of ${s} released before ${e}.`," ","*"),this.padAndOutput(`* The version you are trying to use was released on ${t}.`," ","*"),this.padAndOutput("* Please contact info@ag-grid.com to renew your license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput(""),this.watermarkMessage="License Expired"}};C.RELEASE_INFORMATION="MTcxMjU1ODYyOTkzMw==";var f=C,y=class extends s.B{validateLicense(){this.licenseManager=new f(this.gridOptionsService.getDocument()),this.licenseManager.validateLicense()}static getLicenseDetails(e){return new f(null).getLicenseDetails(e)}isDisplayWatermark(){return this.licenseManager.isDisplayWatermark()}getWatermarkMessage(){return this.licenseManager.getWatermarkMessage()}static setLicenseKey(e){f.setLicenseKey(e)}static setChartsLicenseManager(e){f.setChartsLicenseManager(e)}};u([s.P],y.prototype,"validateLicense",1),y=u([(0,s._)("licenseManager")],y);var S=class extends s.ak{constructor(){super('<div class="ag-watermark">\n                <div ref="eLicenseTextRef" class="ag-watermark-text"></div>\n            </div>')}postConstruct(){const e=this.shouldDisplayWatermark();this.setDisplayed(e),e&&(this.eLicenseTextRef.innerText=this.licenseManager.getWatermarkMessage(),window.setTimeout((()=>this.addCssClass("ag-opacity-zero")),0),window.setTimeout((()=>this.setDisplayed(!1)),5e3))}shouldDisplayWatermark(){return this.licenseManager.isDisplayWatermark()}};u([(0,s.A)("licenseManager")],S.prototype,"licenseManager",2),u([(0,s.R)("eLicenseTextRef")],S.prototype,"eLicenseTextRef",2),u([s.a],S.prototype,"postConstruct",1);var E={version:"31.2.1",moduleName:s.M.EnterpriseCoreModule,beans:[y],agStackComponents:[{componentName:"AgWatermark",componentClass:S}]},b=Object.defineProperty,w=Object.defineProperties,A=Object.getOwnPropertyDescriptor,x=Object.getOwnPropertyDescriptors,T=Object.getOwnPropertySymbols,M=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable,F=(e,t,i)=>t in e?b(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,D=(e,t)=>{for(var i in t||(t={}))M.call(t,i)&&F(e,i,t[i]);if(T)for(var i of T(t))P.call(t,i)&&F(e,i,t[i]);return e},R=(e,t)=>w(e,x(t)),L=(e,t,i,s)=>{for(var r,a=s>1?void 0:s?A(t,i):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s?r(t,i,a):r(a))||a);return s&&a&&b(t,i,a),a},I=class extends s.ak{constructor(e){super('\n            <div class="ag-advanced-filter-header" role="row">\n            </div>'),this.enabled=e}postConstruct(){this.setupAdvancedFilter(this.enabled),this.addDestroyFunc((()=>this.destroyBean(this.eAdvancedFilter))),this.addManagedListener(this.eventService,s.aA.EVENT_GRID_COLUMNS_CHANGED,(()=>this.onGridColumnsChanged())),this.addGuiEventListener("keydown",(e=>this.onKeyDown(e))),this.addGuiEventListener("focusout",(e=>{this.getFocusableElement().contains(e.relatedTarget)||this.focusService.clearAdvancedFilterColumn()}))}getFocusableElement(){var e,t;return null!=(t=null==(e=this.eAdvancedFilter)?void 0:e.getGui())?t:this.getGui()}setEnabled(e){e!==this.enabled&&this.setupAdvancedFilter(e)}refresh(){var e;null==(e=this.eAdvancedFilter)||e.refresh()}getHeight(){return this.height}setInputDisabled(e){var t;null==(t=this.eAdvancedFilter)||t.setInputDisabled(e)}setupAdvancedFilter(e){const t=this.getGui();if(e){this.eAdvancedFilter=this.createBean(new q);const e=this.eAdvancedFilter.getGui();this.eAdvancedFilter.addCssClass("ag-advanced-filter-header-cell"),this.height=this.columnModel.getFloatingFiltersHeight();const i=`${this.height}px`;t.style.height=i,t.style.minHeight=i,this.setAriaRowIndex(),s.ch.setAriaRole(e,"gridcell"),s.ch.setAriaColIndex(e,1),this.setAriaColumnCount(e),t.appendChild(e)}else s.ch.clearElement(t),this.destroyBean(this.eAdvancedFilter),this.height=0;s.ch.setDisplayed(t,e),this.enabled=e}setAriaColumnCount(e){s.ch.setAriaColSpan(e,this.columnModel.getAllGridColumns().length)}setAriaRowIndex(){s.ch.setAriaRowIndex(this.getGui(),this.headerNavigationService.getHeaderRowCount())}onGridColumnsChanged(){this.eAdvancedFilter&&(this.setAriaColumnCount(this.eAdvancedFilter.getGui()),this.setAriaRowIndex())}onKeyDown(e){switch(e.key){case s.b6.ENTER:this.hasFocus()&&this.focusService.focusInto(this.getFocusableElement())&&e.preventDefault();break;case s.b6.ESCAPE:this.hasFocus()||this.getFocusableElement().focus();break;case s.b6.UP:this.navigateUpDown(!0,e);break;case s.b6.DOWN:this.navigateUpDown(!1,e);break;case s.b6.TAB:if(this.hasFocus())this.navigateLeftRight(e);else{const t=this.focusService.findNextFocusableElement(this.getFocusableElement(),null,e.shiftKey);t?(e.preventDefault(),t.focus()):this.navigateLeftRight(e)}}}navigateUpDown(e,t){this.hasFocus()&&this.focusService.focusNextFromAdvancedFilter(e)&&t.preventDefault()}navigateLeftRight(e){(e.shiftKey?this.focusService.focusLastHeader():this.focusService.focusNextFromAdvancedFilter(!1,!0))&&e.preventDefault()}hasFocus(){return this.gridOptionsService.getDocument().activeElement===this.getFocusableElement()}};L([(0,s.A)("columnModel")],I.prototype,"columnModel",2),L([(0,s.A)("focusService")],I.prototype,"focusService",2),L([(0,s.A)("headerNavigationService")],I.prototype,"headerNavigationService",2),L([s.a],I.prototype,"postConstruct",1);var O=class extends s.J{constructor(e){super(R(D({},e),{template:'\n                <div class="ag-picker-field" role="presentation">\n                    <div ref="eLabel"></div>\n                    <div ref="eWrapper" class="ag-wrapper ag-picker-collapsed">\n                        <div ref="eDisplayField" class="ag-picker-field-display"></div>\n                        <ag-input-text-field ref="eInput" class="ag-rich-select-field-input"></ag-input-text-field>\n                        <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>\n                    </div>\n                </div>'})),this.params=e}showPicker(){setTimeout((()=>super.showPicker()))}hidePicker(){setTimeout((()=>super.hidePicker()))}postConstruct(){super.postConstruct();const{wrapperClassName:e,ariaLabel:t}=this.params;s.ch.setDisplayed(this.eDisplayField,!1),e&&this.eWrapper.classList.add(e),s.ch.setAriaLabelledBy(this.eWrapper,""),s.ch.setAriaLabel(this.eWrapper,t)}onEnterKeyDown(e){s.ch.stopPropagationForAgGrid(e),this.isPickerDisplayed?super.onEnterKeyDown(e):(e.preventDefault(),this.showPicker())}},N=class e extends s.B{constructor(e,t){super(),this.comp=e,this.virtualList=t}postConstruct(){this.createManagedBean(new s.cg(this.comp,this.virtualList,{dragSourceType:s.ax.AdvancedFilterBuilder,listItemDragStartEvent:e.EVENT_DRAG_STARTED,listItemDragEndEvent:e.EVENT_DRAG_ENDED,eventSource:this,getCurrentDragValue:e=>this.getCurrentDragValue(e),isMoveBlocked:()=>!1,getNumRows:e=>e.getNumItems(),moveItem:(e,t)=>this.moveItem(e,t)}))}getCurrentDragValue(e){return e.item}moveItem(e,t){this.comp.moveItem(e,t)}};N.EVENT_DRAG_STARTED="advancedFilterBuilderDragStarted",N.EVENT_DRAG_ENDED="advancedFilterBuilderDragEnded",L([s.a],N.prototype,"postConstruct",1);var k=N,G=class extends s.B{constructor(e,t,i){super(),this.eGui=e,this.focusWrapper=t,this.eFocusableComp=i}postConstruct(){this.addManagedListener(this.eGui,"keydown",(e=>{switch(e.key){case s.b6.TAB:e.defaultPrevented||s.ch.stopPropagationForAgGrid(e);break;case s.b6.UP:case s.b6.DOWN:s.ch.stopPropagationForAgGrid(e);break;case s.b6.ESCAPE:if(s.ch.isStopPropagationForAgGrid(e))return;const t=this.gridOptionsService.getDocument();this.eGui.contains(t.activeElement)&&(e.preventDefault(),s.ch.stopPropagationForAgGrid(e),this.focusWrapper.focus())}})),this.addManagedListener(this.focusWrapper,"keydown",(e=>{if(e.key===s.b6.ENTER){if(s.ch.isStopPropagationForAgGrid(e))return;this.gridOptionsService.getDocument().activeElement===this.focusWrapper&&(e.preventDefault(),s.ch.stopPropagationForAgGrid(e),this.eFocusableComp.getFocusableElement().focus())}})),this.addManagedListener(this.focusWrapper,"focusin",(()=>{this.focusWrapper.classList.add("ag-advanced-filter-builder-virtual-list-item-highlight")})),this.addManagedListener(this.focusWrapper,"focusout",(e=>{this.focusWrapper.contains(e.relatedTarget)||this.focusWrapper.classList.remove("ag-advanced-filter-builder-virtual-list-item-highlight")}))}};function V(e,t){return{pickerAriaLabelKey:"ariaLabelAdvancedFilterBuilderAddField",pickerAriaLabelValue:"Advanced Filter Builder Add Field",pickerType:"ag-list",valueList:[{key:"condition",displayValue:e("advancedFilterBuilderAddCondition")},{key:"join",displayValue:e("advancedFilterBuilderAddJoin")}],valueFormatter:e=>{var t;return null==e?null:null!=(t=e.displayValue)?t:e.key},pickerIcon:"advancedFilterBuilderAdd",maxPickerWidth:`${t??120}px`,wrapperClassName:"ag-advanced-filter-builder-item-button",ariaLabel:e("advancedFilterBuilderAddButtonTooltip")}}L([s.a],G.prototype,"postConstruct",1);var B=class{};B.EVENT_ADDED="advancedFilterBuilderAdded",B.EVENT_MOVED="advancedFilterBuilderMoved",B.EVENT_REMOVED="advancedFilterBuilderRemoved",B.EVENT_VALUE_CHANGED="advancedFilterBuilderValueChanged",B.EVENT_VALID_CHANGED="advancedFilterBuilderValidChanged";var _=class extends s.ak{constructor(){super('\n            <div class="ag-advanced-filter-builder-item-condition" role="presentation"></div>\n        '),this.validationMessage=null}init(e){const{item:t,createPill:i}=e;this.item=t,this.createPill=i,this.filterModel=t.filterModel,this.setupColumnCondition(this.filterModel),this.validate(),this.addDestroyFunc((()=>this.destroyBeans([this.eColumnPill,this.eOperatorPill,this.eOperandPill])))}getDragName(){return this.filterModel.colId?this.advancedFilterExpressionService.parseColumnFilterModel(this.filterModel):this.getDefaultColumnDisplayValue()}getAriaLabel(){return`${this.advancedFilterExpressionService.translate("ariaAdvancedFilterBuilderFilterItem")} ${this.getDragName()}`}getValidationMessage(){return this.validationMessage}getFocusableElement(){return this.eColumnPill.getFocusableElement()}setupColumnCondition(e){var t;const i=this.advancedFilterExpressionService.getColumnDetails(e.colId);this.baseCellDataType=i.baseCellDataType,this.column=i.column,this.numOperands=this.getNumOperands(this.getOperatorKey()),this.eColumnPill=this.createPill({key:this.getColumnKey(),displayValue:null!=(t=this.getColumnDisplayValue())?t:this.getDefaultColumnDisplayValue(),cssClass:"ag-advanced-filter-builder-column-pill",isSelect:!0,getEditorParams:()=>({values:this.advancedFilterExpressionService.getColumnAutocompleteEntries()}),update:e=>this.setColumnKey(e),pickerAriaLabelKey:"ariaLabelAdvancedFilterBuilderColumnSelectField",pickerAriaLabelValue:"Advanced Filter Builder Column Select Field",ariaLabel:this.advancedFilterExpressionService.translate("ariaAdvancedFilterBuilderColumn")}),this.getGui().appendChild(this.eColumnPill.getGui()),s.ch.exists(this.getColumnKey())&&(this.createOperatorPill(),this.hasOperand()&&this.createOperandPill())}createOperatorPill(){var e;this.eOperatorPill=this.createPill({key:this.getOperatorKey(),displayValue:null!=(e=this.getOperatorDisplayValue())?e:this.getDefaultOptionSelectValue(),cssClass:"ag-advanced-filter-builder-option-pill",isSelect:!0,getEditorParams:()=>({values:this.getOperatorAutocompleteEntries()}),update:e=>this.setOperatorKey(e),pickerAriaLabelKey:"ariaLabelAdvancedFilterBuilderOptionSelectField",pickerAriaLabelValue:"Advanced Filter Builder Option Select Field",ariaLabel:this.advancedFilterExpressionService.translate("ariaAdvancedFilterBuilderOption")}),this.eColumnPill.getGui().insertAdjacentElement("afterend",this.eOperatorPill.getGui())}createOperandPill(){var e;const t=null!=(e=this.getOperandDisplayValue())?e:"";this.eOperandPill=this.createPill({key:t,displayValue:t,baseCellDataType:this.baseCellDataType,cssClass:"ag-advanced-filter-builder-value-pill",isSelect:!1,update:e=>this.setOperand(e),ariaLabel:this.advancedFilterExpressionService.translate("ariaAdvancedFilterBuilderValue")}),this.getGui().appendChild(this.eOperandPill.getGui())}getColumnKey(){return this.filterModel.colId}getColumnDisplayValue(){return this.advancedFilterExpressionService.getColumnDisplayValue(this.filterModel)}getOperatorKey(){return this.filterModel.type}getOperatorDisplayValue(){return this.advancedFilterExpressionService.getOperatorDisplayValue(this.filterModel)}getOperandDisplayValue(){return this.advancedFilterExpressionService.getOperandDisplayValue(this.filterModel,!0)}hasOperand(){return this.numOperands>0}getOperatorAutocompleteEntries(){return this.column?this.advancedFilterExpressionService.getOperatorAutocompleteEntries(this.column,this.baseCellDataType):[]}setColumnKey(e){this.eOperatorPill||this.createOperatorPill();const t=this.advancedFilterExpressionService.getColumnDetails(e);this.column=t.column;const i=t.baseCellDataType;this.baseCellDataType!==i&&(this.baseCellDataType=i,this.setOperatorKey(void 0),this.eOperatorPill&&(s.ch.removeFromParent(this.eOperatorPill.getGui()),this.destroyBean(this.eOperatorPill),this.createOperatorPill()),this.validate()),this.filterModel.colId=e,this.filterModel.filterType=this.baseCellDataType}setOperatorKey(e){const t=this.getNumOperands(e);t!==this.numOperands&&(this.numOperands=t,0===t?this.destroyOperandPill():(this.createOperandPill(),"number"!==this.baseCellDataType&&this.setOperand(""))),this.filterModel.type=e,this.validate()}setOperand(e){var t;let i=e;this.column&&(i=null!=(t=this.advancedFilterExpressionService.getOperandModelValue(e,this.baseCellDataType,this.column))?t:""),this.filterModel.filter=i,this.validate()}getNumOperands(e){var t,i;return null!=(i=null==(t=this.advancedFilterExpressionService.getExpressionOperator(this.baseCellDataType,e))?void 0:t.numOperands)?i:0}destroyOperandPill(){delete this.filterModel.filter,this.getGui().removeChild(this.eOperandPill.getGui()),this.destroyBean(this.eOperandPill),this.eOperandPill=void 0}validate(){let e=null;s.ch.exists(this.getColumnKey())?s.ch.exists(this.getOperatorKey())?this.numOperands>0&&!s.ch.exists(this.getOperandDisplayValue())&&(e=this.advancedFilterExpressionService.translate("advancedFilterBuilderValidationEnterValue")):e=this.advancedFilterExpressionService.translate("advancedFilterBuilderValidationSelectOption"):e=this.advancedFilterExpressionService.translate("advancedFilterBuilderValidationSelectColumn"),this.item.valid=!e,e!==this.validationMessage&&(this.validationMessage=e,this.dispatchEvent({type:B.EVENT_VALID_CHANGED}))}getDefaultColumnDisplayValue(){return this.advancedFilterExpressionService.translate("advancedFilterBuilderSelectColumn")}getDefaultOptionSelectValue(){return this.advancedFilterExpressionService.translate("advancedFilterBuilderSelectOption")}};L([(0,s.A)("advancedFilterExpressionService")],_.prototype,"advancedFilterExpressionService",2),L([(0,s.A)("valueParserService")],_.prototype,"valueParserService",2);var U=class extends s.ak{constructor(e){super('\n            <div class="ag-advanced-filter-builder-pill-wrapper" role="presentation">\n                <div ref="ePill" class="ag-advanced-filter-builder-pill" role="button">\n                    <span ref="eLabel" class="ag-advanced-filter-builder-pill-display"></span>\n                </div>\n            </div>\n        '),this.params=e,this.value=e.value}postConstruct(){const{cssClass:e,ariaLabel:t}=this.params;this.ePill.classList.add(e),this.activateTabIndex([this.ePill]),this.eLabel.id=`${this.getCompId()}`,s.ch.setAriaDescribedBy(this.ePill,this.eLabel.id),s.ch.setAriaLabel(this.ePill,t),this.renderValue(),this.addManagedListener(this.ePill,"click",(e=>{e.preventDefault(),this.showEditor()})),this.addManagedListener(this.ePill,"keydown",(e=>{if(e.key===s.b6.ENTER)e.preventDefault(),s.ch.stopPropagationForAgGrid(e),this.showEditor()})),this.addDestroyFunc((()=>this.destroyBean(this.eEditor)))}getFocusableElement(){return this.ePill}showEditor(){if(this.eEditor)return;s.ch.setDisplayed(this.ePill,!1),this.eEditor=this.createEditorComp(this.params.type),this.eEditor.setValue(this.value);const e=this.eEditor.getGui();this.eEditor.addManagedListener(e,"keydown",(e=>{switch(e.key){case s.b6.ENTER:e.preventDefault(),s.ch.stopPropagationForAgGrid(e),this.updateValue(!0);break;case s.b6.ESCAPE:e.preventDefault(),s.ch.stopPropagationForAgGrid(e),this.hideEditor(!0)}})),this.eEditor.addManagedListener(e,"focusout",(()=>{this.updateValue(!1)})),this.getGui().appendChild(e),this.eEditor.getFocusableElement().focus()}createEditorComp(e){let t;switch(e){case"text":t=new s.t;break;case"number":t=new s.q;break;case"date":t=new s.p}return this.createBean(t)}hideEditor(e){const{eEditor:t}=this;t&&(this.eEditor=void 0,this.getGui().removeChild(t.getGui()),this.destroyBean(t),s.ch.setDisplayed(this.ePill,!0),e&&this.ePill.focus())}renderValue(){let e;this.eLabel.classList.remove("ag-advanced-filter-builder-value-empty","ag-advanced-filter-builder-value-number","ag-advanced-filter-builder-value-text"),s.ch.exists(this.value)?"number"===this.params.type?(e=this.value,this.eLabel.classList.add("ag-advanced-filter-builder-value-number")):(e=`"${this.value}"`,this.eLabel.classList.add("ag-advanced-filter-builder-value-text")):(e=this.advancedFilterExpressionService.translate("advancedFilterBuilderEnterValue"),this.eLabel.classList.add("ag-advanced-filter-builder-value-empty")),this.eLabel.innerText=e}updateValue(e){var t;if(!this.eEditor)return;const i=null!=(t=this.eEditor.getValue())?t:"";this.dispatchEvent({type:s.aA.EVENT_FIELD_VALUE_CHANGED,value:i}),this.value=i,this.renderValue(),this.hideEditor(e)}};L([(0,s.R)("ePill")],U.prototype,"ePill",2),L([(0,s.R)("eLabel")],U.prototype,"eLabel",2),L([(0,s.A)("advancedFilterExpressionService")],U.prototype,"advancedFilterExpressionService",2),L([s.a],U.prototype,"postConstruct",1);var H=class extends s.ak{constructor(){super('\n            <div class="ag-advanced-filter-builder-item-condition" role="presentation"></div>\n        ')}init(e){const{item:t,createPill:i}=e,s=t.filterModel;this.filterModel=s,this.ePill=i({key:s.type,displayValue:this.advancedFilterExpressionService.parseJoinOperator(s),cssClass:"ag-advanced-filter-builder-join-pill",isSelect:!0,getEditorParams:()=>({values:this.advancedFilterExpressionService.getJoinOperatorAutocompleteEntries()}),update:e=>s.type=e,pickerAriaLabelKey:"ariaLabelAdvancedFilterBuilderJoinSelectField",pickerAriaLabelValue:"Advanced Filter Builder Join Operator Select Field",ariaLabel:this.advancedFilterExpressionService.translate("ariaAdvancedFilterBuilderJoinOperator")}),this.getGui().appendChild(this.ePill.getGui()),this.addDestroyFunc((()=>this.destroyBean(this.ePill)))}getDragName(){return this.advancedFilterExpressionService.parseJoinOperator(this.filterModel)}getAriaLabel(){return`${this.advancedFilterExpressionService.translate("ariaAdvancedFilterBuilderGroupItem")} ${this.getDragName()}`}getValidationMessage(){return null}getFocusableElement(){return this.ePill.getFocusableElement()}};L([(0,s.A)("advancedFilterExpressionService")],H.prototype,"advancedFilterExpressionService",2);var W=class extends s.J{constructor(e){super(R(D({},e),{template:'\n                <div class="ag-picker-field ag-advanced-filter-builder-pill-wrapper" role="presentation">\n                    <div ref="eLabel"></div>\n                    <div ref="eWrapper" class="ag-wrapper ag-advanced-filter-builder-pill ag-picker-collapsed">\n                        <div ref="eDisplayField" class="ag-picker-field-display ag-advanced-filter-builder-pill-display"></div>\n                        <ag-input-text-field ref="eInput" class="ag-rich-select-field-input"></ag-input-text-field>\n                        <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>\n                    </div>\n                </div>'})),this.params=e}getFocusableElement(){return this.eWrapper}showPicker(){setTimeout((()=>super.showPicker()))}hidePicker(){setTimeout((()=>super.hidePicker()))}postConstruct(){super.postConstruct();const{wrapperClassName:e,ariaLabel:t}=this.params;this.eWrapper.classList.add(e),s.ch.setAriaLabelledBy(this.eWrapper,""),s.ch.setAriaLabel(this.eWrapper,t)}createPickerComponent(){var e;if(!this.values){const{values:t}=this.params.getEditorParams();this.values=t;const i=this.value.key,s=null!=(e=t.find((e=>e.key===i)))?e:{key:i,displayValue:this.value.displayValue};this.value=s}return super.createPickerComponent()}onEnterKeyDown(e){s.ch.stopPropagationForAgGrid(e),this.isPickerDisplayed?super.onEnterKeyDown(e):(e.preventDefault(),this.showPicker())}},K=class extends s.bY{constructor(e,t,i){super('\n            <div class="ag-advanced-filter-builder-item-wrapper" role="presentation">\n                <div ref="eItem" class="ag-advanced-filter-builder-item" role="presentation">\n                    <div ref="eTreeLines" class="ag-advanced-filter-builder-item-tree-lines" aria-hidden="true"></div>\n                    <span ref="eDragHandle" class="ag-drag-handle" aria-hidden="true"></span>\n                    <span ref="eValidation" class="ag-advanced-filter-builder-item-button ag-advanced-filter-builder-invalid" aria-hidden="true"></span>\n                </div>\n                <div ref="eButtons" class="ag-advanced-filter-builder-item-buttons">\n                    <span ref="eMoveUpButton" class="ag-advanced-filter-builder-item-button" role="button"></span>\n                    <span ref="eMoveDownButton" class="ag-advanced-filter-builder-item-button" role="button"></span>\n                    <div ref="eAddButton" role="presentation"></div>\n                    <span ref="eRemoveButton" class="ag-advanced-filter-builder-item-button" role="button"></span>\n                </div>\n            </div>\n        '),this.item=e,this.dragFeature=t,this.focusWrapper=i,this.moveUpDisabled=!1,this.moveDownDisabled=!1}postConstruct(){const{filterModel:e,level:t,showMove:i}=this.item,r="join"===e.filterType;if(this.ePillWrapper=this.createManagedBean(r?new H:new _),this.ePillWrapper.init({item:this.item,createPill:e=>this.createPill(e)}),this.eDragHandle.insertAdjacentElement("afterend",this.ePillWrapper.getGui()),0===t){const e=document.createElement("div");e.classList.add("ag-advanced-filter-builder-item-tree-line-vertical-bottom"),e.classList.add("ag-advanced-filter-builder-item-tree-line-root"),this.eTreeLines.appendChild(e),s.ch.setDisplayed(this.eDragHandle,!1),s.ch.setDisplayed(this.eButtons,!1),s.ch.setAriaExpanded(this.focusWrapper,!0)}else this.setupTreeLines(t),this.eDragHandle.appendChild(s.ch.createIconNoSpan("advancedFilterBuilderDrag",this.gridOptionsService)),this.setupValidation(),this.setupMoveButtons(i),this.setupAddButton(),this.setupRemoveButton(),this.setupDragging(),this.updateAriaExpanded();s.ch.setAriaLevel(this.focusWrapper,t+1),this.initialiseTabGuard({}),this.createManagedBean(new G(this.getGui(),this.focusWrapper,this.ePillWrapper)),this.updateAriaLabel(),this.addManagedListener(this.ePillWrapper,B.EVENT_VALUE_CHANGED,(()=>this.dispatchEvent({type:B.EVENT_VALUE_CHANGED}))),this.addManagedListener(this.ePillWrapper,B.EVENT_VALID_CHANGED,(()=>this.updateValidity()))}setState(e){const{level:t}=this.item;if(0===t)return;const{showMove:i}=this.item,{disableMoveUp:r,disableMoveDown:a,treeLines:o,showStartTreeLine:n}=e;this.updateTreeLines(o,n),this.updateAriaExpanded(),i&&(this.moveUpDisabled=!!r,this.moveDownDisabled=!!a,this.eMoveUpButton.classList.toggle("ag-advanced-filter-builder-item-button-disabled",r),this.eMoveDownButton.classList.toggle("ag-advanced-filter-builder-item-button-disabled",a),s.ch.setAriaDisabled(this.eMoveUpButton,!!r),s.ch.setAriaDisabled(this.eMoveDownButton,!!a),this.moveUpTooltipFeature.refreshToolTip(),this.moveDownTooltipFeature.refreshToolTip())}focusMoveButton(e){(e?this.eMoveUpButton:this.eMoveDownButton).focus()}afterAdd(){this.ePillWrapper.getFocusableElement().focus()}setupTreeLines(e){for(let t=0;t<e;t++){const e=document.createElement("div");this.eTreeLines.appendChild(e)}}updateTreeLines(e,t){const i=e.length-1,{children:s}=this.eTreeLines;for(let a=0;a<i;a++){const t=s.item(a);t&&t.classList.toggle("ag-advanced-filter-builder-item-tree-line-vertical",!e[a])}const r=s.item(i);if(r){r.classList.add("ag-advanced-filter-builder-item-tree-line-horizontal");const t=e[i];r.classList.toggle("ag-advanced-filter-builder-item-tree-line-vertical-top",t),r.classList.toggle("ag-advanced-filter-builder-item-tree-line-vertical",!t)}this.eDragHandle.classList.toggle("ag-advanced-filter-builder-item-tree-line-vertical-bottom",t)}setupValidation(){this.eValidation.appendChild(s.ch.createIconNoSpan("advancedFilterBuilderInvalid",this.gridOptionsService)),this.validationTooltipFeature=this.createManagedBean(new s.c4({getGui:()=>this.eValidation,getLocation:()=>"advancedFilter",getTooltipValue:()=>this.ePillWrapper.getValidationMessage(),getTooltipShowDelayOverride:()=>1e3})),this.updateValidity()}setupAddButton(){var e;const t=V((e=>this.advancedFilterExpressionService.translate(e)),null==(e=this.gridOptionsService.get("advancedFilterBuilderParams"))?void 0:e.addSelectWidth),i=this.createManagedBean(new O(t));this.addManagedListener(i,s.aA.EVENT_FIELD_PICKER_VALUE_SELECTED,(e=>{let{value:t}=e;return this.dispatchEvent({type:B.EVENT_ADDED,item:this.item,isJoin:"join"===t.key})})),this.eAddButton.appendChild(i.getGui()),this.createManagedBean(new s.c4({getGui:()=>this.eAddButton,getLocation:()=>"advancedFilter",getTooltipValue:()=>this.advancedFilterExpressionService.translate("advancedFilterBuilderAddButtonTooltip")}))}setupRemoveButton(){this.eRemoveButton.appendChild(s.ch.createIconNoSpan("advancedFilterBuilderRemove",this.gridOptionsService)),this.addManagedListener(this.eRemoveButton,"click",(()=>this.removeItem())),this.addManagedListener(this.eRemoveButton,"keydown",(e=>{if(e.key===s.b6.ENTER)e.preventDefault(),s.ch.stopPropagationForAgGrid(e),this.removeItem()})),this.createManagedBean(new s.c4({getGui:()=>this.eRemoveButton,getLocation:()=>"advancedFilter",getTooltipValue:()=>this.advancedFilterExpressionService.translate("advancedFilterBuilderRemoveButtonTooltip")})),s.ch.setAriaLabel(this.eRemoveButton,this.advancedFilterExpressionService.translate("advancedFilterBuilderRemoveButtonTooltip")),this.activateTabIndex([this.eRemoveButton])}setupMoveButtons(e){e?(this.eMoveUpButton.appendChild(s.ch.createIconNoSpan("advancedFilterBuilderMoveUp",this.gridOptionsService)),this.addManagedListener(this.eMoveUpButton,"click",(()=>this.moveItem(!0))),this.addManagedListener(this.eMoveUpButton,"keydown",(e=>{if(e.key===s.b6.ENTER)e.preventDefault(),s.ch.stopPropagationForAgGrid(e),this.moveItem(!0)})),this.moveUpTooltipFeature=this.createManagedBean(new s.c4({getGui:()=>this.eMoveUpButton,getLocation:()=>"advancedFilter",getTooltipValue:()=>this.moveUpDisabled?null:this.advancedFilterExpressionService.translate("advancedFilterBuilderMoveUpButtonTooltip")})),s.ch.setAriaLabel(this.eMoveUpButton,this.advancedFilterExpressionService.translate("advancedFilterBuilderMoveUpButtonTooltip")),this.eMoveDownButton.appendChild(s.ch.createIconNoSpan("advancedFilterBuilderMoveDown",this.gridOptionsService)),this.addManagedListener(this.eMoveDownButton,"click",(()=>this.moveItem(!1))),this.addManagedListener(this.eMoveDownButton,"keydown",(e=>{if(e.key===s.b6.ENTER)e.preventDefault(),s.ch.stopPropagationForAgGrid(e),this.moveItem(!1)})),this.moveDownTooltipFeature=this.createManagedBean(new s.c4({getGui:()=>this.eMoveDownButton,getLocation:()=>"advancedFilter",getTooltipValue:()=>this.moveDownDisabled?null:this.advancedFilterExpressionService.translate("advancedFilterBuilderMoveDownButtonTooltip")})),s.ch.setAriaLabel(this.eMoveDownButton,this.advancedFilterExpressionService.translate("advancedFilterBuilderMoveDownButtonTooltip")),this.activateTabIndex([this.eMoveUpButton,this.eMoveDownButton])):(s.ch.setDisplayed(this.eMoveUpButton,!1),s.ch.setDisplayed(this.eMoveDownButton,!1))}updateValidity(){s.ch.setVisible(this.eValidation,!this.item.valid),this.validationTooltipFeature.refreshToolTip(),this.updateAriaLabel()}createPill(e){var t,i;const{key:r,displayValue:a,cssClass:o,update:n,ariaLabel:l}=e,d=e=>{null!=e&&(n(e),this.dispatchEvent({type:B.EVENT_VALUE_CHANGED}))};if(e.isSelect){const{getEditorParams:n,pickerAriaLabelKey:h,pickerAriaLabelValue:c}=e,u=this.gridOptionsService.get("advancedFilterBuilderParams"),p=`${null!=(t=null==u?void 0:u.pillSelectMinWidth)?t:140}px`,g=`${null!=(i=null==u?void 0:u.pillSelectMaxWidth)?i:200}px`,m=this.createBean(new W({pickerAriaLabelKey:h,pickerAriaLabelValue:c,pickerType:"ag-list",value:{key:r,displayValue:a},valueFormatter:e=>{var t;return null==e?null:null!=(t=e.displayValue)?t:e.key},variableWidth:!0,minPickerWidth:p,maxPickerWidth:g,getEditorParams:n,wrapperClassName:o,ariaLabel:l}));return this.addManagedListener(m,s.aA.EVENT_FIELD_PICKER_VALUE_SELECTED,(e=>{let{value:t}=e;return d(null==t?void 0:t.key)})),m}{const t=this.createBean(new U({value:a,cssClass:o,type:this.getInputType(e.baseCellDataType),ariaLabel:l}));return this.addManagedListener(t,s.aA.EVENT_FIELD_VALUE_CHANGED,(e=>{let{value:t}=e;return d(t)})),t}}getInputType(e){switch(e){case"text":case"object":case"boolean":return"text";case"number":return"number";case"date":case"dateString":return"date"}}setupDragging(){const e={type:s.ax.AdvancedFilterBuilder,eElement:this.eDragHandle,dragItemName:()=>this.ePillWrapper.getDragName(),getDefaultIconName:()=>s.av.ICON_NOT_ALLOWED,getDragItem:()=>({}),onDragStarted:()=>this.dragFeature.dispatchEvent({type:k.EVENT_DRAG_STARTED,item:this.item}),onDragStopped:()=>this.dragFeature.dispatchEvent({type:k.EVENT_DRAG_ENDED})};this.dragAndDropService.addDragSource(e,!0),this.addDestroyFunc((()=>this.dragAndDropService.removeDragSource(e)))}updateAriaLabel(){const e=this.ePillWrapper.getAriaLabel(),t=`${this.item.level+1}`,i=this.ePillWrapper.getValidationMessage();let r;r=i?this.advancedFilterExpressionService.translate("ariaAdvancedFilterBuilderItemValidation",[e,t,i]):this.advancedFilterExpressionService.translate("ariaAdvancedFilterBuilderItem",[e,t]),s.ch.setAriaLabel(this.focusWrapper,r)}updateAriaExpanded(){s.ch.removeAriaExpanded(this.focusWrapper);const{filterModel:e}=this.item;"join"===(null==e?void 0:e.filterType)&&e.conditions.length&&s.ch.setAriaExpanded(this.focusWrapper,!0)}removeItem(){this.dispatchEvent({type:B.EVENT_REMOVED,item:this.item})}moveItem(e){this.dispatchEvent({type:B.EVENT_MOVED,item:this.item,backwards:e})}};L([(0,s.R)("eTreeLines")],K.prototype,"eTreeLines",2),L([(0,s.R)("eDragHandle")],K.prototype,"eDragHandle",2),L([(0,s.R)("eItem")],K.prototype,"eItem",2),L([(0,s.R)("eButtons")],K.prototype,"eButtons",2),L([(0,s.R)("eValidation")],K.prototype,"eValidation",2),L([(0,s.R)("eMoveUpButton")],K.prototype,"eMoveUpButton",2),L([(0,s.R)("eMoveDownButton")],K.prototype,"eMoveDownButton",2),L([(0,s.R)("eAddButton")],K.prototype,"eAddButton",2),L([(0,s.R)("eRemoveButton")],K.prototype,"eRemoveButton",2),L([(0,s.A)("beans")],K.prototype,"beans",2),L([(0,s.A)("dragAndDropService")],K.prototype,"dragAndDropService",2),L([(0,s.A)("advancedFilterExpressionService")],K.prototype,"advancedFilterExpressionService",2),L([s.a],K.prototype,"postConstruct",1);var z=class extends s.ak{constructor(e,t){super('\n            <div class="ag-advanced-filter-builder-item-wrapper" role="presentation">\n                <div ref="eItem" class="ag-advanced-filter-builder-item" role="presentation">\n                    <div class="ag-advanced-filter-builder-item-tree-lines" aria-hidden="true">\n                        <div class="ag-advanced-filter-builder-item-tree-line-vertical-top ag-advanced-filter-builder-item-tree-line-horizontal"></div>\n                    </div>\n                </div>\n            </div>\n        '),this.item=e,this.focusWrapper=t}postConstruct(){var e;s.ch.setAriaLevel(this.focusWrapper,2);const t=V((e=>this.advancedFilterExpressionService.translate(e)),null==(e=this.gridOptionsService.get("advancedFilterBuilderParams"))?void 0:e.addSelectWidth),i=this.createManagedBean(new O(t));this.addManagedListener(i,s.aA.EVENT_FIELD_PICKER_VALUE_SELECTED,(e=>{let{value:t}=e;this.dispatchEvent({type:B.EVENT_ADDED,item:this.item,isJoin:"join"===t.key})})),this.eItem.appendChild(i.getGui()),this.createManagedBean(new s.c4({getGui:()=>i.getGui(),getLocation:()=>"advancedFilter",getTooltipValue:()=>this.advancedFilterExpressionService.translate("advancedFilterBuilderAddButtonTooltip")})),this.createManagedBean(new G(this.getGui(),this.focusWrapper,i)),s.ch.setAriaLabel(this.focusWrapper,this.advancedFilterExpressionService.translate("ariaAdvancedFilterBuilderItem",[this.advancedFilterExpressionService.translate("advancedFilterBuilderAddButtonTooltip"),`${this.item.level+1}`]))}afterAdd(){}};L([(0,s.A)("beans")],z.prototype,"beans",2),L([(0,s.A)("advancedFilterExpressionService")],z.prototype,"advancedFilterExpressionService",2),L([(0,s.R)("eItem")],z.prototype,"eItem",2),L([s.a],z.prototype,"postConstruct",1);var $=class extends s.ak{constructor(){super('\n            <div role="presentation" class="ag-advanced-filter-builder" tabindex="-1">\n                <div role="presentation" class="ag-advanced-filter-builder-list" ref="eList"></div>\n                <div role="presentation" class="ag-advanced-filter-builder-button-panel">\n                    <button class="ag-button ag-standard-button ag-advanced-filter-builder-apply-button" ref="eApplyFilterButton"></button>\n                    <button class="ag-button ag-standard-button ag-advanced-filter-builder-cancel-button" ref="eCancelFilterButton"></button>\n                </div>\n            </div>'),this.validationMessage=null}postConstruct(){var e;const{showMoveButtons:t}=null!=(e=this.gridOptionsService.get("advancedFilterBuilderParams"))?e:{};this.showMove=!!t,this.addManagedPropertyListener("advancedFilterBuilderParams",(e=>{let{currentValue:t}=e;this.showMove=!(null==t||!t.showMoveButtons),this.refreshList(!1)})),this.filterModel=this.setupFilterModel(),this.setupVirtualList(),this.dragFeature=this.createManagedBean(new k(this,this.virtualList)),this.setupButtons()}refresh(){let e=this.virtualList.getLastFocusedRow();this.setupFilterModel(),this.validateItems(),this.refreshList(!1),null!=e&&(this.virtualList.getComponentAt(e)||(e=0),this.virtualList.focusRow(e))}getNumItems(){return this.items.length}moveItem(e,t){!t||!e||this.moveItemToIndex(e,t.rowIndex,t.position)}afterGuiAttached(){this.virtualList.focusRow(0)}setupVirtualList(){this.virtualList=this.createManagedBean(new s.cf({cssIdentifier:"advanced-filter-builder",ariaRole:"tree",listName:this.advancedFilterExpressionService.translate("ariaAdvancedFilterBuilderList")})),this.virtualList.setComponentCreator(this.createItemComponent.bind(this)),this.virtualList.setComponentUpdater(this.updateItemComponent.bind(this)),this.virtualList.setRowHeight(40),this.eList.appendChild(this.virtualList.getGui()),this.virtualList.setModel({getRowCount:()=>this.items.length,getRow:e=>this.items[e],areRowsEqual:(e,t)=>e===t}),this.buildList(),this.virtualList.refresh()}setupButtons(){this.eApplyFilterButton.innerText=this.advancedFilterExpressionService.translate("advancedFilterBuilderApply"),this.activateTabIndex([this.eApplyFilterButton]),this.addManagedListener(this.eApplyFilterButton,"click",(()=>{this.advancedFilterService.setModel(this.filterModel),this.filterManager.onFilterChanged({source:"advancedFilter"}),this.close()})),this.validationTooltipFeature=this.createManagedBean(new s.c4({getGui:()=>this.eApplyFilterButton,getLocation:()=>"advancedFilter",getTooltipValue:()=>this.validationMessage,getTooltipShowDelayOverride:()=>1e3})),this.validate(),this.addManagedListener(this.eApplyFilterButton,"mouseenter",(()=>this.addOrRemoveCssClass("ag-advanced-filter-builder-validation",!0))),this.addManagedListener(this.eApplyFilterButton,"mouseleave",(()=>this.addOrRemoveCssClass("ag-advanced-filter-builder-validation",!1))),this.eCancelFilterButton.innerText=this.advancedFilterExpressionService.translate("advancedFilterBuilderCancel"),this.activateTabIndex([this.eCancelFilterButton]),this.addManagedListener(this.eCancelFilterButton,"click",(()=>this.close()))}removeItemFromParent(e){const t=e.parent.conditions.indexOf(e.filterModel);return e.parent.conditions.splice(t,1),t}moveItemToIndex(e,t,i){var s;const r=this.items[t],a="join"===(null==(s=r.filterModel)?void 0:s.filterType)&&"bottom"===i,o=a?r.filterModel:r.parent;if(!o||this.isChildOrSelf(o,e.filterModel)||r===e)return;let n;this.removeItemFromParent(e),a?n=0:(n=o.conditions.indexOf(r.filterModel),-1===n?n=o.conditions.length:"bottom"===i&&(n+=1)),o.conditions.splice(n,0,e.filterModel),this.refreshList(!1)}isChildOrSelf(e,t){return e===t||"join"===t.filterType&&t.conditions.some((t=>this.isChildOrSelf(e,t)))}setupFilterModel(){const e=this.formatFilterModel(this.advancedFilterService.getModel());return this.stringifiedModel=JSON.stringify(e),e}formatFilterModel(e){return"join"!==(e=e??{filterType:"join",type:"AND",conditions:[]}).filterType&&(e={filterType:"join",type:"AND",conditions:[e]}),e}buildList(){const e=(t,i,s,r)=>{i.push({filterModel:t,level:s,parent:r,valid:!0,showMove:this.showMove}),"join"===t.filterType&&(t.conditions.forEach((r=>e(r,i,s+1,t))),0===s&&i.push({filterModel:null,level:s+1,parent:t,valid:!0}))};this.items=[],e(this.filterModel,this.items,0)}refreshList(e){if(!e){const e=[];this.items.forEach((t=>{t.valid||e.push(t.filterModel)})),this.buildList(),e.length&&this.items.forEach((t=>{t.filterModel&&e.includes(t.filterModel)&&(t.valid=!1)}))}this.virtualList.refresh(e),this.validate()}updateItemComponent(e,t){const i=this.items.indexOf(e),s=(e,t)=>{const i=this.items.find((t=>t.filterModel===e)),r=null==i?void 0:i.parent;if(r){const{conditions:i}=r;s(r,t),t.push(i[i.length-1]===e)}},r=[],{filterModel:a}=e;a&&(s(a,r),r[0]=!1);const o="join"===(null==a?void 0:a.filterType)&&!!a.conditions.length;t.setState({disableMoveUp:1===i,disableMoveDown:!this.canMoveDown(e,i),treeLines:r,showStartTreeLine:o})}createItemComponent(e,t){const i=this.createBean(e.filterModel?new K(e,this.dragFeature,t):new z(e,t));return i.addManagedListener(i,B.EVENT_REMOVED,(e=>{let{item:t}=e;return this.removeItem(t)})),i.addManagedListener(i,B.EVENT_VALUE_CHANGED,(()=>this.validate())),i.addManagedListener(i,B.EVENT_ADDED,(e=>{let{item:t,isJoin:i}=e;return this.addItem(t,i)})),i.addManagedListener(i,B.EVENT_MOVED,(e=>{let{item:t,backwards:i}=e;return this.moveItemUpDown(t,i)})),i instanceof K&&this.updateItemComponent(e,i),i}addItem(e,t){var i;const{parent:s,level:r,filterModel:a}=e,o="join"===(null==a?void 0:a.filterType),n=t?{filterType:"join",type:"AND",conditions:[]}:{},l=o?a:s;let d=o?0:l.conditions.indexOf(a);d>=0?(o||(d+=1),l.conditions.splice(d,0,n)):l.conditions.push(n);let h=this.items.indexOf(e);const c=h>=0;if(c){e.filterModel&&h++;const i=[{filterModel:n,level:o?r+1:r,parent:l,valid:t,showMove:this.showMove}];this.items.splice(h,0,...i)}this.refreshList(c),c&&(null==(i=this.virtualList.getComponentAt(h))||i.afterAdd())}removeItem(e){var t;const i=e.parent,{filterModel:s}=e,r=i.conditions.indexOf(s);i.conditions.splice(r,1);const a="join"===(null==(t=e.filterModel)?void 0:t.filterType),o=this.items.indexOf(e),n=!a&&o>=0;n&&this.items.splice(o,1),this.refreshList(n),o>=0&&this.virtualList.focusRow(o)}moveItemUpDown(e,t){const i=this.items.indexOf(e),s=t?i-1:i+1;if(0===s||!t&&!this.canMoveDown(e,i))return;const r=this.items[s],a=this.removeItemFromParent(e),{level:o,filterModel:n,parent:l}=e,{level:d,filterModel:h,parent:c}=r;if(t)if(d===o&&"join"===h.filterType)h.conditions.push(n);else if(d<=o){const e=c.conditions.indexOf(h);c.conditions.splice(e,0,n)}else l.conditions[a-1].conditions.push(n);else if(d===o)if("join"===h.filterType)h.conditions.splice(0,0,n);else{const e=c.conditions.indexOf(h);c.conditions.splice(e+1,0,n)}else if(a<l.conditions.length)l.conditions.splice(a+1,0,n);else{const e=this.items.find((e=>e.filterModel===l)),t=e.parent.conditions.indexOf(e.filterModel)+1;e.parent.conditions.splice(t,0,n)}this.refreshList(!1);const u=this.items.findIndex((e=>{let{filterModel:t}=e;return t===n}));if(u>=0){const e=this.virtualList.getComponentAt(u);e instanceof K&&e.focusMoveButton(t)}}canMoveDown(e,t){return!(1===e.level&&t===this.items.length-2||1===e.level&&e.parent.conditions[e.parent.conditions.length-1]===e.filterModel)}close(){this.advancedFilterService.getCtrl().toggleFilterBuilder("ui")}validate(){let e=!this.items.every((e=>{let{valid:t}=e;return t}));e?this.validationMessage=this.advancedFilterExpressionService.translate("advancedFilterBuilderValidationIncomplete"):(e=JSON.stringify(this.filterModel)===this.stringifiedModel,this.validationMessage=e?this.advancedFilterExpressionService.translate("advancedFilterBuilderValidationAlreadyApplied"):null),s.ch.setDisabled(this.eApplyFilterButton,e),this.validationTooltipFeature.refreshToolTip()}validateItems(){const e=e=>{e.type=void 0},t=e=>{delete e.filter};this.items.forEach((i=>{if(!i.valid||!i.filterModel||"join"===i.filterModel.filterType)return;const{filterModel:r}=i,{colId:a}=r,o=this.advancedFilterExpressionService.getColumnAutocompleteEntries().find((e=>{let{key:t}=e;return t===a})),n=this.advancedFilterExpressionService.getColumnDetails(r.colId);if(!o||!n.column)return i.valid=!1,r.colId=void 0,e(r),void t(r);const l=this.advancedFilterExpressionService.getDataTypeExpressionOperator(n.baseCellDataType).operators[r.type];if(!l)return i.valid=!1,e(r),void t(r);l.numOperands>0&&!s.ch.exists(r.filter)&&(i.valid=!1)}))}};L([(0,s.R)("eList")],$.prototype,"eList",2),L([(0,s.R)("eApplyFilterButton")],$.prototype,"eApplyFilterButton",2),L([(0,s.R)("eCancelFilterButton")],$.prototype,"eCancelFilterButton",2),L([(0,s.A)("filterManager")],$.prototype,"filterManager",2),L([(0,s.A)("advancedFilterService")],$.prototype,"advancedFilterService",2),L([(0,s.A)("advancedFilterExpressionService")],$.prototype,"advancedFilterExpressionService",2),L([(0,s.A)("beans")],$.prototype,"beans",2),L([s.a],$.prototype,"postConstruct",1);var j=class e extends s.B{constructor(e){super(),this.enabled=e}postConstruct(){this.hasAdvancedFilterParent=!!this.gridOptionsService.get("advancedFilterParent"),this.ctrlsService.whenReady((()=>this.setAdvancedFilterComp())),this.addManagedListener(this.eventService,s.aA.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,(e=>{let{enabled:t}=e;return this.onEnabledChanged(t)})),this.addManagedPropertyListener("advancedFilterParent",(()=>this.updateComps())),this.addDestroyFunc((()=>{this.destroyAdvancedFilterComp(),this.destroyBean(this.eBuilderComp),this.eBuilderDialog&&this.eBuilderDialog.isAlive()&&this.destroyBean(this.eBuilderDialog)}))}setupHeaderComp(e){this.eHeaderComp=this.createManagedBean(new I(this.enabled&&!this.hasAdvancedFilterParent)),e.insertAdjacentElement("beforebegin",this.eHeaderComp.getGui())}focusHeaderComp(){return!!this.eHeaderComp&&(this.eHeaderComp.getFocusableElement().focus(),!0)}refreshComp(){var e,t;null==(e=this.eFilterComp)||e.refresh(),null==(t=this.eHeaderComp)||t.refresh()}refreshBuilderComp(){var e;null==(e=this.eBuilderComp)||e.refresh()}getHeaderHeight(){var e,t;return null!=(t=null==(e=this.eHeaderComp)?void 0:e.getHeight())?t:0}setInputDisabled(e){var t,i;null==(t=this.eFilterComp)||t.setInputDisabled(e),null==(i=this.eHeaderComp)||i.setInputDisabled(e)}toggleFilterBuilder(t,i){if(i&&this.eBuilderDialog||!1===i&&!this.eBuilderDialog)return;if(this.eBuilderDialog)return this.builderDestroySource=t,void this.destroyBean(this.eBuilderDialog);this.setInputDisabled(!0);const{width:r,height:a,minWidth:o}=this.getBuilderDialogSize();this.eBuilderComp=this.createBean(new $),this.eBuilderDialog=this.createBean(new s.n({title:this.advancedFilterExpressionService.translate("advancedFilterBuilderTitle"),component:this.eBuilderComp,width:r,height:a,resizable:!0,movable:!0,maximizable:!0,centered:!0,closable:!0,minWidth:o,afterGuiAttached:()=>{var e;return null==(e=this.eBuilderComp)?void 0:e.afterGuiAttached()}})),this.dispatchFilterBuilderVisibleChangedEvent(t,!0),this.eBuilderDialog.addEventListener(s.n.EVENT_DESTROYED,(()=>{var t;this.destroyBean(this.eBuilderComp),this.eBuilderComp=void 0,this.eBuilderDialog=void 0,this.setInputDisabled(!1),this.dispatchEvent({type:e.EVENT_BUILDER_CLOSED}),this.dispatchFilterBuilderVisibleChangedEvent(null!=(t=this.builderDestroySource)?t:"ui",!1),this.builderDestroySource=void 0}))}dispatchFilterBuilderVisibleChangedEvent(e,t){const i={type:s.aA.EVENT_ADVANCED_FILTER_BUILDER_VISIBLE_CHANGED,source:e,visible:t};this.eventService.dispatchEvent(i)}getBuilderDialogSize(){var e,t;const i=null!=(t=null==(e=this.gridOptionsService.get("advancedFilterBuilderParams"))?void 0:e.minWidth)?t:500,r=this.popupService.getPopupParent(),a=Math.round(s.ch.getAbsoluteWidth(r))-2,o=Math.round(.75*s.ch.getAbsoluteHeight(r))-2;return{width:Math.min(Math.max(600,i),a),height:Math.min(600,o),minWidth:i}}onEnabledChanged(e){this.enabled=e,this.updateComps()}updateComps(){this.setAdvancedFilterComp(),this.setHeaderCompEnabled(),this.eventService.dispatchEvent({type:s.aA.EVENT_HEADER_HEIGHT_CHANGED})}setAdvancedFilterComp(){if(this.destroyAdvancedFilterComp(),!this.enabled)return;const e=this.gridOptionsService.get("advancedFilterParent");if(this.hasAdvancedFilterParent=!!e,e){const t=this.createBean(new q),i=t.getGui(),{allThemes:s}=this.environment.getTheme();s.length&&i.classList.add(...s),i.classList.add(this.gridOptionsService.get("enableRtl")?"ag-rtl":"ag-ltr"),e.appendChild(i),this.eFilterComp=t}}setHeaderCompEnabled(){var e;null==(e=this.eHeaderComp)||e.setEnabled(this.enabled&&!this.hasAdvancedFilterParent)}destroyAdvancedFilterComp(){this.eFilterComp&&(s.ch.removeFromParent(this.eFilterComp.getGui()),this.destroyBean(this.eFilterComp))}};j.EVENT_BUILDER_CLOSED="advancedFilterBuilderClosed",L([(0,s.A)("focusService")],j.prototype,"focusService",2),L([(0,s.A)("ctrlsService")],j.prototype,"ctrlsService",2),L([(0,s.A)("popupService")],j.prototype,"popupService",2),L([(0,s.A)("advancedFilterExpressionService")],j.prototype,"advancedFilterExpressionService",2),L([s.a],j.prototype,"postConstruct",1);var Y=j,q=class extends s.ak{constructor(){super('\n            <div class="ag-advanced-filter" role="presentation" tabindex="-1">\n                <ag-autocomplete ref="eAutocomplete"></ag-autocomplete>\n                <button class="ag-button ag-standard-button ag-advanced-filter-apply-button" ref="eApplyFilterButton"></button>\n                <button class="ag-advanced-filter-builder-button" ref="eBuilderFilterButton">\n                    <span ref="eBuilderFilterButtonIcon" aria-hidden="true"></span>\n                    <span class="ag-advanced-filter-builder-button-label" ref="eBuilderFilterButtonLabel"></span>\n                </button>\n            </div>'),this.expressionParser=null,this.isApplyDisabled=!0,this.builderOpen=!1}postConstruct(){this.eAutocomplete.setListGenerator(((e,t)=>this.generateAutocompleteListParams(t))).setValidator((()=>this.validateValue())).setForceLastSelection(((e,t)=>this.forceLastSelection(e,t))).setInputAriaLabel(this.advancedFilterExpressionService.translate("ariaAdvancedFilterInput")).setListAriaLabel(this.advancedFilterExpressionService.translate("ariaLabelAdvancedFilterAutocomplete")),this.refresh(),this.addManagedListener(this.eAutocomplete,s.l.EVENT_VALUE_CHANGED,(e=>{let{value:t}=e;return this.onValueChanged(t)})),this.addManagedListener(this.eAutocomplete,s.l.EVENT_VALUE_CONFIRMED,(e=>{let{isValid:t}=e;return this.onValueConfirmed(t)})),this.addManagedListener(this.eAutocomplete,s.l.EVENT_OPTION_SELECTED,(e=>{let{position:t,updateEntry:i,autocompleteType:s}=e;return this.onOptionSelected(t,i,s)})),this.addManagedListener(this.eAutocomplete,s.l.EVENT_VALID_CHANGED,(e=>{let{isValid:t,validationMessage:i}=e;return this.onValidChanged(t,i)})),this.setupApplyButton(),this.setupBuilderButton()}refresh(){const e=this.advancedFilterService.getExpressionDisplayValue();this.eAutocomplete.setValue({value:e??"",position:null==e?void 0:e.length,updateListOnlyIfOpen:!0})}setInputDisabled(e){this.eAutocomplete.setInputDisabled(e),s.ch.setDisabled(this.eApplyFilterButton,e||this.isApplyDisabled)}getTooltipParams(){const e=super.getTooltipParams();return e.location="advancedFilter",e}setupApplyButton(){this.eApplyFilterButton.innerText=this.advancedFilterExpressionService.translate("advancedFilterApply"),this.activateTabIndex([this.eApplyFilterButton]),this.addManagedListener(this.eApplyFilterButton,"click",(()=>this.onValueConfirmed(this.eAutocomplete.isValid()))),s.ch.setDisabled(this.eApplyFilterButton,this.isApplyDisabled)}setupBuilderButton(){this.eBuilderFilterButtonIcon.appendChild(s.ch.createIconNoSpan("advancedFilterBuilder",this.gridOptionsService)),this.eBuilderFilterButtonLabel.innerText=this.advancedFilterExpressionService.translate("advancedFilterBuilder"),this.activateTabIndex([this.eBuilderFilterButton]),this.addManagedListener(this.eBuilderFilterButton,"click",(()=>this.openBuilder())),this.addManagedListener(this.advancedFilterService.getCtrl(),Y.EVENT_BUILDER_CLOSED,(()=>this.closeBuilder()))}onValueChanged(e){var t;e=s.ch.makeNull(e),this.advancedFilterService.setExpressionDisplayValue(e),this.expressionParser=this.advancedFilterService.createExpressionParser(e);const i=null==(t=this.expressionParser)?void 0:t.parseExpression();i&&i!==e&&this.eAutocomplete.setValue({value:i,silent:!0,restoreFocus:!0})}onValueConfirmed(e){!e||this.isApplyDisabled||(s.ch.setDisabled(this.eApplyFilterButton,!0),this.advancedFilterService.applyExpression(),this.filterManager.onFilterChanged({source:"advancedFilter"}))}onOptionSelected(e,t,i){const{updatedValue:s,updatedPosition:r,hideAutocomplete:a}=this.updateExpression(e,t,i);this.eAutocomplete.setValue({value:s,position:r,updateListOnlyIfOpen:a,restoreFocus:!0})}validateValue(){var e,t,i;return null!=(e=this.expressionParser)&&e.isValid()?null:null!=(i=null==(t=this.expressionParser)?void 0:t.getValidationMessage())?i:null}onValidChanged(e,t){this.isApplyDisabled=!e||this.advancedFilterService.isCurrentExpressionApplied(),s.ch.setDisabled(this.eApplyFilterButton,this.isApplyDisabled),this.setTooltip({newTooltipText:t,showDelayOverride:1e3})}generateAutocompleteListParams(e){return this.expressionParser?this.expressionParser.getAutocompleteListParams(e):this.advancedFilterExpressionService.getDefaultAutocompleteListParams("")}updateExpression(e,t,i){var s,r;return this.advancedFilterExpressionService.updateAutocompleteCache(t,i),null!=(r=null==(s=this.expressionParser)?void 0:s.updateExpression(e,t,i))?r:this.advancedFilterService.getDefaultExpression(t)}forceLastSelection(e,t){let{key:i,displayValue:s}=e;return!!t.toLocaleLowerCase().match(`^${(s??i).toLocaleLowerCase()}\\s*$`)}openBuilder(){this.builderOpen||(this.builderOpen=!0,s.ch.setDisabled(this.eBuilderFilterButton,!0),this.advancedFilterService.getCtrl().toggleFilterBuilder("ui"))}closeBuilder(){this.builderOpen&&(this.builderOpen=!1,s.ch.setDisabled(this.eBuilderFilterButton,!1),this.eBuilderFilterButton.focus())}};L([(0,s.R)("eAutocomplete")],q.prototype,"eAutocomplete",2),L([(0,s.R)("eApplyFilterButton")],q.prototype,"eApplyFilterButton",2),L([(0,s.R)("eBuilderFilterButton")],q.prototype,"eBuilderFilterButton",2),L([(0,s.R)("eBuilderFilterButtonIcon")],q.prototype,"eBuilderFilterButtonIcon",2),L([(0,s.R)("eBuilderFilterButtonLabel")],q.prototype,"eBuilderFilterButtonLabel",2),L([(0,s.A)("advancedFilterService")],q.prototype,"advancedFilterService",2),L([(0,s.A)("advancedFilterExpressionService")],q.prototype,"advancedFilterExpressionService",2),L([(0,s.A)("filterManager")],q.prototype,"filterManager",2),L([s.a],q.prototype,"postConstruct",1);var X={ariaAdvancedFilterBuilderItem:e=>`${e[0]}. Level ${e[1]}. Press ENTER to edit.`,ariaAdvancedFilterBuilderItemValidation:e=>`${e[0]}. Level ${e[1]}. ${e[2]} Press ENTER to edit.`,ariaAdvancedFilterBuilderList:"Advanced Filter Builder List",ariaAdvancedFilterBuilderFilterItem:"Filter Condition",ariaAdvancedFilterBuilderGroupItem:"Filter Group",ariaAdvancedFilterBuilderColumn:"Column",ariaAdvancedFilterBuilderOption:"Option",ariaAdvancedFilterBuilderValue:"Value",ariaAdvancedFilterBuilderJoinOperator:"Join Operator",ariaAdvancedFilterInput:"Advanced Filter Input",ariaLabelAdvancedFilterAutocomplete:"Advanced Filter Autocomplete",advancedFilterContains:"contains",advancedFilterNotContains:"does not contain",advancedFilterTextEquals:"equals",advancedFilterTextNotEqual:"does not equal",advancedFilterStartsWith:"begins with",advancedFilterEndsWith:"ends with",advancedFilterBlank:"is blank",advancedFilterNotBlank:"is not blank",advancedFilterEquals:"=",advancedFilterNotEqual:"!=",advancedFilterGreaterThan:">",advancedFilterGreaterThanOrEqual:">=",advancedFilterLessThan:"<",advancedFilterLessThanOrEqual:"<=",advancedFilterTrue:"is true",advancedFilterFalse:"is false",advancedFilterAnd:"AND",advancedFilterOr:"OR",advancedFilterApply:"Apply",advancedFilterBuilder:"Builder",advancedFilterValidationMissingColumn:"Column is missing",advancedFilterValidationMissingOption:"Option is missing",advancedFilterValidationMissingValue:"Value is missing",advancedFilterValidationInvalidColumn:"Column not found",advancedFilterValidationInvalidOption:"Option not found",advancedFilterValidationMissingQuote:"Value is missing an end quote",advancedFilterValidationNotANumber:"Value is not a number",advancedFilterValidationInvalidDate:"Value is not a valid date",advancedFilterValidationMissingCondition:"Condition is missing",advancedFilterValidationJoinOperatorMismatch:"Join operators within a condition must be the same",advancedFilterValidationInvalidJoinOperator:"Join operator not found",advancedFilterValidationMissingEndBracket:"Missing end bracket",advancedFilterValidationExtraEndBracket:"Too many end brackets",advancedFilterValidationMessage:e=>`Expression has an error. ${e[0]} - ${e[1]}.`,advancedFilterValidationMessageAtEnd:e=>`Expression has an error. ${e[0]} at end of expression.`,advancedFilterBuilderTitle:"Advanced Filter",advancedFilterBuilderApply:"Apply",advancedFilterBuilderCancel:"Cancel",advancedFilterBuilderAddButtonTooltip:"Add Filter or Group",advancedFilterBuilderRemoveButtonTooltip:"Remove",advancedFilterBuilderMoveUpButtonTooltip:"Move Up",advancedFilterBuilderMoveDownButtonTooltip:"Move Down",advancedFilterBuilderAddJoin:"Add Group",advancedFilterBuilderAddCondition:"Add Filter",advancedFilterBuilderSelectColumn:"Select a column",advancedFilterBuilderSelectOption:"Select an option",advancedFilterBuilderEnterValue:"Enter a value...",advancedFilterBuilderValidationAlreadyApplied:"Current filter already applied.",advancedFilterBuilderValidationIncomplete:"Not all conditions are complete.",advancedFilterBuilderValidationSelectColumn:"Must select a column.",advancedFilterBuilderValidationSelectOption:"Must select an option.",advancedFilterBuilderValidationEnterValue:"Must enter a value."};function Z(e,t,i){if(!e)return"";const s=i-t;return s?e.slice(0,e.length-s):e}function J(e,t,i,s,r,a,o){const n=i+(!e.length||o?0:1);let l=0;return r&&(" "===e[n]?l=1:(s+=" ",a&&(s+='"'))),{updatedValue:e.slice(0,t)+s+e.slice(n),updatedPosition:t+s.length+l}}function Q(e,t,i,s){let r=t,a=!1;for(;r<e.length;){const t=e[r];if("("===t){s&&" "===e[r-1]?a=!0:r-=1;break}if(" "===t||i&&")"===t){r-=1;break}r++}return{endPosition:r,isEmpty:a}}function ee(e,t,i,s){i!==t&&(e.expression=J(e.expression,s-t.length+1,s,i).updatedValue)}var te=class{constructor(e,t){this.params=e,this.startPosition=t,this.type="column",this.valid=!0,this.hasStartChar=!1,this.hasEndChar=!1,this.colName=""}parse(e,t){if(e!==re.COL_START_CHAR||this.colName)if(e===re.COL_END_CHAR&&this.hasStartChar){if(this.parseColumn(!1,t))return this.hasEndChar=!0,!1;this.colName+=e}else this.colName+=e;else this.hasStartChar=!0}getDisplayValue(){return(this.hasStartChar?re.COL_START_CHAR:"")+this.colName+(this.hasEndChar?re.COL_END_CHAR:"")}getColId(){return this.colId}complete(e){this.parseColumn(!0,e)}getValidationError(){var e;return this.valid?null:{message:this.params.advancedFilterExpressionService.translate("advancedFilterValidationInvalidColumn"),startPosition:this.startPosition,endPosition:null!=(e=this.endPosition)?e:this.params.expression.length-1}}parseColumn(e,t){var i;this.endPosition=t;const s=this.params.advancedFilterExpressionService.getColId(this.colName);return s&&this.hasStartChar&&(this.colId=s.colId,ee(this.params,this.colName,s.columnName,t-1),this.colName=s.columnName,this.column=this.params.columnModel.getPrimaryColumn(this.colId),this.column)?(this.baseCellDataType=null!=(i=this.params.dataTypeService.getBaseDataType(this.column))?i:"text",!0):(e&&(this.valid=!1),this.baseCellDataType="text",!1)}},ie=class{constructor(e,t,i){this.params=e,this.startPosition=t,this.baseCellDataType=i,this.type="operator",this.valid=!0,this.expectedNumOperands=0,this.operator=""}parse(e,t){if(" "===e||")"===e){if(this.parseOperator(!1,t-1))return!0;this.operator+=e}else this.operator+=e}complete(e){this.parseOperator(!0,e)}getValidationError(){var e;return this.valid?null:{message:this.params.advancedFilterExpressionService.translate("advancedFilterValidationInvalidOption"),startPosition:this.startPosition,endPosition:null!=(e=this.endPosition)?e:this.params.expression.length-1}}getDisplayValue(){return this.operator}getOperatorKey(){return this.parsedOperator}parseOperator(e,t){const i=this.params.advancedFilterExpressionService.getDataTypeExpressionOperator(this.baseCellDataType),s=i.findOperator(this.operator);if(this.endPosition=t,s){this.parsedOperator=s;const e=i.operators[s];this.expectedNumOperands=e.numOperands;const r=e.displayValue;return ee(this.params,this.operator,r,t),this.operator=r,!0}return(e||!(null===s))&&(this.valid=!1),!1}},se=class{constructor(e,t,i,s){this.params=e,this.startPosition=t,this.baseCellDataType=i,this.column=s,this.type="operand",this.valid=!0,this.operand="",this.validationMessage=null}parse(e,t){if(" "===e){if(!this.quotes)return this.parseOperand(!1,t),!0;this.operand+=e}else if(")"===e){if("number"===this.baseCellDataType||!this.quotes)return this.parseOperand(!1,t-1),!0;this.operand+=e}else if(this.operand||this.quotes||"'"!==e&&'"'!==e){if(this.quotes&&e===this.quotes)return this.parseOperand(!1,t),!1;this.operand+=e}else this.quotes=e}complete(e){this.parseOperand(!0,e)}getValidationError(){var e;return this.validationMessage?{message:this.validationMessage,startPosition:this.startPosition,endPosition:null!=(e=this.endPosition)?e:this.params.expression.length-1}:null}getRawValue(){return this.operand}getModelValue(){return this.modelValue}parseOperand(e,t){const{advancedFilterExpressionService:i}=this.params;if(this.endPosition=t,this.modelValue=this.operand,e&&this.quotes)this.valid=!1,this.validationMessage=i.translate("advancedFilterValidationMissingQuote");else if(""===this.modelValue)this.valid=!1,this.validationMessage=i.translate("advancedFilterValidationMissingValue");else{const e=i.getOperandModelValue(this.operand,this.baseCellDataType,this.column);switch(null!=e&&(this.modelValue=e),this.baseCellDataType){case"number":(this.quotes||isNaN(this.modelValue))&&(this.valid=!1,this.validationMessage=i.translate("advancedFilterValidationNotANumber"));break;case"date":case"dateString":null==e&&(this.valid=!1,this.validationMessage=i.translate("advancedFilterValidationInvalidDate"))}}}},re=class{constructor(e,t){this.params=e,this.startPosition=t,this.isAwaiting=!0}parseExpression(){var e,t;let i=this.startPosition;const{expression:s}=this.params;for(;i<s.length;){const e=s[i];if(" "!==e||!this.isAwaiting){if(this.isAwaiting=!1,!this.parser){let e;this.columnParser?this.operatorParser?(this.operandParser=new se(this.params,i,this.columnParser.baseCellDataType,this.columnParser.column),e=this.operandParser):(this.operatorParser=new ie(this.params,i,this.columnParser.baseCellDataType),e=this.operatorParser):(this.columnParser=new te(this.params,i),e=this.columnParser),this.parser=e}const t=this.parser.parse(e,i);if(null!=t){if(this.isComplete())return this.returnEndPosition(t?i-1:i,!0);this.parser=void 0,this.isAwaiting=!0}}i++}return null==(t=null==(e=this.parser)?void 0:e.complete)||t.call(e,i-1),this.returnEndPosition(i)}isValid(){return this.isComplete()&&this.columnParser.valid&&this.operatorParser.valid&&(!this.operandParser||this.operandParser.valid)}getValidationError(){var e,t,i,s,r;const a=null!=(r=null!=(i=null==(e=this.columnParser)?void 0:e.getValidationError())?i:null==(t=this.operatorParser)?void 0:t.getValidationError())?r:null==(s=this.operandParser)?void 0:s.getValidationError();if(a)return a;const o=this.params.expression.length;let n;return this.columnParser?this.operatorParser?this.operatorParser.expectedNumOperands&&!this.operandParser&&(n="advancedFilterValidationMissingValue"):n="advancedFilterValidationMissingOption":n="advancedFilterValidationMissingColumn",n?{message:this.params.advancedFilterExpressionService.translate(n),startPosition:o,endPosition:o}:null}getFunction(e){var t,i;const s=this.columnParser.getColId(),r=function(e){return e.replace(/(['"])/,"\\$1")}(s),a=null==(t=this.operatorParser)?void 0:t.getOperatorKey(),{operators:o,evaluatorParams:n,operands:l}=e,d=this.params.advancedFilterExpressionService.getExpressionOperator(this.columnParser.baseCellDataType,a),h=this.addToListAndGetIndex(o,d),c=this.params.advancedFilterExpressionService.getExpressionEvaluatorParams(s),u=this.addToListAndGetIndex(n,c);let p;return p=0===(null==(i=this.operatorParser)?void 0:i.expectedNumOperands)?"":`, params.operands[${this.addToListAndGetIndex(l,this.getOperandValue())}]`,`params.operators[${h}].evaluator(expressionProxy.getValue('${r}', node), node, params.evaluatorParams[${u}]${p})`}getAutocompleteListParams(e){return this.isColumnPosition(e)?this.getColumnAutocompleteListParams(e):this.isOperatorPosition(e)?this.getOperatorAutocompleteListParams(e):this.isBeyondEndPosition(e)?void 0:{enabled:!1}}updateExpression(e,t,i){var s,r,a,o,n;const{expression:l}=this.params;if(this.isColumnPosition(e))return J(this.params.expression,this.startPosition,null!=(s=this.columnParser)&&s.getColId()?this.columnParser.endPosition:Q(l,e).endPosition,this.params.advancedFilterExpressionService.getColumnValue(t),!0);if(this.isOperatorPosition(e)){const s=this.getBaseCellDataTypeFromOperatorAutocompleteType(i),d=this.hasOperand(s,t.key),h=d&&this.doesOperandNeedQuotes(s);let c;if(null!=(null==(r=this.operatorParser)?void 0:r.startPosition)&&e<this.operatorParser.startPosition)c=J(l,e,e,null!=(a=t.displayValue)?a:t.key,d,h);else{let i,s=!1;if(null!=(o=this.operatorParser)&&o.getOperatorKey())i=this.operatorParser.endPosition;else{const{endPosition:t,isEmpty:r}=Q(l,e,!0,!0);i=t,s=r}c=J(l,function(e,t,i){let s=t;for(;s<i&&" "===e[s];)s++;return s}(l,this.columnParser.endPosition+1,i),i,null!=(n=t.displayValue)?n:t.key,d,h,s)}return R(D({},c),{hideAutocomplete:!d})}return null}getModel(){const e=this.columnParser.getColId(),t={filterType:this.columnParser.baseCellDataType,colId:e,type:this.operatorParser.getOperatorKey()};return this.operatorParser.expectedNumOperands&&(t.filter=this.operandParser.getModelValue()),t}getOperandValue(){let e=this.operandParser.getRawValue();const{baseCellDataType:t,column:i}=this.columnParser;switch(t){case"number":e=Number(e);break;case"date":case"dateString":e=this.params.valueParserService.parseValue(i,null,e,void 0)}return"dateString"===t?this.params.dataTypeService.getDateParserFunction(i)(e):e}isComplete(){return!(!this.operatorParser||!(!this.operatorParser.expectedNumOperands||this.operatorParser.expectedNumOperands&&this.operandParser))}isColumnPosition(e){return!this.columnParser||null==this.columnParser.endPosition||e<=this.columnParser.endPosition+1}isOperatorPosition(e){return!this.operatorParser||null==this.operatorParser.endPosition||e<=this.operatorParser.endPosition+1}isBeyondEndPosition(e){return this.isComplete()&&null!=this.endPosition&&e>this.endPosition+1&&this.endPosition+1<this.params.expression.length}returnEndPosition(e,t){return this.endPosition=t?e:e-1,e}getColumnAutocompleteListParams(e){return this.params.advancedFilterExpressionService.generateAutocompleteListParams(this.params.advancedFilterExpressionService.getColumnAutocompleteEntries(),"column",this.getColumnSearchString(e))}getColumnSearchString(e){var t,i,s,r,a;const o=null!=(i=null==(t=this.columnParser)?void 0:t.getDisplayValue())?i:"",n=Z(o,e,null==(null==(s=this.columnParser)?void 0:s.endPosition)?this.params.expression.length:this.columnParser.endPosition+1),l=(null==(r=this.columnParser)?void 0:r.hasStartChar)&&n.length>0,d=(null==(a=this.columnParser)?void 0:a.hasEndChar)&&n.length===o.length+2;return l?n.slice(1,d?-1:void 0):n}getOperatorAutocompleteListParams(e){var t,i,s,r,a;const o=null==(t=this.columnParser)?void 0:t.column;if(!o)return{enabled:!1};const n=this.columnParser.baseCellDataType,l=null!=(null==(i=this.operatorParser)?void 0:i.startPosition)&&e<this.operatorParser.startPosition?"":Z(null!=(r=null==(s=this.operatorParser)?void 0:s.getDisplayValue())?r:"",e,null==(null==(a=this.operatorParser)?void 0:a.endPosition)?this.params.expression.length:this.operatorParser.endPosition+1);return this.params.advancedFilterExpressionService.generateAutocompleteListParams(this.params.advancedFilterExpressionService.getOperatorAutocompleteEntries(o,n),`operator-${n}`,l)}getBaseCellDataTypeFromOperatorAutocompleteType(e){return null==e?void 0:e.replace("operator-","")}hasOperand(e,t){var i,s;return!e||!t||(null!=(s=null==(i=this.params.advancedFilterExpressionService.getExpressionOperator(e,t))?void 0:i.numOperands)?s:0)>0}doesOperandNeedQuotes(e){return"number"!==e}addToListAndGetIndex(e,t){const i=e.length;return e.push(t),i}};function ae(e,t,i){let s=!1;const r=e.toLocaleLowerCase(),a=r+" ",o=Object.entries(t).find((e=>{let[t,o]=e;const n=i(o).toLocaleLowerCase();return n.startsWith(a)&&(s=!0),n===r}));return o?o[0]:s?null:void 0}function oe(e,t){return(t??Object.keys(e)).map((t=>({key:t,displayValue:e[t].displayValue})))}re.COL_START_CHAR="[",re.COL_END_CHAR="]";var ne=class{constructor(e){this.params=e,this.initOperators()}getEntries(e){return oe(this.operators,e)}findOperator(e){return ae(e,this.operators,(e=>{let{displayValue:t}=e;return t}))}initOperators(){const{translate:e}=this.params;this.operators={contains:{displayValue:e("advancedFilterContains"),evaluator:(e,t,i,s)=>this.evaluateExpression(e,t,i,s,!1,((e,t)=>e.includes(t))),numOperands:1},notContains:{displayValue:e("advancedFilterNotContains"),evaluator:(e,t,i,s)=>this.evaluateExpression(e,t,i,s,!0,((e,t)=>!e.includes(t))),numOperands:1},equals:{displayValue:e("advancedFilterTextEquals"),evaluator:(e,t,i,s)=>this.evaluateExpression(e,t,i,s,!1,((e,t)=>e===t)),numOperands:1},notEqual:{displayValue:e("advancedFilterTextNotEqual"),evaluator:(e,t,i,s)=>this.evaluateExpression(e,t,i,s,!0,((e,t)=>e!=t)),numOperands:1},startsWith:{displayValue:e("advancedFilterStartsWith"),evaluator:(e,t,i,s)=>this.evaluateExpression(e,t,i,s,!1,((e,t)=>e.startsWith(t))),numOperands:1},endsWith:{displayValue:e("advancedFilterEndsWith"),evaluator:(e,t,i,s)=>this.evaluateExpression(e,t,i,s,!1,((e,t)=>e.endsWith(t))),numOperands:1},blank:{displayValue:e("advancedFilterBlank"),evaluator:e=>null==e||"string"==typeof e&&0===e.trim().length,numOperands:0},notBlank:{displayValue:e("advancedFilterNotBlank"),evaluator:e=>null!=e&&("string"!=typeof e||e.trim().length>0),numOperands:0}}}evaluateExpression(e,t,i,s,r,a){return null==e?r:i.caseSensitive?a(i.valueConverter(e,t),s):a(i.valueConverter(e,t).toLocaleLowerCase(),s.toLocaleLowerCase())}},le=class{constructor(e){this.params=e,this.initOperators()}getEntries(e){return oe(this.operators,e)}findOperator(e){return ae(e,this.operators,(e=>{let{displayValue:t}=e;return t}))}initOperators(){const{translate:e,equals:t}=this.params;this.operators={equals:{displayValue:e("advancedFilterEquals"),evaluator:(e,i,s,r)=>this.evaluateSingleOperandExpression(e,i,s,r,!!s.includeBlanksInEquals,t),numOperands:1},notEqual:{displayValue:e("advancedFilterNotEqual"),evaluator:(e,i,s,r)=>this.evaluateSingleOperandExpression(e,i,s,r,!!s.includeBlanksInEquals,((e,i)=>!t(e,i))),numOperands:1},greaterThan:{displayValue:e("advancedFilterGreaterThan"),evaluator:(e,t,i,s)=>this.evaluateSingleOperandExpression(e,t,i,s,!!i.includeBlanksInGreaterThan,((e,t)=>e>t)),numOperands:1},greaterThanOrEqual:{displayValue:e("advancedFilterGreaterThanOrEqual"),evaluator:(e,t,i,s)=>this.evaluateSingleOperandExpression(e,t,i,s,!!i.includeBlanksInGreaterThan,((e,t)=>e>=t)),numOperands:1},lessThan:{displayValue:e("advancedFilterLessThan"),evaluator:(e,t,i,s)=>this.evaluateSingleOperandExpression(e,t,i,s,!!i.includeBlanksInLessThan,((e,t)=>e<t)),numOperands:1},lessThanOrEqual:{displayValue:e("advancedFilterLessThanOrEqual"),evaluator:(e,t,i,s)=>this.evaluateSingleOperandExpression(e,t,i,s,!!i.includeBlanksInLessThan,((e,t)=>e<=t)),numOperands:1},blank:{displayValue:e("advancedFilterBlank"),evaluator:e=>null==e,numOperands:0},notBlank:{displayValue:e("advancedFilterNotBlank"),evaluator:e=>null!=e,numOperands:0}}}evaluateSingleOperandExpression(e,t,i,s,r,a){return null==e?r:a(i.valueConverter(e,t),s)}},de=class{constructor(e){this.params=e,this.initOperators()}getEntries(e){return oe(this.operators,e)}findOperator(e){return ae(e,this.operators,(e=>{let{displayValue:t}=e;return t}))}initOperators(){const{translate:e}=this.params;this.operators={true:{displayValue:e("advancedFilterTrue"),evaluator:e=>!!e,numOperands:0},false:{displayValue:e("advancedFilterFalse"),evaluator:e=>!1===e,numOperands:0},blank:{displayValue:e("advancedFilterBlank"),evaluator:e=>null==e,numOperands:0},notBlank:{displayValue:e("advancedFilterNotBlank"),evaluator:e=>null!=e,numOperands:0}}}},he=class extends s.B{constructor(){super(...arguments),this.columnNameToIdMap={},this.columnAutocompleteEntries=null,this.expressionEvaluatorParams={}}postConstruct(){this.expressionJoinOperators=this.generateExpressionJoinOperators(),this.expressionOperators=this.generateExpressionOperators()}parseJoinOperator(e){var t;const{type:i}=e;return null!=(t=this.expressionJoinOperators[i])?t:i}getColumnDisplayValue(e){const{colId:t}=e,i=this.getColumnAutocompleteEntries().find((e=>{let{key:i}=e;return i===t}));let s;return i?(s=i.displayValue,this.columnNameToIdMap[s.toLocaleUpperCase()]={colId:t,columnName:s}):s=t,s}getOperatorDisplayValue(e){var t,i;return null!=(i=null==(t=this.getExpressionOperator(e.filterType,e.type))?void 0:t.displayValue)?i:e.type}getOperandModelValue(e,t,i){var r;switch(t){case"number":return s.ch.exists(e)?Number(e):null;case"date":return s.ch.serialiseDate(this.valueParserService.parseValue(i,null,e,void 0),!1);case"dateString":const t=this.valueParserService.parseValue(i,null,e,void 0);return s.ch.serialiseDate(null!=(r=this.dataTypeService.getDateParserFunction(i)(t))?r:null,!1)}return e}getOperandDisplayValue(e,t){var i,r;const{colId:a,filter:o}=e,n=this.columnModel.getPrimaryColumn(a);let l="";if(null!=o){let a;switch(e.filterType){case"number":a=null!=(i=s.ch.toStringOrNull(o))?i:"";break;case"date":const e=s.ch.parseDateTimeFromString(o);a=n?this.valueFormatterService.formatValue(n,null,e):null;break;case"dateString":const t=s.ch.parseDateTimeFromString(o),r=n?this.dataTypeService.getDateFormatterFunction(n)(t??void 0):null;a=n?this.valueFormatterService.formatValue(n,null,r):null}"number"!==e.filterType&&(a=null!=(r=a??s.ch.toStringOrNull(o))?r:"",t||(a=`"${a}"`)),l=t?a:` ${a}`}return l}parseColumnFilterModel(e){var t,i;return`[${null!=(t=this.getColumnDisplayValue(e))?t:""}] ${null!=(i=this.getOperatorDisplayValue(e))?i:""}${this.getOperandDisplayValue(e)}`}updateAutocompleteCache(e,t){if("column"===t){const{key:t,displayValue:i}=e;this.columnNameToIdMap[e.displayValue.toLocaleUpperCase()]={colId:t,columnName:i}}}translate(e,t){let i=X[e];return"function"==typeof i&&(i=i(t)),this.localeService.getLocaleTextFunc()(e,i,t)}generateAutocompleteListParams(e,t,i){return{enabled:!0,type:t,searchString:i,entries:e}}getColumnAutocompleteEntries(){var e;if(this.columnAutocompleteEntries)return this.columnAutocompleteEntries;const t=null!=(e=this.columnModel.getAllPrimaryColumns())?e:[],i=[],s=this.gridOptionsService.get("includeHiddenColumnsInAdvancedFilter");return t.forEach((e=>{e.getColDef().filter&&(s||e.isVisible()||e.isRowGroupActive())&&i.push({key:e.getColId(),displayValue:this.columnModel.getDisplayNameForColumn(e,"advancedFilter")})})),i.sort(((e,t)=>{var i,s;const r=null!=(i=e.displayValue)?i:"",a=null!=(s=t.displayValue)?s:"";return r<a?-1:a>r?1:0})),i}getOperatorAutocompleteEntries(e,t){const i=this.getActiveOperators(e);return this.getDataTypeExpressionOperator(t).getEntries(i)}getJoinOperatorAutocompleteEntries(){return Object.entries(this.expressionJoinOperators).map((e=>{let[t,i]=e;return{key:t,displayValue:i}}))}getDefaultAutocompleteListParams(e){return this.generateAutocompleteListParams(this.getColumnAutocompleteEntries(),"column",e)}getDataTypeExpressionOperator(e){return this.expressionOperators[e]}getExpressionOperator(e,t){var i,s;return null==(s=null==(i=this.getDataTypeExpressionOperator(e))?void 0:i.operators)?void 0:s[t]}getExpressionJoinOperators(){return this.expressionJoinOperators}getColId(e){const t=e.toLocaleUpperCase(),i=this.columnNameToIdMap[t];if(i)return i;const s=this.getColumnAutocompleteEntries().find((e=>{let{displayValue:i}=e;return i.toLocaleUpperCase()===t}));if(s){const{key:e,displayValue:i}=s,r={colId:e,columnName:i};return this.columnNameToIdMap[t]=r,r}return null}getExpressionEvaluatorParams(e){let t=this.expressionEvaluatorParams[e];if(t)return t;const i=this.columnModel.getPrimaryColumn(e);if(!i)return{valueConverter:e=>e};switch(this.dataTypeService.getBaseDataType(i)){case"dateString":t={valueConverter:this.dataTypeService.getDateParserFunction(i)};break;case"object":t=i.getColDef().filterValueGetter?{valueConverter:e=>e}:{valueConverter:(e,t)=>{var s;return null!=(s=this.valueFormatterService.formatValue(i,t,e))?s:"function"==typeof e.toString?e.toString():""}};break;case"text":case void 0:t={valueConverter:e=>s.ch.toStringOrNull(e)};break;default:t={valueConverter:e=>e}}const{filterParams:r}=i.getColDef();return r&&["caseSensitive","includeBlanksInEquals","includeBlanksInLessThan","includeBlanksInGreaterThan"].forEach((e=>{const i=r[e];i&&(t[e]=i)})),this.expressionEvaluatorParams[e]=t,t}getColumnDetails(e){var t,i;const s=null!=(t=this.columnModel.getPrimaryColumn(e))?t:void 0;return{column:s,baseCellDataType:null!=(i=s?this.dataTypeService.getBaseDataType(s):void 0)?i:"text"}}generateExpressionOperators(){const e=(e,t)=>this.translate(e,t);return{text:new ne({translate:e}),boolean:new de({translate:e}),object:new ne({translate:e}),number:new le({translate:e,equals:(e,t)=>e===t}),date:new le({translate:e,equals:(e,t)=>e.getTime()===t.getTime()}),dateString:new le({translate:e,equals:(e,t)=>e.getTime()===t.getTime()})}}getColumnValue(e){let{displayValue:t}=e;return`${re.COL_START_CHAR}${t}${re.COL_END_CHAR}`}generateExpressionJoinOperators(){return{AND:this.translate("advancedFilterAnd"),OR:this.translate("advancedFilterOr")}}getActiveOperators(e){var t;const i=null==(t=e.getColDef().filterParams)?void 0:t.filterOptions;return i&&i.every((e=>"string"==typeof e))?i:void 0}resetColumnCaches(){this.columnAutocompleteEntries=null,this.columnNameToIdMap={},this.expressionEvaluatorParams={}}};L([(0,s.A)("valueFormatterService")],he.prototype,"valueFormatterService",2),L([(0,s.A)("valueParserService")],he.prototype,"valueParserService",2),L([(0,s.A)("columnModel")],he.prototype,"columnModel",2),L([(0,s.A)("dataTypeService")],he.prototype,"dataTypeService",2),L([s.a],he.prototype,"postConstruct",1),he=L([(0,s._)("advancedFilterExpressionService")],he);var ce=class{constructor(e){this.params=e,this.operators=[],this.operatorStartPositions=[],this.operatorEndPositions=[],this.activeOperator=0,this.validationError=null}parseExpression(e){this.operators.push(""),this.operatorStartPositions.push(e),this.operatorEndPositions.push(void 0);const{expression:t}=this.params;for(;e<t.length;){const i=t[e];if(" "===i){if(this.parseOperator(e-1))return this.activeOperator++,e-1;this.operators[this.activeOperator]+=i}else this.operators[this.activeOperator]+=i;e++}return this.parseOperator(e-1),e}isValid(){return!this.validationError&&(!this.operators.length||!!this.parsedOperator)}getValidationError(){return this.validationError}getFunction(){return"OR"===this.parsedOperator?"||":"&&"}getModel(){return"OR"===this.parsedOperator?"OR":"AND"}getAutocompleteListParams(e,t){let i;if(null==t)i="";else{const s=this.operators[t],r=this.operatorEndPositions[t];i=Z(s,e,null==r?this.params.expression.length:r+1)}let s=this.params.advancedFilterExpressionService.getJoinOperatorAutocompleteEntries();return(t||null==t&&this.activeOperator)&&(s=s.filter((e=>{let{key:t}=e;return t===this.parsedOperator}))),this.params.advancedFilterExpressionService.generateAutocompleteListParams(s,"join",i)}updateExpression(e,t,i){var s,r;let{expression:a}=this.params;const o=null!=(s=t.displayValue)?s:t.key;if(0===i)for(let n=this.operatorEndPositions.length-1;n>0;n--){const e=this.operatorEndPositions[n];null!=e&&(a=J(a,this.operatorStartPositions[n],e,o).updatedValue)}return J(a,this.operatorStartPositions.length>i?this.operatorStartPositions[i]:e,null!=(r=this.operatorEndPositions.length>i?this.operatorEndPositions[i]:void 0)?r:Q(a,e,!0).endPosition,o,!0)}getNumOperators(){return this.operators.length}getLastOperatorEndPosition(){return this.operatorEndPositions[this.operatorEndPositions.length-1]}parseOperator(e){const t=this.operators.length>this.activeOperator?this.operators[this.activeOperator]:"",i=this.params.advancedFilterExpressionService.getExpressionJoinOperators(),s=ae(t,i,(e=>e));if(s){this.operatorEndPositions[this.activeOperator]=e;const r=i[s];if(this.activeOperator){if(s!==this.parsedOperator)return this.validationError||(this.validationError={message:this.params.advancedFilterExpressionService.translate("advancedFilterValidationJoinOperatorMismatch"),startPosition:e-t.length+1,endPosition:e}),!1}else this.parsedOperator=s;return t!==r&&(ee(this.params,t,r,e),this.operators[this.activeOperator]=r),!0}return null!==s&&(this.validationError||(this.validationError={message:this.params.advancedFilterExpressionService.translate("advancedFilterValidationInvalidJoinOperator"),startPosition:e-t.length+1,endPosition:e}),!0)}},ue=class e{constructor(e,t){this.params=e,this.startPosition=t,this.expectingExpression=!0,this.expectingOperator=!1,this.expressionParsers=[],this.operatorParser=new ce(this.params),this.missingEndBracket=!1,this.extraEndBracket=!1}parseExpression(){let t=this.startPosition;const{expression:i}=this.params;for(;t<i.length;){const s=i[t];if("("!==s||this.expectingOperator){if(")"===s)return this.endPosition=t-1,0===this.startPosition&&(this.extraEndBracket=!0),t;if(" "!==s)if(this.expectingExpression){const e=new re(this.params,t);t=e.parseExpression(),this.expressionParsers.push(e),this.expectingExpression=!1,this.expectingOperator=!0}else this.expectingOperator&&(t=this.operatorParser.parseExpression(t),this.expectingOperator=!1,this.expectingExpression=!0)}else{const i=new e(this.params,t+1);t=i.parseExpression(),this.expressionParsers.push(i),this.expectingExpression=!1,this.expectingOperator=!0}t++}return this.startPosition>0&&(this.missingEndBracket=!0),t}isValid(){return!this.missingEndBracket&&!this.extraEndBracket&&this.expressionParsers.length===this.operatorParser.getNumOperators()+1&&this.operatorParser.isValid()&&this.expressionParsers.every((e=>e.isValid()))}getValidationError(){const e=this.operatorParser.getValidationError();for(let i=0;i<this.expressionParsers.length;i++){const t=this.expressionParsers[i].getValidationError();if(t)return e&&e.startPosition<t.startPosition?e:t}if(e)return e;if(this.extraEndBracket)return{message:this.params.advancedFilterExpressionService.translate("advancedFilterValidationExtraEndBracket"),startPosition:this.endPosition+1,endPosition:this.endPosition+1};let t;return this.expressionParsers.length===this.operatorParser.getNumOperators()?t="advancedFilterValidationMissingCondition":this.missingEndBracket&&(t="advancedFilterValidationMissingEndBracket"),t?{message:this.params.advancedFilterExpressionService.translate(t),startPosition:this.params.expression.length,endPosition:this.params.expression.length}:null}getFunction(e){const t=this.expressionParsers.length>1,i=this.expressionParsers.map((t=>t.getFunction(e))).join(` ${this.operatorParser.getFunction()} `);return t?`(${i})`:i}getAutocompleteListParams(e){if(null!=this.endPosition&&e>this.endPosition+1)return;if(!this.expressionParsers.length)return this.getColumnAutocompleteListParams();const t=this.getExpressionParserIndex(e);if(null==t)return"("===this.params.expression[e]?{enabled:!1}:this.getColumnAutocompleteListParams();const i=this.expressionParsers[t].getAutocompleteListParams(e);if(!i){if(t<this.expressionParsers.length-1)return this.operatorParser.getAutocompleteListParams(e,t);if(this.expressionParsers.length===this.operatorParser.getNumOperators()){const t=this.operatorParser.getLastOperatorEndPosition();return null==t||e<=t+1?this.operatorParser.getAutocompleteListParams(e,this.operatorParser.getNumOperators()-1):this.getColumnAutocompleteListParams()}return")"===this.params.expression[e-1]?{enabled:!1}:this.operatorParser.getAutocompleteListParams(e)}return i}updateExpression(e,t,i){var s;const r=this.params.expression,a=this.getExpressionParserIndex(e);if(null==a){const e="column"===i?this.params.advancedFilterExpressionService.getColumnValue(t):null!=(s=t.displayValue)?s:t.key;return J(r,this.startPosition,this.startPosition,e,!0)}return this.expressionParsers[a].updateExpression(e,t,i)??("column"===i?J(r,e,r.length-1,this.params.advancedFilterExpressionService.getColumnValue(t),!0):null!=this.endPosition&&e>this.endPosition+1?null:this.operatorParser.updateExpression(e,t,a))}getModel(){return this.expressionParsers.length>1?{filterType:"join",type:this.operatorParser.getModel(),conditions:this.expressionParsers.map((e=>e.getModel()))}:this.expressionParsers[0].getModel()}getColumnAutocompleteListParams(){return this.params.advancedFilterExpressionService.generateAutocompleteListParams(this.params.advancedFilterExpressionService.getColumnAutocompleteEntries(),"column","")}getExpressionParserIndex(e){let t;for(let i=0;i<this.expressionParsers.length&&!(this.expressionParsers[i].startPosition>e);i++)t=i;return t}},pe=class{constructor(e){this.params=e,this.valid=!1}parseExpression(){this.joinExpressionParser=new ue(this.params,0);const e=this.joinExpressionParser.parseExpression();return this.valid=e>=this.params.expression.length-1&&this.joinExpressionParser.isValid(),this.params.expression}isValid(){return this.valid}getValidationMessage(){const e=this.joinExpressionParser.getValidationError();if(!e)return null;const{message:t,startPosition:i,endPosition:s}=e;return i<this.params.expression.length?this.params.advancedFilterExpressionService.translate("advancedFilterValidationMessage",[t,this.params.expression.slice(i,s+1).trim()]):this.params.advancedFilterExpressionService.translate("advancedFilterValidationMessageAtEnd",[t])}getFunction(){const e={operands:[],operators:[],evaluatorParams:[]};return{functionBody:`return ${this.joinExpressionParser.getFunction(e)};`,params:e}}getAutocompleteListParams(e){var t;return null!=(t=this.joinExpressionParser.getAutocompleteListParams(e))?t:{enabled:!1}}updateExpression(e,t,i){return this.joinExpressionParser.updateExpression(e,t,i)}getModel(){return this.isValid()?this.joinExpressionParser.getModel():null}},ge=class extends s.B{constructor(){super(...arguments),this.appliedExpression=null,this.expression=null,this.isValid=!0}postConstruct(){this.setEnabled(this.gridOptionsService.get("enableAdvancedFilter"),!0),this.ctrl=this.createManagedBean(new Y(this.enabled)),this.expressionProxy={getValue:(e,t)=>{const i=this.columnModel.getPrimaryColumn(e);return i?this.valueService.getValue(i,t,!0):void 0}},this.addManagedPropertyListener("enableAdvancedFilter",(e=>this.setEnabled(!!e.currentValue))),this.addManagedListener(this.eventService,s.aA.EVENT_NEW_COLUMNS_LOADED,(e=>this.onNewColumnsLoaded(e))),this.addManagedPropertyListener("includeHiddenColumnsInAdvancedFilter",(()=>this.updateValidity()))}isEnabled(){return this.enabled}isFilterPresent(){return!!this.expressionFunction}doesFilterPass(e){return this.expressionFunction(this.expressionProxy,e,this.expressionParams)}getModel(){var e;const t=this.createExpressionParser(this.appliedExpression);return null==t||t.parseExpression(),null!=(e=null==t?void 0:t.getModel())?e:null}setModel(e){const t=(e,i)=>{if("join"===e.filterType){const r=this.advancedFilterExpressionService.parseJoinOperator(e),a=e.conditions.map((e=>t(e))).filter((e=>s.ch.exists(e))).join(` ${r} `);return i||e.conditions.length<=1?a:`(${a})`}return this.advancedFilterExpressionService.parseColumnFilterModel(e)},i=e?t(e,!0):null;this.setExpressionDisplayValue(i),this.applyExpression(),this.ctrl.refreshComp(),this.ctrl.refreshBuilderComp()}getExpressionDisplayValue(){return this.expression}setExpressionDisplayValue(e){this.expression=e}isCurrentExpressionApplied(){return this.appliedExpression===this.expression}createExpressionParser(e){return e?new pe({expression:e,columnModel:this.columnModel,dataTypeService:this.dataTypeService,valueParserService:this.valueParserService,advancedFilterExpressionService:this.advancedFilterExpressionService}):null}getDefaultExpression(e){const t=this.advancedFilterExpressionService.getColumnValue(e)+" ";return{updatedValue:t,updatedPosition:t.length}}isHeaderActive(){return!this.gridOptionsService.get("advancedFilterParent")}getCtrl(){return this.ctrl}setEnabled(e,t){const i=this.enabled,r=this.rowModel.getType(),a="clientSide"===r||"serverSide"===r;if(e&&!r&&s.ch.warnOnce("Advanced Filter is only supported with the Client-Side Row Model or Server-Side Row Model."),this.enabled=e&&a,!t&&this.enabled!==i){const e={type:s.aA.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,enabled:this.enabled};this.eventService.dispatchEvent(e)}}applyExpression(){const e=this.createExpressionParser(this.expression);null==e||e.parseExpression(),this.applyExpressionFromParser(e)}applyExpressionFromParser(e){if(this.isValid=!e||e.isValid(),!e||!this.isValid)return this.expressionFunction=null,this.expressionParams=null,void(this.appliedExpression=null);const{functionBody:t,params:i}=e.getFunction();this.expressionFunction=new Function("expressionProxy","node","params",t),this.expressionParams=i,this.appliedExpression=this.expression}updateValidity(){this.advancedFilterExpressionService.resetColumnCaches();const e=this.createExpressionParser(this.expression);null==e||e.parseExpression();const t=(!e||e.isValid())!==this.isValid;return this.applyExpressionFromParser(e),this.ctrl.refreshComp(),this.ctrl.refreshBuilderComp(),t}onNewColumnsLoaded(e){if("gridInitializing"!==e.source||!this.dataTypeService.isPendingInference())return;this.ctrl.setInputDisabled(!0);const t=this.addManagedListener(this.eventService,s.aA.EVENT_DATA_TYPES_INFERRED,(()=>{null==t||t(),this.ctrl.setInputDisabled(!1)}))}};L([(0,s.A)("valueService")],ge.prototype,"valueService",2),L([(0,s.A)("columnModel")],ge.prototype,"columnModel",2),L([(0,s.A)("dataTypeService")],ge.prototype,"dataTypeService",2),L([(0,s.A)("valueParserService")],ge.prototype,"valueParserService",2),L([(0,s.A)("rowModel")],ge.prototype,"rowModel",2),L([(0,s.A)("advancedFilterExpressionService")],ge.prototype,"advancedFilterExpressionService",2),L([s.a],ge.prototype,"postConstruct",1),ge=L([(0,s._)("advancedFilterService")],ge);var me={version:"31.2.1",moduleName:s.M.AdvancedFilterModule,beans:[ge,he],agStackComponents:[{componentName:"agAdvancedFilter",componentClass:q}],dependantModules:[E]},ve={};d(ve,{GridChartsModule:()=>Ha,__FORCE_MODULE_DETECTION_AG_GRID_CORE_EXT:()=>Wa,agCharts:()=>Ka});var Ce=Object.defineProperty,fe=Object.defineProperties,ye=Object.getOwnPropertyDescriptor,Se=Object.getOwnPropertyDescriptors,Ee=Object.getOwnPropertySymbols,be=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable,Ae=(e,t,i)=>t in e?Ce(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,xe=(e,t)=>{for(var i in t||(t={}))be.call(t,i)&&Ae(e,i,t[i]);if(Ee)for(var i of Ee(t))we.call(t,i)&&Ae(e,i,t[i]);return e},Te=(e,t)=>fe(e,Se(t)),Me=(e,t,i,s)=>{for(var r,a=s>1?void 0:s?ye(t,i):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s?r(t,i,a):r(a))||a);return s&&a&&Ce(t,i,a),a},Pe=class extends s.B{constructor(){super(...arguments),this.cellRanges=[],this.bodyScrollListener=this.onBodyScroll.bind(this),this.dragging=!1,this.intersectionRange=!1}init(){this.addManagedListener(this.eventService,s.aA.EVENT_NEW_COLUMNS_LOADED,(()=>this.onColumnsChanged())),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_VISIBLE,this.onColumnsChanged.bind(this)),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_VALUE_CHANGED,this.onColumnsChanged.bind(this)),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_PIVOT_MODE_CHANGED,(()=>this.removeAllCellRanges())),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_ROW_GROUP_CHANGED,(()=>this.removeAllCellRanges())),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_PIVOT_CHANGED,(()=>this.removeAllCellRanges())),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_GROUP_OPENED,this.refreshLastRangeStart.bind(this)),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_MOVED,this.refreshLastRangeStart.bind(this)),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_PINNED,this.refreshLastRangeStart.bind(this)),this.ctrlsService.whenReady((()=>{const e=this.ctrlsService.getGridBodyCtrl();this.autoScrollService=new s.W({scrollContainer:e.getBodyViewportElement(),scrollAxis:"xy",getVerticalPosition:()=>e.getScrollFeature().getVScrollPosition().top,setVerticalPosition:t=>e.getScrollFeature().setVerticalScrollPosition(t),getHorizontalPosition:()=>e.getScrollFeature().getHScrollPosition().left,setHorizontalPosition:t=>e.getScrollFeature().setHorizontalScrollPosition(t),shouldSkipVerticalScroll:()=>!this.gridOptionsService.isDomLayout("normal"),shouldSkipHorizontalScroll:()=>!e.getScrollFeature().isHorizontalScrollShowing()})}))}onColumnsChanged(){this.refreshLastRangeStart();const e=this.columnModel.getAllDisplayedColumns();this.cellRanges.forEach((t=>{const i=t.columns;t.columns=t.columns.filter((t=>t.isVisible()&&-1!==e.indexOf(t))),!s.ch.areEqual(i,t.columns)&&this.dispatchChangedEvent(!1,!0,t.id)}));const t=this.cellRanges.length;this.cellRanges=this.cellRanges.filter((e=>e.columns.length>0)),t>this.cellRanges.length&&this.dispatchChangedEvent(!1,!0)}refreshLastRangeStart(){const e=s.ch.last(this.cellRanges);e&&this.refreshRangeStart(e)}isContiguousRange(e){const t=e.columns;if(!t.length)return!1;const i=this.columnModel.getAllDisplayedColumns(),r=t.map((e=>i.indexOf(e))).sort(((e,t)=>e-t));return s.ch.last(r)-r[0]+1===t.length}getRangeStartRow(e){return e.startRow&&e.endRow?this.rowPositionUtils.before(e.startRow,e.endRow)?e.startRow:e.endRow:{rowIndex:0,rowPinned:this.pinnedRowModel.getPinnedTopRowCount()>0?"top":null}}getRangeEndRow(e){if(e.startRow&&e.endRow)return this.rowPositionUtils.before(e.startRow,e.endRow)?e.endRow:e.startRow;const t=this.pinnedRowModel.getPinnedBottomRowCount();return t>0?{rowIndex:t-1,rowPinned:"bottom"}:{rowIndex:this.rowModel.getRowCount()-1,rowPinned:null}}setRangeToCell(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.gridOptionsService.get("enableRangeSelection"))return;const i=this.calculateColumnsBetween(e.column,e.column);if(!i)return;(this.gridOptionsService.get("suppressMultiRangeSelection")||!t||s.ch.missing(this.cellRanges))&&this.removeAllCellRanges(!0);const r={rowIndex:e.rowIndex,rowPinned:e.rowPinned},a={startRow:r,endRow:r,columns:i,startColumn:e.column};this.cellRanges.push(a),this.setNewestRangeStartCell(e),this.onDragStop(),this.dispatchChangedEvent(!0,!0)}extendLatestRangeToCell(e){if(this.isEmpty()||!this.newestRangeStartCell)return;const t=s.ch.last(this.cellRanges);this.updateRangeEnd(t,e)}updateRangeEnd(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const s=t.column,r=this.calculateColumnsBetween(e.startColumn,s);!r||this.isLastCellOfRange(e,t)||(e.columns=r,e.endRow={rowIndex:t.rowIndex,rowPinned:t.rowPinned},i||this.dispatchChangedEvent(!0,!0,e.id))}refreshRangeStart(e){const{startColumn:t,columns:i}=e,r=(t,i)=>{const s=e.columns.filter((e=>e!==t));t?(e.startColumn=t,e.columns=i?[t,...s]:[...s,t]):e.columns=s},{left:a,right:o}=this.getRangeEdgeColumns(e);t!==i[0]||t===a?t!==s.ch.last(i)||t!==o||r(o,!1):r(a,!0)}getRangeEdgeColumns(e){const t=this.columnModel.getAllDisplayedColumns(),i=e.columns.map((e=>t.indexOf(e))).filter((e=>e>-1)).sort(((e,t)=>e-t));return{left:t[i[0]],right:t[s.ch.last(i)]}}extendLatestRangeInDirection(e){if(this.isEmpty()||!this.newestRangeStartCell)return;const t=e.key,i=e.ctrlKey||e.metaKey,r=s.ch.last(this.cellRanges),a=this.newestRangeStartCell,o=r.columns[0],n=s.ch.last(r.columns),l=r.endRow.rowIndex,d=r.endRow.rowPinned,h={column:a.column===o?n:o,rowIndex:l,rowPinned:d},c=this.cellNavigationService.getNextCellToFocus(t,h,i);return c?(this.setCellRange({rowStartIndex:a.rowIndex,rowStartPinned:a.rowPinned,rowEndIndex:c.rowIndex,rowEndPinned:c.rowPinned,columnStart:a.column,columnEnd:c.column}),c):void 0}setCellRange(e){this.gridOptionsService.get("enableRangeSelection")&&(this.removeAllCellRanges(!0),this.addCellRange(e))}setCellRanges(e){s.ch.shallowCompare(this.cellRanges,e)||(this.removeAllCellRanges(!0),e.forEach((e=>{e.columns&&e.startRow&&this.setNewestRangeStartCell({rowIndex:e.startRow.rowIndex,rowPinned:e.startRow.rowPinned,column:e.columns[0]}),this.cellRanges.push(e)})),this.dispatchChangedEvent(!1,!0))}setNewestRangeStartCell(e){this.newestRangeStartCell=e}clearCellRangeCellValues(e){let{cellRanges:t}=e;const{cellEventSource:i="rangeService",dispatchWrapperEvents:r,wrapperEventSource:a="deleteKey"}=e;if(r){const e={type:s.aA.EVENT_RANGE_DELETE_START,source:a};this.eventService.dispatchEvent(e)}if(t||(t=this.cellRanges),t.forEach((e=>{this.forEachRowInRange(e,(t=>{const s=this.rowPositionUtils.getRowNode(t);if(s)for(let r=0;r<e.columns.length;r++){const t=this.columnModel.getGridColumn(e.columns[r]);!t||!t.isCellEditable(s)||s.setDataValue(t,null,i)}}))})),r){const e={type:s.aA.EVENT_RANGE_DELETE_END,source:a};this.eventService.dispatchEvent(e)}}createCellRangeFromCellRangeParams(e){let t,i=!1;if(e.columns)t=e.columns.map((e=>this.columnModel.getColumnWithValidation(e))).filter((e=>e));else{const s=this.columnModel.getColumnWithValidation(e.columnStart),r=this.columnModel.getColumnWithValidation(e.columnEnd);if(!s||!r)return;t=this.calculateColumnsBetween(s,r),t&&t.length&&(i=t[0]!==s)}if(!t)return;return{startRow:null!=e.rowStartIndex?{rowIndex:e.rowStartIndex,rowPinned:e.rowStartPinned||null}:void 0,endRow:null!=e.rowEndIndex?{rowIndex:e.rowEndIndex,rowPinned:e.rowEndPinned||null}:void 0,columns:t,startColumn:i?s.ch.last(t):t[0]}}addCellRange(e){if(!this.gridOptionsService.get("enableRangeSelection"))return;const t=this.createCellRangeFromCellRangeParams(e);t&&(t.startRow&&this.setNewestRangeStartCell({rowIndex:t.startRow.rowIndex,rowPinned:t.startRow.rowPinned,column:t.startColumn}),this.cellRanges.push(t),this.dispatchChangedEvent(!1,!0,t.id))}getCellRanges(){return this.cellRanges}isEmpty(){return 0===this.cellRanges.length}isMoreThanOneCell(){const e=this.cellRanges.length;if(0===e)return!1;if(e>1)return!0;const t=this.cellRanges[0],i=this.getRangeStartRow(t),s=this.getRangeEndRow(t);return i.rowPinned!==s.rowPinned||i.rowIndex!==s.rowIndex||1!==t.columns.length}areAllRangesAbleToMerge(){const e=new Map;if(this.cellRanges.length<=1)return!0;let t;this.cellRanges.forEach((t=>{this.forEachRowInRange(t,(i=>{const s=`${i.rowPinned||"normal"}_${i.rowIndex}`,r=e.get(s),a=t.columns.map((e=>e.getId()));if(r){const e=a.filter((e=>-1===r.indexOf(e)));r.push(...e)}else e.set(s,a)}))}));for(const i of e.values()){const e=i.sort().join();if(void 0!==t){if(t!==e)return!1}else t=e}return!0}forEachRowInRange(e,t){const i=this.getRangeStartRow(e),s=this.getRangeEndRow(e);let r=i;for(;r&&(t(r),!this.rowPositionUtils.sameRow(r,s));)r=this.cellNavigationService.getRowBelow(r)}removeAllCellRanges(e){this.isEmpty()||(this.onDragStop(),this.cellRanges.length=0,e||this.dispatchChangedEvent(!1,!0))}onBodyScroll(){this.dragging&&this.lastMouseEvent&&this.onDragging(this.lastMouseEvent)}isCellInAnyRange(e){return this.getCellRangeCount(e)>0}isCellInSpecificRange(e,t){const i=null!==t.columns&&s.ch.includes(t.columns,e.column),r=this.isRowInRange(e.rowIndex,e.rowPinned,t);return i&&r}isLastCellOfRange(e,t){const{startRow:i,endRow:r}=e,a=this.rowPositionUtils.before(i,r)?r:i,o=t.rowIndex===a.rowIndex&&t.rowPinned===a.rowPinned,n=e.columns[0],l=s.ch.last(e.columns),d=e.startColumn===n?l:n;return t.column===d&&o}isBottomRightCell(e,t){const i=this.columnModel.getAllDisplayedColumns(),r=e.columns.map((e=>i.indexOf(e))).sort(((e,t)=>e-t)),{startRow:a,endRow:o}=e,n=this.rowPositionUtils.before(a,o)?o:a,l=i.indexOf(t.column)===s.ch.last(r),d=t.rowIndex===n.rowIndex&&s.ch.makeNull(t.rowPinned)===s.ch.makeNull(n.rowPinned);return l&&d}getCellRangeCount(e){return this.isEmpty()?0:this.cellRanges.filter((t=>this.isCellInSpecificRange(e,t))).length}isRowInRange(e,t,i){const s=this.getRangeStartRow(i),r=this.getRangeEndRow(i),a={rowIndex:e,rowPinned:t||null},o=a.rowIndex===s.rowIndex&&a.rowPinned==s.rowPinned,n=a.rowIndex===r.rowIndex&&a.rowPinned==r.rowPinned;if(o||n)return!0;const l=!this.rowPositionUtils.before(a,s),d=this.rowPositionUtils.before(a,r);return l&&d}getDraggingRange(){return this.draggingRange}onDragStart(e){if(!this.gridOptionsService.get("enableRangeSelection"))return;const{ctrlKey:t,metaKey:i,shiftKey:r}=e,a=t||i,o=!this.gridOptionsService.get("suppressMultiRangeSelection")&&a,n=r&&s.ch.existsAndNotEmpty(this.cellRanges);!o&&(!n||s.ch.exists(s.ch.last(this.cellRanges).type))&&this.removeAllCellRanges(!0);const l=this.dragService.getStartTarget();if(l&&this.updateValuesOnMove(l),this.lastCellHovered){if(this.dragging=!0,this.lastMouseEvent=e,this.intersectionRange=o&&this.getCellRangeCount(this.lastCellHovered)>1,n||this.setNewestRangeStartCell(this.lastCellHovered),this.cellRanges.length>0)this.draggingRange=s.ch.last(this.cellRanges);else{const e={rowIndex:this.lastCellHovered.rowIndex,rowPinned:this.lastCellHovered.rowPinned};this.draggingRange={startRow:e,endRow:e,columns:[this.lastCellHovered.column],startColumn:this.newestRangeStartCell.column},this.cellRanges.push(this.draggingRange)}this.ctrlsService.getGridBodyCtrl().addScrollEventListener(this.bodyScrollListener),this.dispatchChangedEvent(!0,!1,this.draggingRange.id)}}intersectLastRange(e){if(e&&this.dragging||this.gridOptionsService.get("suppressMultiRangeSelection")||this.isEmpty())return;const t=s.ch.last(this.cellRanges),i=this.getRangeStartRow(t),r=this.getRangeEndRow(t),a=[];this.cellRanges.slice(0,-1).forEach((e=>{const o=this.getRangeStartRow(e),n=this.getRangeEndRow(e),l=e.columns,d=l.filter((e=>-1===t.columns.indexOf(e)));if(d.length===l.length)return void a.push(e);if(this.rowPositionUtils.before(r,o)||this.rowPositionUtils.before(n,i))return void a.push(e);const h=a.length;if(this.rowPositionUtils.before(o,i)){const e={columns:[...l],startColumn:t.startColumn,startRow:xe({},o),endRow:this.cellNavigationService.getRowAbove(i)};a.push(e)}if(d.length>0){const e={columns:d,startColumn:s.ch.includes(d,t.startColumn)?t.startColumn:d[0],startRow:this.rowPositionUtils.rowMax([xe({},i),xe({},o)]),endRow:this.rowPositionUtils.rowMin([xe({},r),xe({},n)])};a.push(e)}this.rowPositionUtils.before(r,n)&&a.push({columns:[...l],startColumn:t.startColumn,startRow:this.cellNavigationService.getRowBelow(r),endRow:xe({},n)}),a.length-h===1&&(a[a.length-1].id=e.id)})),this.cellRanges=a,e&&this.dispatchChangedEvent(!1,!0)}updateValuesOnMove(e){const t=s.ch.getCtrlForEventTarget(this.gridOptionsService,e,s.a3.DOM_DATA_KEY_CELL_CTRL),i=null==t?void 0:t.getCellPosition();this.cellHasChanged=!1,!(!i||this.lastCellHovered&&this.cellPositionUtils.equals(i,this.lastCellHovered))&&(this.lastCellHovered&&(this.cellHasChanged=!0),this.lastCellHovered=i)}onDragging(e){if(!this.dragging||!e)return;this.updateValuesOnMove(e.target),this.lastMouseEvent=e;const t=this.lastCellHovered,i=e=>t&&t.rowPinned===e&&this.newestRangeStartCell.rowPinned===e,s=i("top")||i("bottom");if(this.autoScrollService.check(e,s),!this.cellHasChanged)return;const r=this.calculateColumnsBetween(this.newestRangeStartCell.column,t.column);r&&(this.draggingRange.endRow={rowIndex:t.rowIndex,rowPinned:t.rowPinned},this.draggingRange.columns=r,this.dispatchChangedEvent(!1,!1,this.draggingRange.id))}onDragStop(){if(!this.dragging)return;const{id:e}=this.draggingRange;this.autoScrollService.ensureCleared(),this.ctrlsService.getGridBodyCtrl().removeScrollEventListener(this.bodyScrollListener),this.lastMouseEvent=null,this.dragging=!1,this.draggingRange=void 0,this.lastCellHovered=void 0,this.intersectionRange&&(this.intersectionRange=!1,this.intersectLastRange()),this.dispatchChangedEvent(!1,!0,e)}dispatchChangedEvent(e,t,i){const r={type:s.aA.EVENT_RANGE_SELECTION_CHANGED,started:e,finished:t,id:i};this.eventService.dispatchEvent(r)}calculateColumnsBetween(e,t){const i=this.columnModel.getAllDisplayedColumns(),s=e===t,r=i.indexOf(e);if(r<0)return void console.warn(`AG Grid: column ${e.getId()} is not visible`);const a=s?r:i.indexOf(t);if(a<0)return void console.warn(`AG Grid: column ${t.getId()} is not visible`);if(s)return[e];const o=Math.min(r,a),n=o===r?a:r,l=[];for(let d=o;d<=n;d++)l.push(i[d]);return l}};Me([(0,s.A)("rowModel")],Pe.prototype,"rowModel",2),Me([(0,s.A)("dragService")],Pe.prototype,"dragService",2),Me([(0,s.A)("columnModel")],Pe.prototype,"columnModel",2),Me([(0,s.A)("cellNavigationService")],Pe.prototype,"cellNavigationService",2),Me([(0,s.A)("pinnedRowModel")],Pe.prototype,"pinnedRowModel",2),Me([(0,s.A)("rowPositionUtils")],Pe.prototype,"rowPositionUtils",2),Me([(0,s.A)("cellPositionUtils")],Pe.prototype,"cellPositionUtils",2),Me([(0,s.A)("ctrlsService")],Pe.prototype,"ctrlsService",2),Me([s.a],Pe.prototype,"init",1),Pe=Me([(0,s._)("rangeService")],Pe);var Fe=class extends s.ak{constructor(){super(...arguments),this.changedCalculatedValues=!1,this.dragging=!1,this.shouldDestroyOnEndDragging=!1}init(){this.dragService.addDragSource({dragStartPixels:0,eElement:this.getGui(),onDragStart:this.onDragStart.bind(this),onDragging:e=>{this.dragging=!0,this.rangeService.autoScrollService.check(e),this.changedCalculatedValues&&(this.onDrag(e),this.changedCalculatedValues=!1)},onDragStop:e=>{this.dragging=!1,this.onDragEnd(e),this.clearValues(),this.rangeService.autoScrollService.ensureCleared(),document.body.classList.remove(this.getDraggingCssClass()),this.shouldDestroyOnEndDragging&&this.destroy()}}),this.addManagedListener(this.getGui(),"mousedown",this.preventRangeExtension.bind(this))}isDragging(){return this.dragging}getCellCtrl(){return this.cellCtrl}setCellCtrl(e){this.cellCtrl=e}getCellRange(){return this.cellRange}setCellRange(e){this.cellRange=e}getRangeStartRow(){return this.rangeStartRow}setRangeStartRow(e){this.rangeStartRow=e}getRangeEndRow(){return this.rangeEndRow}setRangeEndRow(e){this.rangeEndRow=e}getLastCellHovered(){return this.lastCellHovered}preventRangeExtension(e){e.stopPropagation()}onDragStart(e){this.cellHoverListener=this.addManagedListener(this.ctrlsService.getGridCtrl().getGui(),"mousemove",this.updateValuesOnMove.bind(this)),document.body.classList.add(this.getDraggingCssClass())}getDraggingCssClass(){return`ag-dragging-${this.type===s.bP.FILL?"fill":"range"}-handle`}updateValuesOnMove(e){const t=this.mouseEventService.getCellPositionForEvent(e);!t||this.lastCellHovered&&this.cellPositionUtils.equals(t,this.lastCellHovered)||(this.lastCellHovered=t,this.changedCalculatedValues=!0)}getType(){return this.type}refresh(e){const t=this.getCellCtrl(),i=this.getGui(),r=s.ch.last(this.rangeService.getCellRanges()),a=r.startRow,o=r.endRow;if(a&&o&&(this.rowPositionUtils.before(o,a)?(this.setRangeStartRow(o),this.setRangeEndRow(a)):(this.setRangeStartRow(a),this.setRangeEndRow(o))),t!==e||!s.ch.isVisible(i)){this.setCellCtrl(e);const t=e.getComp().getParentOfValue();t&&t.appendChild(i)}this.setCellRange(r)}clearValues(){this.lastCellHovered=void 0,this.removeListeners()}removeListeners(){this.cellHoverListener&&(this.cellHoverListener(),this.cellHoverListener=void 0)}destroy(){if(!this.shouldDestroyOnEndDragging&&this.isDragging())return s.ch.setDisplayed(this.getGui(),!1),void(this.shouldDestroyOnEndDragging=!0);this.shouldDestroyOnEndDragging=!1,super.destroy(),this.removeListeners();const e=this.getGui();e.parentElement&&e.parentElement.removeChild(e)}};function De(e){const t=e.length;let i=0;if(t<=1)return e;for(let c=0;c<e.length;c++){const t=e[c],s=t.toString().split("e-");s.length>1?i=Math.max(i,parseInt(s[1],10)):Math.floor(t)!==t&&(i=Math.max(i,t.toString().split(".")[1].length))}let s=0,r=0,a=0,o=0,n=0;for(let c=0;c<t;c++)n=e[c],s+=c,r+=n,o+=c*c,a+=c*n;const l=(t*a-s*r)/(t*o-s*s),d=r/t-l*s/t,h=[];for(let c=0;c<=t;c++)h.push(parseFloat((c*l+d).toFixed(i)));return h}Me([(0,s.A)("rowRenderer")],Fe.prototype,"rowRenderer",2),Me([(0,s.A)("dragService")],Fe.prototype,"dragService",2),Me([(0,s.A)("rangeService")],Fe.prototype,"rangeService",2),Me([(0,s.A)("mouseEventService")],Fe.prototype,"mouseEventService",2),Me([(0,s.A)("columnModel")],Fe.prototype,"columnModel",2),Me([(0,s.A)("cellNavigationService")],Fe.prototype,"cellNavigationService",2),Me([(0,s.A)("navigationService")],Fe.prototype,"navigationService",2),Me([(0,s.A)("rowPositionUtils")],Fe.prototype,"rowPositionUtils",2),Me([(0,s.A)("cellPositionUtils")],Fe.prototype,"cellPositionUtils",2),Me([(0,s.A)("ctrlsService")],Fe.prototype,"ctrlsService",2),Me([s.a],Fe.prototype,"init",1);var Re=class e extends Fe{constructor(){super(e.TEMPLATE),this.markedCells=[],this.cellValues=[],this.isUp=!1,this.isLeft=!1,this.isReduce=!1,this.type=s.bP.FILL}updateValuesOnMove(e){super.updateValuesOnMove(e),this.initialXY||(this.initialXY=this.mouseEventService.getNormalisedPosition(e));const{x:t,y:i}=this.initialXY,{x:s,y:r}=this.mouseEventService.getNormalisedPosition(e),a=Math.abs(t-s),o=Math.abs(i-r),n=this.getFillHandleDirection();let l;l="xy"===n?a>o?"x":"y":n,l!==this.dragAxis&&(this.dragAxis=l,this.changedCalculatedValues=!0)}onDrag(e){if(!this.initialPosition){const e=this.getCellCtrl();if(!e)return;this.initialPosition=e.getCellPosition()}const t=this.getLastCellHovered();t&&this.markPathFrom(this.initialPosition,t)}onDragEnd(e){if(this.initialXY=null,!this.markedCells.length)return;const t="x"===this.dragAxis,i=this.getCellRange(),s=i.columns.length,r=this.getRangeStartRow(),a=this.getRangeEndRow();let o;if(this.isUp||this.isLeft){const e=t?r:this.lastCellMarked;o=this.rangeService.createCellRangeFromCellRangeParams({rowStartIndex:e.rowIndex,rowStartPinned:e.rowPinned,columnStart:t?this.lastCellMarked.column:i.columns[0],rowEndIndex:a.rowIndex,rowEndPinned:a.rowPinned,columnEnd:i.columns[s-1]})}else o=this.rangeService.createCellRangeFromCellRangeParams({rowStartIndex:r.rowIndex,rowStartPinned:r.rowPinned,columnStart:i.columns[0],rowEndIndex:t?a.rowIndex:this.lastCellMarked.rowIndex,rowEndPinned:t?a.rowPinned:this.lastCellMarked.rowPinned,columnEnd:t?this.lastCellMarked.column:i.columns[s-1]});o&&(this.raiseFillStartEvent(),this.handleValueChanged(i,o,e),this.rangeService.setCellRanges([o]),this.raiseFillEndEvent(i,o))}getFillHandleDirection(){const e=this.gridOptionsService.get("fillHandleDirection");return e?"x"!==e&&"y"!==e&&"xy"!==e?(s.ch.warnOnce("valid values for fillHandleDirection are 'x', 'y' and 'xy'. Default to 'xy'."),"xy"):e:"xy"}raiseFillStartEvent(){const e={type:s.aA.EVENT_FILL_START};this.eventService.dispatchEvent(e)}raiseFillEndEvent(e,t){const i={type:s.aA.EVENT_FILL_END,initialRange:e,finalRange:t};this.eventService.dispatchEvent(i)}handleValueChanged(e,t,i){const r=this.rangeService.getRangeEndRow(e),a=this.rangeService.getRangeStartRow(e),o=this.rangeService.getRangeEndRow(t),n=this.rangeService.getRangeStartRow(t),l="y"===this.dragAxis;if(this.isReduce&&!this.gridOptionsService.get("suppressClearOnFillReduction")){const i=l?e.columns:e.columns.filter((e=>t.columns.indexOf(e)<0)),s=l?this.cellNavigationService.getRowBelow(o):n;return void(s&&this.clearCellsInRange(s,r,i))}const d=[],h=[],c=[],u=[];let p=!0,g=0;const m=()=>{d.length=0,h.length=0,c.length=0,u.length=0,g=0},v=(t,i)=>{let h=this.isUp?r:a,c=!1;for(l&&(p=!0,m());!c&&h;){const u=this.rowPositionUtils.getRowNode(h);if(!u)break;l&&t?C(d,t,u,(()=>!this.rowPositionUtils.sameRow(h,this.isUp?a:r))):i&&(p=!0,m(),i.forEach((t=>C(d,t,u,(()=>t!==(this.isLeft?e.columns[0]:s.ch.last(e.columns))))))),c=this.rowPositionUtils.sameRow(h,this.isUp?n:o),h=this.isUp?this.cellNavigationService.getRowAbove(h):this.cellNavigationService.getRowBelow(h)}},C=(e,t,r,a)=>{var o,n;let l,d=!1;if(p)l=this.valueService.getValue(t,r),h.push(l),c.push(this.valueService.getValue(t,r,void 0,!0)),u.push(this.valueFormatterService.formatValue(t,r,l)),p=a();else{const{value:a,fromUserFunction:p,sourceCol:m,sourceRowNode:v}=this.processValues({event:i,values:e,initialValues:h,initialNonAggregatedValues:c,initialFormattedValues:u,col:t,rowNode:r,idx:g++});if(l=a,t.isCellEditable(r)){const e=this.valueService.getValue(t,r);p||(m&&!1!==(null==(o=m.getColDef())?void 0:o.useValueFormatterForExport)&&(l=null!=(n=this.valueFormatterService.formatValue(m,v,l))?n:l),!1!==t.getColDef().useValueParserForImport&&(l=this.valueParserService.parseValue(t,r,m?l:s.ch.toStringOrNull(l),e))),p&&e===l?d=!0:r.setDataValue(t,l,"rangeService")}}d||e.push({value:l,column:t,rowNode:r})};if(l)e.columns.forEach((e=>{v(e)}));else{const e=this.isLeft?[...t.columns].reverse():t.columns;v(void 0,e)}}clearCellsInRange(e,t,i){const s={startRow:e,endRow:t,columns:i,startColumn:i[0]};this.rangeService.clearCellRangeCellValues({cellRanges:[s]})}processValues(e){const{event:t,values:i,initialValues:r,initialNonAggregatedValues:a,initialFormattedValues:o,col:n,rowNode:l,idx:d}=e,h=this.gridOptionsService.getCallback("fillOperation");let c;if(c="y"===this.dragAxis?this.isUp?"up":"down":this.isLeft?"left":"right",h){const e=h({event:t,values:i.map((e=>{let{value:t}=e;return t})),initialValues:r,initialNonAggregatedValues:a,initialFormattedValues:o,currentIndex:d,currentCellValue:this.valueService.getValue(n,l),direction:c,column:n,rowNode:l});if(!1!==e)return{value:e,fromUserFunction:!0}}const u=!i.some((e=>{let{value:t}=e;const i=parseFloat(t);return isNaN(i)||i.toString()!==t.toString()}));if(t.altKey||!u){if(u&&1===r.length){const e=this.isUp||this.isLeft?-1:1;return{value:parseFloat(s.ch.last(i).value)+1*e,fromUserFunction:!1}}const{value:e,column:t,rowNode:a}=i[d%i.length];return{value:e,fromUserFunction:!1,sourceCol:t,sourceRowNode:a}}return{value:s.ch.last(De(i.map((e=>{let{value:t}=e;return Number(t)})))),fromUserFunction:!1}}clearValues(){this.clearMarkedPath(),this.clearCellValues(),this.lastCellMarked=void 0,super.clearValues()}clearMarkedPath(){this.markedCells.forEach((e=>{if(!e.isAlive())return;const t=e.getComp();t.addOrRemoveCssClass("ag-selection-fill-top",!1),t.addOrRemoveCssClass("ag-selection-fill-right",!1),t.addOrRemoveCssClass("ag-selection-fill-bottom",!1),t.addOrRemoveCssClass("ag-selection-fill-left",!1)})),this.markedCells.length=0,this.isUp=!1,this.isLeft=!1,this.isReduce=!1}clearCellValues(){this.cellValues.length=0}markPathFrom(e,t){if(this.clearMarkedPath(),this.clearCellValues(),"y"===this.dragAxis){if(this.rowPositionUtils.sameRow(t,e))return;const i=this.rowPositionUtils.before(t,e),s=this.getRangeStartRow(),r=this.getRangeEndRow();i&&(t.rowPinned==s.rowPinned&&t.rowIndex>=s.rowIndex||s.rowPinned!=r.rowPinned&&t.rowPinned==r.rowPinned&&t.rowIndex<=r.rowIndex)?(this.reduceVertical(e,t),this.isReduce=!0):(this.extendVertical(e,t,i),this.isReduce=!1)}else{const i=e.column,s=t.column;if(i===s)return;const r=this.columnModel.getAllDisplayedColumns(),a=r.indexOf(i),o=r.indexOf(s);o<=a&&o>=r.indexOf(this.getCellRange().columns[0])?(this.reduceHorizontal(e,t),this.isReduce=!0):(this.extendHorizontal(e,t,o<a),this.isReduce=!1)}this.lastCellMarked=t}extendVertical(e,t,i){const{navigationService:s,rangeService:r}=this;let a=e;do{const o=this.getCellRange(),n=o.columns.length;for(let l=0;l<n;l++){const d=o.columns[l],h={rowIndex:a.rowIndex,rowPinned:a.rowPinned},c=Te(xe({},h),{column:d}),u=r.isCellInSpecificRange(c,o),p=this.rowPositionUtils.sameRow(a,e);if(i&&(this.isUp=!0),!p){const e=s.getCellByPosition(c);if(e){this.markedCells.push(e);const s=e.getComp();u||(s.addOrRemoveCssClass("ag-selection-fill-left",0===l),s.addOrRemoveCssClass("ag-selection-fill-right",l===n-1)),s.addOrRemoveCssClass(i?"ag-selection-fill-top":"ag-selection-fill-bottom",this.rowPositionUtils.sameRow(a,t))}}}if(this.rowPositionUtils.sameRow(a,t))break}while(a=i?this.cellNavigationService.getRowAbove(a):this.cellNavigationService.getRowBelow(a))}reduceVertical(e,t){let i=e;do{const e=this.getCellRange(),s=e.columns.length,r=this.rowPositionUtils.sameRow(i,t);for(let a=0;a<s;a++){const s={rowIndex:i.rowIndex,rowPinned:i.rowPinned},r=Te(xe({},s),{column:e.columns[a]}),o=this.navigationService.getCellByPosition(r);o&&(this.markedCells.push(o),o.getComp().addOrRemoveCssClass("ag-selection-fill-bottom",this.rowPositionUtils.sameRow(i,t)))}if(r)break}while(i=this.cellNavigationService.getRowAbove(i))}extendHorizontal(e,t,i){const r=this.columnModel.getAllDisplayedColumns(),a=r.indexOf(i?t.column:e.column),o=r.indexOf(i?this.getCellRange().columns[0]:t.column),n=i?0:1,l=r.slice(a+n,o+n),d=this.getRangeStartRow(),h=this.getRangeEndRow();l.forEach((e=>{let t=d,r=!1;do{r=this.rowPositionUtils.sameRow(t,h);const a=this.navigationService.getCellByPosition({rowIndex:t.rowIndex,rowPinned:t.rowPinned,column:e});if(a){this.markedCells.push(a);const r=a.getComp();r.addOrRemoveCssClass("ag-selection-fill-top",this.rowPositionUtils.sameRow(t,d)),r.addOrRemoveCssClass("ag-selection-fill-bottom",this.rowPositionUtils.sameRow(t,h)),i?(this.isLeft=!0,r.addOrRemoveCssClass("ag-selection-fill-left",e===l[0])):r.addOrRemoveCssClass("ag-selection-fill-right",e===s.ch.last(l))}t=this.cellNavigationService.getRowBelow(t)}while(!r)}))}reduceHorizontal(e,t){const i=this.columnModel.getAllDisplayedColumns(),s=i.indexOf(t.column),r=i.indexOf(e.column),a=i.slice(s,r),o=this.getRangeStartRow(),n=this.getRangeEndRow();a.forEach((e=>{let t=o,i=!1;do{i=this.rowPositionUtils.sameRow(t,n);const s=this.navigationService.getCellByPosition({rowIndex:t.rowIndex,rowPinned:t.rowPinned,column:e});s&&(this.markedCells.push(s),s.getComp().addOrRemoveCssClass("ag-selection-fill-right",e===a[0])),t=this.cellNavigationService.getRowBelow(t)}while(!i)}))}refresh(e){const t=this.rangeService.getCellRanges()[0];t.startRow&&t.endRow?super.refresh(e):this.destroy()}};Re.TEMPLATE='<div class="ag-fill-handle"></div>',Me([(0,s.A)("valueService")],Re.prototype,"valueService",2),Me([(0,s.A)("valueParserService")],Re.prototype,"valueParserService",2),Me([(0,s.A)("valueFormatterService")],Re.prototype,"valueFormatterService",2);var Le=Re,Ie=class e extends Fe{constructor(){super(e.TEMPLATE),this.type=s.bP.RANGE,this.rangeFixed=!1}onDrag(e){const t=this.getLastCellHovered();if(!t)return;const i=this.rangeService.getCellRanges(),r=s.ch.last(i);this.rangeFixed||(this.fixRangeStartEnd(r),this.rangeFixed=!0),this.endPosition={rowIndex:t.rowIndex,rowPinned:t.rowPinned,column:t.column},2===i.length&&i[0].type===s.a6.DIMENSION&&r.type===s.a6.VALUE&&!this.rowPositionUtils.sameRow(this.endPosition,this.rangeService.getRangeEndRow(r))&&this.rangeService.updateRangeEnd(i[0],Te(xe({},this.endPosition),{column:i[0].columns[0]}),!0),this.rangeService.extendLatestRangeToCell(this.endPosition)}onDragEnd(e){const t=s.ch.last(this.rangeService.getCellRanges());this.fixRangeStartEnd(t),this.rangeFixed=!1}fixRangeStartEnd(e){const t=this.rangeService.getRangeStartRow(e),i=this.rangeService.getRangeEndRow(e),s=e.columns[0];e.startRow=t,e.endRow=i,e.startColumn=s}};Ie.TEMPLATE='<div class="ag-range-handle"></div>';var Oe=Ie,Ne=class extends s.B{createSelectionHandle(e){return this.createBean(e===s.bP.RANGE?new Oe:new Le)}};Ne=Me([(0,s._)("selectionHandleFactory")],Ne);var ke={version:"31.2.1",moduleName:s.M.RangeSelectionModule,beans:[Pe,Ne],agStackComponents:[{componentName:"AgFillHandle",componentClass:Le},{componentName:"AgRangeHandle",componentClass:Oe}],dependantModules:[E]};c(ve,r.b);var Ge=Object.defineProperty,Ve=Object.defineProperties,Be=Object.getOwnPropertyDescriptor,_e=Object.getOwnPropertyDescriptors,Ue=Object.getOwnPropertySymbols,He=Object.prototype.hasOwnProperty,We=Object.prototype.propertyIsEnumerable,Ke=(e,t,i)=>t in e?Ge(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,ze=(e,t)=>{for(var i in t||(t={}))He.call(t,i)&&Ke(e,i,t[i]);if(Ue)for(var i of Ue(t))We.call(t,i)&&Ke(e,i,t[i]);return e},$e=(e,t)=>Ve(e,_e(t)),je=(e,t)=>{var i={};for(var s in e)He.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&Ue)for(var s of Ue(e))t.indexOf(s)<0&&We.call(e,s)&&(i[s]=e[s]);return i},Ye=(e,t,i,s)=>{for(var r,a=s>1?void 0:s?Be(t,i):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s?r(t,i,a):r(a))||a);return s&&a&&Ge(t,i,a),a},qe=class e extends s.B{getData(e){if(e.crossFiltering){if(e.grouping)return console.warn("AG Grid: crossing filtering with row grouping is not supported."),{chartData:[],columnNames:{}};if(!this.gridOptionsService.isRowModelType("clientSide"))return console.warn("AG Grid: crossing filtering is only supported in the client side row model."),{chartData:[],columnNames:{}}}this.gridOptionsService.isRowModelType("serverSide")&&e.pivoting&&this.updatePivotKeysForSSRM();const t=this.extractRowsFromGridRowModel(e);return t.chartData=this.aggregateRowsByDimension(e,t.chartData),t}extractRowsFromGridRowModel(t){let i=[];const r={},a={},o={};let n,l={},d=[];if(t.crossFiltering)l=this.getFilteredRowNodes(),d=this.getAllRowNodes(),n=d.length;else{const e=this.gridRowModel.getRowCount()-1;n=(t.endRow>=0?Math.min(t.endRow,e):e)-t.startRow+1}for(let s=0;s<n;s++){const n={},h=t.crossFiltering?d[s]:this.gridRowModel.getRow(s+t.startRow);t.dimensionCols.forEach((i=>{const r=i.colId,l=this.columnModel.getGridColumn(r);if(l){const i=this.valueService.getValue(l,h);if(t.grouping){const t=i&&i.toString?String(i.toString()):"",l=e.getGroupLabels(h,t);n[r]={labels:l,toString:function(){return this.labels.filter((e=>!!e)).reverse().join(" - ")}},h.group&&(a[l.toString()]=s);const d=l.slice(1,l.length).toString();d&&(o[d]=a[d])}else n[r]=i}else n[mt.DEFAULT_CATEGORY]=s+1})),t.valueCols.forEach((e=>{let i=[];const s=e.getColDef().pivotKeys;s&&(i=s.slice());const a=e.getColDef().headerName;a&&i.push(a),i.length>0&&(r[e.getId()]=i);const o=e.getColId();if(t.crossFiltering){const i=o+"-filtered-out",s=this.valueService.getValue(e,h),r=null!=s&&"function"==typeof s.toNumber?s.toNumber():s;l[h.id]?(n[o]=r,n[i]=t.aggFunc||t.isScatter?void 0:0):(n[o]=t.aggFunc||t.isScatter?void 0:0,n[i]=r)}else{let t=this.valueService.getValue(e,h);t&&t.hasOwnProperty("toString")&&(t=parseFloat(t.toString())),n[o]=null!=t&&"function"==typeof t.toNumber?t.toNumber():t}})),h.footer&&(n.footer=!0),i.push(n)}if(t.grouping){const e=s.ch.values(o),t=(t,i)=>!t.footer&&!s.ch.includes(e,i);i=i.filter(t)}return{chartData:i,columnNames:r}}aggregateRowsByDimension(e,t){const i=e.dimensionCols;if(!e.aggFunc||0===i.length)return t;const r=s.ch.last(i),a=r&&r.colId,o={},n=[];return t.forEach((e=>{let t=o;i.forEach((s=>{const r=s.colId,o=e[r];if(r===a){let s=t[o];s||(s={__children:[]},i.forEach((t=>{const i=t.colId;s[i]=e[i]})),t[o]=s,n.push(s)),s.__children.push(e)}else t[o]||(t[o]={}),t=t[o]}))})),s.e.__assertRegistered(s.M.RowGroupingModule,"Charting Aggregation",this.context.getGridId())&&n.forEach((t=>e.valueCols.forEach((i=>{if(e.crossFiltering)e.valueCols.forEach((i=>{const s=i.getColId(),r=t.__children.filter((e=>typeof e[s]<"u")).map((e=>e[s]));let a=this.aggregationStage.aggregateValues(r,e.aggFunc);t[i.getId()]=a&&typeof a.value<"u"?a.value:a;const o=`${s}-filtered-out`,n=t.__children.filter((e=>typeof e[o]<"u")).map((e=>e[o]));let l=this.aggregationStage.aggregateValues(n,e.aggFunc);t[o]=l&&typeof l.value<"u"?l.value:l}));else{const r=t.__children.map((e=>e[i.getId()]));let a=0;s.e.__assertRegistered(s.M.RowGroupingModule,"Charting Aggregation",this.context.getGridId())&&(a=this.aggregationStage.aggregateValues(r,e.aggFunc)),t[i.getId()]=a&&typeof a.value<"u"?a.value:a}})))),n}updatePivotKeysForSSRM(){const e=this.columnModel.getSecondaryColumns();if(!e)return;const t=this.extractPivotKeySeparator(e);e.forEach((e=>{if(""===t)e.getColDef().pivotKeys=[];else{const i=e.getColId().split(t);e.getColDef().pivotKeys=i.slice(0,i.length-1)}}))}extractPivotKeySeparator(e){if(0===e.length)return"";const t=(e,i)=>{const s=e.getGroupId();return e.getParent()?t(e.getParent(),s):i.split(s)[1][0]},i=e[0];return null==i.getParent()?"":t(i.getParent(),i.getColId())}static getGroupLabels(e,t){const i=[t];for(;e&&0!==e.level;)(e=e.parent)&&i.push(e.key);return i}getFilteredRowNodes(){const e={};return this.gridRowModel.forEachNodeAfterFilterAndSort((t=>{e[t.id]=t})),e}getAllRowNodes(){let e=[];return this.gridRowModel.forEachNode((t=>{e.push(t)})),this.sortRowNodes(e)}sortRowNodes(e){const t=this.sortController.getSortOptions();return t&&0!=t.length?this.rowNodeSorter.doFullSort(e,t):e}};Ye([(0,s.A)("rowModel")],qe.prototype,"gridRowModel",2),Ye([(0,s.A)("valueService")],qe.prototype,"valueService",2),Ye([(0,s.A)("columnModel")],qe.prototype,"columnModel",2),Ye([(0,s.A)("rowNodeSorter")],qe.prototype,"rowNodeSorter",2),Ye([(0,s.A)("sortController")],qe.prototype,"sortController",2),Ye([(0,s.O)("aggregationStage")],qe.prototype,"aggregationStage",2);var Xe=qe,Ze=class extends s.B{getColumn(e){return this.columnModel.getPrimaryColumn(e)}getAllDisplayedColumns(){return this.columnModel.getAllDisplayedColumns()}getColDisplayName(e){return this.columnModel.getDisplayNameForColumn(e,"chart")}getRowGroupColumns(){return this.columnModel.getRowGroupColumns()}getGroupDisplayColumns(){return this.columnModel.getGroupDisplayColumns()}isPivotMode(){return this.columnModel.isPivotMode()}isPivotActive(){return this.columnModel.isPivotActive()}getChartColumns(){const e=this.columnModel.getAllDisplayedColumns(),t=new Set,i=new Set;return e.forEach((e=>{const s=e.getColDef(),r=s.chartDataType;if(r)switch(r){case"category":case"time":return void t.add(e);case"series":return void i.add(e);case"excluded":return;default:console.warn(`AG Grid: unexpected chartDataType value '${r}' supplied, instead use 'category', 'series' or 'excluded'`)}"ag-Grid-AutoColumn"!==s.colId?e.isPrimary()?(this.isNumberCol(e)?i:t).add(e):i.add(e):t.add(e)})),{dimensionCols:t,valueCols:i}}isNumberCol(e){if("ag-Grid-AutoColumn"===e.getColId())return!1;const t=this.rowRenderer.getRowNode({rowIndex:0,rowPinned:null});if(!t)return!1;let i=this.valueService.getValue(e,t);return null==i&&(i=this.extractLeafData(t,e)),null!=i&&"function"==typeof i.toNumber&&(i=i.toNumber()),"number"==typeof i}extractLeafData(e,t){if(!e.allLeafChildren)return null;for(let i=0;i<e.allLeafChildren.length;i++){const s=e.allLeafChildren[i],r=this.valueService.getValue(t,s);if(null!=r)return r}return null}};Ye([(0,s.A)("columnModel")],Ze.prototype,"columnModel",2),Ye([(0,s.A)("valueService")],Ze.prototype,"valueService",2),Ye([(0,s.A)("rowRenderer")],Ze.prototype,"rowRenderer",2),Ze=Ye([(0,s._)("chartColumnService")],Ze);var Je=class e extends s.B{constructor(e){var t;super(),this.suppressComboChartWarnings=!1,this.chartDataModel=e,this.seriesChartTypes=null!=(t=e.params.seriesChartTypes)?t:[]}init(){this.initComboCharts()}update(e){this.seriesChartTypes=e??this.seriesChartTypes,this.initComboCharts(),this.updateSeriesChartTypes()}initComboCharts(){const e=this.seriesChartTypes&&this.seriesChartTypes.length>0;("customCombo"===this.chartDataModel.chartType||e)&&(this.chartDataModel.chartType="customCombo",this.savedCustomSeriesChartTypes=this.seriesChartTypes||[])}updateSeriesChartTypes(){if(this.chartDataModel.isComboChart()){if(this.seriesChartTypes=this.seriesChartTypes.map((e=>{const t=["groupedColumn","stackedColumn","stackedArea"].includes(e.chartType);return e.secondaryAxis=!t&&e.secondaryAxis,e})),"customCombo"===this.chartDataModel.chartType)return void this.updateSeriesChartTypesForCustomCombo();this.updateChartSeriesTypesForBuiltInCombos()}}updateSeriesChartTypesForCustomCombo(){!(this.seriesChartTypes&&this.seriesChartTypes.length>0)&&!this.suppressComboChartWarnings&&console.warn("AG Grid: 'seriesChartTypes' are required when the 'customCombo' chart type is specified."),this.seriesChartTypes=this.seriesChartTypes.map((t=>(e.SUPPORTED_COMBO_CHART_TYPES.includes(t.chartType)||(console.warn(`AG Grid: invalid chartType '${t.chartType}' supplied in 'seriesChartTypes', converting to 'line' instead.`),t.chartType="line"),t)));const t=this.chartDataModel.valueColState.map((e=>{(!this.savedCustomSeriesChartTypes||0===this.savedCustomSeriesChartTypes.length)&&(this.savedCustomSeriesChartTypes=this.seriesChartTypes);return this.savedCustomSeriesChartTypes.find((t=>t.colId===e.colId))||(e.selected&&!this.suppressComboChartWarnings&&console.warn(`AG Grid: no 'seriesChartType' found for colId = '${e.colId}', defaulting to 'line'.`),{colId:e.colId,chartType:"line",secondaryAxis:!1})}));this.seriesChartTypes=t,this.savedCustomSeriesChartTypes=t,this.suppressComboChartWarnings=!0}updateChartSeriesTypesForBuiltInCombos(){const{chartType:e,valueColState:t}=this.chartDataModel;let i="columnLineCombo"===e?"groupedColumn":"stackedArea",s="columnLineCombo"===e?"line":"groupedColumn";const r=t.filter((e=>e.selected)),a=Math.ceil(r.length/2);this.seriesChartTypes=r.map(((e,t)=>{const r=t>=a?s:i;return{colId:e.colId,chartType:r,secondaryAxis:!1}}))}};Je.SUPPORTED_COMBO_CHART_TYPES=["line","groupedColumn","stackedColumn","area","stackedArea"],Ye([s.a],Je.prototype,"init",1);var Qe=Je,et=["area","bar","column","histogram","line","pie","donut","scatter","bubble","radial-column","radial-bar","radar-line","radar-area","nightingale","range-bar","range-area","box-plot","treemap","sunburst","heatmap","waterfall"];function tt(e){switch(e){case"rangeBar":case"rangeArea":case"waterfall":case"boxPlot":case"radarLine":case"radarArea":case"nightingale":case"radialColumn":case"radialBar":case"sunburst":case"treemap":case"heatmap":return!0;default:return!1}}var it=new Set(["bar","groupedBar","stackedBar","normalizedBar"]);function st(e){return it.has(e)}var rt=new Set(["stackedColumn","normalizedColumn","stackedBar","normalizedBar"]);function at(e){return rt.has(e)}function ot(e){switch(e){case"area":case"areaColumnCombo":case"bar":case"boxPlot":case"bubble":case"column":case"columnLineCombo":case"customCombo":case"groupedBar":case"groupedColumn":case"heatmap":case"histogram":case"line":case"normalizedArea":case"normalizedBar":case"normalizedColumn":case"rangeArea":case"rangeBar":case"scatter":case"stackedArea":case"stackedBar":case"stackedColumn":case"waterfall":return!0;default:return!1}}function nt(e){switch(e){case"treemap":case"sunburst":return!0;default:return!1}}function lt(e){return"doughnut"===e?"donut":e}function dt(e){switch(e){case"bar":case"groupedBar":case"stackedBar":case"normalizedBar":case"column":case"groupedColumn":case"stackedColumn":case"normalizedColumn":return"bar";case"line":return"line";case"area":case"stackedArea":case"normalizedArea":return"area";case"bubble":return"bubble";case"scatter":return"scatter";case"histogram":return"histogram";case"radialColumn":return"radial-column";case"radialBar":return"radial-bar";case"radarLine":return"radar-line";case"radarArea":return"radar-area";case"nightingale":return"nightingale";case"rangeBar":return"range-bar";case"rangeArea":return"range-area";case"boxPlot":return"box-plot";case"treemap":return"treemap";case"sunburst":return"sunburst";case"pie":return"pie";case"donut":case"doughnut":return"donut";case"heatmap":return"heatmap";case"waterfall":return"waterfall";default:return"cartesian"}}function ht(e){switch(e){case"pie":case"donut":return!0;default:return!1}}function ct(e){return nt(e)?void 0:1}function ut(e){return nt(e)?2:function(e){return"pie"===e||"waterfall"===e||"histogram"===e}(e)?1:void 0}function pt(e){switch(e){case"column":case"groupedColumn":case"stackedColumn":case"normalizedColumn":case"bar":case"groupedBar":case"stackedBar":case"normalizedBar":case"line":case"donut":case"doughnut":case"area":case"stackedArea":case"normalizedArea":case"radarLine":case"radarArea":case"nightingale":case"radialColumn":case"radialBar":return!0;case"pie":case"scatter":case"bubble":case"sunburst":case"rangeBar":case"rangeArea":case"boxPlot":case"histogram":case"treemap":case"heatmap":case"waterfall":case"columnLineCombo":case"areaColumnCombo":case"customCombo":return!1}}var gt=class e extends s.B{constructor(e){super(),this.unlinked=!1,this.chartData=[],this.valueColState=[],this.dimensionColState=[],this.columnNames={},this.crossFiltering=!1,this.grouping=!1,this.params=e,this.chartId=e.chartId,this.chartType=e.chartType,this.pivotChart=e.pivotChart,this.chartThemeName=e.chartThemeName,this.switchCategorySeries=!!e.switchCategorySeries,this.aggFunc=e.aggFunc,this.referenceCellRange=e.cellRange,this.suppliedCellRange=e.cellRange,this.suppressChartRanges=e.suppressChartRanges,this.unlinked=!!e.unlinkChart,this.crossFiltering=!!e.crossFiltering}init(){this.datasource=this.createManagedBean(new Xe),this.chartColumnService=this.createManagedBean(new Ze),this.comboChartModel=this.createManagedBean(new Qe(this)),this.updateCellRanges({setColsFromRange:!0}),this.updateData()}updateModel(e){const{cellRange:t,chartType:i,pivotChart:s,chartThemeName:r,switchCategorySeries:a,aggFunc:o,suppressChartRanges:n,unlinkChart:l,crossFiltering:d,seriesChartTypes:h}=e;t!==this.suppliedCellRange&&(this.dimensionCellRange=void 0,this.valueCellRange=void 0),this.chartType=i,this.pivotChart=s,this.chartThemeName=r,this.switchCategorySeries=!!a,this.aggFunc=o,this.referenceCellRange=t,this.suppliedCellRange=t,this.suppressChartRanges=n,this.unlinked=!!l,this.crossFiltering=!!d,this.updateSelectedDimensions(null==t?void 0:t.columns),this.updateCellRanges({setColsFromRange:!0}),(this.isComboChart()||h)&&this.comboChartModel.update(h),this.unlinked||this.updateData()}updateCellRanges(e){const{updatedColState:t,resetOrder:i,maintainColState:s,setColsFromRange:r}=e??{};this.valueCellRange&&(this.referenceCellRange=this.valueCellRange);const{dimensionCols:a,valueCols:o}=this.chartColumnService.getChartColumns(),n=this.getAllColumnsFromRanges();t&&this.updateColumnState(t,i),this.setDimensionCellRange(a,n,t),this.setValueCellRange(o,n,r),!t&&!s&&(this.resetColumnState(),this.syncDimensionCellRange()),this.comboChartModel.updateSeriesChartTypes()}updateData(){const{startRow:e,endRow:t}=this.getRowIndexes();this.pivotChart&&this.resetColumnState(),this.grouping=this.isGrouping();const i={aggFunc:this.aggFunc,dimensionCols:this.getSelectedDimensions(),grouping:this.grouping,pivoting:this.isPivotActive(),crossFiltering:this.crossFiltering,valueCols:this.getSelectedValueCols(),startRow:e,endRow:t,isScatter:s.ch.includes(["scatter","bubble"],this.chartType)},{chartData:r,columnNames:a}=this.datasource.getData(i);this.chartData=r,this.columnNames=a}isGrouping(){const e=this.gridOptionsService.get("treeData"),t=e?null:this.chartColumnService.getRowGroupColumns(),i=e||t&&t.length>0,s=this.getSelectedDimensions().map((e=>{let{colId:t}=e;return t})),r=this.chartColumnService.getGroupDisplayColumns().map((e=>e.getColId())).some((e=>s.includes(e)));return!!i&&r}getSelectedValueCols(){return this.valueColState.filter((e=>e.selected)).map((e=>e.column))}getSelectedDimensions(){return this.dimensionColState.filter((e=>e.selected))}getColDisplayName(e){return this.chartColumnService.getColDisplayName(e)}isPivotMode(){return this.chartColumnService.isPivotMode()}getChartDataType(e){const t=this.chartColumnService.getColumn(e);return t?t.getColDef().chartDataType:void 0}isPivotActive(){return this.chartColumnService.isPivotActive()}createCellRange(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return{id:this.chartId,startRow:this.referenceCellRange.startRow,endRow:this.referenceCellRange.endRow,columns:i,startColumn:e===s.a6.DIMENSION?i[0]:this.referenceCellRange.startColumn,type:e}}getAllColumnsFromRanges(){if(this.pivotChart)return s.ch.convertToSet(this.chartColumnService.getAllDisplayedColumns());const e=this.dimensionCellRange||this.valueCellRange?[]:this.referenceCellRange.columns;return this.dimensionCellRange&&e.push(...this.dimensionCellRange.columns),this.valueCellRange&&e.push(...this.valueCellRange.columns),s.ch.convertToSet(e)}getRowIndexes(){let e=0,t=0;const{rangeService:i,valueCellRange:s,dimensionCellRange:r}=this,a=s||r;if(i&&a){e=i.getRangeStartRow(a).rowIndex;const s=i.getRangeEndRow(a);t="bottom"===s.rowPinned?-1:s.rowIndex}return{startRow:e,endRow:t}}resetColumnState(){const{dimensionCols:t,valueCols:i}=this.chartColumnService.getChartColumns(),r=this.getAllColumnsFromRanges(),a=this.valueColState.length<1;this.dimensionColState=[],this.valueColState=[];const o=nt(this.chartType);let n=!1,l=1;const d=this.suppliedCellRange.columns[0];t.forEach((e=>{const t="ag-Grid-AutoColumn"===e.getColId();let i=!1;this.crossFiltering&&this.aggFunc?d.getColId()===e.getColId()&&(i=!0):i=!!t||(!n||o)&&r.has(e),this.dimensionColState.push({column:e,colId:e.getColId(),displayName:this.getColDisplayName(e),selected:i,order:l++}),i&&(n=!0)}));const h={colId:e.DEFAULT_CATEGORY,displayName:this.chartTranslationService.translate("defaultCategory"),selected:!n,order:0};this.dimensionColState.unshift(h);const c=this.referenceCellRange.columns.filter((e=>i.has(e)));i.forEach((e=>{a&&s.ch.includes(this.referenceCellRange.columns,e)&&(e=c.shift()),this.valueColState.push({column:e,colId:e.getColId(),displayName:this.getColDisplayName(e),selected:r.has(e),order:l++})}))}updateColumnState(e,t){const i=t=>t.colId===e.colId,{dimensionColState:s,valueColState:r}=this,a=s.find(i),o=r.find(i);if(a)if(nt(this.chartType))a.selected=e.selected;else{const t=e.selected?a:s.filter((e=>e!==a)).find((e=>{let{selected:t}=e;return t}));s.forEach((e=>e.selected=e===t))}else o&&(o.selected=e.selected);const n=[...s,...r],l=[];t||(n.forEach(((t,i)=>{i===e.order&&l.push(e.colId),t.colId!==e.colId&&l.push(t.colId)})),n.forEach((e=>{const t=l.indexOf(e.colId);e.order=t>=0?l.indexOf(e.colId):n.length-1}))),this.reorderColState()}reorderColState(){const e=(e,t)=>e.order-t.order;this.dimensionColState.sort(e),this.valueColState.sort(e)}setDimensionCellRange(t,i,r){this.dimensionCellRange=void 0;const a=nt(this.chartType);if(!r&&!this.dimensionColState.length){const e=new Array;return t.forEach((t=>{e.length>0&&!a||!i.has(t)||e.push(t)})),void(e.length>0&&(this.dimensionCellRange=this.createCellRange(s.a6.DIMENSION,...e)))}let o=r?[r]:[];if(this.crossFiltering&&this.aggFunc){const e=this.suppliedCellRange.columns[0];o=this.dimensionColState.filter((t=>t.colId===e.getColId()))}else(a||0===o.length||o.some((e=>{let{column:i}=e;return!i||!t.has(i)})))&&(o=this.dimensionColState.filter((e=>e.selected)));const n=1===o.length&&o[0].colId===e.DEFAULT_CATEGORY,l=o.map((e=>{let{column:t}=e;return t})).filter((e=>null!=e));l.length>0&&!n&&(this.dimensionCellRange=this.createCellRange(s.a6.DIMENSION,...l))}setValueCellRange(e,t,i){this.valueCellRange=void 0;const r=[],a=ut(this.chartType);let o=0;if(e.forEach((e=>{i?(null==a||o<a)&&t.has(e)&&(r.push(e),o++):this.valueColState.some((t=>t.selected&&t.colId===e.getColId()))&&r.push(e)})),r.length>0){let e=[];this.valueColState.length>0?e=this.valueColState.map((e=>e.colId)):t.forEach((t=>e.push(t.getColId()))),r.sort(((t,i)=>e.indexOf(t.getColId())-e.indexOf(i.getColId()))),this.valueCellRange=this.createCellRange(s.a6.VALUE,...r)}}resetCellRanges(e,t){if(!e&&!t)return;const{dimensionCols:i,valueCols:s}=this.chartColumnService.getChartColumns(),r=this.getAllColumnsFromRanges();e&&this.setDimensionCellRange(i,r),t&&this.setValueCellRange(s,r)}updateSelectedDimensions(e){const t=new Set(e.map((e=>e.getColId())));if(nt(this.chartType)){const e=this.dimensionColState.filter((e=>t.has(e.colId))),i=new Set(e.map((e=>e.colId)));this.dimensionColState=this.dimensionColState.map((e=>$e(ze({},e),{selected:i.has(e.colId)})))}else{const e=(this.dimensionColState.find((e=>t.has(e.colId)))||this.dimensionColState[0]).colId;this.dimensionColState=this.dimensionColState.map((t=>$e(ze({},t),{selected:t.colId===e})))}}syncDimensionCellRange(){const e=this.getSelectedDimensions();if(0===e.length)return;const t=e.map((e=>{let{column:t}=e;return t})).filter((e=>null!=e));t.length>0&&(this.dimensionCellRange=this.createCellRange(s.a6.DIMENSION,...t))}isComboChart(e){return["columnLineCombo","areaColumnCombo","customCombo"].includes(e??this.chartType)}};gt.DEFAULT_CATEGORY="AG-GRID-DEFAULT-CATEGORY",Ye([(0,s.A)("rangeService")],gt.prototype,"rangeService",2),Ye([(0,s.A)("chartTranslationService")],gt.prototype,"chartTranslationService",2),Ye([s.a],gt.prototype,"init",1);var mt=gt,vt=["number","category","grouped-category","log","time"];function Ct(e,t){return!1!==t.clone&&t.isMergeableObject(e)?wt(function(e){return Array.isArray(e)?[]:{}}(e),e,t):e}function ft(e,t,i){return e.concat(t).map((function(e){return Ct(e,i)}))}function yt(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function St(e,t){try{return t in e}catch{return!1}}function Et(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;const s={};return i.isMergeableObject(e)&&yt(e).forEach((function(t){s[t]=Ct(e[t],i)})),yt(t).forEach((function(r){(function(e,t){return St(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,r)||(St(e,r)&&i.isMergeableObject(t[r])?s[r]=function(e,t){if(!t.customMerge)return wt;const i=t.customMerge(e);return"function"==typeof i?i:wt}(r,i)(e[r],t[r],i):s[r]=Ct(t[r],i))})),s}function bt(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){const t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t}(e)}function wt(e,t,i){(i=i||{}).arrayMerge=i.arrayMerge||ft,i.isMergeableObject=i.isMergeableObject||bt,i.cloneUnlessOtherwiseSpecified=Ct;const s=Array.isArray(t);return s===Array.isArray(e)?s?i.arrayMerge(e,t,i):Et(e,t,i):Ct(t,i)}function At(e,t,i){if(null==e)return i;const s=t.split(".");let r=e;for(;s.length>1;)if(r=r[s.shift()],null==r)return i;return r[s[0]]??i}function xt(e,t,i){var a;const{chartOptionsToRestore:o,chartPaletteToRestore:n,chartThemeToRestore:l}=e,d=function(e){let t=e.getChartThemeName();const i=e.getChartThemes();return s.ch.includes(i,t)||(t=i[0]),t}(e),h=Tt(d),c=h?{baseTheme:d}:null!=(a=Ft(e,d))?a:{},u=e.getGridOptionsChartThemeOverrides(),p=e.apiChartThemeOverrides,g=dt(e.chartType),m=ht(g)?g:"cartesian",v=e.crossFiltering?function(e,t,i){const s={listeners:{legendItemClick:t=>{e.getChart().series.forEach((e=>{e.toggleSeriesItem(t.itemId,t.enabled),e.toggleSeriesItem(`${t.itemId}-filtered-out`,t.enabled)}))}}},r={};return{[i]:{tooltip:{delay:500},legend:s,listeners:{click:e=>t.crossFilterCallback(e,!0)},series:r}}}(t,e,m):void 0,C=ze({},o??{}),f=[h?Pt(e,i,(()=>{const e=e=>!!e&&Object.keys(e).some((t=>At(e[t],"title.enabled",!1)));return e(u)||e(p)})()):void 0,v,u,p,C].filter((e=>!!e)).reduce(((e,t)=>({baseTheme:e,overrides:t})),c);if(n&&d===l){(function(e,t){const i=(e,t)=>e.length===t.length&&e.every(((e,i)=>e===t[i]));return i(e.fills,t.fills)&&i(e.strokes,t.strokes)})(n,r.a.getChartTheme(c).palette)||(f.palette=n)}return f}function Tt(e){return s.ch.includes(Object.keys(r.a.themes),e)}var Mt=vt.reduce(((e,t)=>$e(ze({},e),{[t]:{title:{_enabledFromTheme:!0}}})),{});function Pt(e,t,i){const s=e.getExtraPaddingDirections();return{common:$e(ze({},t?{animation:{duration:500}}:void 0),{axes:Mt,padding:{top:!i&&s.includes("top")?40:20,right:s.includes("right")?30:20,bottom:s.includes("bottom")?40:20,left:s.includes("left")?30:20}}),pie:{series:{title:{_enabledFromTheme:!0},calloutLabel:{_enabledFromTheme:!0},sectorLabel:{enabled:!1,_enabledFromTheme:!0}}},donut:{series:{title:{_enabledFromTheme:!0},calloutLabel:{_enabledFromTheme:!0},sectorLabel:{enabled:!1,_enabledFromTheme:!0}}}}}function Ft(e,t){const{customChartThemes:i}=e,s=i&&i[t];return s||console.warn(`AG Grid: no stock theme exists with the name '${t}' and no custom chart theme with that name was supplied to 'customChartThemes'`),s}var Dt=e=>t=>null==t||e(t),Rt=e=>"string"==typeof e,Lt=e=>"boolean"==typeof e,It=e=>"object"==typeof e,Ot=(e,t)=>i=>`AG Grid - unable to update chart as invalid params supplied:  \`${e}: ${i}\`, expected ${t}.`,Nt=class e{static isValidChartType(t){return e.validChartTypes.includes(t)}static isLegacyChartType(t){return e.legacyChartTypes.includes(t)}static validateChartParams(t){switch(t.type){case"rangeChartUpdate":return e.validateUpdateRangeChartParams(t);case"pivotChartUpdate":return e.validateUpdatePivotChartParams(t);case"crossFilterChartUpdate":return e.validateUpdateCrossFilterChartParams(t);default:return console.warn(`AG Grid - Invalid value supplied for 'type': ${t.type}. It must be either 'rangeChartUpdate', 'pivotChartUpdate', or 'crossFilterChartUpdate'.`),!1}}static validateUpdateRangeChartParams(t){const i=[...e.commonValidations,...e.cellRangeValidations,{property:"seriesChartTypes",validationFn:e=>void 0===e||Array.isArray(e)&&e.every(It),warnMessage:Ot("seriesChartTypes","Array of SeriesChartType")}];return e.validateProperties(t,i,["type","chartId","chartType","chartThemeName","chartThemeOverrides","unlinkChart","cellRange","suppressChartRanges","aggFunc","seriesChartTypes"],"UpdateRangeChartParams")}static validateUpdatePivotChartParams(t){const i=[...e.commonValidations];return e.validateProperties(t,i,["type","chartId","chartType","chartThemeName","chartThemeOverrides","unlinkChart"],"UpdatePivotChartParams")}static validateUpdateCrossFilterChartParams(t){const i=[...e.commonValidations,...e.cellRangeValidations];return e.validateProperties(t,i,["type","chartId","chartType","chartThemeName","chartThemeOverrides","unlinkChart","cellRange","suppressChartRanges","aggFunc"],"UpdateCrossFilterChartParams")}static validateProperties(e,t,i,s){let r;for(const a of t){const{property:t,validationFn:i,warnMessage:s}=a;if(t in e){const a=e[t],o=i(a);if(!0===o)continue;if(!1===o)return console.warn(s(a)),!1;r=r||ze({},e),r[t]=o}}for(const a in e)if(!i.includes(a))return console.warn(`AG Grid - Unexpected property supplied. ${s} does not contain: \`${a}\`.`),!1;return r||!0}};Nt.validChartTypes=["column","groupedColumn","stackedColumn","normalizedColumn","bar","groupedBar","stackedBar","normalizedBar","line","scatter","bubble","pie","donut","area","stackedArea","normalizedArea","histogram","radialColumn","radialBar","radarLine","radarArea","nightingale","rangeBar","rangeArea","boxPlot","treemap","sunburst","heatmap","waterfall","columnLineCombo","areaColumnCombo","customCombo"],Nt.legacyChartTypes=["doughnut"],Nt.validateChartType=Dt((e=>{if(Nt.isValidChartType(e))return!0;if(Nt.isLegacyChartType(e)){const t=lt(e);return console.warn(`AG Grid - The chart type '${e}' has been deprecated. Please use '${t}' instead.`),t}return!1})),Nt.validateAgChartThemeOverrides=Dt((e=>"object"==typeof e)),Nt.validateChartParamsCellRange=Dt((e=>"object"==typeof e)),Nt.validateAggFunc=Dt((e=>"string"==typeof e||"function"==typeof e)),Nt.commonValidations=[{property:"chartId",validationFn:Rt,warnMessage:Ot("chartId","string")},{property:"chartType",validationFn:Nt.validateChartType,warnMessage:Ot("chartType",Nt.validChartTypes.join(", "))},{property:"chartThemeName",validationFn:Rt,warnMessage:Ot("chartThemeName","string")},{property:"chartThemeOverrides",validationFn:Nt.validateAgChartThemeOverrides,warnMessage:Ot("chartThemeOverrides","AgChartThemeOverrides")},{property:"unlinkChart",validationFn:Lt,warnMessage:Ot("unlinkChart","boolean")}],Nt.cellRangeValidations=[{property:"cellRange",validationFn:Nt.validateChartParamsCellRange,warnMessage:Ot("cellRange","ChartParamsCellRange")},{property:"suppressChartRanges",validationFn:Lt,warnMessage:Ot("suppressChartRanges","boolean")},{property:"aggFunc",validationFn:Nt.validateAggFunc,warnMessage:Ot("aggFunc","string or IAggFunc")}];var kt=Nt,Gt=["ag-default","ag-material","ag-sheets","ag-polychroma","ag-vivid"],Vt=class e extends s.B{constructor(e){super(),this.model=e,this.isEnterprise=()=>r.m.enterpriseModule.isEnterprise}init(){this.setChartRange(),this.addManagedListener(this.eventService,s.aA.EVENT_RANGE_SELECTION_CHANGED,(e=>{e.id&&e.id===this.model.chartId&&this.updateForRangeChange()})),this.model.unlinked&&this.rangeService&&this.rangeService.setCellRanges([]),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_MOVED,this.updateForGridChange.bind(this)),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_PINNED,this.updateForGridChange.bind(this)),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_VISIBLE,this.updateForGridChange.bind(this)),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_ROW_GROUP_CHANGED,this.updateForGridChange.bind(this)),this.addManagedListener(this.eventService,s.aA.EVENT_MODEL_UPDATED,this.updateForGridChange.bind(this)),this.addManagedListener(this.eventService,s.aA.EVENT_CELL_VALUE_CHANGED,this.updateForDataChange.bind(this))}update(e){if(!this.validUpdateType(e))return!1;const t=kt.validateChartParams(e);if(!t)return!1;const i=!0===t?e:t;return this.applyValidatedChartParams(i),!0}applyValidatedChartParams(e){var t,i,s,r,a,o,n,l;const{chartId:d,chartType:h,chartThemeName:c,unlinkChart:u}=e,p={chartId:d,pivotChart:this.model.pivotChart,chartType:h??this.model.chartType,chartThemeName:c??this.model.chartThemeName,unlinkChart:u??this.model.unlinked,cellRange:this.model.suppliedCellRange,switchCategorySeries:this.model.switchCategorySeries,aggFunc:this.model.aggFunc,seriesChartTypes:void 0,suppressChartRanges:!1,crossFiltering:!1};let g=ze({},p);switch(e.type){case"rangeChartUpdate":g.cellRange=null!=(t=this.createCellRange(e))?t:this.model.suppliedCellRange,g.switchCategorySeries=null!=(i=e.switchCategorySeries)?i:this.model.switchCategorySeries,g.aggFunc=null!=(s=e.aggFunc)?s:this.model.aggFunc,g.seriesChartTypes=e.seriesChartTypes,g.suppressChartRanges=null!=(r=e.suppressChartRanges)?r:this.model.suppressChartRanges;break;case"crossFilterChartUpdate":g.cellRange=null!=(a=this.createCellRange(e))?a:this.model.suppliedCellRange,g.switchCategorySeries=!1,g.aggFunc=null!=(o=e.aggFunc)?o:this.model.aggFunc,g.crossFiltering=!0,g.suppressChartRanges=null!=(n=e.suppressChartRanges)?n:this.model.suppressChartRanges;break;case"pivotChartUpdate":g.switchCategorySeries=!1}this.model.updateModel(g),g.unlinkChart||g.suppressChartRanges?null==(l=this.rangeService)||l.setCellRanges([]):this.setChartRange()}updateForGridChange(e){if(this.model.unlinked)return;const{maintainColState:t,setColsFromRange:i}=e??{};this.model.updateCellRanges({maintainColState:t,setColsFromRange:i}),this.model.updateData(),this.setChartRange()}updateForDataChange(){this.model.unlinked||(this.model.updateData(),this.raiseChartModelUpdateEvent())}updateForRangeChange(){this.updateForGridChange({setColsFromRange:!0}),this.raiseChartRangeSelectionChangedEvent()}updateForPanelChange(e,t){this.model.updateCellRanges({updatedColState:e,resetOrder:t}),this.model.updateData(),this.setChartRange(),this.raiseChartRangeSelectionChangedEvent()}updateThemeOverrides(e){this.chartProxy.updateThemeOverrides(e)}getChartUpdateParams(e){const t=this.getSelectedValueColState().map((e=>({colId:e.colId,displayName:e.displayName}))),i=this.getChartData(),s=this.getSelectedDimensions(),r={data:i,grouping:this.isGrouping(),categories:s.map((e=>({id:e.colId,name:e.displayName,chartDataType:this.model.getChartDataType(e.colId)}))),fields:t,chartId:this.getChartId(),getCrossFilteringContext:()=>({lastSelectedChartId:"xxx"}),seriesChartTypes:this.getSeriesChartTypes(),updatedOverrides:e};return this.isCategorySeriesSwitched()?this.invertCategorySeriesParams(r):r}invertCategorySeriesParams(e){const[t]=e.categories,i=[{id:mt.DEFAULT_CATEGORY,name:""}],s=e.data.map(((e,i)=>{const s=`${t.id}:${i}`,r=e[t.id];return{colId:s,displayName:null==r?"":String(r)}})),r=e.fields.map((i=>{const s={[mt.DEFAULT_CATEGORY]:i.displayName};for(const[r,a]of e.data.entries()){const e=`${t.id}:${r}`,o=a[i.colId];s[e]=o}return s}));return $e(ze({},e),{categories:i,fields:s,data:r})}getChartModel(){const e=this.model.pivotChart?"pivot":"range",t=this.isComboChart()?this.model.comboChartModel.seriesChartTypes:void 0;return{modelType:e,chartId:this.model.chartId,chartType:this.model.chartType,chartThemeName:this.getChartThemeName(),chartOptions:this.chartProxy.getChartThemeOverrides(),chartPalette:this.chartProxy.getChartPalette(),cellRange:this.getCellRangeParams(),switchCategorySeries:this.model.switchCategorySeries,suppressChartRanges:this.model.suppressChartRanges,aggFunc:this.model.aggFunc,unlinkChart:this.model.unlinked,seriesChartTypes:t}}getChartId(){return this.model.chartId}getChartData(){return this.model.chartData}getChartType(){return this.model.chartType}setChartType(e){this.updateMultiSeriesAndCategory(this.model.chartType,e),this.model.chartType=e,this.model.comboChartModel.updateSeriesChartTypes(),this.model.switchCategorySeries=!1,this.raiseChartModelUpdateEvent(),this.raiseChartOptionsChangedEvent()}isCategorySeriesSwitched(){return this.model.switchCategorySeries}switchCategorySeries(e){pt(this.getChartType())&&(this.model.switchCategorySeries=e,this.raiseChartModelUpdateEvent())}getAggFunc(){return this.model.aggFunc}setAggFunc(e,t){this.model.aggFunc!==e&&(this.model.aggFunc=e,!t&&(this.model.updateData(),this.raiseChartModelUpdateEvent()))}updateMultiSeriesAndCategory(e,t){var i,s;const r=(e,t)=>{let i=0;for(const s of e)s.selected&&(i>=t?s.selected=!1:i++);0===i&&(e[0].selected=!0)},a=ct(t),o=ut(t),n=null!=a&&(null!=(i=ct(e))?i:100)>(a??100),l=null!=o&&(null!=(s=ut(e))?s:100)>(o??100);n&&r(this.model.dimensionColState,a),l&&r(this.model.valueColState,o),(n||l)&&(this.model.resetCellRanges(n,l),this.setChartRange(!0))}setChartThemeName(e,t){this.model.chartThemeName=e,t||(this.raiseChartModelUpdateEvent(),this.raiseChartOptionsChangedEvent())}getChartThemeName(){return this.model.chartThemeName}isPivotChart(){return this.model.pivotChart}isPivotMode(){return this.model.isPivotMode()}isGrouping(){return this.model.isGrouping()}isCrossFilterChart(){return this.model.crossFiltering}getThemeNames(){return this.gridOptionsService.get("chartThemes")||Gt}getThemes(){return this.getThemeNames().map((e=>{const t=Tt(e)?e:this.chartProxy.lookupCustomChartTheme(e);return r.a.getChartTheme(t)}))}getPalettes(){return this.getThemes().map((e=>e.palette))}getThemeTemplateParameters(){return this.getThemes().map((e=>e.getTemplateParameters()))}getValueColState(){return this.model.valueColState.map(this.displayNameMapper.bind(this))}getSelectedValueColState(){return this.getValueColState().filter((e=>e.selected))}getSelectedDimensions(){return this.model.getSelectedDimensions()}displayNameMapper(e){const t=this.model.columnNames[e.colId];return e.displayName=t?t.join(" - "):this.model.getColDisplayName(e.column),e}getColStateForMenu(){return{dimensionCols:this.model.dimensionColState,valueCols:this.getValueColState()}}setChartRange(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.rangeService&&!this.model.suppressChartRanges&&!this.model.unlinked&&this.rangeService.setCellRanges(this.getCellRanges()),e||this.raiseChartModelUpdateEvent()}detachChartRange(){this.model.unlinked=!this.model.unlinked,this.model.unlinked?this.rangeService&&this.rangeService.setCellRanges([]):this.updateForGridChange(),this.dispatchEvent({type:e.EVENT_CHART_LINKED_CHANGED})}setChartProxy(e){this.chartProxy=e}getChartProxy(){return this.chartProxy}isActiveXYChart(){return s.ch.includes(["scatter","bubble"],this.getChartType())}isChartLinked(){return!this.model.unlinked}customComboExists(){const e=this.model.comboChartModel.savedCustomSeriesChartTypes;return e&&e.length>0}getSeriesChartTypes(){return this.model.comboChartModel.seriesChartTypes}isComboChart(e){return this.model.isComboChart(e)}updateSeriesChartType(t,i,s){const r=this.model.comboChartModel.seriesChartTypes.find((e=>e.colId===t));if(r){const t="customCombo"!==this.model.chartType;t&&(this.model.chartType="customCombo");const a=r.chartType;null!=i&&(r.chartType=i),null!=s&&(r.secondaryAxis=s),this.model.comboChartModel.savedCustomSeriesChartTypes=this.model.comboChartModel.seriesChartTypes,this.model.comboChartModel.updateSeriesChartTypes(),this.updateForDataChange(),t&&this.dispatchEvent({type:e.EVENT_CHART_TYPE_CHANGED}),a!==i&&this.dispatchEvent({type:e.EVENT_CHART_SERIES_CHART_TYPE_CHANGED}),this.raiseChartOptionsChangedEvent()}}getActiveSeriesChartTypes(){const e=this.getSelectedValueColState().map((e=>e.colId));return this.getSeriesChartTypes().filter((t=>e.includes(t.colId)))}getChartSeriesTypes(e){const t=e??this.getChartType();return this.isComboChart(t)?["line","bar","area"]:[dt(t)]}getCellRanges(){return[this.model.dimensionCellRange,this.model.valueCellRange].filter((e=>e))}createCellRange(e){var t;return e.cellRange&&(null==(t=this.rangeService)?void 0:t.createCellRangeFromCellRangeParams(e.cellRange))}validUpdateType(e){var t;if(!e.type)return console.warn("AG Grid - Unable to update chart as the 'type' is missing. It must be either 'rangeChartUpdate', 'pivotChartUpdate', or 'crossFilterChartUpdate'."),!1;const i={"Range Chart":()=>!this.isPivotChart()&&!this.isCrossFilterChart(),"Pivot Chart":()=>this.isPivotChart(),"Cross Filter Chart":()=>this.isCrossFilterChart()},s=null!=(t=Object.keys(i).find((e=>i[e]())))?t:"Range Chart",r=e.type===`${s[0].toLowerCase()}${s.slice(1).replace(/ /g,"")}Update`;return r||console.warn(`AG Grid - Unable to update chart as a '${e.type}' update type is not permitted on a ${s}.`),r}getCellRangeParams(){const e=this.getCellRanges(),t=e[0],i=t&&t.startRow||null,s=t&&t.endRow||null;return{rowStartIndex:i&&i.rowIndex,rowStartPinned:i&&i.rowPinned,rowEndIndex:s&&s.rowIndex,rowEndPinned:s&&s.rowPinned,columns:e.reduce(((e,t)=>e.concat(t.columns.map((e=>e.getId())))),[])}}raiseChartModelUpdateEvent(){const t={type:e.EVENT_CHART_MODEL_UPDATE};this.dispatchEvent(t)}raiseChartUpdatedEvent(){const t={type:e.EVENT_CHART_UPDATED};this.dispatchEvent(t)}raiseChartApiUpdateEvent(){const t={type:e.EVENT_CHART_API_UPDATE};this.dispatchEvent(t)}raiseChartOptionsChangedEvent(){const{chartId:e,chartType:t}=this.getChartModel(),i={type:s.aA.EVENT_CHART_OPTIONS_CHANGED,chartId:e,chartType:t,chartThemeName:this.getChartThemeName(),chartOptions:this.chartProxy.getChartThemeOverrides()};this.eventService.dispatchEvent(i)}raiseChartRangeSelectionChangedEvent(){const e={type:s.aA.EVENT_CHART_RANGE_SELECTION_CHANGED,id:this.model.chartId,chartId:this.model.chartId,cellRange:this.getCellRangeParams()};this.eventService.dispatchEvent(e)}destroy(){super.destroy(),this.rangeService&&this.rangeService.setCellRanges([])}};Vt.EVENT_CHART_UPDATED="chartUpdated",Vt.EVENT_CHART_API_UPDATE="chartApiUpdate",Vt.EVENT_CHART_MODEL_UPDATE="chartModelUpdate",Vt.EVENT_CHART_TYPE_CHANGED="chartTypeChanged",Vt.EVENT_CHART_SERIES_CHART_TYPE_CHANGED="chartSeriesChartTypeChanged",Vt.EVENT_CHART_LINKED_CHANGED="chartLinkedChanged",Ye([(0,s.A)("rangeService")],Vt.prototype,"rangeService",2),Ye([s.a],Vt.prototype,"init",1);var Bt=Vt,_t=class e extends s.ak{constructor(t){super(e.TEMPLATE),this.config=t??{};const{selectedValueList:i,valueFormatter:r,valueList:a}=this.config;this.selectedValues=i??[],this.valueList=a??[],this.valueFormatter=r??(e=>s.ch.escapeString(e))}init(){const{ariaLabel:e,onValuesChange:t,dragSourceId:i}=this.config;this.dropZonePanel=this.createManagedBean(new Wt({getValues:()=>this.selectedValues,setValues:e=>this.updateValues(e),isDraggable:()=>this.selectedValues.length>1},(e=>this.valueFormatter(e)),e,i)),this.getGui().appendChild(this.dropZonePanel.getGui()),this.initSelect(),null!=t&&(this.onValuesChange=t)}setValues(e,t){const{added:i,removed:s,updated:r}=this.getChanges(this.valueList,e);let a=!1;return(i.length||s.length||r.length)&&(a=!0),this.valueList=e,this.updateValues(t,a,!0),this}setValueFormatter(e){return this.valueFormatter=e,this}initSelect(){const e=this.createSelectOptions();if(!e.length)return!1;const{selectPlaceholder:t}=this.config;return this.eSelect=this.createBean(new s.K({options:e,placeholder:t,onValueChange:e=>this.addValue(e),pickerIcon:"chartsMenuAdd"})),this.getGui().appendChild(this.eSelect.getGui()),!0}createSelectOptions(){let e=[];const{maxSelection:t}=this.config;return t&&this.selectedValues.length>=t||this.valueList.forEach((t=>{this.selectedValues.includes(t)||e.push({value:t,text:this.valueFormatter(t)})})),e}addValue(e){this.dropZonePanel.addItem(e)}updateValues(e,t,i){var s,r,a,o,n;const l=this.selectedValues;this.selectedValues=e;const d=this.getChanges(l,e),h=t||d.added.length||d.removed.length,c=this.gridOptionsService.getDocument().activeElement,u=null==(s=this.eSelect)?void 0:s.getGui().contains(c),p=null==(r=this.dropZonePanel)?void 0:r.getGui().contains(c);i||null==(a=this.onValuesChange)||a.call(this,d);const g=!!h&&!this.refreshSelect();this.dropZonePanel.refreshGui(),h&&u&&(g?this.dropZonePanel.focusList(!0):null==(o=this.eSelect)||o.getFocusableElement().focus()),p&&!e.length&&(null==(n=this.eSelect)||n.getFocusableElement().focus())}getChanges(e,t){return{added:t.filter((t=>!e.includes(t))),removed:e.filter((e=>!t.includes(e))),updated:t.filter(((t,i)=>e[i]!==t)),selected:t}}refreshSelect(){if(!this.eSelect)return this.initSelect();const e=this.createSelectOptions();return e.length?(this.eSelect.clearOptions().addOptions(e).setValue(void 0,!0),!0):(s.ch.removeFromParent(this.eSelect.getGui()),this.eSelect=this.destroyBean(this.eSelect),!1)}destroy(){this.destroyBean(this.eSelect),super.destroy()}};_t.TEMPLATE='<div class="ag-pill-select" role="presentation"></div>',Ye([s.a],_t.prototype,"init",1);var Ut=_t,Ht=class extends s.bl{constructor(e,t,i,s,r,a){super(t,i,!1),this.value=e,this.valueFormatter=s,this.draggable=r,this.sourceId=a}getItem(){return this.value}getDisplayName(){return this.valueFormatter(this.value)}getAriaDisplayName(){return this.getDisplayName()}getTooltip(){}createGetDragItem(){return()=>({value:this.value})}getDragSourceType(){return s.ax.ChartPanel}getDragSourceId(){return this.sourceId}isDraggable(){return this.draggable}},Wt=class extends s.bm{constructor(e,t,i,s){super(!1),this.model=e,this.valueFormatter=t,this.ariaLabel=i,this.sourceId=s}postConstruct(){super.init()}isItemDroppable(e,t){return this.isSourceEventFromTarget(t)||null!=this.sourceId&&this.sourceId===t.dragSource.sourceId}updateItems(e){this.model.setValues(e)}getExistingItems(){return this.model.getValues()}getIconName(){return this.isPotentialDndItems()?s.av.ICON_MOVE:s.av.ICON_NOT_ALLOWED}getAriaLabel(){return this.ariaLabel}createPillComponent(e,t,i){return new Ht(e,t,i,this.valueFormatter,this.model.isDraggable(),this.sourceId)}getItems(e){return[e.value]}isInterestedIn(e){return e===s.ax.ChartPanel}};Ye([s.a],Wt.prototype,"postConstruct",1);var Kt=class extends s.ak{constructor(e,t,i,s,r){super(r),this.chartController=e,this.autoScrollService=t,this.allowMultipleSelection=i,this.maxSelection=s,this.columnComps=new Map}refreshColumnComps(e){return!!s.ch.areEqual(s.ch.keys(this.columnComps),e.map((e=>{let{colId:t}=e;return t})))&&(e.forEach((e=>{this.columnComps.get(e.colId).setValue(e.selected,!0)})),!0)}createGroup(e,t,i,r){if(this.allowMultipleSelection){const s=e.filter((e=>e.selected));this.valuePillSelect=this.groupComp.createManagedBean(new Ut({valueList:e,selectedValueList:s,valueFormatter:t,selectPlaceholder:this.chartTranslationService.translate(i),dragSourceId:r,onValuesChange:e=>this.onValueChange(e),maxSelection:this.maxSelection})),this.groupComp.addItem(this.valuePillSelect)}else{const t=this.createValueSelectParams(e);t.onValueChange=t=>{e.forEach((e=>{e.selected=!1})),t.selected=!0,t.colId===mt.DEFAULT_CATEGORY&&this.chartController.setAggFunc(void 0,!0),this.chartController.updateForPanelChange(t)},this.valueSelect=this.groupComp.createManagedBean(new s.K(t)),this.groupComp.addItem(this.valueSelect)}}refreshValueSelect(e){if(!this.valueSelect)return;const{options:t,value:i}=this.createValueSelectParams(e);this.valueSelect.clearOptions().addOptions(t).setValue(i,!0)}createValueSelectParams(e){let t;return{options:e.map((e=>{const i=s.ch.escapeString(e.displayName);return e.selected&&(t=e),{value:e,text:i}})),value:t}}onDragging(e){const t=this.checkHoveredItem(e);if(!t)return;this.lastDraggedColumn=e.dragItem.columns[0];const{comp:i,position:s}=t,{comp:r,position:a}=this.lastHoveredItem||{};i===r&&s===a||(this.autoScrollService.check(e.event),this.clearHoveredItems(),this.lastHoveredItem={comp:i,position:s},i.getGui().classList.add("ag-list-item-hovered",`ag-item-highlight-${s}`))}checkHoveredItem(e){if(s.ch.missing(e.vDirection))return null;const t=e.event;for(const i of this.columnComps.values()){const e=i.getGui();if(!e.querySelector(".ag-chart-data-column-drag-handle"))continue;const s=e.getBoundingClientRect();if(t.clientY>=s.top&&t.clientY<=s.bottom){const r=e.clientHeight;return{comp:i,position:t.clientY>s.top+r/2?"bottom":"top"}}}return null}onDragLeave(){this.clearHoveredItems()}onDragStop(){if(this.lastHoveredItem){const{dimensionCols:e,valueCols:t}=this.chartController.getColStateForMenu(),i=[...e,...t].find((e=>e.column===this.lastDraggedColumn));if(i){let e=Array.from(this.columnComps.values()).indexOf(this.lastHoveredItem.comp);"bottom"===this.lastHoveredItem.position&&e++,i.order=e,this.chartController.updateForPanelChange(i)}}this.clearHoveredItems(),this.lastDraggedColumn=void 0,this.autoScrollService.ensureCleared()}clearHoveredItems(){this.columnComps.forEach((e=>{e.getGui().classList.remove("ag-list-item-hovered","ag-item-highlight-top","ag-item-highlight-bottom")})),this.lastHoveredItem=void 0}addDragHandle(e,t){const i=s.ch.createIconNoSpan("columnDrag",this.gridOptionsService);i.classList.add("ag-drag-handle","ag-chart-data-column-drag-handle"),e.getGui().insertAdjacentElement("beforeend",i);const r={type:s.ax.ChartPanel,eElement:i,dragItemName:t.displayName,getDragItem:()=>({columns:[t.column]}),onDragStopped:()=>this.onDragStop()};this.dragAndDropService.addDragSource(r,!0),this.addDestroyFunc((()=>this.dragAndDropService.removeDragSource(r)))}addChangeListener(e,t){this.addManagedListener(e,s.aA.EVENT_FIELD_VALUE_CHANGED,(()=>{t.selected=e.getValue(),this.chartController.updateForPanelChange(t)}))}isInterestedIn(e){return e===s.ax.ChartPanel}onValueChange(e){let t,i,{added:s,updated:r,removed:a,selected:o}=e;const n=()=>{o.forEach(((e,t)=>{e.order=t})),i=!0};s.length?(t=s[0],t.selected=!0,n()):a.length?(t=a[0],t.selected=!1):r.length&&(n(),t=r[0]),t&&this.chartController.updateForPanelChange(t,i)}destroy(){this.valuePillSelect=void 0,this.valueSelect=void 0,super.destroy()}};Ye([(0,s.A)("dragAndDropService")],Kt.prototype,"dragAndDropService",2),Ye([(0,s.A)("chartTranslationService")],Kt.prototype,"chartTranslationService",2);var zt=class e extends Kt{constructor(t,i,s,r,a,o){super(t,i,r,void 0,e.TEMPLATE),this.title=s,this.dimensionCols=a,this.isOpen=o}init(){this.groupComp=this.createBean(new s.o({title:this.title,enabled:!0,suppressEnabledCheckbox:!0,suppressOpenCloseIcons:!1,cssIdentifier:"charts-data",expanded:this.isOpen})),this.chartMenuService.isLegacyFormat()?(this.createLegacyCategoriesGroup(this.dimensionCols),this.clearAggFuncControls()):(this.createCategoriesGroup(this.dimensionCols),this.createAggFuncControls(this.dimensionCols)),this.getGui().appendChild(this.groupComp.getGui())}refresh(e){var t;this.chartMenuService.isLegacyFormat()?this.refreshColumnComps(e)||this.recreate(e):(null==(t=this.valuePillSelect)||t.setValues(e,e.filter((e=>e.selected))),this.refreshValueSelect(e),this.refreshAggFuncControls(e,this.chartController.getAggFunc()))}recreate(e){this.isOpen=this.groupComp.isExpanded(),s.ch.clearElement(this.getGui()),this.destroyBean(this.groupComp),this.dimensionCols=e,this.init()}createCategoriesGroup(e){this.createGroup(e,(e=>s.ch.escapeString(null==e?void 0:e.displayName)),"categoryAdd","categorySelect")}createLegacyCategoriesGroup(e){const t=`chartDimension${this.groupComp.getCompId()}`,i=this.allowMultipleSelection;if(e.forEach((e=>{const r={label:s.ch.escapeString(e.displayName),value:e.selected,inputName:t},a=this.groupComp.createManagedBean(i?(()=>{const e=new s.m(r);return e.addCssClass("ag-data-select-checkbox"),e})():new s.H(r));this.addChangeListener(a,e),this.groupComp.addItem(a),this.columnComps.set(e.colId,a),i&&this.addDragHandle(a,e)})),i){const e=this.groupComp.getGui(),t={getIconName:()=>s.av.ICON_MOVE,getContainer:()=>e,onDragging:e=>this.onDragging(e),onDragLeave:()=>this.onDragLeave(),isInterestedIn:this.isInterestedIn.bind(this),targetContainsSource:!0};this.dragAndDropService.addDropTarget(t),this.addDestroyFunc((()=>this.dragAndDropService.removeDropTarget(t)))}}createAggFuncControls(e){const t=this.chartController.getAggFunc();this.groupComp.addItem(this.aggFuncToggle=this.createBean(new s.Q({label:this.chartTranslationService.translate("aggregate"),labelAlignment:"left",labelWidth:"flex",inputWidth:"flex",value:null!=t,onValueChange:e=>{var t,i;const s=e?"sum":void 0;this.chartController.setAggFunc(s),null==(t=this.aggFuncSelect)||t.setValue(s,!0),null==(i=this.aggFuncSelect)||i.setDisplayed(null!=s)}}))),this.groupComp.addItem(this.aggFuncSelect=this.createBean(new s.K({options:[{value:"sum",text:this.chartTranslationService.translate("sum")},{value:"first",text:this.chartTranslationService.translate("first")},{value:"last",text:this.chartTranslationService.translate("last")},{value:"min",text:this.chartTranslationService.translate("min")},{value:"max",text:this.chartTranslationService.translate("max")},{value:"count",text:this.chartTranslationService.translate("count")},{value:"avg",text:this.chartTranslationService.translate("avg")}],value:"string"==typeof t?t:void 0,onValueChange:e=>{this.chartController.setAggFunc(e)}}))),this.refreshAggFuncControls(e,t)}refreshAggFuncControls(e,t){var i,s,r,a;const o=e.filter((e=>e.selected)).some((e=>e.colId!==mt.DEFAULT_CATEGORY));null==(i=this.aggFuncToggle)||i.setValue(null!=t),null==(s=this.aggFuncSelect)||s.setValue("string"==typeof t?t:void 0,!0),null==(r=this.aggFuncToggle)||r.setDisplayed(o),null==(a=this.aggFuncSelect)||a.setDisplayed(o&&null!=t)}clearAggFuncControls(){this.aggFuncToggle=this.aggFuncToggle&&this.destroyBean(this.aggFuncToggle),this.aggFuncSelect=this.aggFuncSelect&&this.destroyBean(this.aggFuncSelect)}destroy(){this.clearAggFuncControls(),this.groupComp=this.destroyBean(this.groupComp),super.destroy()}};zt.TEMPLATE='<div id="categoriesGroup"></div>',Ye([(0,s.A)("chartMenuService")],zt.prototype,"chartMenuService",2),Ye([s.a],zt.prototype,"init",1);var $t=zt,jt=class e extends Kt{constructor(t,i,s,r,a,o,n,l){super(t,i,a,o,e.TEMPLATE),this.chartOptionsService=s,this.title=r,this.valueCols=n,this.isOpen=l}init(){if(this.groupComp=this.createBean(new s.o({title:this.title,enabled:!0,suppressEnabledCheckbox:!0,suppressOpenCloseIcons:!1,cssIdentifier:"charts-data",expanded:this.isOpen})),this.chartController.isActiveXYChart()){const e=this.groupComp.createManagedBean(new s.Q({label:this.chartTranslationService.translate("paired"),labelAlignment:"left",labelWidth:"flex",inputWidth:"flex",value:this.chartOptionsService.getPairedMode(),onValueChange:e=>{this.chartOptionsService.setPairedMode(!!e),this.chartController.updateForGridChange({maintainColState:!0})}}));this.groupComp.addItem(e)}this.chartMenuService.isLegacyFormat()?this.createLegacySeriesGroup(this.valueCols):this.createSeriesGroup(this.valueCols),this.getGui().appendChild(this.groupComp.getGui())}refresh(e){var t,i;if(this.chartMenuService.isLegacyFormat())if(this.refreshColumnComps(e)){if(this.chartController.isActiveXYChart()){const t=this.generateGetSeriesLabel(e);e.forEach((e=>{this.columnComps.get(e.colId).setLabel(t(e))}))}}else this.recreate(e);else null==(t=this.valuePillSelect)||t.setValueFormatter(this.generateGetSeriesLabel(e)),null==(i=this.valuePillSelect)||i.setValues(e,e.filter((e=>e.selected))),this.refreshValueSelect(e)}recreate(e){this.isOpen=this.groupComp.isExpanded(),s.ch.clearElement(this.getGui()),this.destroyBean(this.groupComp),this.valueCols=e,this.init()}createSeriesGroup(e){this.createGroup(e,this.generateGetSeriesLabel(e),"seriesAdd","seriesSelect")}createLegacySeriesGroup(e){const t=this.generateGetSeriesLabel(e);e.forEach((e=>{const i=t(e),r=this.groupComp.createManagedBean(new s.m({label:i,value:e.selected}));r.addCssClass("ag-data-select-checkbox"),this.addChangeListener(r,e),this.groupComp.addItem(r),this.columnComps.set(e.colId,r),this.addDragHandle(r,e)}));const i=this.groupComp.getGui(),r={getIconName:()=>s.av.ICON_MOVE,getContainer:()=>i,onDragging:e=>this.onDragging(e),onDragLeave:()=>this.onDragLeave(),isInterestedIn:this.isInterestedIn.bind(this),targetContainsSource:!0};this.dragAndDropService.addDropTarget(r),this.addDestroyFunc((()=>this.dragAndDropService.removeDropTarget(r)))}generateGetSeriesLabel(e){if(!this.chartController.isActiveXYChart())return e=>s.ch.escapeString(e.displayName);const t=e.filter((e=>e.selected)),i="bubble"===this.chartController.getChartType(),r=this.chartOptionsService.getPairedMode(),a=new Map;return a.set(0,"X"),a.set(1,"Y"),a.set(2,"size"),e=>{const o=s.ch.escapeString(e.displayName);if(!e.selected)return o;const n=t.indexOf(e);if(-1===n)return o;let l;return l=r?a.get(n%(i?3:2)):0===n?"X":i&&n%2===0?"size":"Y",`${o} (${l})`}}destroy(){this.groupComp=this.destroyBean(this.groupComp),super.destroy()}};jt.TEMPLATE='<div id="seriesGroup"></div>',Ye([(0,s.A)("chartMenuService")],jt.prototype,"chartMenuService",2),Ye([s.a],jt.prototype,"init",1);var Yt=jt,qt=class e extends s.ak{constructor(t,i,s){super(e.TEMPLATE),this.chartController=t,this.columns=i,this.isOpen=s,this.selectedColIds=[],this.chartTypeComps=new Map,this.secondaryAxisComps=new Map}init(){this.createSeriesChartTypeGroup(this.columns)}refresh(e){s.ch.areEqual(this.getValidColIds(e),this.selectedColIds)?this.refreshComps():this.recreate(e)}recreate(e){this.isOpen=this.seriesChartTypeGroupComp.isExpanded(),s.ch.clearElement(this.getGui()),this.destroyBean(this.seriesChartTypeGroupComp),this.columns=e,this.selectedColIds=[],this.clearComps(),this.init()}getValidColIds(e){const t=this.chartController.getSeriesChartTypes();return e.filter((e=>e.selected&&!!t.filter((t=>t.colId===e.colId))[0])).map((e=>{let{colId:t}=e;return t}))}createSeriesChartTypeGroup(e){this.seriesChartTypeGroupComp=this.createBean(new s.o({title:this.chartTranslationService.translate("seriesChartType"),enabled:!0,suppressEnabledCheckbox:!0,suppressOpenCloseIcons:!1,cssIdentifier:"charts-data",expanded:this.isOpen}));const t=this.chartController.getSeriesChartTypes();e.forEach((e=>{if(!e.selected)return;const i=t.filter((t=>t.colId===e.colId))[0];if(!i)return;this.selectedColIds.push(e.colId);const r=this.seriesChartTypeGroupComp.createManagedBean(new s.o({title:e.displayName,enabled:!0,suppressEnabledCheckbox:!0,suppressOpenCloseIcons:!0,cssIdentifier:"charts-format-sub-level"})),a=this.seriesChartTypeGroupComp.createManagedBean(new s.m({label:this.chartTranslationService.translate("secondaryAxis"),labelWidth:"flex",disabled:(o=i.chartType,["groupedColumn","stackedColumn","stackedArea"].includes(o)),value:!!i.secondaryAxis,onValueChange:t=>this.chartController.updateSeriesChartType(e.colId,void 0,t)}));var o;r.addItem(a);const n=e=>this.chartTranslationService.translate(e),l=[{value:"line",text:n("line")},{value:"area",text:n("area")},{value:"stackedArea",text:n("stackedArea")},{value:"groupedColumn",text:n("groupedColumn")},{value:"stackedColumn",text:n("stackedColumn")}],d=r.createManagedBean(new s.K({labelAlignment:"left",labelWidth:"flex",options:l,value:i.chartType,onValueChange:t=>this.chartController.updateSeriesChartType(e.colId,t)}));r.addItem(d),this.seriesChartTypeGroupComp.addItem(r),this.chartTypeComps.set(e.colId,d),this.secondaryAxisComps.set(e.colId,a)})),this.getGui().appendChild(this.seriesChartTypeGroupComp.getGui())}refreshComps(){const e=this.chartController.getSeriesChartTypes();this.selectedColIds.forEach((t=>{const i=e.find((e=>e.colId===t));if(!i)return;const s=this.chartTypeComps.get(t),r=this.secondaryAxisComps.get(t);null==s||s.setValue(i.chartType),null==r||r.setValue(!!i.secondaryAxis),null==r||r.setDisabled(this.isSecondaryAxisDisabled(i.chartType))}))}clearComps(){this.chartTypeComps.clear(),this.secondaryAxisComps.clear()}isSecondaryAxisDisabled(e){return["groupedColumn","stackedColumn","stackedArea"].includes(e)}destroy(){this.clearComps(),this.seriesChartTypeGroupComp=this.destroyBean(this.seriesChartTypeGroupComp),super.destroy()}};qt.TEMPLATE='<div id="seriesChartTypeGroup"></div>',Ye([(0,s.A)("chartTranslationService")],qt.prototype,"chartTranslationService",2),Ye([s.a],qt.prototype,"init",1);var Xt=qt,Zt=class e extends s.ak{constructor(e,t){super(),this.getValue=e,this.setValue=t}init(){this.switchCategorySeriesToggleButton=this.createManagedBean(new s.Q({label:this.chartTranslationService.translate("switchCategorySeries"),labelAlignment:"left",labelWidth:"flex",inputWidth:"flex",value:this.getValue(),onValueChange:e=>{this.setValue(e)}}));const t={title:void 0,suppressEnabledCheckbox:!0,suppressOpenCloseIcons:!0,cssIdentifier:"charts-data",expanded:!0,items:[this.switchCategorySeriesToggleButton]};this.setTemplate(e.TEMPLATE,{switchCategorySeriesGroup:t})}refresh(){var e;null==(e=this.switchCategorySeriesToggleButton)||e.setValue(this.getValue(),!0)}};Zt.TEMPLATE='<div>\n        <ag-group-component ref="switchCategorySeriesGroup"></ag-group-component>\n    </div>',Ye([(0,s.A)("chartTranslationService")],Zt.prototype,"chartTranslationService",2),Ye([s.a],Zt.prototype,"init",1);var Jt=Zt,Qt={groups:[{type:"categories",isOpen:!0},{type:"series",isOpen:!0},{type:"seriesChartType",isOpen:!0}]},ei=class e extends s.ak{constructor(t,i){super(e.TEMPLATE),this.chartController=t,this.chartOptionsService=i,this.isSwitchCategorySeriesToggled=!1}init(){this.switchCategorySeriesPanel=this.addComponent(this.createManagedBean(new Jt((()=>this.chartController.isCategorySeriesSwitched()),(e=>this.chartController.switchCategorySeries(e))))),this.isSwitchCategorySeriesToggled=this.chartController.isCategorySeriesSwitched(),this.createAutoScrollService(),this.updatePanels(),this.addManagedListener(this.chartController,Bt.EVENT_CHART_MODEL_UPDATE,this.updatePanels.bind(this)),this.addManagedListener(this.chartController,Bt.EVENT_CHART_API_UPDATE,this.updatePanels.bind(this))}destroy(){this.clearPanelComponents(),super.destroy()}updatePanels(){var e,t,i,s,r;const a=this.chartType,o=this.isSwitchCategorySeriesToggled,{dimensionCols:n,valueCols:l}=this.chartController.getColStateForMenu();this.chartType=this.chartController.getChartType();const d=this.chartType!==a;this.isSwitchCategorySeriesToggled=this.chartController.isCategorySeriesSwitched();const h=this.isSwitchCategorySeriesToggled!==o;this.canRefresh(a,this.chartType)&&!h?(null==(e=this.categoriesDataPanel)||e.refresh(n),null==(t=this.seriesDataPanel)||t.refresh(l),null==(i=this.seriesChartTypePanel)||i.refresh(l)):this.recreatePanels(n,l),d&&(null==(s=this.switchCategorySeriesPanel)||s.setDisplayed(pt(this.chartType)&&!this.chartMenuService.isLegacyFormat())),h&&(null==(r=this.switchCategorySeriesPanel)||r.refresh())}canRefresh(e,t){if(void 0===e)return!1;if(e===t)return!0;const i=e=>["columnLineCombo","areaColumnCombo","customCombo"].includes(e);return!(!i(e)||!i(t))}recreatePanels(e,t){var i;this.clearPanelComponents();const{chartType:r}=this;if(!r)return;const a=this.chartController.isCategorySeriesSwitched(),o=null==(i=this.getDataPanelDef().groups)?void 0:i.map((i=>{let{type:o,isOpen:n}=i;return o===(a?"series":"categories")?this.categoriesDataPanel=this.createBean(new $t(this.chartController,this.autoScrollService,this.getCategoryGroupTitle(a),this.getCategoryGroupMultipleSelect(r,a),e,n)):o===(a?"categories":"series")?this.seriesDataPanel=this.createBean(new Yt(this.chartController,this.autoScrollService,this.chartOptionsService,this.getSeriesGroupTitle(a),this.getSeriesGroupMultipleSelect(r,a),this.getSeriesGroupMaxSelection(r,a),t,n)):"seriesChartType"===o?this.chartController.isComboChart()?this.seriesChartTypePanel=this.createBean(new Xt(this.chartController,t,n)):null:(s.ch.warnOnce(`Invalid charts data panel group name supplied: '${o}'`),null)})).filter((e=>null!=e));o&&this.addPanelComponents(o)}addPanelComponents(e){var t;const i=document.createDocumentFragment();for(const r of e)this.registerComponent(r),i.appendChild(r.getGui());const s=null==(t=this.switchCategorySeriesPanel)?void 0:t.getGui();return this.getGui().insertBefore(i,s??null),e}clearPanelComponents(){const e=this.getGui();this.categoriesDataPanel&&e.removeChild(this.categoriesDataPanel.getGui()),this.seriesDataPanel&&e.removeChild(this.seriesDataPanel.getGui()),this.seriesChartTypePanel&&e.removeChild(this.seriesChartTypePanel.getGui()),this.categoriesDataPanel=this.destroyBean(this.categoriesDataPanel),this.seriesDataPanel=this.destroyBean(this.seriesDataPanel),this.seriesChartTypePanel=this.destroyBean(this.seriesChartTypePanel)}createAutoScrollService(){const e=this.getGui();this.autoScrollService=new s.W({scrollContainer:e,scrollAxis:"y",getVerticalPosition:()=>e.scrollTop,setVerticalPosition:t=>e.scrollTop=t})}addComponent(e){return this.registerComponent(e),this.getGui().appendChild(e.getGui()),e}registerComponent(e){e.addCssClass("ag-chart-data-section")}getDataPanelDef(){var e,t;return null!=(t=null==(e=this.gridOptionsService.get("chartToolPanelsDef"))?void 0:e.dataPanel)?t:Qt}getCategoryGroupTitle(e){return e?this.chartTranslationService.translate("seriesLabels"):this.chartTranslationService.translate(this.chartController.isActiveXYChart()?"labels":"categories")}getCategoryGroupMultipleSelect(e,t){return!t&&1!==ct(e)}getSeriesGroupTitle(e){return e?this.chartTranslationService.translate("categoryValues"):this.chartTranslationService.translate(this.chartController.isActiveXYChart()?"xyValues":"series")}getSeriesGroupMultipleSelect(e,t){return 1!==this.getSeriesGroupMaxSelection(e,t)}getSeriesGroupMaxSelection(e,t){if(!t)return ut(e)}};ei.TEMPLATE='<div class="ag-chart-data-wrapper ag-scrollable-container"></div>',Ye([(0,s.A)("chartTranslationService")],ei.prototype,"chartTranslationService",2),Ye([(0,s.A)("chartMenuService")],ei.prototype,"chartMenuService",2),Ye([s.a],ei.prototype,"init",1);var ti=ei,ii=class e extends s.ak{constructor(e){super(),this.activeComps=[],this.params=e,this.chartOptions=e.chartMenuUtils.getChartOptions()}init(){const t={cssIdentifier:"charts-format-sub-level",direction:"vertical",suppressOpenCloseIcons:!0,title:this.params.name||this.chartTranslationService.translate("font"),enabled:this.params.enabled,suppressEnabledCheckbox:!!this.params.suppressEnabledCheckbox,onEnableChange:e=>{this.params.onEnableChange&&this.params.onEnableChange(e)}};this.setTemplate(e.TEMPLATE,{fontGroup:t,familySelect:this.getFamilySelectParams(),weightStyleSelect:this.getWeightStyleSelectParams(),sizeSelect:this.getSizeSelectParams(),colorPicker:this.params.chartMenuUtils.getDefaultColorPickerParams(this.params.keyMapper("color"))})}addCompToPanel(e){this.fontGroup.addItem(e),this.activeComps.push(e)}setEnabled(e){this.fontGroup.setEnabled(e)}getFamilySelectParams(){const e=["Arial, sans-serif","Aria Black, sans-serif","Book Antiqua,  serif","Charcoal, sans-serif","Comic Sans MS, cursive","Courier, monospace","Courier New, monospace","Gadget, sans-serif","Geneva, sans-serif","Helvetica, sans-serif","Impact, sans-serif","Lucida Console, monospace","Lucida Grande, sans-serif","Lucida Sans Unicode,  sans-serif","Monaco, monospace","Palatino Linotype, serif","Palatino, serif","Times New Roman, serif","Times, serif","Verdana, sans-serif"],t=this.getInitialFontValue("fontFamily");let i=e[0];if(t){const r=e.map((e=>e.toLowerCase())).indexOf(t.toLowerCase());if(r>=0)i=e[r];else{const r=s.ch.capitalise(t);e.push(r),i=r}}return{options:e.sort().map((e=>({value:e,text:e}))),inputWidth:"flex",value:`${i}`,onValueChange:e=>this.setFont({fontFamily:e})}}getSizeSelectParams(){const e=[8,10,12,14,16,18,20,22,24,26,28,30,32,34,36],t=this.getInitialFontValue("fontSize");return s.ch.includes(e,t)||e.push(t),{options:e.sort(((e,t)=>e-t)).map((e=>({value:`${e}`,text:`${e}`}))),inputWidth:"flex",value:`${t}`,onValueChange:e=>this.setFont({fontSize:parseInt(e,10)}),label:this.chartTranslationService.translate("size")}}getWeightStyleSelectParams(){var e,t;const i=null!=(e=this.getInitialFontValue("fontWeight"))?e:"normal",s=null!=(t=this.getInitialFontValue("fontStyle"))?t:"normal",r=[{name:"normal",weight:"normal",style:"normal"},{name:"bold",weight:"bold",style:"normal"},{name:"italic",weight:"normal",style:"italic"},{name:"boldItalic",weight:"bold",style:"italic"}];let a=r.find((e=>e.weight===i&&e.style===s));return a||(a={name:"predefined",weight:i,style:s},r.unshift(a)),{options:r.map((e=>({value:e.name,text:this.chartTranslationService.translate(e.name)}))),inputWidth:"flex",value:a.name,onValueChange:e=>{const t=r.find((t=>t.name===e));this.setFont({fontWeight:t.weight,fontStyle:t.style})}}}addItemToPanel(e){this.fontGroup.addItem(e),this.activeComps.push(e)}destroyActiveComps(){this.activeComps.forEach((e=>{s.ch.removeFromParent(e.getGui()),this.destroyBean(e)}))}destroy(){this.destroyActiveComps(),super.destroy()}setFont(e){const{keyMapper:t}=this.params;Object.entries(e).forEach((e=>{let[i,s]=e;s&&this.chartOptions.setValue(t(i),s)}))}getInitialFontValue(e){const{keyMapper:t}=this.params;return this.chartOptions.getValue(t(e))}};ii.TEMPLATE='<div class="ag-font-panel">\n            <ag-group-component ref="fontGroup">\n                <ag-select ref="familySelect"></ag-select>\n                <ag-select ref="weightStyleSelect"></ag-select>\n                <div class="ag-charts-font-size-color">\n                    <ag-select ref="sizeSelect"></ag-select>\n                    <ag-color-picker ref="colorPicker"></ag-color-picker>\n                </div>\n            </ag-group-component>\n        </div>',Ye([(0,s.R)("fontGroup")],ii.prototype,"fontGroup",2),Ye([(0,s.A)("chartTranslationService")],ii.prototype,"chartTranslationService",2),Ye([s.a],ii.prototype,"init",1);var si=ii,ri=class e extends s.ak{constructor(e){let{chartMenuParamsFactory:t,isExpandedOnInit:i=!1}=e;super(),this.chartMenuUtils=t,this.isExpandedOnInit=i}init(){const t=this.chartMenuUtils.addEnableParams("legend.enabled",{cssIdentifier:"charts-format-top-level",direction:"vertical",title:this.chartTranslationService.translate("legend"),suppressEnabledCheckbox:!1,suppressToggleExpandOnEnableChange:!0,expanded:this.isExpandedOnInit,items:[this.createLabelPanel()]});this.setTemplate(e.TEMPLATE,{legendGroup:t,legendPositionSelect:this.chartMenuUtils.getDefaultLegendParams("legend.position"),legendPaddingSlider:this.getSliderParams("spacing","spacing",200),markerSizeSlider:this.getSliderParams("item.marker.size","markerSize",40),markerStrokeSlider:this.getSliderParams("item.marker.strokeWidth","markerStroke",10),markerPaddingSlider:this.getSliderParams("item.marker.padding","itemSpacing",20),itemPaddingXSlider:this.getSliderParams("item.paddingX","layoutHorizontalSpacing",50),itemPaddingYSlider:this.getSliderParams("item.paddingY","layoutVerticalSpacing",50)})}getSliderParams(e,t,i){return this.chartMenuUtils.getDefaultSliderParams(`legend.${e}`,t,i)}createLabelPanel(){const e={enabled:!0,suppressEnabledCheckbox:!0,chartMenuUtils:this.chartMenuUtils,keyMapper:e=>`legend.item.label.${e}`};return this.createManagedBean(new si(e))}};ri.TEMPLATE='<div>\n            <ag-group-component ref="legendGroup">\n                <ag-select ref="legendPositionSelect"></ag-select>\n                <ag-slider ref="legendPaddingSlider"></ag-slider>\n                <ag-slider ref="markerSizeSlider"></ag-slider>\n                <ag-slider ref="markerStrokeSlider"></ag-slider>\n                <ag-slider ref="markerPaddingSlider"></ag-slider>\n                <ag-slider ref="itemPaddingXSlider"></ag-slider>\n                <ag-slider ref="itemPaddingYSlider"></ag-slider>\n            </ag-group-component>\n        </div>',Ye([(0,s.A)("chartTranslationService")],ri.prototype,"chartTranslationService",2),Ye([s.a],ri.prototype,"init",1);var ai=ri,oi=class e extends s.ak{constructor(e){super(),this.chartMenuUtils=e}init(){const t=this.chartMenuUtils.addEnableParams("tick.enabled",{cssIdentifier:"charts-format-sub-level",direction:"vertical",suppressOpenCloseIcons:!0,title:this.chartTranslationService.translate("ticks"),suppressEnabledCheckbox:!1}),i=this.chartMenuUtils.getDefaultColorPickerParams("tick.color"),s=this.chartMenuUtils.getDefaultSliderParams("tick.width","width",10),r=this.chartMenuUtils.getDefaultSliderParams("tick.size","length",30);this.setTemplate(e.TEMPLATE,{axisTicksGroup:t,axisTicksColorPicker:i,axisTicksWidthSlider:s,axisTicksSizeSlider:r})}};oi.TEMPLATE='<div>\n            <ag-group-component ref="axisTicksGroup">\n                <ag-color-picker ref="axisTicksColorPicker"></ag-color-picker>\n                <ag-slider ref="axisTicksWidthSlider"></ag-slider>\n                <ag-slider ref="axisTicksSizeSlider"></ag-slider>\n            </ag-group-component>\n        </div>',Ye([(0,s.A)("chartTranslationService")],oi.prototype,"chartTranslationService",2),Ye([s.a],oi.prototype,"init",1);var ni=oi,li=class e extends s.ak{constructor(e){super(),this.chartMenuUtils=e,this.chartOptions=e.getChartOptions()}init(){const t=this.chartMenuUtils.addEnableParams("gridLine.enabled",{cssIdentifier:"charts-format-sub-level",direction:"vertical",suppressOpenCloseIcons:!0,title:this.chartTranslationService.translate("gridLines"),suppressEnabledCheckbox:!1}),i=this.getGridLineColorPickerParams("color"),s=this.getGridLineWidthSliderParams("thickness"),r=this.getGridLineDashSliderParams("lineDash");this.setTemplate(e.TEMPLATE,{gridLineGroup:t,gridLineColorPicker:i,gridLineWidthSlider:s,gridLineLineDashSlider:r})}getGridLineColorPickerParams(e){return this.chartMenuUtils.getDefaultColorPickerParams("gridLine.style",e,{formatInputValue:e=>{var t;return null==(t=null==e?void 0:e[0])?void 0:t.stroke},parseInputValue:e=>{var t;const i=null!=(t=this.chartOptions.getValue("gridLine.style"))?t:[];return 0===i.length?[{stroke:e,lineDash:[]}]:[$e(ze({},i[0]),{stroke:e})]}})}getGridLineWidthSliderParams(e){return this.chartMenuUtils.getDefaultSliderParams("gridLine.width",e,10)}getGridLineDashSliderParams(e){var t,i;const s=this.chartOptions.getValue("gridLine.style"),r=null==(i=null==(t=null==s?void 0:s[0])?void 0:t.lineDash)?void 0:i[0],a=this.chartMenuUtils.getDefaultSliderParamsWithoutValueParams(r??0,e,30);return a.onValueChange=e=>{const t=this.chartOptions.getValue("gridLine.style.0.stroke");this.chartOptions.setValue("gridLine.style",[{lineDash:[e],stroke:t}])},a}};li.TEMPLATE='<div>\n            <ag-group-component ref="gridLineGroup">\n                <ag-color-picker ref="gridLineColorPicker"></ag-color-picker>\n                <ag-slider ref="gridLineWidthSlider"></ag-slider>\n                <ag-slider ref="gridLineLineDashSlider"></ag-slider>\n            </ag-group-component>\n        </div>',Ye([(0,s.A)("chartTranslationService")],li.prototype,"chartTranslationService",2),Ye([s.a],li.prototype,"init",1);var di=li,hi=class e extends s.k{constructor(t){super(t,e.TEMPLATE),this.radius=0,this.offsetX=0,this.offsetY=0}postConstruct(){super.postConstruct();const{value:e,onValueChange:t}=this.config;null!=e&&this.setValue(e,void 0,!0),null!=t&&this.onValueChange(t),this.dragListener={eElement:this.eParentCircle,dragStartPixels:0,onDragStart:e=>{this.parentCircleRect=this.eParentCircle.getBoundingClientRect()},onDragging:e=>this.calculateAngleDrag(e),onDragStop:()=>{}},this.dragService.addDragSource(this.dragListener),this.eAngleValue.setLabel("").setLabelWidth(5).setInputWidth(45).setMin(0).setMax(360).setValue(`${this.degrees}`).onValueChange((e=>{(null==e||""===e)&&(e="0"),e=this.eAngleValue.normalizeValue(e);let t=parseFloat(e);t>180&&(t-=360),this.setValue(t)})),this.updateNumberInput(),s.ch.exists(this.getValue())&&this.eAngleValue.setValue(this.normalizeNegativeValue(this.getValue()).toString()),this.addManagedListener(this,s.aA.EVENT_FIELD_VALUE_CHANGED,(()=>{const e=this.gridOptionsService.getDocument();this.eAngleValue.getInputElement().contains(e.activeElement)||this.updateNumberInput()}))}updateNumberInput(){const e=this.normalizeNegativeValue(this.getValue());this.eAngleValue.setValue(e.toString())}positionChildCircle(e){const t=this.parentCircleRect||{width:24,height:24},i=this.eChildCircle,s=t.width/2,r=t.height/2;i.style.left=`${s+8*Math.cos(e)}px`,i.style.top=`${r+8*Math.sin(e)}px`}calculatePolar(){const e=this.offsetX,t=this.offsetY,i=Math.atan2(t,e);this.degrees=this.toDegrees(i),this.radius=Math.sqrt(e*e+t*t),this.positionChildCircle(i)}calculateCartesian(){const e=this.toRadians(this.getValue()),t=this.getRadius();this.setOffsetX(Math.cos(e)*t).setOffsetY(Math.sin(e)*t)}setOffsetX(e){return this.offsetX!==e&&(this.offsetX=e,this.calculatePolar()),this}setOffsetY(e){return this.offsetY!==e&&(this.offsetY=e,this.calculatePolar()),this}calculateAngleDrag(e){const t=this.parentCircleRect,i=t.width/2,s=t.height/2,r=e.clientX-t.left-i,a=e.clientY-t.top-s,o=Math.atan2(a,r);this.setValue(o,!0)}toDegrees(e){return e/Math.PI*180}toRadians(e){return e/180*Math.PI}normalizeNegativeValue(e){return e<0?360+e:e}normalizeAngle180(e){return(e%=2*Math.PI)<-Math.PI?e+=2*Math.PI:e>=Math.PI&&(e-=2*Math.PI),e}getRadius(){return this.radius}setRadius(e){return this.radius===e||(this.radius=e,this.calculateCartesian()),this}onValueChange(e){return this.addManagedListener(this,s.aA.EVENT_FIELD_VALUE_CHANGED,(()=>{e(this.degrees)})),this}getValue(e){return e?this.toRadians(this.degrees):this.degrees}setValue(e,t,i){let r;return r=t?e:this.normalizeAngle180(this.toRadians(e)),e=this.toDegrees(r),this.degrees!==e&&(this.degrees=Math.floor(e),this.calculateCartesian(),this.positionChildCircle(r),i||this.dispatchEvent({type:s.aA.EVENT_FIELD_VALUE_CHANGED})),this}setWidth(e){return s.ch.setFixedWidth(this.getGui(),e),this}setDisabled(e){return super.setDisabled(e),this.eAngleValue.setDisabled(e),this}destroy(){this.dragService.removeDragSource(this.dragListener),super.destroy()}};hi.TEMPLATE='<div class="ag-angle-select">\n            <div ref="eLabel"></div>\n            <div class="ag-wrapper ag-angle-select-wrapper">\n                <div ref="eAngleSelectField" class="ag-angle-select-field">\n                    <div ref="eParentCircle" class="ag-angle-select-parent-circle">\n                        <div ref="eChildCircle" class="ag-angle-select-child-circle"></div>\n                    </div>\n                </div>\n                <ag-input-number-field ref="eAngleValue"></ag-input-number-field>\n            </div>\n        </div>',Ye([(0,s.R)("eLabel")],hi.prototype,"eLabel",2),Ye([(0,s.R)("eParentCircle")],hi.prototype,"eParentCircle",2),Ye([(0,s.R)("eChildCircle")],hi.prototype,"eChildCircle",2),Ye([(0,s.R)("eAngleValue")],hi.prototype,"eAngleValue",2),Ye([(0,s.A)("dragService")],hi.prototype,"dragService",2);var ci=hi,ui=class extends s.B{constructor(e){super(),this.chartOptionsProxy=e}getDefaultColorPickerParams(e,t,i){return this.addValueParams(e,{label:this.chartTranslationService.translate(t??"color"),labelWidth:"flex",inputWidth:"flex"},i)}getDefaultNumberInputParams(e,t,i){return this.addValueParams(e,{label:this.chartTranslationService.translate(t),labelWidth:"flex",inputWidth:"flex",precision:null==i?void 0:i.precision,step:null==i?void 0:i.step,min:null==i?void 0:i.min,max:null==i?void 0:i.max},{parseInputValue:e=>{const t=Number(e);return isNaN(t)?void 0:t},formatInputValue:e=>null==e?"":`${e}`})}getDefaultSliderParams(e,t,i,s){var r;let a=null!=(r=this.chartOptionsProxy.getValue(e))?r:0;s&&Array.isArray(a)&&(a=a[0]);const o=this.getDefaultSliderParamsWithoutValueParams(a,t,i);return o.onValueChange=t=>this.chartOptionsProxy.setValue(e,s?[t]:t),o}getDefaultSliderParamsWithoutValueParams(e,t,i){return{label:this.chartTranslationService.translate(t),minValue:0,maxValue:Math.max(e,i),textFieldWidth:45,value:`${e}`}}getDefaultCheckboxParams(e,t,i){const s=this.chartOptionsProxy.getValue(e),r={label:this.chartTranslationService.translate(t),value:s,readOnly:null==i?void 0:i.readOnly,passive:null==i?void 0:i.passive};return r.onValueChange=t=>{this.chartOptionsProxy.setValue(e,"boolean"==typeof t?t:void 0)},r}getDefaultSelectParams(e,t,i,s){const r=this.chartOptionsProxy.getValue(e),a={label:this.chartTranslationService.translate(t),value:r,options:i,pickerType:null==s?void 0:s.pickerType,pickerAriaLabelKey:null==s?void 0:s.pickerAriaLabelKey,pickerAriaLabelValue:null==s?void 0:s.pickerAriaLabelValue};return a.onValueChange=t=>{this.chartOptionsProxy.setValue(e,t)},a}getDefaultLegendParams(e){return this.addValueParams(e,{label:this.chartTranslationService.translate("position"),labelWidth:"flex",inputWidth:"flex",options:["top","right","bottom","left"].map((e=>({value:e,text:this.chartTranslationService.translate(e)})))})}getDefaultFontPanelParams(e,t){const i=t=>`${e}.${t}`;return this.addEnableParams(i("enabled"),{name:this.chartTranslationService.translate(t),suppressEnabledCheckbox:!1,chartMenuUtils:this,keyMapper:i})}addValueParams(e,t,i){const s=this.chartOptionsProxy.getValue(e);return t.value=null!=i&&i.formatInputValue?i.formatInputValue(s):s,t.onValueChange=t=>{const s=null!=i&&i.parseInputValue?i.parseInputValue(t):t;this.chartOptionsProxy.setValue(e,s)},t}addEnableParams(e,t){var i;return t.enabled=null!=(i=this.chartOptionsProxy.getValue(e))&&i,t.onEnableChange=t=>this.chartOptionsProxy.setValue(e,t),t}getChartOptions(){return this.chartOptionsProxy}};Ye([(0,s.A)("chartTranslationService")],ui.prototype,"chartTranslationService",2);var pi=class e extends s.ak{constructor(e,t){let{chartController:i,chartOptionsService:s,isExpandedOnInit:r=!1}=t;super(),this.activePanels=[],this.axisLabelUpdateFuncs=[],this.axisType=e,this.chartController=i,this.chartAxisOptionsProxy=s.getCartesianAxisOptionsProxy(e),this.chartAxisThemeOverridesProxy=s.getCartesianAxisThemeOverridesProxy(e),this.chartAxisAppliedThemeOverridesProxy=s.getCartesianAxisAppliedThemeOverridesProxy(e),this.isExpandedOnInit=r}init(){const t=this.axisType,i={cssIdentifier:"charts-format-top-level",direction:"vertical",title:this.translate(t),expanded:this.isExpandedOnInit,suppressEnabledCheckbox:!0},r=this.createManagedBean(new ui(this.chartAxisOptionsProxy)),a=this.createManagedBean(new ui(this.chartAxisThemeOverridesProxy)),o=this.getAxisTypeSelectParams(r,this.chartAxisAppliedThemeOverridesProxy),n=this.getAxisPositionSelectParams(r),l=this.getAxisTimeFormatSelectParams(r),d=this.getAxisColorInputParams(a),h=this.getAxisLineWidthSliderParams(a);if(this.setTemplate(e.TEMPLATE,{axisGroup:i,axisTypeSelect:o??void 0,axisPositionSelect:n??void 0,axisTimeFormatSelect:l??void 0,axisColorInput:d,axisLineWidthSlider:h}),o||this.removeTemplateComponent(this.axisTypeSelect),n||this.removeTemplateComponent(this.axisPositionSelect),l){const e=()=>{const e="time"===this.chartAxisOptionsProxy.getValue("type");s.ch.setDisplayed(this.axisTimeFormatSelect.getGui(),e)};e(),this.addManagedListener(this.eventService,s.aA.EVENT_CHART_OPTIONS_CHANGED,(t=>{e()}))}else this.removeTemplateComponent(this.axisTimeFormatSelect);this.initGridLines(a),this.initAxisTicks(a),this.initAxisLabels(a);this.addManagedListener(this.chartController,Bt.EVENT_CHART_UPDATED,(()=>this.axisLabelUpdateFuncs.forEach((e=>e()))))}getAxisTypeSelectParams(e,t){const i=e.getChartOptions(),s=((e,t)=>{if(!ot(e))return null;if("heatmap"===e)return null;switch(t){case"xAxis":return[{value:"category",text:this.translate("category")},{value:"number",text:this.translate("number")},{value:"time",text:this.translate("time")}];case"yAxis":return null}})(this.chartController.getChartType(),this.axisType);if(!s)return null;const r=e.getDefaultSelectParams("type","axisType",s);return r.onValueChange=e=>{var s;const r=i.getValue("type");if(e===r)return;const a=t.getValue("*"),o=mi(r),n=mi(e),l=o!==n?n?"%d %B %Y":void 0:null;if(null===l)i.setValue("type",e);else{const t=null!=(s=i.getValue("label"))?s:{};i.setValues([{expression:"type",value:e},{expression:"label",value:$e(ze({},t),{format:l})}]),this.axisTimeFormatSelect.setValue(l,!0)}t.setValue("*",a)},r}getAxisPositionSelectParams(e){const t=((e,t)=>{if(!ot(e))return null;if("heatmap"===e)return null;switch(t){case"xAxis":return[{value:"top",text:this.translate("top")},{value:"bottom",text:this.translate("bottom")}];case"yAxis":return[{value:"left",text:this.translate("left")},{value:"right",text:this.translate("right")}]}})(this.chartController.getChartType(),this.axisType);return t?e.getDefaultSelectParams("position","position",t):null}getAxisTimeFormatSelectParams(e){const t=((e,t)=>{if(!ot(e))return null;switch(t){case"xAxis":return[{value:"%d/%m/%Y",text:this.translate("timeFormatSlashesDDMMYYYY")},{value:"%m/%d/%Y",text:this.translate("timeFormatSlashesMMDDYYYY")},{value:"%d/%m/%y",text:this.translate("timeFormatSlashesDDMMYY")},{value:"%m/%d/%y",text:this.translate("timeFormatSlashesMMDDYY")},{value:"%d.%e.%y",text:this.translate("timeFormatDotsDDMYY")},{value:"%e.%d.%y",text:this.translate("timeFormatDotsMDDYY")},{value:"%Y-%m-%d",text:this.translate("timeFormatDashesYYYYMMDD")},{value:"%d %B %Y",text:this.translate("timeFormatSpacesDDMMMMYYYY")},{value:"%H:%M:%S",text:this.translate("timeFormatHHMMSS")},{value:"%I:%M:%S %p",text:this.translate("timeFormatHHMMSSAmPm")}];case"yAxis":return null}})(this.chartController.getChartType(),this.axisType);return t?e.getDefaultSelectParams("label.format","timeFormat",t):null}getAxisColorInputParams(e){return e.getDefaultColorPickerParams("line.color")}getAxisLineWidthSliderParams(e){var t;const i=e.getChartOptions(),s=e.getDefaultSliderParamsWithoutValueParams(null!=(t=i.getValue("line.enabled")?i.getValue("line.width"):null)?t:0,"thickness",10);return s.onValueChange=e=>{(e=>{i.setValues([{expression:"line.enabled",value:null!=e},{expression:"line.width",value:e??0}])})(0===e?null:e)},s}initGridLines(e){if("heatmap"!==this.chartController.getChartType()){const t=this.createBean(new di(e));this.axisGroup.addItem(t),this.activePanels.push(t)}}initAxisTicks(e){if(!this.hasConfigurableAxisTicks())return;const t=this.createBean(new ni(e));this.axisGroup.addItem(t),this.activePanels.push(t)}hasConfigurableAxisTicks(){switch(this.chartController.getChartType()){case"radarLine":case"radarArea":case"rangeBar":case"boxPlot":case"waterfall":return!1;default:return!0}}initAxisLabels(e){const t={name:this.translate("labels"),enabled:!0,suppressEnabledCheckbox:!0,chartMenuUtils:e,keyMapper:e=>`label.${e}`},i=this.createBean(new si(t));this.axisGroup.addItem(i),this.activePanels.push(i),this.addAdditionalLabelComps(i,e)}addAdditionalLabelComps(e,t){this.addLabelPadding(e,t);const i=this.createRotationWidget("labelRotation",t),s=this.initLabelRotation(i,t);e.addCompToPanel(s),e.addCompToPanel(i)}initLabelRotation(e,t){const i=t.getChartOptions(),r=()=>i.getValue("label.rotation"),a="number"!=typeof r()&&i.getValue("label.autoRotate"),o=this.createBean(new s.m({label:this.translate("autoRotate"),value:a,onValueChange:t=>{t&&(this.prevRotation=r()),i.setValues([{expression:"label.autoRotate",value:t},{expression:"label.rotation",value:t?void 0:this.prevRotation}]),e.setDisabled(t)}}));return e.setDisabled(a),o}createRotationWidget(e,t){var i;const s=t.getChartOptions(),r=()=>s.getValue("label.rotation"),a=`${this.chartTranslationService.translate(e)} \xb0`,o=new ci({label:a,labelWidth:"flex",value:null!=(i=r())?i:0,onValueChange:e=>s.setValue("label.rotation",e)});return this.axisLabelUpdateFuncs.push((()=>{var e;o.setValue(null!=(e=r())?e:0)})),this.createBean(o)}addLabelPadding(e,t){const i=this.createBean(new s.L(t.getDefaultSliderParams("label.padding","padding",30)));e.addCompToPanel(i)}translate(e){return this.chartTranslationService.translate(e)}removeTemplateComponent(e){s.ch.removeFromParent(e.getGui()),this.destroyBean(e)}destroyActivePanels(){this.activePanels.forEach((e=>{s.ch.removeFromParent(e.getGui()),this.destroyBean(e)}))}destroy(){this.destroyActivePanels(),super.destroy()}};pi.TEMPLATE='<div>\n            <ag-group-component ref="axisGroup">\n                <ag-select ref="axisTypeSelect"></ag-select>\n                <ag-select ref="axisTimeFormatSelect"></ag-select>\n                <ag-select ref="axisPositionSelect"></ag-select>\n                <ag-color-picker ref="axisColorInput"></ag-color-picker>\n                <ag-slider ref="axisLineWidthSlider"></ag-slider>\n            </ag-group-component>\n        </div>',Ye([(0,s.R)("axisGroup")],pi.prototype,"axisGroup",2),Ye([(0,s.R)("axisTypeSelect")],pi.prototype,"axisTypeSelect",2),Ye([(0,s.R)("axisPositionSelect")],pi.prototype,"axisPositionSelect",2),Ye([(0,s.R)("axisTimeFormatSelect")],pi.prototype,"axisTimeFormatSelect",2),Ye([(0,s.A)("chartTranslationService")],pi.prototype,"chartTranslationService",2),Ye([s.a],pi.prototype,"init",1);var gi=pi;function mi(e){return"time"===e}var vi=class e extends s.ak{constructor(e){let{chartController:t,chartAxisMenuParamsFactory:i,isExpandedOnInit:s=!1}=e;super(),this.chartController=t,this.chartMenuUtils=i,this.isExpandedOnInit=s}init(){const t={cssIdentifier:"charts-format-top-level",direction:"vertical",title:this.translate("polarAxis"),expanded:this.isExpandedOnInit,suppressEnabledCheckbox:!0},i=this.chartMenuUtils.getDefaultColorPickerParams("line.color"),s=this.chartMenuUtils.getDefaultSliderParams("line.width","thickness",10);this.setTemplate(e.TEMPLATE,{axisGroup:t,axisColorInput:i,axisLineWidthSlider:s}),this.initAxis(),this.initAxisLabels(),this.initRadiusAxis()}initAxis(){const e=this.chartController.getChartType();if(["radarLine","radarArea"].includes(e)){const e=[{value:"circle",text:this.translate("circle")},{value:"polygon",text:this.translate("polygon")}];this.axisGroup.addItem(this.createSelect({labelKey:"shape",options:e,property:"shape"}))}"pie"!==e&&this.axisGroup.addItem(this.createSlider({labelKey:"innerRadius",defaultMaxValue:1,property:"innerRadiusRatio"}))}initAxisLabels(){const e={name:this.translate("labels"),enabled:!0,suppressEnabledCheckbox:!0,chartMenuUtils:this.chartMenuUtils,keyMapper:e=>`label.${e}`},t=this.createManagedBean(new si(e)),i=this.createOrientationWidget();t.addItemToPanel(i),this.axisGroup.addItem(t)}createOrientationWidget(){const e=[{value:"fixed",text:this.translate("fixed")},{value:"parallel",text:this.translate("parallel")},{value:"perpendicular",text:this.translate("perpendicular")}];return this.createSelect({labelKey:"orientation",options:e,property:"label.orientation"})}initRadiusAxis(){if(!function(e){switch(e){case"radialColumn":case"radialBar":return!0;default:return!1}}(this.chartController.getChartType()))return;const e=[this.createSlider({labelKey:"groupPadding",defaultMaxValue:1,property:"paddingInner"}),this.createSlider({labelKey:"seriesPadding",defaultMaxValue:1,property:"groupPaddingInner"})],t=this.createManagedBean(new s.o({cssIdentifier:"charts-format-sub-level",direction:"vertical",suppressOpenCloseIcons:!0,enabled:!0,suppressEnabledCheckbox:!0,title:this.translate("padding"),items:e})).hideEnabledCheckbox(!0).hideOpenCloseIcons(!0);this.axisGroup.addItem(t)}createSlider(e){const{labelKey:t,defaultMaxValue:i,step:r=.05,property:a}=e,o=this.chartMenuUtils.getDefaultSliderParams(a,t,i);return o.step=r,this.createManagedBean(new s.L(o))}createSelect(e){const{labelKey:t,options:i,property:r}=e;return this.createManagedBean(new s.K(this.chartMenuUtils.addValueParams(r,{label:this.chartTranslationService.translate(t),labelAlignment:"left",labelWidth:"flex",inputWidth:"flex",options:i})))}translate(e){return this.chartTranslationService.translate(e)}};vi.TEMPLATE='<div>\n            <ag-group-component ref="axisGroup">\n                <ag-color-picker ref="axisColorInput"></ag-color-picker>\n                <ag-slider ref="axisLineWidthSlider"></ag-slider>\n            </ag-group-component>\n        </div>',Ye([(0,s.R)("axisGroup")],vi.prototype,"axisGroup",2),Ye([(0,s.A)("chartTranslationService")],vi.prototype,"chartTranslationService",2),Ye([s.a],vi.prototype,"init",1);var Ci=vi,fi=class e extends s.ak{constructor(e,t){super(),this.chartMenuUtils=e,this.chartController=t}init(){const t={cssIdentifier:"charts-format-sub-level",direction:"vertical",suppressOpenCloseIcons:!0,title:this.chartTranslationService.translate("padding"),suppressEnabledCheckbox:!0},i=e=>this.chartMenuUtils.getDefaultSliderParams("padding."+e,e,200);this.setTemplate(e.TEMPLATE,{chartPaddingGroup:t,paddingTopSlider:i("top"),paddingRightSlider:i("right"),paddingBottomSlider:i("bottom"),paddingLeftSlider:i("left")}),this.addManagedListener(this.eventService,s.aA.EVENT_CHART_OPTIONS_CHANGED,(e=>{this.updateTopPadding(e.chartOptions)}))}updateTopPadding(e){const t=[...this.chartController.getChartSeriesTypes(),"common"].map((t=>{var i,s;return null==(s=null==(i=e[t])?void 0:i.padding)?void 0:s.top})).find((e=>null!=e));null!=t&&this.paddingTopSlider.setValue(t)}};fi.TEMPLATE='<div>\n            <ag-group-component ref="chartPaddingGroup">\n                <ag-slider ref="paddingTopSlider"></ag-slider>\n                <ag-slider ref="paddingRightSlider"></ag-slider>\n                <ag-slider ref="paddingBottomSlider"></ag-slider>\n                <ag-slider ref="paddingLeftSlider"></ag-slider>\n            </ag-group-component>\n        <div>',Ye([(0,s.R)("paddingTopSlider")],fi.prototype,"paddingTopSlider",2),Ye([(0,s.A)("chartTranslationService")],fi.prototype,"chartTranslationService",2),Ye([s.a],fi.prototype,"init",1);var yi=fi,Si=class e extends s.ak{constructor(e){super(),this.chartMenuUtils=e}init(){const t=this.chartMenuUtils.addEnableParams("background.visible",{cssIdentifier:"charts-format-sub-level",direction:"vertical",suppressOpenCloseIcons:!0,title:this.chartTranslationService.translate("background"),suppressEnabledCheckbox:!1}),i=this.chartMenuUtils.getDefaultColorPickerParams("background.fill");this.setTemplate(e.TEMPLATE,{chartBackgroundGroup:t,colorPicker:i})}};Si.TEMPLATE='<div>\n            <ag-group-component ref="chartBackgroundGroup">\n                <ag-color-picker ref="colorPicker"></ag-color-picker>\n            </ag-group-component>\n        <div>',Ye([(0,s.A)("chartTranslationService")],Si.prototype,"chartTranslationService",2),Ye([s.a],Si.prototype,"init",1);var Ei=Si,bi=class e extends s.ak{constructor(t,i){super(e.TEMPLATE),this.chartMenuUtils=t,this.chartController=i,this.activePanels=[],this.chartOptions=t.getChartOptions()}init(){this.initFontPanel(),this.titlePlaceholder=this.chartTranslationService.translate("titlePlaceholder")}hasTitle(){const e=this.chartOptions.getValue("title");return e&&e.enabled&&e.text&&e.text.length>0}initFontPanel(){const e=this.hasTitle(),t={name:this.chartTranslationService.translate("title"),enabled:e,suppressEnabledCheckbox:!1,chartMenuUtils:this.chartMenuUtils,keyMapper:e=>`title.${e}`,onEnableChange:e=>{if(this.chartMenuService.doesChartToolbarExist(this.chartController)){const t=this.chartOptions.getValue("padding.top");this.chartOptions.setValue("padding.top",e?t-20:t+20)}this.chartOptions.setValue("title.enabled",e);const t=this.chartOptions.getValue("title.text"),i="Title"===t||0===(null==t?void 0:t.trim().length);e&&i&&this.chartOptions.setValue("title.text",this.titlePlaceholder)}},i=this.createBean(new si(t));i.addItemToPanel(this.createSpacingSlicer()),this.getGui().appendChild(i.getGui()),this.activePanels.push(i),this.addManagedListener(this.eventService,"chartTitleEdit",(()=>{i.setEnabled(this.hasTitle())}))}createSpacingSlicer(){const e=this.chartMenuUtils.getDefaultSliderParams("title.spacing","spacing",100);return e.value="10",this.createBean(new s.L(e))}destroyActivePanels(){this.activePanels.forEach((e=>{s.ch.removeFromParent(e.getGui()),this.destroyBean(e)}))}destroy(){this.destroyActivePanels(),super.destroy()}};bi.TEMPLATE="<div></div>",Ye([(0,s.A)("chartTranslationService")],bi.prototype,"chartTranslationService",2),Ye([(0,s.A)("chartMenuService")],bi.prototype,"chartMenuService",2),Ye([s.a],bi.prototype,"init",1);var wi=bi,Ai=class e extends s.ak{constructor(e){let{chartController:t,chartMenuParamsFactory:i,isExpandedOnInit:s=!1}=e;super(),this.chartController=t,this.chartMenuUtils=i,this.isExpandedOnInit=s}init(){const t={cssIdentifier:"charts-format-top-level",direction:"vertical",title:this.chartTranslationService.translate("chart"),expanded:this.isExpandedOnInit,suppressEnabledCheckbox:!0,items:[this.createManagedBean(new wi(this.chartMenuUtils,this.chartController)),this.createManagedBean(new yi(this.chartMenuUtils,this.chartController)),this.createManagedBean(new Ei(this.chartMenuUtils))]};this.setTemplate(e.TEMPLATE,{chartGroup:t})}};Ai.TEMPLATE='<div>\n            <ag-group-component ref="chartGroup"></ag-group-component>\n        </div>',Ye([(0,s.A)("chartTranslationService")],Ai.prototype,"chartTranslationService",2),Ye([s.a],Ai.prototype,"init",1);var xi=Ai,Ti=class e extends s.ak{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"shadow";super(),this.chartMenuUtils=e,this.propertyKey=t}init(){const t=this.propertyKey,i=this.chartMenuUtils.addEnableParams(`${t}.enabled`,{cssIdentifier:"charts-format-sub-level",direction:"vertical",suppressOpenCloseIcons:!0,title:this.chartTranslationService.translate("shadow"),suppressEnabledCheckbox:!1}),s=this.chartMenuUtils.getDefaultColorPickerParams(`${t}.color`);this.setTemplate(e.TEMPLATE,{shadowGroup:i,shadowColorPicker:s,shadowBlurSlider:this.getSliderParams("blur",0,20),shadowXOffsetSlider:this.getSliderParams("xOffset",-10,10),shadowYOffsetSlider:this.getSliderParams("yOffset",-10,10)})}getSliderParams(e,t,i){const s=`${this.propertyKey}.${e}`,r=this.chartMenuUtils.getDefaultSliderParams(s,e,i);return r.minValue=t,r}};Ti.TEMPLATE='<div>\n            <ag-group-component ref="shadowGroup">\n                <ag-color-picker ref="shadowColorPicker"></ag-color-picker>\n                <ag-slider ref="shadowBlurSlider"></ag-slider>\n                <ag-slider ref="shadowXOffsetSlider"></ag-slider>\n                <ag-slider ref="shadowYOffsetSlider"></ag-slider>\n            </ag-group-component>\n        </div>',Ye([(0,s.A)("chartTranslationService")],Ti.prototype,"chartTranslationService",2),Ye([s.a],Ti.prototype,"init",1);var Mi=Ti,Pi=class e extends s.ak{constructor(e,t){super(),this.chartOptionsService=e,this.chartMenuUtils=t}init(){const t=this.chartOptionsService.getChartType(),i=s.ch.includes(["scatter","bubble"],t),r=this.chartMenuUtils.addEnableParams("marker.enabled",{cssIdentifier:"charts-format-sub-level",direction:"vertical",title:this.chartTranslationService.translate("markers"),suppressEnabledCheckbox:i,suppressOpenCloseIcons:!0}),a="bubble"===t;let o,n;a?(o=this.getSliderParams("marker.maxSize","maxSize",60),n=this.getSliderParams("marker.size","minSize",60)):(o={},n=this.getSliderParams("marker.size","size",60)),this.setTemplate(e.TEMPLATE,{seriesMarkersGroup:r,seriesMarkerShapeSelect:this.getMarkerShapeSelectParams(),seriesMarkerMinSizeSlider:o,seriesMarkerSizeSlider:n,seriesMarkerStrokeWidthSlider:this.getSliderParams("marker.strokeWidth","strokeWidth",10)}),a||this.seriesMarkerMinSizeSlider.setDisplayed(!1)}getMarkerShapeSelectParams(){return this.chartMenuUtils.addValueParams("marker.shape",{options:[{value:"square",text:"Square"},{value:"circle",text:"Circle"},{value:"cross",text:"Cross"},{value:"diamond",text:"Diamond"},{value:"plus",text:"Plus"},{value:"triangle",text:"Triangle"},{value:"heart",text:"Heart"}],label:this.chartTranslationService.translate("shape")})}getSliderParams(e,t,i){return this.chartMenuUtils.getDefaultSliderParams(e,t,i)}};Pi.TEMPLATE='<div>\n            <ag-group-component ref="seriesMarkersGroup">\n                <ag-select ref="seriesMarkerShapeSelect"></ag-select>\n                <ag-slider ref="seriesMarkerMinSizeSlider"></ag-slider>\n                <ag-slider ref="seriesMarkerSizeSlider"></ag-slider>\n                <ag-slider ref="seriesMarkerStrokeWidthSlider"></ag-slider>\n            </ag-group-component>\n        </div>',Ye([(0,s.R)("seriesMarkerMinSizeSlider")],Pi.prototype,"seriesMarkerMinSizeSlider",2),Ye([(0,s.A)("chartTranslationService")],Pi.prototype,"chartTranslationService",2),Ye([s.a],Pi.prototype,"init",1);var Fi=Pi,Di=class e extends s.ak{constructor(t){super(e.TEMPLATE),this.H=1,this.S=1,this.B=1,this.A=1,this.isSpectrumDragging=!1,this.isSpectrumHueDragging=!1,this.isSpectrumAlphaDragging=!1,this.colorChanged=!1,this.picker=t.picker}postConstruct(){this.initTabIndex(),this.initRecentColors(),this.addGuiEventListener("focus",(()=>this.spectrumColor.focus())),this.addGuiEventListener("keydown",(e=>{e.key===s.b6.ENTER&&!e.defaultPrevented&&this.destroy()})),this.addManagedListener(this.spectrumColor,"keydown",(e=>this.moveDragger(e))),this.addManagedListener(this.spectrumAlphaSlider,"keydown",(e=>this.moveAlphaSlider(e))),this.addManagedListener(this.spectrumHueSlider,"keydown",(e=>this.moveHueSlider(e))),this.addManagedListener(this.spectrumVal,"mousedown",this.onSpectrumDraggerDown.bind(this)),this.addManagedListener(this.spectrumHue,"mousedown",this.onSpectrumHueDown.bind(this)),this.addManagedListener(this.spectrumAlpha,"mousedown",this.onSpectrumAlphaDown.bind(this)),this.addGuiEventListener("mousemove",(e=>{this.onSpectrumDraggerMove(e),this.onSpectrumHueMove(e),this.onSpectrumAlphaMove(e)})),this.addManagedListener(document,"mouseup",this.onMouseUp.bind(this)),this.addManagedListener(this.recentColors,"click",this.onRecentColorClick.bind(this)),this.addManagedListener(this.recentColors,"keydown",(e=>{(e.key===s.b6.ENTER||e.key===s.b6.SPACE)&&(e.preventDefault(),this.onRecentColorClick(e))}))}initTabIndex(){const e=this.tabIndex=this.gridOptionsService.get("tabIndex").toString();this.spectrumColor.setAttribute("tabindex",e),this.spectrumHueSlider.setAttribute("tabindex",e),this.spectrumAlphaSlider.setAttribute("tabindex",e)}refreshSpectrumRect(){return this.spectrumValRect=this.spectrumVal.getBoundingClientRect()}refreshHueRect(){return this.spectrumHueRect=this.spectrumHue.getBoundingClientRect()}refreshAlphaRect(){return this.spectrumAlphaRect=this.spectrumAlpha.getBoundingClientRect()}onSpectrumDraggerDown(e){this.refreshSpectrumRect(),this.isSpectrumDragging=!0,this.moveDragger(e)}onSpectrumDraggerMove(e){this.isSpectrumDragging&&this.moveDragger(e)}onSpectrumHueDown(e){this.refreshHueRect(),this.isSpectrumHueDragging=!0,this.moveHueSlider(e)}onSpectrumHueMove(e){this.isSpectrumHueDragging&&this.moveHueSlider(e)}onSpectrumAlphaDown(e){this.refreshAlphaRect(),this.isSpectrumAlphaDragging=!0,this.moveAlphaSlider(e)}onSpectrumAlphaMove(e){this.isSpectrumAlphaDragging&&this.moveAlphaSlider(e)}onMouseUp(){this.isSpectrumDragging=!1,this.isSpectrumHueDragging=!1,this.isSpectrumAlphaDragging=!1}moveDragger(e){const t=this.spectrumValRect;if(!t)return;let i,r;if(e instanceof MouseEvent)i=e.clientX-t.left,r=e.clientY-t.top;else{const t=e.key===s.b6.LEFT,a=e.key===s.b6.RIGHT,o=e.key===s.b6.UP,n=e.key===s.b6.DOWN,l=o||n,d=t||a;if(!l&&!d)return;e.preventDefault();const{x:h,y:c}=this.getSpectrumValue();i=h+(d?t?-5:5:0),r=c+(l?o?-5:5:0)}i=Math.max(i,0),i=Math.min(i,t.width),r=Math.max(r,0),r=Math.min(r,t.height),this.setSpectrumValue(i/t.width,1-r/t.height)}moveHueSlider(e){const t=this.spectrumHueRect;if(!t)return;const i=this.moveSlider(this.spectrumHueSlider,e);null!=i&&(this.H=1-i/t.width,this.update())}moveAlphaSlider(e){const t=this.spectrumAlphaRect;if(!t)return;const i=this.moveSlider(this.spectrumAlphaSlider,e);null!=i&&(this.A=i/t.width,this.update())}moveSlider(e,t){var i;const r=e.getBoundingClientRect(),a=null==(i=e.parentElement)?void 0:i.getBoundingClientRect();if(!e||!a)return null;let o;if(t instanceof MouseEvent)o=t.clientX-a.left;else{const i=t.key===s.b6.LEFT,a=t.key===s.b6.RIGHT;if(!i&&!a)return null;t.preventDefault();const n=i?-5:5;o=parseFloat(e.style.left)-r.width/2+n}return o=Math.max(o,0),o=Math.min(o,a.width),e.style.left=o+r.width/2+"px",o}update(){const e=r.s.Color.fromHSB(360*this.H,this.S,this.B,this.A),t=r.s.Color.fromHSB(360*this.H,1,1),i=e.toRgbaString(),s=this.picker;r.s.Color.fromString(s.getValue()).toRgbaString()!==i&&(this.colorChanged=!0),s.setValue(i),this.spectrumColor.style.backgroundColor=t.toRgbaString(),this.spectrumDragger.style.backgroundColor=i}setSpectrumValue(e,t){const i=this.spectrumValRect||this.refreshSpectrumRect();if(null==i)return;const s=this.spectrumDragger,r=s.getBoundingClientRect();e=Math.max(0,e),e=Math.min(1,e),t=Math.max(0,t),t=Math.min(1,t),this.S=e,this.B=t,s.style.left=e*i.width-r.width/2+"px",s.style.top=(1-t)*i.height-r.height/2+"px",this.update()}getSpectrumValue(){const e=this.spectrumDragger,t=e.getBoundingClientRect();return{x:parseFloat(e.style.left)+t.width/2,y:parseFloat(e.style.top)+t.height/2}}initRecentColors(){const t=e.recentColors.map(((e,t)=>`<div class="ag-recent-color" id=${t} style="background-color: ${e}; width: 15px; height: 15px;" recent-color="${e}" tabIndex="${this.tabIndex}"></div>`));this.recentColors.innerHTML=t.join("")}setValue(e){const t=r.s.Color.fromString(e),[i,s,a]=t.toHSB();this.H=(isNaN(i)?0:i)/360,this.A=t.a;const o=this.spectrumHueRect||this.refreshHueRect(),n=this.spectrumAlphaRect||this.refreshAlphaRect();this.spectrumHueSlider.style.left=(this.H-1)*-o.width+"px",this.spectrumAlphaSlider.style.left=this.A*n.width+"px",this.setSpectrumValue(s,a)}onRecentColorClick(t){const i=t.target;if(!s.ch.exists(i.id))return;const r=parseInt(i.id,10);this.setValue(e.recentColors[r]),this.destroy()}addRecentColor(){const t=r.s.Color.fromHSB(360*this.H,this.S,this.B,this.A).toRgbaString();let i=e.recentColors;!this.colorChanged||i[0]===t||(i=i.filter((e=>e!=t)),i=[t].concat(i),i.length>e.maxRecentColors&&(i=i.slice(0,e.maxRecentColors)),e.recentColors=i)}destroy(){this.addRecentColor(),super.destroy()}};Di.maxRecentColors=8,Di.recentColors=[],Di.TEMPLATE='<div class="ag-color-panel" tabindex="-1">\n            <div ref="spectrumColor" class="ag-spectrum-color">\n                <div class="ag-spectrum-sat ag-spectrum-fill">\n                    <div ref="spectrumVal" class="ag-spectrum-val ag-spectrum-fill">\n                        <div ref="spectrumDragger" class="ag-spectrum-dragger"></div>\n                    </div>\n                </div>\n            </div>\n            <div class="ag-spectrum-tools">\n                <div ref="spectrumHue" class="ag-spectrum-hue ag-spectrum-tool">\n                    <div class="ag-spectrum-hue-background"></div>\n                    <div ref="spectrumHueSlider" class="ag-spectrum-slider"></div>\n                </div>\n                <div ref="spectrumAlpha" class="ag-spectrum-alpha ag-spectrum-tool">\n                    <div class="ag-spectrum-alpha-background"></div>\n                    <div ref="spectrumAlphaSlider" class="ag-spectrum-slider"></div>\n                </div>\n                <div ref="recentColors" class="ag-recent-colors"></div>\n            </div>\n        </div>',Ye([(0,s.R)("spectrumColor")],Di.prototype,"spectrumColor",2),Ye([(0,s.R)("spectrumVal")],Di.prototype,"spectrumVal",2),Ye([(0,s.R)("spectrumDragger")],Di.prototype,"spectrumDragger",2),Ye([(0,s.R)("spectrumHue")],Di.prototype,"spectrumHue",2),Ye([(0,s.R)("spectrumHueSlider")],Di.prototype,"spectrumHueSlider",2),Ye([(0,s.R)("spectrumAlpha")],Di.prototype,"spectrumAlpha",2),Ye([(0,s.R)("spectrumAlphaSlider")],Di.prototype,"spectrumAlphaSlider",2),Ye([(0,s.R)("recentColors")],Di.prototype,"recentColors",2),Ye([s.a],Di.prototype,"postConstruct",1);var Ri=Di,Li=class extends s.z{constructor(e){super(ze({pickerAriaLabelKey:"ariaLabelColorPicker",pickerAriaLabelValue:"Color Picker",pickerType:"ag-list",className:"ag-color-picker",pickerIcon:"colorPicker"},e))}postConstruct(){super.postConstruct(),this.value&&this.setValue(this.value)}createPickerComponent(){const e=this.getGui().getBoundingClientRect();return this.createBean(new s.n({closable:!1,modal:!0,hideTitleBar:!0,minWidth:190,width:190,height:250,x:e.right-190,y:e.top-250}))}renderAndPositionPicker(){const e=this.pickerComponent,t=this.createBean(new Ri({picker:this}));return e.addCssClass("ag-color-dialog"),t.addDestroyFunc((()=>{e.isAlive()&&this.destroyBean(e)})),e.setParentComponent(this),e.setBodyComponent(t),t.setValue(this.getValue()),t.getGui().focus(),e.addDestroyFunc((()=>{this.isDestroyingPicker?this.isDestroyingPicker=!1:(this.beforeHidePicker(),this.isDestroyingPicker=!0,t.isAlive()&&this.destroyBean(t),this.isAlive()&&this.getFocusableElement().focus())})),()=>{var e;return null==(e=this.pickerComponent)?void 0:e.close()}}setValue(e){return this.value===e?this:(this.eDisplayField.style.backgroundColor=e,super.setValue(e))}getValue(){return this.value}},Ii=class e extends s.ak{constructor(e){super(),this.chartMenuUtils=e}init(){const t={cssIdentifier:"charts-format-sub-level",direction:"vertical",title:this.chartTranslationService.translate("callout"),enabled:!0,suppressOpenCloseIcons:!0,suppressEnabledCheckbox:!0};this.setTemplate(e.TEMPLATE,{calloutGroup:t,calloutLengthSlider:this.chartMenuUtils.getDefaultSliderParams("calloutLine.length","length",40),calloutStrokeWidthSlider:this.chartMenuUtils.getDefaultSliderParams("calloutLine.strokeWidth","strokeWidth",10),labelOffsetSlider:this.chartMenuUtils.getDefaultSliderParams("calloutLabel.offset","offset",30)})}};Ii.TEMPLATE='<div>\n            <ag-group-component ref="calloutGroup">\n                <ag-slider ref="calloutLengthSlider"></ag-slider>\n                <ag-slider ref="calloutStrokeWidthSlider"></ag-slider>\n                <ag-slider ref="labelOffsetSlider"></ag-slider>\n            </ag-group-component>\n        </div>',Ye([(0,s.A)("chartTranslationService")],Ii.prototype,"chartTranslationService",2),Ye([s.a],Ii.prototype,"init",1);var Oi=Ii,Ni=class e extends s.ak{constructor(e){super(),this.chartMenuUtils=e}init(){const t={cssIdentifier:"charts-format-sub-level",direction:"vertical",title:this.chartTranslationService.translate("cap"),enabled:!0,suppressOpenCloseIcons:!0,suppressEnabledCheckbox:!0},i=this.chartMenuUtils.getDefaultSliderParams("cap.lengthRatio","capLengthRatio",1);i.step=.05,this.setTemplate(e.TEMPLATE,{capsGroup:t,capLengthRatioSlider:i})}};Ni.TEMPLATE='<div>\n            <ag-group-component ref="capsGroup">\n                <ag-slider ref="capLengthRatioSlider"></ag-slider>\n            </ag-group-component>\n        </div>',Ye([(0,s.A)("chartTranslationService")],Ni.prototype,"chartTranslationService",2),Ye([s.a],Ni.prototype,"init",1);var ki=Ni,Gi=class e extends s.ak{constructor(e){super(),this.chartMenuUtils=e}init(){const t={cssIdentifier:"charts-format-sub-level",direction:"vertical",title:this.chartTranslationService.translate("connectorLine"),enabled:!0,suppressOpenCloseIcons:!0,suppressEnabledCheckbox:!0};this.setTemplate(e.TEMPLATE,{lineGroup:t,lineColorPicker:this.chartMenuUtils.getDefaultColorPickerParams("line.stroke"),lineStrokeWidthSlider:this.getSliderParams("strokeWidth",10,"line.strokeWidth"),lineDashSlider:this.getSliderParams("lineDash",30,"line.lineDash",1,!0),lineOpacitySlider:this.getSliderParams("strokeOpacity",1,"line.strokeOpacity",.05)})}getSliderParams(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const a=this.chartMenuUtils.getDefaultSliderParams(i,e,t,r);return a.step=s,a}};Gi.TEMPLATE='<div>\n            <ag-group-component ref="lineGroup">\n                <ag-color-picker ref="lineColorPicker"></ag-color-picker>\n                <ag-slider ref="lineStrokeWidthSlider"></ag-slider>\n                <ag-slider ref="lineOpacitySlider"></ag-slider>\n                <ag-slider ref="lineDashSlider"></ag-slider>                \n            </ag-group-component>\n        </div>',Ye([(0,s.A)("chartTranslationService")],Gi.prototype,"chartTranslationService",2),Ye([s.a],Gi.prototype,"init",1);var Vi=Gi,Bi=class e extends s.ak{constructor(e){super(),this.chartMenuUtils=e}init(){const t={cssIdentifier:"charts-format-sub-level",direction:"vertical",title:this.chartTranslationService.translate("whisker"),enabled:!0,suppressOpenCloseIcons:!0,suppressEnabledCheckbox:!0};this.setTemplate(e.TEMPLATE,{whiskersGroup:t,whiskerColorPicker:this.chartMenuUtils.getDefaultColorPickerParams("whisker.stroke"),whiskerThicknessSlider:this.chartMenuUtils.getDefaultSliderParams("whisker.strokeWidth","strokeWidth",10),whiskerOpacitySlider:this.chartMenuUtils.getDefaultSliderParams("whisker.strokeOpacity","strokeOpacity",1),whiskerLineDashSlider:this.chartMenuUtils.getDefaultSliderParams("whisker.lineDash","lineDash",30,!0),whiskerLineDashOffsetSlider:this.chartMenuUtils.getDefaultSliderParams("whisker.lineDashOffset","lineDashOffset",30)})}};Bi.TEMPLATE='<div>\n            <ag-group-component ref="whiskersGroup">\n                <ag-color-picker ref="whiskerColorPicker"></ag-color-picker>\n                <ag-slider ref="whiskerThicknessSlider"></ag-slider>\n                <ag-slider ref="whiskerOpacitySlider"></ag-slider>\n                <ag-slider ref="whiskerLineDashSlider"></ag-slider>\n                <ag-slider ref="whiskerLineDashOffsetSlider"></ag-slider>\n            </ag-group-component>\n        </div>',Ye([(0,s.A)("chartTranslationService")],Bi.prototype,"chartTranslationService",2),Ye([s.a],Bi.prototype,"init",1);var _i=Bi,Ui=class e extends s.ak{constructor(e){super(),this.chartMenuUtils=e,this.activePanels=[]}init(){const t={cssIdentifier:"charts-format-sub-level",direction:"vertical",title:this.chartTranslationService.translate("seriesItems"),enabled:!0,suppressOpenCloseIcons:!0,suppressEnabledCheckbox:!0};this.setTemplate(e.TEMPLATE,{seriesItemsGroup:t,seriesItemSelect:this.getSeriesItemsParams()}),this.initSeriesControls()}getSeriesItemsParams(){const e=[{value:"positive",text:this.chartTranslationService.translate("seriesItemPositive")},{value:"negative",text:this.chartTranslationService.translate("seriesItemNegative")}];return{label:this.chartTranslationService.translate("seriesItemType"),labelAlignment:"left",labelWidth:"flex",inputWidth:"flex",options:e,value:"positive",onValueChange:e=>{this.destroyActivePanels(),this.initSeriesControls(e)}}}initSeriesControls(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"positive";this.initSlider("strokeWidth",10,`item.${e}.strokeWidth`),this.initSlider("lineDash",30,`item.${e}.lineDash`,1,!0),this.initSlider("strokeOpacity",1,`item.${e}.strokeOpacity`,.05,!1),this.initSlider("fillOpacity",1,`item.${e}.fillOpacity`,.05,!1),this.initItemLabels(e)}initSlider(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const o=this.chartMenuUtils.getDefaultSliderParams(i,e,t,a);o.step=r;const n=this.seriesItemsGroup.createManagedBean(new s.L(o));this.seriesItemsGroup.addItem(n),this.activePanels.push(n)}initItemLabels(e){const t=this.chartMenuUtils.getDefaultFontPanelParams(`item.${e}.label`,"seriesItemLabels"),i=this.createBean(new si(t));this.seriesItemsGroup.addItem(i),this.activePanels.push(i)}destroyActivePanels(){this.activePanels.forEach((e=>{s.ch.removeFromParent(e.getGui()),this.destroyBean(e)}))}destroy(){this.destroyActivePanels(),super.destroy()}};Ui.TEMPLATE='<div>\n            <ag-group-component ref="seriesItemsGroup">\n                <ag-select ref="seriesItemSelect"></ag-select>\n            </ag-group-component>\n        </div>',Ye([(0,s.R)("seriesItemsGroup")],Ui.prototype,"seriesItemsGroup",2),Ye([(0,s.A)("chartTranslationService")],Ui.prototype,"chartTranslationService",2),Ye([s.a],Ui.prototype,"init",1);var Hi=Ui,Wi=class e extends s.ak{constructor(e){super(),this.chartMenuUtils=e}init(){const t={cssIdentifier:"charts-format-sub-level",direction:"vertical",enabled:!0,suppressOpenCloseIcons:!0,suppressEnabledCheckbox:!0};this.setTemplate(e.TEMPLATE,{groupSpacing:$e(ze({},t),{title:this.chartTranslationService.translate("group")}),tileSpacing:$e(ze({},t),{title:this.chartTranslationService.translate("tile")}),groupPaddingSlider:this.getSliderParams("padding","group.padding"),groupSpacingSlider:this.getSliderParams("spacing","group.gap"),tilePaddingSlider:this.getSliderParams("padding","tile.padding"),tileSpacingSlider:this.getSliderParams("spacing","tile.gap")})}getSliderParams(e,t){return this.chartMenuUtils.getDefaultSliderParams(t,e,10)}};Wi.TEMPLATE='<div>\n            <ag-group-component ref="groupSpacing">\n                <ag-slider ref="groupPaddingSlider"></ag-slider>\n                <ag-slider ref="groupSpacingSlider"></ag-slider>\n            </ag-group-component>\n            <ag-group-component ref="tileSpacing">\n                <ag-slider ref="tilePaddingSlider"></ag-slider>\n                <ag-slider ref="tileSpacingSlider"></ag-slider>\n            </ag-group-component>\n        </div>',Ye([(0,s.A)("chartTranslationService")],Wi.prototype,"chartTranslationService",2),Ye([s.a],Wi.prototype,"init",1);var Ki=Wi,zi=class e extends s.ak{constructor(e){let{chartController:t,chartOptionsService:i,seriesType:s,isExpandedOnInit:r=!1}=e;super(),this.activePanels=[],this.widgetFuncs={lineWidth:()=>this.initStrokeWidth("lineWidth"),strokeWidth:()=>this.initStrokeWidth("strokeWidth"),lineColor:()=>this.initLineColor(),lineDash:()=>this.initLineDash(),lineOpacity:()=>this.initLineOpacity(),fillOpacity:()=>this.initFillOpacity(),markers:()=>this.initMarkers(),labels:()=>this.initLabels(),shadow:()=>this.initShadow(),tooltips:()=>this.initTooltips(),bins:()=>this.initBins(),whiskers:()=>this.initWhiskers(),caps:()=>this.initCaps(),connectorLine:()=>this.initConnectorLine(),seriesItems:()=>this.initSeriesItemsPanel(),tileSpacing:()=>this.initTileSpacingPanel()},this.seriesWidgetMappings={column:["tooltips","strokeWidth","lineDash","lineOpacity","fillOpacity","labels","shadow"],bar:["tooltips","strokeWidth","lineDash","lineOpacity","fillOpacity","labels","shadow"],pie:["tooltips","strokeWidth","lineOpacity","fillOpacity","labels","shadow"],donut:["tooltips","strokeWidth","lineOpacity","fillOpacity","labels","shadow"],line:["tooltips","lineWidth","lineDash","lineOpacity","markers","labels"],scatter:["tooltips","markers","labels"],bubble:["tooltips","markers","labels"],area:["tooltips","lineWidth","lineDash","lineOpacity","fillOpacity","markers","labels","shadow"],histogram:["tooltips","bins","strokeWidth","lineDash","lineOpacity","fillOpacity","labels","shadow"],"radial-column":["tooltips","strokeWidth","lineDash","lineOpacity","fillOpacity","labels"],"radial-bar":["tooltips","strokeWidth","lineDash","lineOpacity","fillOpacity","labels"],"radar-line":["tooltips","strokeWidth","lineDash","lineOpacity","markers","labels"],"radar-area":["tooltips","strokeWidth","lineDash","lineOpacity","fillOpacity","markers","labels"],nightingale:["tooltips","strokeWidth","lineDash","lineOpacity","fillOpacity","labels"],"box-plot":["tooltips","strokeWidth","lineDash","lineOpacity","fillOpacity","whiskers","caps"],"range-bar":["tooltips","strokeWidth","lineDash","lineOpacity","fillOpacity","labels"],"range-area":["tooltips","lineWidth","lineDash","lineOpacity","fillOpacity","markers","labels","shadow"],treemap:["tooltips","tileSpacing"],sunburst:["tooltips"],heatmap:["tooltips","labels","lineColor","lineWidth","lineOpacity"],waterfall:["tooltips","connectorLine","seriesItems"]},this.chartController=t,this.chartOptionsService=i,this.seriesType=s||this.getChartSeriesType(),this.isExpandedOnInit=r}init(){const t={cssIdentifier:"charts-format-top-level",direction:"vertical",title:this.translate("series"),expanded:this.isExpandedOnInit,suppressEnabledCheckbox:!0};this.setTemplate(e.TEMPLATE,{seriesGroup:t}),this.chartMenuUtils=this.createManagedBean(new ui(this.chartOptionsService.getSeriesOptionsProxy((()=>this.seriesType)))),this.chartOptions=this.chartMenuUtils.getChartOptions(),this.addManagedListener(this.chartController,Bt.EVENT_CHART_SERIES_CHART_TYPE_CHANGED,this.refreshWidgets.bind(this)),this.refreshWidgets()}refreshWidgets(){this.destroyActivePanels(),this.chartController.getChartProxy().getChart().waitForUpdate().then((()=>{var e;this.isAlive()&&(this.chartController.isComboChart()&&(this.updateSeriesType(),this.initSeriesSelect()),(null!=(e=this.seriesWidgetMappings[this.seriesType])?e:[]).forEach((e=>this.widgetFuncs[e]())))})).catch((e=>console.error("AG Grid - chart rendering failed",e)))}initSeriesSelect(){const e=this.seriesGroup.createManagedBean(new s.K({label:this.translate("seriesType"),labelAlignment:"left",labelWidth:"flex",inputWidth:"flex",options:this.getSeriesSelectOptions(),value:`${this.seriesType}`,onValueChange:e=>{this.seriesType=e,this.refreshWidgets()}}));this.seriesGroup.addItem(e),this.activePanels.push(e)}initTooltips(){const e=this.createBean(new s.Q(this.chartMenuUtils.addValueParams("tooltip.enabled",{label:this.translate("tooltips"),labelAlignment:"left",labelWidth:"flex",inputWidth:"flex"})));this.addWidget(e)}initLineColor(){const e=this.createBean(new Li(this.chartMenuUtils.getDefaultColorPickerParams("stroke","strokeColor")));this.addWidget(e)}initStrokeWidth(e){const t=this.createBean(new s.L(this.chartMenuUtils.getDefaultSliderParams("strokeWidth",e,10)));this.addWidget(t)}initLineDash(){const e=this.createBean(new s.L(this.chartMenuUtils.getDefaultSliderParams("lineDash","lineDash",30,!0)));this.addWidget(e)}initLineOpacity(){const e=this.chartMenuUtils.getDefaultSliderParams("strokeOpacity","strokeOpacity",1);e.step=.05;const t=this.createBean(new s.L(e));this.addWidget(t)}initFillOpacity(){const e=this.chartMenuUtils.getDefaultSliderParams("fillOpacity","fillOpacity",1);e.step=.05;const t=this.createBean(new s.L(e));this.addWidget(t)}initLabels(){const e=ht(this.seriesType),t=e?"calloutLabel":"label",i=e?"calloutLabels":"labels",r=this.chartMenuUtils.getDefaultFontPanelParams(t,i),a=this.createBean(new si(r));if(e){const e=this.createBean(new Oi(this.chartMenuUtils));a.addCompToPanel(e),this.activePanels.push(e)}if(this.addWidget(a),e){const e=this.chartMenuUtils.getDefaultFontPanelParams("sectorLabel","sectorLabels"),t=this.createBean(new si(e)),i=this.getSectorLabelPositionRatio();t.addCompToPanel(i),this.addWidget(t)}if("range-bar"===this.seriesType){const e=[{value:"inside",text:this.translate("inside")},{value:"outside",text:this.translate("outside")}],t=a.createManagedBean(new s.K(this.chartMenuUtils.addValueParams("label.placement",{label:this.translate("labelPlacement"),labelAlignment:"left",labelWidth:"flex",inputWidth:"flex",options:e})));a.addCompToPanel(t),this.activePanels.push(t);const i=a.createManagedBean(new s.L(this.chartMenuUtils.getDefaultSliderParams("label.padding","padding",200)));a.addCompToPanel(i),this.activePanels.push(i)}}getSectorLabelPositionRatio(){const e=this.chartMenuUtils.getDefaultSliderParams("sectorLabel.positionRatio","positionRatio",1);return e.step=.05,this.createBean(new s.L(e))}initShadow(){const e=this.createBean(new Mi(this.chartMenuUtils));this.addWidget(e)}initMarkers(){const e=this.createBean(new Fi(this.chartOptionsService,this.chartMenuUtils));this.addWidget(e)}initBins(){var e;const t=this.chartMenuUtils.getDefaultSliderParams("binCount","histogramBinCount",20),i=(null!=(e=this.chartOptions.getValue("bins"))?e:this.chartOptions.getValue("calculatedBins",!0)).length;t.value=`${i}`,t.maxValue=Math.max(i,20);const r=this.createBean(new s.L(t));this.addWidget(r)}initWhiskers(){const e=this.createBean(new _i(this.chartMenuUtils));this.addWidget(e)}initCaps(){const e=this.createBean(new ki(this.chartMenuUtils));this.addWidget(e)}initConnectorLine(){const e=this.createBean(new Vi(this.chartMenuUtils));this.addWidget(e)}initSeriesItemsPanel(){const e=this.createBean(new Hi(this.chartMenuUtils));this.addWidget(e)}initTileSpacingPanel(){const e=this.createBean(new Ki(this.chartMenuUtils));this.addWidget(e)}addWidget(e){this.seriesGroup.addItem(e),this.activePanels.push(e)}getChartSeriesType(){if(0===this.chartController.getSeriesChartTypes().length)return"column";const e=this.chartController.getSeriesChartTypes()[0].chartType;return"columnLineCombo"===e?"column":"areaColumnCombo"===e?"area":dt(e)}getSeriesSelectOptions(){this.seriesSelectOptions||(this.seriesSelectOptions=new Map([["area",{value:"area",text:this.translate("area")}],["bar",{value:"bar",text:this.translate("bar")}],["column",{value:"column",text:this.translate("column")}],["line",{value:"line",text:this.translate("line")}],["scatter",{value:"scatter",text:this.translate("scatter")}],["histogram",{value:"histogram",text:this.translate("histogram")}],["radial-column",{value:"radial-column",text:this.translate("radialColumn")}],["radial-bar",{value:"radial-bar",text:this.translate("radialBar")}],["radar-line",{value:"radar-line",text:this.translate("radarLine")}],["radar-area",{value:"radar-area",text:this.translate("radarArea")}],["nightingale",{value:"nightingale",text:this.translate("nightingale")}],["range-bar",{value:"range-bar",text:this.translate("rangeBar")}],["range-area",{value:"range-area",text:this.translate("rangeArea")}],["treemap",{value:"treemap",text:this.translate("treemap")}],["sunburst",{value:"sunburst",text:this.translate("sunburst")}],["waterfall",{value:"waterfall",text:this.translate("waterfall")}],["box-plot",{value:"box-plot",text:this.translate("boxPlot")}],["pie",{value:"pie",text:this.translate("pie")}],["donut",{value:"donut",text:this.translate("donut")}]]));const e=new Set;return this.chartController.getActiveSeriesChartTypes().forEach((t=>{const i=dt(t.chartType);e.add(this.seriesSelectOptions.get(i))})),Array.from(e)}updateSeriesType(){const e=this.chartController.getActiveSeriesChartTypes().map((e=>dt(e.chartType)));!e.includes(this.seriesType)&&e.length>0&&(this.seriesType=e[0])}translate(e){return this.chartTranslationService.translate(e)}destroyActivePanels(){this.activePanels.forEach((e=>{s.ch.removeFromParent(e.getGui()),this.destroyBean(e)}))}destroy(){this.destroyActivePanels(),super.destroy()}};zi.TEMPLATE='<div>\n            <ag-group-component ref="seriesGroup">\n            </ag-group-component>\n        </div>',Ye([(0,s.R)("seriesGroup")],zi.prototype,"seriesGroup",2),Ye([(0,s.A)("chartTranslationService")],zi.prototype,"chartTranslationService",2),Ye([s.a],zi.prototype,"init",1);var $i=zi,ji=class e extends s.ak{constructor(e){let{chartMenuParamsFactory:t,isExpandedOnInit:i=!1}=e;super(),this.chartMenuUtils=t,this.isExpandedOnInit=i}init(){const t=this.chartMenuUtils.addEnableParams("gradientLegend.enabled",{cssIdentifier:"charts-format-top-level",direction:"vertical",title:this.chartTranslationService.translate("legend"),suppressEnabledCheckbox:!1,suppressToggleExpandOnEnableChange:!0,expanded:this.isExpandedOnInit,items:[this.createLabelPanel()]});this.setTemplate(e.TEMPLATE,{legendGroup:t,legendPositionSelect:this.chartMenuUtils.getDefaultLegendParams("gradientLegend.position"),gradientReverseCheckbox:this.getGradientReverseCheckboxParams(),gradientThicknessSlider:this.chartMenuUtils.getDefaultSliderParams("gradientLegend.gradient.thickness","thickness",40),gradientPreferredLengthSlider:this.chartMenuUtils.getDefaultSliderParams("gradientLegend.gradient.preferredLength","preferredLength",300),legendSpacingSlider:this.chartMenuUtils.getDefaultSliderParams("gradientLegend.spacing","spacing",200)})}getGradientReverseCheckboxParams(){return this.chartMenuUtils.addValueParams("gradientLegend.reverseOrder",{label:this.chartTranslationService.translate("reverseDirection"),labelWidth:"flex"})}createLabelPanel(){const e={enabled:!0,suppressEnabledCheckbox:!0,chartMenuUtils:this.chartMenuUtils,keyMapper:e=>`gradientLegend.scale.label.${e}`};return this.createManagedBean(new si(e))}};ji.TEMPLATE='<div>\n            <ag-group-component ref="legendGroup">\n                <ag-select ref="legendPositionSelect"></ag-select>\n                <ag-checkbox ref="gradientReverseCheckbox"></ag-checkbox>\n                <ag-slider ref="gradientThicknessSlider"></ag-slider>\n                <ag-slider ref="gradientPreferredLengthSlider"></ag-slider>\n                <ag-slider ref="legendSpacingSlider"></ag-slider>\n            </ag-group-component>\n        </div>',Ye([(0,s.A)("chartTranslationService")],ji.prototype,"chartTranslationService",2),Ye([s.a],ji.prototype,"init",1);var Yi=ji,qi=class extends s.B{constructor(e,t,i,s){super(),this.chartController=e,this.eGui=t,this.cssClass=i,this.createPanels=s,this.panels=[]}postConstruct(){this.addManagedListener(this.chartController,Bt.EVENT_CHART_UPDATED,(()=>this.refreshPanels(!0))),this.addManagedListener(this.chartController,Bt.EVENT_CHART_API_UPDATE,(()=>this.refreshPanels(!1)))}addComponent(e){this.createBean(e),this.panels.push(e),e.addCssClass(this.cssClass),this.eGui.appendChild(e.getGui())}refreshPanels(e){const t=this.chartController.getChartType(),i=this.chartController.isGrouping(),s=dt(t);e&&t===this.chartType&&i===this.isGrouping||(this.destroyPanels(),this.createPanels(t,s),this.chartType=t,this.isGrouping=i)}destroyPanels(){this.panels.forEach((e=>{s.ch.removeFromParent(e.getGui()),this.destroyBean(e)})),this.panels=[]}destroy(){this.destroyPanels(),super.destroy()}};Ye([s.a],qi.prototype,"postConstruct",1);var Xi={groups:[{type:"chart"},{type:"legend"},{type:"series"},{type:"axis"}]},Zi=class e extends s.ak{constructor(t){super(e.TEMPLATE),this.chartMenuContext=t,this.isGroupPanelShownInSeries=(e,t)=>{var i,s;return!!["chart","legend","series"].includes(e)||null!=(s=null==(i={bar:["axis","horizontalAxis","verticalAxis"],column:["axis","horizontalAxis","verticalAxis"],line:["axis","horizontalAxis","verticalAxis"],area:["axis","horizontalAxis","verticalAxis"],scatter:["axis","horizontalAxis","verticalAxis"],bubble:["axis","horizontalAxis","verticalAxis"],histogram:["axis","horizontalAxis","verticalAxis"],cartesian:["axis","horizontalAxis","verticalAxis"],"radial-column":["axis"],"radial-bar":["axis"],"radar-line":["axis"],"radar-area":["axis"],nightingale:["axis"],"range-bar":["axis","horizontalAxis","verticalAxis"],"range-area":["axis","horizontalAxis","verticalAxis"],treemap:[],sunburst:[],heatmap:["axis","horizontalAxis","verticalAxis"],waterfall:["axis","horizontalAxis","verticalAxis"],"box-plot":["axis","horizontalAxis","verticalAxis"]}[t])?void 0:i.includes(e))&&s}}init(){this.chartPanelFeature=this.createManagedBean(new qi(this.chartMenuContext.chartController,this.getGui(),"ag-chart-format-section",((e,t)=>this.createPanels(e,t)))),this.chartPanelFeature.refreshPanels()}createPanels(e,t){var i;null==(i=this.getFormatPanelDef().groups)||i.forEach((i=>{const r=i.type;if(!this.isGroupPanelShownInSeries(r,t))return;const a=$e(ze({},this.chartMenuContext),{isExpandedOnInit:i.isOpen,seriesType:t});switch(r){case"chart":this.chartPanelFeature.addComponent(new xi(a));break;case"legend":const t=function(e){switch(e){case"treemap":case"sunburst":case"heatmap":return!0;default:return!1}}(e)?new Yi(a):new ai(a);this.chartPanelFeature.addComponent(t);break;case"axis":!function(e){switch(e){case"donut":case"doughnut":case"pie":case"radialColumn":case"radialBar":case"radarLine":case"radarArea":case"nightingale":return!0;default:return!1}}(e)?ot(e)&&(this.chartPanelFeature.addComponent(new gi("xAxis",a)),this.chartPanelFeature.addComponent(new gi("yAxis",a))):this.chartPanelFeature.addComponent(new Ci(a));break;case"horizontalAxis":this.chartPanelFeature.addComponent(new gi("xAxis",a));break;case"verticalAxis":this.chartPanelFeature.addComponent(new gi("yAxis",a));break;case"series":this.chartPanelFeature.addComponent(new $i(a));break;case"navigator":s.ch.warnOnce("'navigator' is now displayed in the charts advanced settings instead of the format panel, and this setting will be ignored.");default:s.ch.warnOnce(`Invalid charts format panel group name supplied: '${i.type}'`)}}))}getFormatPanelDef(){var e;return(null==(e=this.gridOptionsService.get("chartToolPanelsDef"))?void 0:e.formatPanel)||Xi}};Zi.TEMPLATE='<div class="ag-chart-format-wrapper"></div>',Ye([s.a],Zi.prototype,"init",1);var Ji=Zi,Qi=class extends s.ak{constructor(e,t){super(),this.tooltipName=t,this.size=58,this.padding=5,this.root=new r.i.Group;const i=new r.i.Scene({width:this.size,height:this.size});i.canvas.element.classList.add("ag-chart-mini-thumbnail-canvas"),i.setRoot(this.root),i.setContainer(e),this.scene=i}init(){this.scene.canvas.element.title=this.chartTranslationService.translate(this.tooltipName),this.scene.render().catch((e=>{console.error("AG Grid - chart update failed",e)}))}};Ye([(0,s.A)("chartTranslationService")],Qi.prototype,"chartTranslationService",2),Ye([s.a],Qi.prototype,"init",1);var es=class extends Qi{constructor(e,t){super(e,t),this.stroke="gray",this.axisOvershoot=3}addAxes(){const e=this.size,t=this.padding,i=new r.i.Line;i.x1=t,i.y1=t,i.x2=t,i.y2=e-t+this.axisOvershoot,i.stroke=this.stroke;const s=new r.i.Line;s.x1=t-this.axisOvershoot+1,s.y1=e-t,s.x2=e-t+1,s.y2=e-t,s.stroke=this.stroke;const a=this.root;a.append(i),a.append(s)}};function ts(e){const{stacked:t,size:i,padding:s,xScalePadding:a,xScaleDomain:o,yScaleDomain:n}=e,l=new r.i.BandScale;l.domain=o,l.range=[s,i-s],l.paddingInner=a,l.paddingOuter=a;const d=new r.i.LinearScale;d.domain=n,d.range=[i-s,s];const h=(e,t,i)=>e.map(((e,s)=>{const a=i.convert(e),o=new r.i.Rect;return o.x=t.convert(s),o.y=a,o.width=t.bandwidth,o.height=i.convert(0)-a,o.strokeWidth=0,o.crisp=!0,o}));return t?e.data.map((e=>h(e,l,d))):h(e.data,l,d)}function is(e,t,i,s){const a=new r.i.LinearScale;a.domain=[0,4],a.range=[s,i-s];const o=new r.i.LinearScale;o.domain=[0,10],o.range=[i-s,s];const n=t.map((e=>{const t=new r.i.Path;return t.strokeWidth=3,t.lineCap="round",t.fill=void 0,e.forEach(((e,i)=>{t.path[i>0?"lineTo":"moveTo"](a.convert(i),o.convert(e))})),t})),l=new r.i.Group;return l.setClipRectInGroupCoordinateSpace(new r.i.BBox(s,s,i-2*s,i-2*s)),l.append(n),e.append(l),n}function ss(e,t,i,s,a){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const n=new r.i.LinearScale;n.domain=[0,7],n.range=[-Math.PI,Math.PI].map((e=>e+Math.PI/2));const l=new r.i.LinearScale;l.domain=[0,10],l.range=[s,a];const d=[],h=t.map((e=>{const t=new r.i.Path;return t.strokeWidth=1,t.strokeOpacity=.5,t.lineCap="round",t.fill=void 0,t.fillOpacity=.8,e.forEach(((e,i)=>{const h=n.convert(i),c=s+a-l.convert(e),u=c*Math.cos(h),p=c*Math.sin(h);if(t.path[i>0?"lineTo":"moveTo"](u,p),o>0){const e=new r.i.Circle;e.x=u,e.y=p,e.size=o,d.push(e)}})),t.path.closePath(),t})),c=new r.i.Group,u=i/2;return c.translationX=u,c.translationY=u,c.append([...h,...d]),e.append(c),{paths:h,markers:d}}function rs(e){let[t,i]=[1/0,-1/0];return{processedData:e.reduce(((e,s,r)=>{const a=r>0?e[r-1]:void 0;null!=e[r]||(e[r]=[]);const o=e[r];return s.forEach(((e,s)=>{a&&(e+=a[s]),o[s]=e,o[s]<t&&(t=o[s]),o[s]>i&&(i=o[s])})),e}),[]),min:t,max:i}}Ye([s.a],es.prototype,"addAxes",1);var as=class extends es{constructor(e,t,i){super(e,"groupedColumnTooltip"),this.columnData=[2,3,4];const{root:s,columnData:r,size:a,padding:o}=this;this.columns=ts({stacked:!1,root:s,data:r,size:a,padding:o,xScaleDomain:[0,1,2],yScaleDomain:[0,4],xScalePadding:.3}),s.append(this.columns),this.updateColors(t,i)}updateColors(e,t){this.columns.forEach(((i,s)=>{i.fill=e[s],i.stroke=t[s]}))}};as.chartType="groupedColumn";var os=class e extends es{constructor(t,i,s,r,a){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e.data,n=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[0,16];super(t,arguments.length>7&&void 0!==arguments[7]?arguments[7]:"stackedColumnTooltip");const{root:l,size:d,padding:h}=this;this.stackedColumns=ts({stacked:!0,root:l,data:o,size:d,padding:h,xScaleDomain:[0,1,2],yScaleDomain:n,xScalePadding:.3}),l.append([].concat.apply([],this.stackedColumns)),this.updateColors(i,s)}updateColors(e,t){this.stackedColumns.forEach(((i,s)=>i.forEach((i=>{i.fill=e[s],i.stroke=t[s]}))))}};os.chartType="stackedColumn",os.data=[[8,12,16],[6,9,12],[2,3,4]];var ns=os,ls=class e extends ns{constructor(t,i,s,r,a){super(t,i,s,r,a,e.data,[0,10],"normalizedColumnTooltip")}};ls.chartType="normalizedColumn",ls.data=[[10,10,10],[6,7,8],[2,4,6]];var ds=ls,hs=class extends es{constructor(e,t,i){super(e,"groupedBarTooltip");const s=this.padding,a=this.size,o=new r.i.BandScale;o.domain=[0,1,2],o.range=[s,a-s],o.paddingInner=.3,o.paddingOuter=.3;const n=new r.i.LinearScale;n.domain=[0,4],n.range=[a-s,s];const l=n.convert(0),d=o.bandwidth;this.bars=[2,3,4].map(((e,t)=>{const i=new r.i.Rect;return i.x=s,i.y=o.convert(t),i.width=l-n.convert(e),i.height=d,i.strokeWidth=0,i.crisp=!0,i})),this.updateColors(t,i),this.root.append(this.bars)}updateColors(e,t){this.bars.forEach(((i,s)=>{i.fill=e[s],i.stroke=t[s]}))}};hs.chartType="groupedBar";var cs=class e extends es{constructor(t,i,s,a,o){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e.data,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[0,16];super(t,arguments.length>7&&void 0!==arguments[7]?arguments[7]:"stackedBarTooltip");const d=this.size,h=this.padding,c=new r.i.BandScale;c.domain=[0,1,2],c.range=[h,d-h],c.paddingInner=.3,c.paddingOuter=.3;const u=new r.i.LinearScale;u.domain=l,u.range=[d-h,h];const p=u.convert(0),g=c.bandwidth;this.bars=n.map((e=>e.map(((e,t)=>{const i=new r.i.Rect;return i.x=h,i.y=c.convert(t),i.width=p-u.convert(e),i.height=g,i.strokeWidth=0,i.crisp=!0,i})))),this.updateColors(i,s),this.root.append([].concat.apply([],this.bars))}updateColors(e,t){this.bars.forEach(((i,s)=>i.forEach((i=>{i.fill=e[s],i.stroke=t[s]}))))}};cs.chartType="stackedBar",cs.data=[[8,12,16],[6,9,12],[2,3,4]];var us=cs,ps=class e extends us{constructor(t,i,s,r,a){super(t,i,s,r,a,e.data,[0,10],"normalizedBarTooltip")}};ps.chartType="normalizedBar",ps.data=[[10,10,10],[6,7,8],[2,4,6]];var gs=ps,ms=r.i.toRadians,vs=class extends Qi{constructor(e,t,i,s,a){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.6;super(e,arguments.length>6&&void 0!==arguments[6]?arguments[6]:"donutTooltip");const n=(this.size-2*this.padding)/2,l=n+this.padding,d=[[ms(-90),ms(30)],[ms(30),ms(120)],[ms(120),ms(180)],[ms(180),ms(210)],[ms(210),ms(240)],[ms(240),ms(270)]];this.sectors=d.map((e=>{let[t,i]=e;const s=new r.i.Sector;return s.centerX=l,s.centerY=l,s.innerRadius=n*o,s.outerRadius=n,s.startAngle=t,s.endAngle=i,s.stroke=void 0,s.strokeWidth=0,s.inset=.75,s})),this.updateColors(t,i),this.root.append(this.sectors)}updateColors(e,t){this.sectors.forEach(((i,s)=>{i.fill=e[s%e.length],i.stroke=t[s%t.length]}))}};vs.chartType="donut";var Cs=class extends vs{constructor(e,t,i,s,r){super(e,t,i,s,r,0,"pieTooltip")}};Cs.chartType="pie";var fs=class extends es{constructor(e,t,i){super(e,"lineTooltip"),this.data=[[9,7,8,5,6],[5,6,3,4,1],[1,3,4,8,7]],this.lines=is(this.root,this.data,this.size,this.padding),this.updateColors(t,i)}updateColors(e,t){this.lines.forEach(((t,i)=>{t.stroke=e[i]}))}};fs.chartType="line";var ys=class extends es{constructor(e,t,i){super(e,"scatterTooltip");const s=this.size,a=this.padding,o=new r.i.LinearScale;o.domain=[-.5,4],o.range=[2*a,s-a];const n=new r.i.LinearScale;n.domain=[-.5,3.5],n.range=[s-a,a];const l=[];[[[.3,3],[1.1,.9],[2,.4],[3.4,2.4]],[[0,.3],[1,2],[2.4,1.4],[3,0]]].forEach((e=>{e.forEach((e=>{let[t,i]=e;const s=new r.i.Arc;s.strokeWidth=0,s.centerX=o.convert(t),s.centerY=n.convert(i),s.radius=2.5,l.push(s)}))})),this.points=l,this.updateColors(t,i);const d=new r.i.Group;d.setClipRectInGroupCoordinateSpace(new r.i.BBox(a,a,s-2*a,s-2*a)),d.append(this.points),this.root.append(d)}updateColors(e,t){this.points.forEach(((i,s)=>{i.stroke=t[s%t.length],i.fill=e[s%e.length]}))}};ys.chartType="scatter";var Ss=class extends es{constructor(e,t,i){super(e,"bubbleTooltip");const s=this.size,a=this.padding,o=new r.i.LinearScale;o.domain=[0,1],o.range=[2*a,s-a];const n=new r.i.LinearScale;n.domain=[0,1],n.range=[s-a,a];const l=[];[[[.1,.3,5],[.5,.4,7],[.2,.8,7]],[[.8,.7,5],[.7,.3,9]]].forEach((e=>{e.forEach((e=>{let[t,i,s]=e;const a=new r.i.Arc;a.strokeWidth=0,a.centerX=o.convert(t),a.centerY=n.convert(i),a.radius=s,a.fillOpacity=.7,l.push(a)}))})),this.points=l,this.updateColors(t,i);const d=new r.i.Group;d.setClipRectInGroupCoordinateSpace(new r.i.BBox(a,a,s-2*a,s-2*a)),d.append(this.points),this.root.append(d)}updateColors(e,t){this.points.forEach(((i,s)=>{i.stroke=t[s%t.length],i.fill=e[s%e.length]}))}};Ss.chartType="bubble";var Es=class e extends es{constructor(t,i,s,a,o){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e.data;super(t,"groupedAreaTooltip");const l=this.size,d=this.padding,h=new r.i.BandScale;h.domain=[0,1,2],h.paddingInner=1,h.paddingOuter=0,h.range=[d+.5,l-d-.5];const c=new r.i.LinearScale;c.domain=[0,6],c.range=[l-d+.5,d];const u=2*n.length-1,p=[],g=c.convert(0);n.forEach(((e,t)=>{const i=h.convert(t);e.forEach(((e,s)=>{const r=c.convert(e),a=p[s]||(p[s]=[]);a[t]={x:i,y:r},a[u-t]={x:i,y:g}}))})),this.areas=p.reverse().map((e=>{const t=new r.i.Path;t.strokeWidth=1,t.strokeOpacity=.75,t.fillOpacity=.7;const i=t.path;return i.clear(),e.forEach(((e,t)=>i[t>0?"lineTo":"moveTo"](e.x,e.y))),i.closePath(),t})),this.updateColors(i,s),this.root.append(this.areas)}updateColors(e,t){this.areas.forEach(((i,s)=>{i.fill=e[s],i.stroke=t[s]}))}};Es.chartType="area",Es.data=[[1,3,5],[2,6,4],[5,3,1]];var bs=Es,ws=class e extends es{constructor(t,i,s,a,o){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e.data;super(t,arguments.length>6&&void 0!==arguments[6]?arguments[6]:"stackedAreaTooltip");const l=this.size,d=this.padding,h=new r.i.BandScale;h.domain=[0,1,2],h.paddingInner=1,h.paddingOuter=0,h.range=[d+.5,l-d-.5];const c=new r.i.LinearScale;c.domain=[0,16],c.range=[l-d+.5,d+.5];const u=2*n.length-1,p=[];n.forEach(((e,t)=>{const i=h.convert(t);let s=0;e.forEach(((e,r)=>{const a=c.convert(s+e),o=p[r]||(p[r]=[]);o[t]={x:i,y:a},o[u-t]={x:i,y:c.convert(s)},s+=e}))})),this.areas=p.map((e=>{const t=new r.i.Path;t.strokeWidth=0;const i=t.path;return i.clear(),e.forEach(((e,t)=>i[t>0?"lineTo":"moveTo"](e.x,e.y))),i.closePath(),t})),this.updateColors(i,s),this.root.append(this.areas)}updateColors(e,t){this.areas.forEach(((i,s)=>{i.fill=e[s],i.stroke=t[s]}))}};ws.chartType="stackedArea",ws.data=[[2,3,2],[3,6,5],[6,2,2]];var As=ws,xs=class e extends As{constructor(t,i,s,r,a){super(t,i,s,r,a,arguments.length>5&&void 0!==arguments[5]?arguments[5]:e.data,"normalizedAreaTooltip")}};xs.chartType="normalizedArea",xs.data=As.data.map((e=>{const t=e.reduce(((e,t)=>e+t),0);return e.map((e=>e/t*16))}));var Ts=xs,Ms=class extends es{constructor(e,t,i){super(e,"histogramTooltip");const s=this.padding,a=this.size,o=[2,5,11,13,10,6,1],n=new r.i.LinearScale;n.domain=[0,o.length],n.range=[s,a-s];const l=new r.i.LinearScale;l.domain=[0,o.reduce(((e,t)=>Math.max(e,t)),0)],l.range=[a-s,s];const d=l.convert(0);this.bars=o.map(((e,t)=>{const i=l.convert(e),s=n.convert(t),a=n.convert(t+1),o=new r.i.Rect;return o.x=s,o.y=i,o.width=a-s,o.height=d-i,o.strokeWidth=1,o.strokeOpacity=.75,o.crisp=!0,o})),this.updateColors(t,i),this.root.append(this.bars)}updateColors(e,t){let[i]=e,[s]=t;this.bars.forEach((e=>{e.fill=i,e.stroke=s}))}};Ms.chartType="histogram";var Ps=class extends Qi{constructor(e,t){super(e,t),this.stroke="gray",this.showRadiusAxisLine=!0,this.showAngleAxisLines=!0}addAxes(){const e=this.size,t=this.padding,i=(e-2*t)/2,s=this.showAngleAxisLines?[i,.8*i,.6*i,.4*i]:[],a=new r.i.Line;a.x1=e/2,a.y1=t,a.x2=e/2,a.y2=e-t-i-s[s.length-1],a.stroke=this.stroke,a.strokeOpacity=.5,a.fill=void 0,a.visible=this.showRadiusAxisLine;const o=t+i;this.gridLines=s.map(((e,t)=>{const i=new r.i.Path;return i.path.arc(o,o,e,0,2*Math.PI),i.strokeWidth=1,i.stroke=this.stroke,i.strokeOpacity=0===t?.5:.2,i.fill=void 0,i}));const n=this.root;n.append(a),this.gridLines.length>0&&n.append(this.gridLines)}};Ye([s.a],Ps.prototype,"addAxes",1);var Fs=class extends Ps{constructor(e,t,i){super(e,"radialColumnTooltip"),this.data=[[6,8,10,2,6,5],[4,4,3,6,4,4],[5,4,2,9,8,9]],this.showRadiusAxisLine=!1;const{padding:s,size:a,data:o}=this,n=(a-2*s)/2,l=.4*n,d=new r.i.BandScale;d.domain=o[0].map(((e,t)=>t)),d.range=[0,2*Math.PI],d.paddingInner=0,d.paddingOuter=0;const h=.7*d.bandwidth,{processedData:c,max:u}=rs(o),p=new r.i.LinearScale;p.domain=[0,u],p.range=[l,n];const g=this.size/2;this.series=c.map(((e,t)=>{const i=0===t?void 0:c[t-1],s=new r.i.Group({zIndex:1e6}),a=e.map(((e,t)=>{const s=null==i?void 0:i[t],a=p.convert(e),o=p.convert(s??0),c=d.convert(t),u=c+h,m=r.i.getRadialColumnWidth(c,u,n,.5,.5),v=new r.i.RadialColumnShape;return v.scalingCenterX=g,v.scalingCenterY=g,v.columnWidth=m,v.innerRadius=o,v.outerRadius=a,v.startAngle=c,v.endAngle=u,v.isBeveled=!0,v.axisInnerRadius=l,v.axisOuterRadius=n,v.stroke=void 0,v.strokeWidth=0,v}));return s.append(a),s.translationX=g,s.translationY=g,s})),this.root.append(this.series),this.updateColors(t,i)}updateColors(e,t){this.series.forEach(((i,s)=>{var r;null==(r=i.children)||r.forEach((i=>{i.fill=e[s%e.length],i.stroke=t[s%t.length]}))}))}};Fs.chartType="radialColumn";var Ds=class extends Ps{constructor(e,t,i){super(e,"radialBarTooltip"),this.data=[[6,8,10],[4,4,3],[5,4,2]],this.showRadiusAxisLine=!1;const s=(this.size-this.padding)/2,a=.4*s,o=s+a,n=new r.i.BandScale;n.domain=this.data[0].map(((e,t)=>t)),n.range=[s,a],n.paddingInner=.5,n.paddingOuter=0;const l=n.bandwidth,{processedData:d,max:h}=rs(this.data),c=new r.i.LinearScale;c.domain=[0,Math.ceil(1.5*h)];const u=1.5*Math.PI,p=u+2*Math.PI;c.range=[u,p];const g=this.size/2;this.series=d.map(((e,t)=>{const i=t<0?void 0:d[t-1],s=new r.i.Group({zIndex:1e6}),a=e.map(((e,t)=>{var s;const a=null!=(s=null==i?void 0:i[t])?s:0,d=o-n.convert(t),h=d+l,u=c.convert(a),p=c.convert(e),m=new r.i.Sector;return m.centerX=g,m.centerY=g,m.innerRadius=d,m.outerRadius=h,m.startAngle=u,m.endAngle=p,m.stroke=void 0,m.strokeWidth=0,m}));return s.append(a),s})),this.root.append(this.series),this.updateColors(t,i)}updateColors(e,t){this.series.forEach(((i,s)=>{var r;null==(r=i.children)||r.forEach((i=>{i.fill=e[s%e.length],i.stroke=t[s%t.length]}))}))}};Ds.chartType="radialBar";var Rs=class extends Ps{constructor(e,t,i){super(e,"radarLineTooltip"),this.markerSize=4,this.data=[[8,7,8,7,8,8,7,8],[6,8,5,10,6,7,4,6],[0,3,3,5,4,4,2,0]],this.showRadiusAxisLine=!1;const s=(this.size-2*this.padding)/2,{paths:r,markers:a}=ss(this.root,this.data,this.size,s,0,this.markerSize);this.lines=r,this.markers=a,this.updateColors(t,i)}updateColors(e,t){this.lines.forEach(((i,s)=>{const r=this.data[s].length;i.stroke=e[s];const a=s*r,o=a+r;this.markers.slice(a,o).forEach((i=>{i.stroke=t[s],i.fill=e[s]}))}))}};Rs.chartType="radarLine";var Ls=class extends Ps{constructor(e,t,i){super(e,"radarAreaTooltip"),this.data=[[8,10,5,7,4,1,5,8],[1,1,2,7,7,8,10,1],[4,5,9,9,4,2,3,4]],this.showRadiusAxisLine=!1;const s=(this.size-2*this.padding)/2,r=s-.3*this.size;this.areas=ss(this.root,this.data,this.size,s,r).paths,this.updateColors(t,i)}updateColors(e,t){this.areas.forEach(((i,s)=>{i.fill=e[s],i.stroke=t[s]}))}};Ls.chartType="radarArea";var Is=class extends Ps{constructor(e,t,i){super(e,"nightingaleTooltip"),this.data=[[6,10,9,8,7,8],[4,6,5,4,5,5],[3,5,4,3,4,7]],this.showRadiusAxisLine=!1;const s=(this.size-2*this.padding)/2,a=new r.i.BandScale;a.domain=this.data[0].map(((e,t)=>t)),a.range=[-Math.PI,Math.PI],a.paddingInner=0,a.paddingOuter=0;const o=.7*a.bandwidth,{processedData:n,max:l}=rs(this.data),d=new r.i.LinearScale;d.domain=[0,l],d.range=[0,s];const h=this.size/2;this.series=n.map(((e,t)=>{const i=t<0?void 0:n[t-1],s=new r.i.Group({zIndex:1e6}),l=e.map(((e,t)=>{const s=null==i?void 0:i[t],n=d.convert(e),l=d.convert(s??0),c=a.convert(t),u=c+o,p=new r.i.Sector;return p.centerX=h,p.centerY=h,p.innerRadius=l,p.outerRadius=n,p.startAngle=c,p.endAngle=u,p.stroke=void 0,p.strokeWidth=0,p}));return s.append(l),s})),this.root.append(this.series),this.updateColors(t,i)}updateColors(e,t){this.series.forEach(((i,s)=>{var r;null==(r=i.children)||r.forEach((i=>{i.fill=e[s%e.length],i.stroke=t[s%t.length]}))}))}};Is.chartType="nightingale";var Os=class extends es{constructor(e,t,i){super(e,"rangeBarTooltip");this.bars=this.createRangeBar(this.root,[3,3.5,3],this.size,this.padding,"vertical"),this.updateColors(t,i)}updateColors(e,t){this.bars.forEach(((i,s)=>{i.fill=e[s],i.stroke=t[s]}))}createRangeBar(e,t,i,s,a){const o="horizontal"===a,n=2*s,l=new r.i.BandScale;l.domain=t.map(((e,t)=>t)),l.range=[s,i-s],l.paddingInner=.3,l.paddingOuter=.3;const d=new r.i.LinearScale;d.domain=[.7*t.reduce(((e,t)=>Math.min(e,t)),1/0),1.3*t.reduce(((e,t)=>Math.max(e,t)),0)],d.range=[n,i-n];const h=l.bandwidth,c=t.map(((e,t)=>{const[i,s]=[.7*e,1.3*e],a=l.convert(t),n=d.convert(i),c=d.convert(s)-n,u=new r.i.Rect;return u.x=o?n:a,u.y=o?a:n,u.width=o?c:h,u.height=o?h:c,u.strokeWidth=0,u.crisp=!0,u}));return e.append(c),c}};Os.chartType="rangeBar";var Ns=class extends es{constructor(e,t,i){super(e,"rangeAreaTooltip");const s=[ks({offset:1.5,length:4,pattern:{low:3,high:5,period:4}}),ks({offset:1.5,length:4,pattern:{low:2.25,high:4.25,period:4}}),ks({offset:3,length:4,pattern:{low:2.5,high:4.5,period:4}})],r=s.map((e=>e.map((e=>{let[t,i]=e;return{x:t,low:i-.875,high:i+.875}})))),{lines:a,areas:o}=this.createRangeArea(this.root,r,this.size,this.padding);this.lines=a,this.areas=o,this.updateColors(t,i)}updateColors(e,t){e=Vs(e,1,2),t=Vs(t,1,2),this.lines.forEach(((e,i)=>{let[s,r]=e;s.fill=void 0,s.stroke=t[i],r.fill=void 0,r.stroke=t[i]})),this.areas.forEach(((t,i)=>{t.fill=e[i]}))}createRangeArea(e,t,i,s){const a=t.reduce(((e,t)=>t.reduce(((e,t)=>{let{x:i}=t;return Math.min(e,i)}),e)),1/0),o=t.reduce(((e,t)=>t.reduce(((e,t)=>{let{x:i}=t;return Math.max(e,i)}),e)),-1/0),n=t.reduce(((e,t)=>t.reduce(((e,t)=>{let{low:i}=t;return Math.min(e,i)}),e)),1/0),l=t.reduce(((e,t)=>t.reduce(((e,t)=>{let{high:i}=t;return Math.max(e,i)}),e)),-1/0),d=new r.i.LinearScale;d.domain=[a,o],d.range=[s,i-s];const h=2*s,c=new r.i.LinearScale;c.domain=[n,l],c.range=[i-h,h];const u=[],p=[];return t.map((e=>{const t=new r.i.Path,i=new r.i.Path,s=new r.i.Path;return u.push([t,i]),p.push(s),t.strokeWidth=0,i.strokeWidth=0,s.strokeWidth=0,s.fillOpacity=.8,t.path.clear(),i.path.clear(),s.path.clear(),e.map(((e,r)=>{const{x:a,low:o,high:n}=e,l=d.convert(a),h=c.convert(o),u=c.convert(n),p=r>0?"lineTo":"moveTo";return t.path[p](l,u),i.path[p](l,h),s.path[p](l,u),[l,h]}))})).forEach(((e,t)=>{const i=e.length-1,s=p[t];for(let r=i;r>=0;r--){const[t,i]=e[r];s.path.lineTo(t,i)}})),e.append(p.concat(...u)),{lines:u,areas:p}}};function ks(e){const{offset:t,length:i,pattern:s}=e,r=function(e,t,i){const{period:s}=i,r=e/s,a=[0,.5].map((e=>e-r)).map(Gs).sort(((e,t)=>e-t));return Array.from({length:Math.floor(a.length*(s/t))},((e,t)=>a[t%a.length]+Math.floor(t/a.length))).map((e=>e*s)).map((t=>o(t,e,i)))}(t,i,s),a=i;return(0===r.length||0!==r[0][0])&&r.unshift(o(0,t,s)),r[r.length-1][0]!==a&&r.push(o(a,t,s)),r;function o(e,t,i){return[e,n(t+e,i)]}function n(e,t){const{low:i,high:s,period:r}=t,a=Gs(e/r);return i+(s-i)*(a>.5?1-2*(a-.5):2*a)}}function Gs(e){const t=e%1;return t<0?t+1:t}function Vs(e,t,i){const s=[...e],r=s[t];return s[t]=s[i],s[i]=r,s}Ns.chartType="rangeArea";var Bs=class extends es{constructor(e,t,i,s,a){super(e,"boxPlotTooltip");const o=this.padding,n=this.size,l=[11,11.5,10.5],d=new r.i.LinearScale;d.domain=[.8*l.reduce(((e,t)=>Math.min(e,t)),1/0),1.2*l.reduce(((e,t)=>Math.max(e,t)),0)],d.range=[n-1.5*o,o];const h=new r.i.BandScale;h.domain=l.map(((e,t)=>t)),h.range=[o,n-o],h.paddingInner=.4,h.paddingOuter=.2;const c=Math.round(h.bandwidth),u=Math.round(h.bandwidth/2);this.boxPlotGroups=l.map(((e,t)=>{let[i,s,a,o]=[.8*e,.9*e,1.1*e,1.2*e];const n=Math.round(d.convert(a)),l=Math.round(h.convert(t)),p=Math.round(l+c),g=Math.round(d.convert(s)),m=Math.round(d.convert(i)),v=Math.round(d.convert(e)),C=Math.round(d.convert(o)),f=l+u,y=new r.i.Group,S=new r.i.Rect,E=new r.i.Line,b=new r.i.Line,w=new r.i.Line,A=new r.i.Line,x=new r.i.Line;return S.x=l,S.y=n,S.width=c,S.height=g-n,S.strokeWidth=1,S.strokeOpacity=.75,S.crisp=!0,this.setLineProperties(E,l,p,v,v),this.setLineProperties(b,f,f,C,n),this.setLineProperties(w,f,f,m,g),this.setLineProperties(A,l,p,C,C),this.setLineProperties(x,l,p,m,m),y.append([S,E,b,w,A,x]),y})),this.updateColors(t,i,s,a),this.root.append(this.boxPlotGroups)}updateColors(e,t,i,s){var a;const o=null==i?void 0:i.properties.get(r.a.DEFAULT_BACKGROUND_COLOUR),n=null!=(a=Array.isArray(o)?o[0]:o)?a:"white";this.boxPlotGroups.forEach(((i,a)=>{var o;null==(o=i.children)||o.forEach((i=>{const o=e[a%e.length];i.fill=s?o:r.s.Color.interpolate(o,n)(.7),i.stroke=t[a%t.length]}))}))}setLineProperties(e,t,i,s,r){e.x1=t,e.x2=i,e.y1=s,e.y2=r,e.strokeOpacity=.75}};Bs.chartType="boxPlot";var _s=class extends Qi{constructor(e,t,i,s,a){super(e,"treemapTooltip");const{size:o,padding:n}=this,l=[[1,1],[3,2,1]],d=l.length%2===0?.3:.2,h=[n,o-n],c=l.length,u=c*(c+1)/2,p=d/(c-1),g=h[1]-h[0],m=g-d;let v=h[0];this.rects=l.reduce(((e,t,i)=>{e??(e=[]);const s=m*((c-i)/u),a=t.length,o=t.reduce(((e,t)=>e+t),0),n=d/(a-1||1),l=a>1?g-d:g;let C=h[0];const f=t.map((e=>{const t=new r.i.Rect,i=l*e/o;return t.x=v,t.y=C,t.width=s,t.height=i,t.strokeWidth=.75,t.crisp=!0,C+=i+n,t}));return v+=s+p,e.push(...f),e}),[]),this.updateColors(t,i,s,a);const C=new r.i.Group;C.setClipRectInGroupCoordinateSpace(new r.i.BBox(n,n,o-n,o-n)),C.append(this.rects),this.root.append(C)}updateColors(e,t,i,s){var a;const{properties:o}=i??{},n=null==o?void 0:o.get(r.a.DEFAULT_BACKGROUND_COLOUR),l=null!=(a=Array.isArray(n)?n[0]:n)?a:"white";this.rects.forEach(((i,r)=>{i.fill=e[r%t.length],i.stroke=s?t[r%t.length]:l}))}};_s.chartType="treemap";var Us=class extends Ps{constructor(e,t,i){super(e,"sunburstTooltip"),this.data=[[[],[]],[[],[]],[[],[]]],this.angleOffset=-Math.PI/2,this.innerRadiusRatio=0,this.showRadiusAxisLine=!1,this.showAngleAxisLines=!1;const{data:s,size:a,padding:o,angleOffset:n,innerRadiusRatio:l}=this,d=(a-2*o)/2,h=[n+0,n+2*Math.PI],c=Math.abs(h[1]-h[0]),u=[d*l,d],p=Math.abs(u[1]-u[0]);let g=0;const m=(e,t)=>{e.forEach((e=>{const i=t+1;g=Math.max(g,i),m(e,i)}))};m(s,0);const v=p/g,C=this.size/2,f=h[0];this.series=[];const y=(e,t,i,s,a)=>{if(!Array.isArray(e))return;const o=t+1;let n=i;e.forEach(((e,i,l)=>{let d=a;d||(d=new r.i.Group,this.series.push(d));const h=u[0]+t*v,c=u[0]+o*v,p=1/l.length,g=n,m=g+s*p,f=new r.i.Sector;f.centerX=C,f.centerY=C,f.innerRadius=h,f.outerRadius=c,f.startAngle=g,f.endAngle=m,f.stroke=void 0,f.strokeWidth=0,f.inset=.75,n=m,d.append(f),y(e,o,g,Math.abs(m-g),d)}))};y(s,0,f,c),this.root.append(this.series),this.updateColors(t,i)}updateColors(e,t){this.series.forEach(((i,s)=>{var r;null==(r=i.children)||r.forEach((i=>{i.fill=e[s%e.length],i.stroke=t[s%t.length]}))}))}};Us.chartType="sunburst";var Hs=class extends Qi{constructor(e,t,i,s,a){var o,n;super(e,"heatmapTooltip");const{size:l,padding:d}=this,h=Array.from({length:3},((e,t)=>Array.from({length:3},((e,t)=>t)))),c=h.map(((e,t)=>t)),u=new r.i.BandScale;u.domain=c,u.range=[d,l-d],u.paddingInner=.01,u.paddingOuter=.1;const p=new r.i.BandScale;p.domain=c,p.range=[d,l-d],p.paddingInner=.01,p.paddingOuter=.1;const g=null!=(o=u.bandwidth)?o:0,m=null!=(n=p.bandwidth)?n:0;this.rects=h.reduce(((e,t,i)=>{e??(e=[]);const s=t.map(((e,t)=>{const s=new r.i.Rect;return s.x=u.convert(i),s.y=p.convert(t),s.width=g,s.height=m,s.strokeWidth=0,s.crisp=!0,s}));return e.push(...s),e}),[]),this.updateColors(t,i,s,a);const v=new r.i.Group;v.setClipRectInGroupCoordinateSpace(new r.i.BBox(d,d,l-d,l-d)),v.append(this.rects),this.root.append(v)}updateColors(e,t,i,s){var a;const{properties:o}=i??{},n=null==o?void 0:o.get(r.a.DEFAULT_DIVERGING_SERIES_COLOUR_RANGE),l=null==o?void 0:o.get(r.a.DEFAULT_BACKGROUND_COLOUR),d=null!=(a=Array.isArray(l)?l[0]:l)?a:"white",h=s?[e[0],e[1]]:n,c=s?t[0]:d;this.rects.forEach(((e,t)=>{e.fill=r.s.Color.interpolate(h[0],h[1])(.2*t),e.stroke=c}))}};Hs.chartType="heatmap";var Ws=class extends es{constructor(e,t,i,s,r){super(e,"waterfallTooltip"),this.data=[4,3,-3,6,-3],this.bars=this.createWaterfall(this.root,this.data,this.size,this.padding,"vertical").bars,this.updateColors(t,i,s,r)}updateColors(e,t,i,s){var a,o;const{data:n}=this,{properties:l}=i??{},d={fill:e[0],stroke:t[0]},h={fill:e[1],stroke:t[1]},c=s?d:null!=(a=null==l?void 0:l.get(r.a.DEFAULT_WATERFALL_SERIES_POSITIVE_COLOURS))?a:d,u=s?h:null!=(o=null==l?void 0:l.get(r.a.DEFAULT_WATERFALL_SERIES_NEGATIVE_COLOURS))?o:h;this.bars.forEach(((e,t)=>{const i=n[t]>=0;e.fill=i?c.fill:u.fill,e.stroke=i?c.stroke:u.stroke}))}createWaterfall(e,t,i,s,a){const o=2*s,{processedData:n,min:l,max:d}=rs(t.map((e=>[e]))),h=n.reduce(((e,t)=>e.concat(t)),[]),c=new r.i.LinearScale;c.domain=[Math.min(l,0),d],c.range=[i-o,o];const u=new r.i.BandScale;u.domain=t.map(((e,t)=>t)),u.range=[s,i-s],u.paddingInner=.2,u.paddingOuter=.3;const p=u.bandwidth,g=new r.i.Path;g.stroke="#575757",g.strokeWidth=0;const m=Math.floor(g.strokeWidth)%2/2,v=g.path;v.clear();const C="horizontal"===a,f=h.map(((e,i)=>{const s=i>0?h[i-1]:0,a=t[i]>0,o=Math.round(c.convert(e)),n=Math.round(c.convert(s)),l=(a?o:n)-m,d=(a?n:o)+m,g=Math.abs(d-l),f=u.convert(i),y=new r.i.Rect;y.x=C?l:f,y.y=C?f:l,y.width=C?g:p,y.height=C?p:g,y.strokeWidth=0,y.crisp=!0;const S=o+m,E=n+m;if(i>0){const e=C?E:y.x,t=C?y.y:E;v.lineTo(e,t)}const b=C?S:y.x,w=C?y.y:S;return v.moveTo(b,w),y}));return e.append([g,...f]),{bars:f}}};Ws.chartType="waterfall";var Ks=class extends es{constructor(e,t,i){super(e,"columnLineComboTooltip"),this.columnData=[3,4],this.lineData=[[5,4,6,5,4]];const{root:s,columnData:r,lineData:a,size:o,padding:n}=this;this.columns=ts({stacked:!1,root:s,data:r,size:o,padding:n,xScaleDomain:[0,1],yScaleDomain:[0,4],xScalePadding:.5}),s.append(this.columns),this.lines=is(s,a,o,n),this.updateColors(t,i)}updateColors(e,t){this.columns.forEach(((i,s)=>{i.fill=e[s],i.stroke=t[s]})),this.lines.forEach(((t,i)=>{t.stroke=e[i+2]}))}};Ks.chartType="columnLineCombo";var zs=class extends es{constructor(e,t,i){super(e,"areaColumnComboTooltip"),this.columnData=[3,4.5],this.areaData=[[5,4,6,5,4]];const{root:s,columnData:a,areaData:o,size:n,padding:l}=this;this.columns=ts({stacked:!1,root:s,data:a,size:n,padding:l,xScaleDomain:[0,1],yScaleDomain:[0,6],xScalePadding:.5});const d=new r.i.BandScale;d.range=[l,n-l],d.domain=[0,1,2,3,4],d.paddingInner=1,d.paddingOuter=0;const h=new r.i.LinearScale;h.range=[n-l,l],h.domain=[0,6];const c=[],u=h.convert(0),p=d.convert(0);o.forEach(((e,t)=>{const i=c[t]||(c[t]=[]);e.forEach(((e,t)=>{const s=e,r=t,a=d.convert(r),o=h.convert(s);i[t]={x:a,y:o}}));const s=d.convert(e.length-1);c[t].push({x:s,y:u},{x:p,y:u})})),this.areas=c.map((e=>{const t=new r.i.Path;t.strokeWidth=0,t.fillOpacity=.8;const i=t.path;return e.forEach(((e,t)=>i[t>0?"lineTo":"moveTo"](e.x,e.y))),t})),s.append(this.areas),s.append([].concat.apply([],this.columns)),this.updateColors(t,i)}updateColors(e,t){this.areas.forEach(((i,s)=>{i.fill=e[s],i.stroke=t[s]})),this.columns.forEach(((i,s)=>{i.fill=e[s+1],i.stroke=t[s+1]}))}};zs.chartType="areaColumnCombo";var $s=class extends Qi{constructor(e,t,i){super(e,"customComboTooltip"),this.columnData=[3,4],this.lineData=[[5,4,6,5,4]];const{root:s,columnData:a,lineData:o,size:n,padding:l}=this;this.columns=ts({stacked:!1,root:s,data:a,size:n,padding:l,xScaleDomain:[0,1],yScaleDomain:[0,4],xScalePadding:.5}),s.append(this.columns),this.lines=is(s,o,n,l);const d="grey",h=new r.i.Line;h.x1=l,h.y1=l,h.x2=l,h.y2=n-l+3,h.stroke=d;const c=new r.i.Line;c.x1=l-3+1,c.y1=n-l,c.x2=n-l+1,c.y2=n-l,c.stroke=d;const u=new r.i.Path;this.buildPenIconPath(u),u.fill="whitesmoke",u.stroke="darkslategrey",u.strokeWidth=1,s.append([c,h,u]),this.updateColors(t,i)}updateColors(e,t){this.columns.forEach(((i,s)=>{i.fill=e[s],i.stroke=t[s]})),this.lines.forEach(((t,i)=>{t.stroke=e[i+2]}))}buildPenIconPath(e){const{path:t}=e;t.moveTo(25.76,43.46),t.lineTo(31.27,48.53),t.moveTo(49.86,22),t.lineTo(49.86,22),t.cubicCurveTo(49.01994659053345,21.317514933510974,47.89593834348529,21.09645997825817,46.86,21.41),t.lineTo(46.86,21.41),t.cubicCurveTo(45.55460035985361,21.77260167850787,44.38777081121966,22.517979360321792,43.51,23.55),t.lineTo(25.51,43.8),t.lineTo(25.43,43.89),t.lineTo(23.01,51.89),t.lineTo(22.83,52.46),t.lineTo(31.02,48.86),t.lineTo(49.02,28.52),t.lineTo(49.02,28.52),t.cubicCurveTo(49.940716461596224,27.521914221246085,50.54302631059587,26.2720342455763,50.75,24.93),t.lineTo(50.75,24.93),t.cubicCurveTo(50.95363374988308,23.866379846512814,50.62080640232334,22.77066734274871,49.86,22),t.closePath(),t.moveTo(41.76,25.5),t.lineTo(47.34,30.5),t.moveTo(40.74,26.65),t.lineTo(46.25,31.71)}};$s.chartType="customCombo";var js={columnGroup:{column:{range:!0,pivot:!0,enterprise:!1,icon:as},stackedColumn:{range:!0,pivot:!0,enterprise:!1,icon:ns},normalizedColumn:{range:!0,pivot:!0,enterprise:!1,icon:ds}},barGroup:{bar:{range:!0,pivot:!0,enterprise:!1,icon:hs},stackedBar:{range:!0,pivot:!0,enterprise:!1,icon:us},normalizedBar:{range:!0,pivot:!0,enterprise:!1,icon:gs}},pieGroup:{pie:{range:!0,pivot:!0,enterprise:!1,icon:Cs},donut:{range:!0,pivot:!0,enterprise:!1,icon:vs},doughnut:{range:!0,pivot:!0,enterprise:!1,icon:vs}},lineGroup:{line:{range:!0,pivot:!0,enterprise:!1,icon:fs}},scatterGroup:{scatter:{range:!0,pivot:!0,enterprise:!1,icon:ys},bubble:{range:!0,pivot:!0,enterprise:!1,icon:Ss}},areaGroup:{area:{range:!0,pivot:!0,enterprise:!1,icon:bs},stackedArea:{range:!0,pivot:!0,enterprise:!1,icon:As},normalizedArea:{range:!0,pivot:!0,enterprise:!1,icon:Ts}},polarGroup:{radarLine:{range:!0,pivot:!1,enterprise:!0,icon:Rs},radarArea:{range:!0,pivot:!1,enterprise:!0,icon:Ls},nightingale:{range:!0,pivot:!1,enterprise:!0,icon:Is},radialColumn:{range:!0,pivot:!1,enterprise:!0,icon:Fs},radialBar:{range:!0,pivot:!1,enterprise:!0,icon:Ds}},statisticalGroup:{boxPlot:{range:!0,pivot:!1,enterprise:!0,icon:Bs},histogram:{range:!0,pivot:!1,enterprise:!1,icon:Ms},rangeBar:{range:!0,pivot:!1,enterprise:!0,icon:Os},rangeArea:{range:!0,pivot:!1,enterprise:!0,icon:Ns}},hierarchicalGroup:{treemap:{range:!0,pivot:!0,enterprise:!0,icon:_s},sunburst:{range:!0,pivot:!0,enterprise:!0,icon:Us}},specializedGroup:{heatmap:{range:!0,pivot:!1,enterprise:!0,icon:Hs},waterfall:{range:!0,pivot:!1,enterprise:!0,icon:Ws}},combinationGroup:{columnLineCombo:{range:!0,pivot:!0,enterprise:!1,icon:Ks},areaColumnCombo:{range:!0,pivot:!0,enterprise:!1,icon:zs},customCombo:{range:!0,pivot:!0,enterprise:!1,icon:$s}}},Ys={columnGroup:["column","stackedColumn","normalizedColumn"],barGroup:["bar","stackedBar","normalizedBar"],pieGroup:["pie","donut"],lineGroup:["line"],scatterGroup:["scatter","bubble"],areaGroup:["area","stackedArea","normalizedArea"],polarGroup:["radarLine","radarArea","nightingale","radialColumn","radialBar"],statisticalGroup:["boxPlot","histogram","rangeBar","rangeArea"],hierarchicalGroup:["treemap","sunburst"],specializedGroup:["heatmap","waterfall"],combinationGroup:["columnLineCombo","areaColumnCombo","customCombo"]},qs=class e extends s.ak{constructor(t,i,s,r,a){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Ys;super(e.TEMPLATE),this.wrappers={},this.chartController=t,this.fills=i,this.strokes=s,this.themeTemplateParameters=r,this.isCustomTheme=a,this.chartGroups=ze({},o)}init(){const e=this.getGui(),t=this.chartController.isEnterprise(),i=this.chartController.isPivotChart(),r=!i,a=Object.keys(this.chartGroups).map((e=>{var a;const o=e in js?js[e]:void 0;if(!o)return s.ch.warnOnce(`invalid chartGroupsDef config '${e}'`),null;const n=(null!=(a=this.chartGroups[e])?a:[]).map((a=>{const n=a in o?o[a]:void 0;return n?!t&&n.enterprise?null:r&&n.range||i&&n.pivot?n:null:(s.ch.warnOnce(`invalid chartGroupsDef config '${e}.${a}'`),null)})).filter((e=>null!=e));return 0===n.length?null:{label:this.chartTranslationService.translate(e),items:n}})).filter((e=>null!=e));for(const{label:o,items:n}of a){const t=this.createBean(new s.o({title:o,suppressEnabledCheckbox:!0,enabled:!0,suppressOpenCloseIcons:!0,cssIdentifier:"charts-settings",direction:"horizontal"}));for(const e of n){const i=e.icon,s=document.createElement("div");s.classList.add("ag-chart-mini-thumbnail");const r=i.chartType;this.addManagedListener(s,"click",(()=>{this.chartController.setChartType(r),this.updateSelectedMiniChart()})),this.wrappers[r]=s,this.createBean(new i(s,this.fills,this.strokes,this.themeTemplateParameters,this.isCustomTheme)),t.addItem(s)}e.appendChild(t.getGui())}!this.chartController.customComboExists()&&this.chartGroups.combinationGroup&&(this.chartGroups.combinationGroup=this.chartGroups.combinationGroup.filter((e=>"customCombo"!==e))),this.updateSelectedMiniChart()}updateSelectedMiniChart(){const e=this.chartController.getChartType();for(const t in this.wrappers){const i=t===e;this.wrappers[t].classList.toggle("ag-selected",i)}}};qs.TEMPLATE='<div class="ag-chart-settings-mini-wrapper"></div>',Ye([(0,s.A)("chartTranslationService")],qs.prototype,"chartTranslationService",2),Ye([s.a],qs.prototype,"init",1);var Xs=qs,Zs=class e extends s.ak{constructor(t){super(e.TEMPLATE),this.chartController=t,this.miniChartsContainers=[],this.cardItems=[],this.activePaletteIndex=0,this.palettes=[],this.themes=[]}postConstruct(){this.resetPalettes(),this.ePrevBtn.insertAdjacentElement("afterbegin",s.ch.createIconNoSpan("previous",this.gridOptionsService)),this.eNextBtn.insertAdjacentElement("afterbegin",s.ch.createIconNoSpan("next",this.gridOptionsService)),this.addManagedListener(this.ePrevBtn,"click",(()=>this.setActivePalette(this.getPrev(),"left"))),this.addManagedListener(this.eNextBtn,"click",(()=>this.setActivePalette(this.getNext(),"right"))),this.addManagedListener(this.chartController,Bt.EVENT_CHART_TYPE_CHANGED,(()=>this.resetPalettes(!0))),this.addManagedListener(this.chartController,Bt.EVENT_CHART_API_UPDATE,(()=>this.resetPalettes(!0))),this.scrollSelectedIntoView()}scrollSelectedIntoView(){setTimeout((()=>{const e=this.miniChartsContainers.find((e=>!e.getGui().classList.contains("ag-hidden"))).getGui().querySelector(".ag-selected");if(e){const t=e.offsetParent;t&&this.eMiniChartsContainer.scrollTo(0,t.offsetTop)}}),250)}resetPalettes(e){var t,i;const r=this.chartController.getPalettes(),a=this.chartController.getThemeTemplateParameters(),o=null==(i=null==(t=this.gridOptionsService.get("chartToolPanelsDef"))?void 0:t.settingsPanel)?void 0:i.chartGroupsDef;if(s.ch.shallowCompare(r,this.palettes)&&!e||this.isAnimating)return;this.palettes=r,this.themes=this.chartController.getThemeNames(),this.activePaletteIndex=this.themes.findIndex((e=>e===this.chartController.getChartThemeName())),this.cardItems=[],s.ch.clearElement(this.eCardSelector),this.destroyMiniCharts();const{themes:n}=this;this.palettes.forEach(((e,t)=>{const i=this.activePaletteIndex===t,{fills:s,strokes:r}=e,l=!Tt(n[t]),d=this.createBean(new Xs(this.chartController,s,r,a[t],l,o));this.miniChartsContainers.push(d),this.eMiniChartsContainer.appendChild(d.getGui()),this.addCardLink(t),i?d.updateSelectedMiniChart():d.setDisplayed(!1)})),s.ch.setDisplayed(this.eNavBar,this.palettes.length>1),s.ch.radioCssClass(this.cardItems[this.activePaletteIndex],"ag-selected","ag-not-selected")}addCardLink(e){const t=document.createElement("div");t.classList.add("ag-chart-settings-card-item"),this.addManagedListener(t,"click",(()=>{this.setActivePalette(e,e<this.activePaletteIndex?"left":"right")})),this.eCardSelector.appendChild(t),this.cardItems.push(t)}getPrev(){let e=this.activePaletteIndex-1;return e<0&&(e=this.palettes.length-1),e}getNext(){let e=this.activePaletteIndex+1;return e>=this.palettes.length&&(e=0),e}setActivePalette(e,t){if(this.isAnimating||this.activePaletteIndex===e)return;s.ch.radioCssClass(this.cardItems[e],"ag-selected","ag-not-selected");const i=this.miniChartsContainers[this.activePaletteIndex],r=i.getGui(),a=this.miniChartsContainers[e],o=a.getGui();i.updateSelectedMiniChart(),a.updateSelectedMiniChart();const n="left"===t?-1:1,l=o.style.left=s.ch.getAbsoluteWidth(this.getGui())*n+"px";this.activePaletteIndex=e,this.isAnimating=!0;const d="ag-animating";a.setDisplayed(!0),i.addCssClass(d),a.addCssClass(d),this.chartController.setChartThemeName(this.themes[e]),window.setTimeout((()=>{r.style.left=-parseFloat(l)+"px",o.style.left="0px"}),0),window.setTimeout((()=>{this.isAnimating=!1,i.removeCssClass(d),a.removeCssClass(d),i.setDisplayed(!1)}),300)}destroyMiniCharts(){s.ch.clearElement(this.eMiniChartsContainer),this.miniChartsContainers=this.destroyBeans(this.miniChartsContainers)}destroy(){this.destroyMiniCharts(),super.destroy()}};Zs.TEMPLATE='<div class="ag-chart-settings-wrapper">\n            <div ref="eMiniChartsContainer" class="ag-chart-settings-mini-charts-container ag-scrollable-container"></div>\n            <div ref="eNavBar" class="ag-chart-settings-nav-bar">\n                <div ref="ePrevBtn" class="ag-chart-settings-prev">\n                    <button type="button" class="ag-button ag-chart-settings-prev-button"></button>\n                </div>\n                <div ref="eCardSelector" class="ag-chart-settings-card-selector"></div>\n                <div ref="eNextBtn" class="ag-chart-settings-next">\n                    <button type="button" class="ag-button ag-chart-settings-next-button"></button>\n                </div>\n            </div>\n        </div>',Ye([(0,s.R)("eMiniChartsContainer")],Zs.prototype,"eMiniChartsContainer",2),Ye([(0,s.R)("eNavBar")],Zs.prototype,"eNavBar",2),Ye([(0,s.R)("eCardSelector")],Zs.prototype,"eCardSelector",2),Ye([(0,s.R)("ePrevBtn")],Zs.prototype,"ePrevBtn",2),Ye([(0,s.R)("eNextBtn")],Zs.prototype,"eNextBtn",2),Ye([s.a],Zs.prototype,"postConstruct",1);var Js=Zs,Qs=class e extends s.ak{constructor(e,t){super(),this.panels=e,this.chartMenuContext=t,this.tabs=[]}init(){this.panels.forEach((e=>{const t=e.replace("chart","").toLowerCase(),i=this.createPanel(t),s=this.createTab(e,t,i);this.tabs.push(s),this.addDestroyFunc((()=>this.destroyBean(i)))})),this.tabbedLayout=new s.b_({items:this.tabs,cssClass:"ag-chart-tabbed-menu",keepScrollPosition:!0,suppressFocusBodyOnOpen:!0,suppressTrapFocus:!0,enableCloseButton:!this.chartMenuService.isLegacyFormat(),closeButtonAriaLabel:this.chartTranslationService.translate("ariaChartMenuClose"),onCloseClicked:()=>{var t;null==(t=this.eventSource)||t.focus({preventScroll:!0}),this.dispatchEvent({type:e.EVENT_CLOSED})}}),this.getContext().createBean(this.tabbedLayout)}createTab(e,t,i){const r=document.createElement("div");r.classList.add("ag-chart-tab",`ag-chart-${t}`),this.getContext().createBean(i),r.appendChild(i.getGui());const a=document.createElement("div"),o=this.chartTranslationService.translate(t);return a.innerText=o,{title:a,titleLabel:o,bodyPromise:s.D.resolve(r),getScrollableContainer:()=>r.querySelector(".ag-scrollable-container")||r,name:e}}showTab(e){const t=this.tabs[e];this.tabbedLayout.showItem(t)}getGui(){return this.tabbedLayout&&this.tabbedLayout.getGui()}showMenu(e,t){var i;this.eventSource=e,t||null==(i=this.tabbedLayout)||i.focusHeader(!0)}destroy(){this.parentComponent&&this.parentComponent.isAlive()&&this.destroyBean(this.parentComponent),super.destroy()}createPanel(t){const{chartController:i,chartOptionsService:s}=this.chartMenuContext;switch(t){case e.TAB_DATA:return new ti(i,s);case e.TAB_FORMAT:return new Ji(this.chartMenuContext);default:return new Js(i)}}};Qs.EVENT_CLOSED="closed",Qs.TAB_DATA="data",Qs.TAB_FORMAT="format",Ye([(0,s.A)("chartTranslationService")],Qs.prototype,"chartTranslationService",2),Ye([(0,s.A)("chartMenuService")],Qs.prototype,"chartMenuService",2),Ye([s.a],Qs.prototype,"init",1);var er=Qs,tr=class extends s.ak{constructor(){super('<div class="ag-chart-menu" ref="eMenu"></div>'),this.buttonListenersDestroyFuncs=[]}updateParams(e){const{buttons:t}=e;this.createButtons(t)}createButtons(e){this.buttonListenersDestroyFuncs.forEach((e=>null==e?void 0:e())),this.buttonListenersDestroyFuncs=[];const t=this.eMenu;s.ch.clearElement(t),e.forEach((e=>{const{buttonName:i,iconName:s,callback:r}=e,a=this.createButton(s),o=this.chartTranslationService.translate(i+"ToolbarTooltip");o&&a instanceof HTMLElement&&(a.title=o),this.buttonListenersDestroyFuncs.push(this.addManagedListener(a,"click",(e=>r(e.target)))),t.appendChild(a)}))}createButton(e){let t=s.ch.createIconNoSpan(e,this.gridOptionsService,void 0,!0);return t.classList.add("ag-chart-menu-icon"),this.chartMenuService.isLegacyFormat()||(t=this.wrapButton(t)),t}wrapButton(e){const t=this.gridOptionsService.getDocument().createElement("button");return t.appendChild(e),t.classList.add("ag-chart-menu-toolbar-button"),t}destroy(){this.buttonListenersDestroyFuncs=[],super.destroy()}};Ye([(0,s.A)("chartTranslationService")],tr.prototype,"chartTranslationService",2),Ye([(0,s.A)("chartMenuService")],tr.prototype,"chartMenuService",2),Ye([(0,s.R)("eMenu")],tr.prototype,"eMenu",2);var ir=class e extends s.ak{constructor(t,i,s){super(e.TEMPLATE),this.eChartContainer=t,this.eMenuPanelContainer=i,this.chartMenuContext=s,this.buttons={chartSettings:{iconName:"menu",callback:()=>this.showMenu({panel:this.defaultPanel})},chartData:{iconName:"menu",callback:()=>this.showMenu({panel:"chartData"})},chartFormat:{iconName:"menu",callback:()=>this.showMenu({panel:"chartFormat"})},chartLink:{iconName:"linked",callback:()=>this.chartMenuService.toggleLinked(this.chartMenuContext)},chartUnlink:{iconName:"unlinked",callback:()=>this.chartMenuService.toggleLinked(this.chartMenuContext)},chartDownload:{iconName:"save",callback:()=>this.chartMenuService.downloadChart(this.chartMenuContext)},chartMenu:{iconName:"menuAlt",callback:e=>this.showMenuList(e)}},this.panels=[],this.menuVisible=!1,this.chartController=s.chartController}postConstruct(){this.legacyFormat=this.chartMenuService.isLegacyFormat(),this.chartToolbar=this.createManagedBean(new tr),this.getGui().appendChild(this.chartToolbar.getGui()),this.legacyFormat&&this.createLegacyToggleButton(),this.refreshToolbarAndPanels(),this.addManagedListener(this.eventService,s.aA.EVENT_CHART_CREATED,(e=>{var t;e.chartId===this.chartController.getChartId()&&null!=(t=this.gridOptionsService.get("chartToolPanelsDef"))&&t.defaultToolPanel&&this.showMenu({panel:this.defaultPanel,animate:!1,suppressFocus:!0})})),this.addManagedListener(this.chartController,Bt.EVENT_CHART_LINKED_CHANGED,this.refreshToolbarAndPanels.bind(this)),this.refreshMenuClasses(),this.legacyFormat&&!this.gridOptionsService.get("suppressChartToolPanelsButton")&&this.panels.length>0&&(this.getGui().classList.add("ag-chart-tool-panel-button-enable"),this.eHideButton&&this.addManagedListener(this.eHideButton,"click",this.toggleMenu.bind(this))),this.legacyFormat||this.getGui().classList.add("ag-chart-menu-wrapper"),this.addManagedListener(this.chartController,Bt.EVENT_CHART_API_UPDATE,this.refreshToolbarAndPanels.bind(this))}isVisible(){return this.menuVisible}getExtraPaddingDirections(){const e=[];return["chartMenu","chartLink","chartUnlink","chartDownload"].some((e=>this.chartToolbarOptions.includes(e)))&&e.push("top"),["chartSettings","chartData","chartFormat"].some((e=>this.chartToolbarOptions.includes(e)))&&e.push(this.gridOptionsService.get("enableRtl")?"left":"right"),e}createLegacyToggleButton(){const e=this.gridOptionsService.getDocument();this.eHideButton=e.createElement("button"),this.eHideButton.classList.add("ag-button","ag-chart-menu-close"),this.eHideButtonIcon=e.createElement("span"),this.eHideButtonIcon.classList.add("ag-icon","ag-icon-contracted"),this.eHideButton.appendChild(this.eHideButtonIcon),this.getGui().appendChild(this.eHideButton)}refreshToolbarAndPanels(){this.initToolbarOptionsAndPanels(),this.updateToolbar()}initToolbarOptionsAndPanels(){const{panels:e,defaultPanel:t,chartToolbarOptions:i}=this.chartMenuService.getToolbarOptionsAndPanels(this.chartController);this.panels=e,this.defaultPanel=t,this.chartToolbarOptions=i}updateToolbar(){const e=this.chartToolbarOptions.map((e=>{const{iconName:t,callback:i}=this.buttons[e];return{buttonName:e,iconName:t,callback:i}}));this.chartToolbar.updateParams({buttons:e})}createMenuPanel(e){const t=this.environment.chartMenuPanelWidth(),i=this.menuPanel=this.createBean(new s.y({minWidth:t,width:t,height:"100%",closable:!0,hideTitleBar:!0,cssIdentifier:"chart-menu"}));return i.setParentComponent(this),this.eMenuPanelContainer.appendChild(i.getGui()),this.tabbedMenu=this.createBean(new er(this.panels,this.chartMenuContext)),this.addManagedListener(this.tabbedMenu,er.EVENT_CLOSED,(()=>{this.hideMenu(!1)})),this.addManagedListener(i,s.ak.EVENT_DESTROYED,(()=>this.destroyBean(this.tabbedMenu))),new s.D((t=>{window.setTimeout((()=>{i.setBodyComponent(this.tabbedMenu),this.tabbedMenu.showTab(e),t(i),this.legacyFormat&&this.addManagedListener(this.eChartContainer,"click",(e=>{this.getGui().contains(e.target)||this.menuVisible&&this.hideMenu()}))}),100)}))}showContainer(e,t){this.menuPanel&&(this.menuVisible=!0,this.showParent(this.menuPanel.getWidth()),this.refreshMenuClasses(),this.tabbedMenu.showMenu(e,t))}toggleMenu(){this.menuVisible?this.hideMenu(this.legacyFormat):this.showMenu({animate:this.legacyFormat})}showMenu(e){const{panel:t,animate:i=!0,eventSource:s,suppressFocus:r}=e;if(i||this.eMenuPanelContainer.classList.add("ag-no-transition"),this.menuPanel&&!t)this.showContainer(s,r);else{const e=t||this.defaultPanel;let i=this.panels.indexOf(e);i<0&&(console.warn(`AG Grid: '${t}' is not a valid Chart Tool Panel name`),i=this.panels.indexOf(this.defaultPanel)),this.menuPanel?(this.tabbedMenu.showTab(i),this.showContainer(s,r)):this.createMenuPanel(i).then((()=>this.showContainer(s,r)))}i||setTimeout((()=>{this.isAlive()&&this.eMenuPanelContainer.classList.remove("ag-no-transition")}),500)}hideMenu(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e||this.eMenuPanelContainer.classList.add("ag-no-transition"),this.hideParent(),window.setTimeout((()=>{this.menuVisible=!1,this.refreshMenuClasses(),e||this.eMenuPanelContainer.classList.remove("ag-no-transition")}),500)}refreshMenuClasses(){this.eChartContainer.classList.toggle("ag-chart-menu-visible",this.menuVisible),this.eChartContainer.classList.toggle("ag-chart-menu-hidden",!this.menuVisible),this.legacyFormat&&!this.gridOptionsService.get("suppressChartToolPanelsButton")&&(this.eHideButtonIcon.classList.toggle("ag-icon-contracted",this.menuVisible),this.eHideButtonIcon.classList.toggle("ag-icon-expanded",!this.menuVisible))}showParent(e){this.eMenuPanelContainer.style.minWidth=`${e}px`}hideParent(){this.eMenuPanelContainer.style.minWidth="0"}showMenuList(e){this.chartMenuListFactory.showMenuList({eventSource:e,showMenu:()=>this.showMenu({animate:!1,eventSource:e}),chartMenuContext:this.chartMenuContext})}destroy(){super.destroy(),this.menuPanel&&this.menuPanel.isAlive()&&this.destroyBean(this.menuPanel),this.tabbedMenu&&this.tabbedMenu.isAlive()&&this.destroyBean(this.tabbedMenu)}};ir.TEMPLATE="<div></div>",Ye([(0,s.A)("chartMenuService")],ir.prototype,"chartMenuService",2),Ye([(0,s.A)("chartMenuListFactory")],ir.prototype,"chartMenuListFactory",2),Ye([s.a],ir.prototype,"postConstruct",1);var sr=ir,rr=class e extends s.ak{constructor(t){super(e.TEMPLATE),this.chartMenu=t,this.destroyableChartListeners=[],this.editing=!1}init(){this.addManagedListener(this.getGui(),"keydown",(e=>{this.editing&&"Enter"===e.key&&!e.shiftKey&&(this.handleEndEditing(),e.preventDefault())})),this.addManagedListener(this.getGui(),"input",(()=>{this.editing&&this.updateHeight()})),this.addManagedListener(this.getGui(),"blur",(()=>this.endEditing()))}refreshTitle(e){this.chartController=e.chartController,this.chartOptionsService=e.chartOptionsService,this.chartMenuUtils=e.chartMenuParamsFactory.getChartOptions();for(const o of this.destroyableChartListeners)o();this.destroyableChartListeners=[];const t=this.chartController.getChartProxy().getChart(),i=t.scene.canvas.element,s=this.addManagedListener(i,"dblclick",(e=>{const{title:s}=t;if(s&&s.node.containsPoint(e.offsetX,e.offsetY)){const e=s.node.computeBBox(),t=s.node.inverseTransformPoint(e.x,e.y);this.startEditing(ze(ze({},e),t),i.width)}}));let r=!1;const a=this.addManagedListener(i,"mousemove",(e=>{const{title:s}=t,a=!!(s&&s.enabled&&s.node.containsPoint(e.offsetX,e.offsetY));r!==a&&(i.style.cursor=a?"pointer":""),r=a}));this.destroyableChartListeners=[s,a]}startEditing(e,t){if(this.chartMenuService.isLegacyFormat()&&this.chartMenu&&this.chartMenu.isVisible()||this.editing)return;this.editing=!0;const i=Math.max(Math.min(e.width+20,t),300),s=this.getGui();s.classList.add("currently-editing");const r=s.style;r.fontFamily=this.chartMenuUtils.getValue("title.fontFamily"),r.fontWeight=this.chartMenuUtils.getValue("title.fontWeight"),r.fontStyle=this.chartMenuUtils.getValue("title.fontStyle"),r.fontSize=this.chartMenuUtils.getValue("title.fontSize")+"px",r.color=this.chartMenuUtils.getValue("title.color");const a=this.chartMenuUtils.getValue("title.text"),o=a===this.chartTranslationService.translate("titlePlaceholder");s.value=o?"":a;const n=a.split(/\r?\n/g).length;r.left=Math.round(e.x+e.width/2-i/2-1)+"px",r.top=Math.round(e.y+e.height/2-n*this.getLineHeight()/2-2)+"px",r.width=Math.round(i)+"px",r.lineHeight=this.getLineHeight()+"px",this.updateHeight(),s.focus()}updateHeight(){const e=this.getGui(),t=this.chartMenuUtils.getValue("title.text").split(/\r?\n/g).length,i=e.value.split(/\r?\n/g).length;e.style.height=Math.round(Math.max(t,i)*this.getLineHeight())+4+"px"}getLineHeight(){const e=this.chartMenuUtils.getValue("title.lineHeight");return e?parseInt(e):Math.round(1.2*parseInt(this.chartMenuUtils.getValue("title.fontSize")))}handleEndEditing(){const e=this.chartMenuUtils.getValue("title.color");this.chartMenuUtils.setValue("title.color","rgba(0, 0, 0, 0)"),this.chartOptionsService.awaitChartOptionUpdate((()=>this.endEditing())),this.chartOptionsService.awaitChartOptionUpdate((()=>{this.chartMenuUtils.setValue("title.color",e)}))}endEditing(){if(!this.editing)return;this.editing=!1;const e=this.getGui().value;e&&""!==e.trim()?(this.chartMenuUtils.setValue("title.text",e),this.chartMenuUtils.setValue("title.enabled",!0)):(this.chartMenuUtils.setValue("title.text",""),this.chartMenuUtils.setValue("title.enabled",!1)),this.getGui().classList.remove("currently-editing"),this.chartOptionsService.awaitChartOptionUpdate((()=>{this.eventService.dispatchEvent({type:"chartTitleEdit"})}))}};rr.TEMPLATE='<textarea\n             class="ag-chart-title-edit"\n             style="padding:0; border:none; border-radius: 0; min-height: 0; text-align: center; resize: none;" />\n        ',Ye([(0,s.A)("chartTranslationService")],rr.prototype,"chartTranslationService",2),Ye([(0,s.A)("chartMenuService")],rr.prototype,"chartMenuService",2),Ye([s.a],rr.prototype,"init",1);var ar=rr;function or(e){return null!=e.chart?e.chart:e}var nr=class{constructor(e){this.chartProxyParams=e,this.clearThemeOverrides=!1,this.isEnterpriseCharts=r.m.enterpriseModule.isEnterprise,this.chart=e.chartInstance,this.chartType=e.chartType,this.crossFiltering=e.crossFiltering,this.crossFilterCallback=e.crossFilterCallback,this.standaloneChartType=dt(this.chartType),null==this.chart?this.chart=r.c.create(this.getCommonChartOptions()):this.clearThemeOverrides=!0}updateThemeOverrides(e){r.c.updateDelta(this.getChartRef(),{theme:{overrides:e}})}getChart(){return or(this.chart)}getChartRef(){return this.chart}downloadChart(e,t,i){const{chart:s}=this,a=or(s),o=t||(a.title?a.title.text:"chart"),{width:n,height:l}=e||{};r.c.download(s,{width:n,height:l,fileName:o,fileFormat:i})}getChartImageDataURL(e){return this.getChart().scene.getDataURL(e)}getChartOptions(){return this.chart.getOptions()}getChartThemeOverrides(){var e;return null!=(e=this.getChartOptions().theme.overrides)?e:{}}getChartPalette(){return r.a.getChartTheme(this.getChartOptions().theme).palette}setPaired(e){const t=dt(this.chartProxyParams.chartType);r.c.updateDelta(this.chart,{theme:{overrides:{[t]:{paired:e}}}})}isPaired(){const e=dt(this.chartProxyParams.chartType);return At(this.getChartThemeOverrides(),`${e}.paired`,!0)}lookupCustomChartTheme(e){return Ft(this.chartProxyParams,e)}transformData(e,t,i){return i?e.map(((e,i)=>{const s=e[t],r=s&&s.toString?s.toString():"",a=ze({},e);return a[t]={id:i,value:s,toString:()=>r},a})):e}getCommonChartOptions(e){var t,i;const s=this.clearThemeOverrides?{}:null!=(i=null==(t=this.chart)?void 0:t.getOptions())?i:{},r=null!=this.chart?this.getActiveFormattingPanelOverrides():void 0;this.clearThemeOverrides=!1;const a=function(e,t){return t.reduce(((e,t)=>t?{baseTheme:e,overrides:t}:e),e)}(xt(this.chartProxyParams,this,this.isEnterpriseCharts),[this.getChartThemeDefaults(),e??r]);return $e(ze({},s),{theme:a,container:this.chartProxyParams.parentElement,mode:"integrated"})}getChartThemeDefaults(){}getActiveFormattingPanelOverrides(){var e,t;if(this.clearThemeOverrides)return{};const i=null==(e=this.chart)?void 0:e.getOptions().theme;return null!=(t=null==i?void 0:i.overrides)?t:{}}destroy(){let{keepChartInstance:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e)return this.chart.resetAnimations(),this.chart;this.destroyChart()}destroyChart(){this.chart&&(this.chart.destroy(),this.chart=void 0)}},lr=class e extends nr{constructor(e){super(e),this.crossFilteringAllPoints=new Set,this.crossFilteringSelectedPoints=[]}update(e){const t=this.getAxes(e),i=$e(ze({},this.getCommonChartOptions(e.updatedOverrides)),{data:this.getData(e,t),axes:t,series:this.getSeries(e)});r.c.update(this.getChartRef(),i)}getData(e,t){const i=["area","line"].includes(this.standaloneChartType),s=t.some((e=>"category"===(null==e?void 0:e.type)));return this.crossFiltering&&i?this.getCrossFilterData(e):this.getDataTransformedData(e,s)}getDataTransformedData(e,t){const[i]=e.categories;return this.transformData(e.data,i.id,t)}getXAxisType(t){return t.grouping?"grouped-category":e.isTimeAxis(t)?"time":"category"}static isTimeAxis(e){const[t]=e.categories;if(t&&t.chartDataType)return"time"===t.chartDataType;const i=e.data[0];return(i&&i[t.id])instanceof Date}crossFilteringReset(){this.crossFilteringSelectedPoints=[],this.crossFilteringAllPoints.clear()}crossFilteringPointSelected(e){return 0==this.crossFilteringSelectedPoints.length||this.crossFilteringSelectedPoints.includes(e)}crossFilteringDeselectedPoints(){return this.crossFilteringSelectedPoints.length>0&&this.crossFilteringAllPoints.size!==this.crossFilteringSelectedPoints.length}extractLineAreaCrossFilterSeries(e,t){const[i]=t.categories,s=e=>"area"===this.standaloneChartType?t.getCrossFilteringContext().lastSelectedChartId===t.chartId?e+"-total":e:e+"-total";return e.map((e=>(e.yKey=s(e.yKey),e.listeners={nodeClick:t=>{const i=t.datum[e.xKey],s=t.event.metaKey||t.event.ctrlKey;this.crossFilteringAddSelectedPoint(s,i),this.crossFilterCallback(t)}},e.marker={formatter:e=>{const t=e.datum[i.id];return{fill:e.highlighted?"yellow":e.fill,size:e.highlighted?14:this.crossFilteringPointSelected(t)?8:0}}},"area"===this.standaloneChartType&&(e.fillOpacity=this.crossFilteringDeselectedPoints()?.3:1),"line"===this.standaloneChartType&&(e.strokeOpacity=this.crossFilteringDeselectedPoints()?.3:1),e)))}getCrossFilterData(e){this.crossFilteringAllPoints.clear();const[t]=e.categories,i=e.fields[0].colId,s=`${i}-filtered-out`,r=e.getCrossFilteringContext().lastSelectedChartId;return e.data.map((a=>{const o=a[t.id];this.crossFilteringAllPoints.add(o);const n=this.crossFilteringPointSelected(o);return"area"===this.standaloneChartType&&r===e.chartId&&(a[`${i}-total`]=n?a[i]:a[i]+a[s]),"line"===this.standaloneChartType&&(a[`${i}-total`]=n?a[i]:a[i]+a[s]),a}))}crossFilteringAddSelectedPoint(e,t){e?this.crossFilteringSelectedPoints.push(t):this.crossFilteringSelectedPoints=[t]}};function dr(e,t){const i=parseInt(e.slice(1,3),16),s=parseInt(e.slice(3,5),16),r=parseInt(e.slice(5,7),16);return t?`rgba(${i}, ${s}, ${r}, ${t})`:`rgba(${i}, ${s}, ${r})`}function hr(e,t){return e.map((e=>{const i=r.s.Color.fromString(e);return new r.s.Color(i.r,i.g,i.b,t).toHexString()}))}var cr=class extends lr{constructor(e){super(e)}getAxes(e){const t=[{type:this.getXAxisType(e),position:st(this.chartType)?"left":"bottom"},{type:"number",position:st(this.chartType)?"bottom":"left"}];if(this.isNormalised()){const e=t[1];e.label=$e(ze({},e.label),{formatter:e=>Math.round(e.value)+"%"})}return t}getSeries(e){const[t]=e.categories,i=e.fields.map((e=>({type:this.standaloneChartType,direction:st(this.chartType)?"horizontal":"vertical",stacked:this.crossFiltering||at(this.chartType),normalizedTo:this.isNormalised()?100:void 0,xKey:t.id,xName:t.name,yKey:e.colId,yName:e.displayName})));return this.crossFiltering?this.extractCrossFilterSeries(i):i}extractCrossFilterSeries(e){const t=this.getChartPalette(),i=(e,i)=>$e(ze({},e),{highlightStyle:{item:{fill:void 0}},fill:null==t?void 0:t.fills[i],stroke:null==t?void 0:t.strokes[i],listeners:{nodeClick:this.crossFilterCallback}}),s=e=>{const t=e.yKey+"-filtered-out";return $e(ze({},wt({},e)),{yKey:t,fill:dr(e.fill,"0.3"),stroke:dr(e.stroke,"0.3"),showInLegend:!1})},r=[];for(let a=0;a<e.length;a++){const t=i(e[a],a);r.push(t),r.push(s(t))}return r}isNormalised(){return!this.crossFiltering&&s.ch.includes(["normalizedColumn","normalizedBar"],this.chartType)}},ur=class extends lr{constructor(e){super(e)}getAxes(e){const t=[{type:this.getXAxisType(e),position:"bottom"},{type:"number",position:"left"}];if(this.isNormalised()){const e=t[1];e.label=$e(ze({},e.label),{formatter:e=>Math.round(e.value)+"%"})}return t}getSeries(e){const[t]=e.categories,i=e.fields.map((e=>({type:this.standaloneChartType,xKey:t.id,xName:t.name,yKey:e.colId,yName:e.displayName,normalizedTo:"normalizedArea"===this.chartType?100:void 0,stacked:["normalizedArea","stackedArea"].includes(this.chartType)})));return this.crossFiltering?this.extractLineAreaCrossFilterSeries(i,e):i}isNormalised(){return!this.crossFiltering&&"normalizedArea"===this.chartType}},pr=class extends lr{constructor(e){super(e)}getAxes(e){return[{type:this.getXAxisType(e),position:"bottom"},{type:"number",position:"left"}]}getSeries(e){const[t]=e.categories,i=e.fields.map((e=>({type:this.standaloneChartType,xKey:t.id,xName:t.name,yKey:e.colId,yName:e.displayName})));return this.crossFiltering?this.extractLineAreaCrossFilterSeries(i,e):i}},gr=class extends nr{constructor(e){super(e)}getAxes(e){const t="radial-bar"===this.standaloneChartType;return[{type:t?"angle-number":"angle-category"},{type:t?"radius-category":"radius-number"}]}getSeries(e){const{fields:t}=e,[i]=e.categories,s="radial-bar"===this.standaloneChartType;return t.map((e=>{var t,r;return{type:this.standaloneChartType,angleKey:s?e.colId:i.id,angleName:s?null!=(t=e.displayName)?t:void 0:i.name,radiusKey:s?i.id:e.colId,radiusName:s?i.name:null!=(r=e.displayName)?r:void 0}}))}update(e){const t=this.getAxes(e),i=$e(ze({},this.getCommonChartOptions(e.updatedOverrides)),{data:this.getData(e,t),axes:t,series:this.getSeries(e)});r.c.update(this.getChartRef(),i)}getData(e,t){const i=t.some((e=>"angle-category"===e.type||"radius-category"===e.type));return this.getDataTransformedData(e,i)}getDataTransformedData(e,t){const[i]=e.categories;return this.transformData(e.data,i.id,t)}crossFilteringReset(){}},mr=class e extends nr{constructor(e){super(e)}update(e){const{data:t}=e,[i]=e.categories,s=$e(ze({},this.getCommonChartOptions(e.updatedOverrides)),{data:this.crossFiltering?this.getCrossFilterData(e):this.transformData(t,i.id),series:this.getSeries(e)});r.c.update(this.getChartRef(),s)}getSeries(t){const[i]=t.categories,s=t.fields.length,r={currentOffset:0,offsetAmount:s>1?20:40},a=this.getFields(t).map((t=>{var a;const o={type:this.standaloneChartType,angleKey:t.colId,angleName:t.displayName,sectorLabelKey:t.colId,calloutLabelName:i.name,calloutLabelKey:i.id};if("donut"===this.chartType||"doughnut"===this.chartType){const{outerRadiusOffset:i,innerRadiusOffset:n}=e.calculateOffsets(r),l=t.displayName?{title:{text:t.displayName,showInLegend:s>1}}:void 0;return $e(ze($e(ze({},o),{type:"donut",outerRadiusOffset:i,innerRadiusOffset:n}),l),{calloutLine:{colors:null==(a=this.getChartPalette())?void 0:a.strokes}})}return o}));return this.crossFiltering?this.extractCrossFilterSeries(a):a}getCrossFilterData(e){const t=e.fields[0].colId,i=`${t}-filtered-out`;return e.data.map((e=>{const s=e[t]+e[i];return e[`${t}-total`]=s,e[i]=1,e[t]=e[t]/s,e}))}extractCrossFilterSeries(e){const t=this.getChartPalette(),i=e[0],s=i.angleKey,r=(e=>$e(ze({},e),{legendItemKey:e.calloutLabelKey,calloutLabel:{enabled:!1},highlightStyle:{item:{fill:void 0}},radiusKey:e.angleKey,angleKey:e.angleKey+"-total",radiusMin:0,radiusMax:1,listeners:{nodeClick:this.crossFilterCallback}}))(i);return[((e,i)=>{var s,a;return $e(ze({},wt({},r)),{radiusKey:i+"-filtered-out",fills:hr(null!=(s=e.fills)?s:t.fills,.3),strokes:hr(null!=(a=e.strokes)?a:t.strokes,.3),showInLegend:!1})})(i,s),r]}static calculateOffsets(e){const t=e.currentOffset;e.currentOffset-=e.offsetAmount;const i=e.currentOffset;return e.currentOffset-=e.offsetAmount,{outerRadiusOffset:t,innerRadiusOffset:i}}getFields(e){return"pie"===this.chartType?e.fields.slice(0,1):e.fields}crossFilteringReset(){}},vr=class extends lr{constructor(e){super(e)}getAxes(e){return[{type:"number",position:"bottom"},{type:"number",position:"left"}]}getSeries(e){const[t]=e.categories,i=this.isPaired(),s=this.getSeriesDefinitions(e.fields,i),r=t.id===mt.DEFAULT_CATEGORY?void 0:t,a=s.map((e=>{var t,i,s,a,o;return null!=e&&e.sizeField?{type:"bubble",xKey:e.xField.colId,xName:null!=(t=e.xField.displayName)?t:void 0,yKey:e.yField.colId,yName:null!=(i=e.yField.displayName)?i:void 0,title:`${e.yField.displayName} vs ${e.xField.displayName}`,sizeKey:e.sizeField.colId,sizeName:null!=(s=e.sizeField.displayName)?s:"",labelKey:r?r.id:e.yField.colId,labelName:r?r.name:void 0}:{type:"scatter",xKey:e.xField.colId,xName:null!=(a=e.xField.displayName)?a:void 0,yKey:e.yField.colId,yName:null!=(o=e.yField.displayName)?o:void 0,title:`${e.yField.displayName} vs ${e.xField.displayName}`,labelKey:r?r.id:e.yField.colId,labelName:r?r.name:void 0}}));return this.crossFiltering?this.extractCrossFilterSeries(a,e):a}extractCrossFilterSeries(e,t){const{data:i}=t,s=this.getChartPalette(),r=e=>`${e}-filtered-out`,a=e.map(((e,t)=>{const a=null==s?void 0:s.fills[t],o=null==s?void 0:s.strokes[t];let n;if("bubble"===e.type){const{sizeKey:t}=e;n=((e,t)=>{var i;const s=[1/0,-1/0];if(null!=t)for(const a of e){const e=null!=(i=a[t])?i:a[r(t)];e<s[0]&&(s[0]=e),e>s[1]&&(s[1]=e)}if(s[0]<=s[1])return s})(i,t)}const l=$e(ze({},e.marker),{fill:a,stroke:o,domain:n});return $e(ze({},e),{marker:l,highlightStyle:{item:{fill:"yellow"}},listeners:$e(ze({},e.listeners),{nodeClick:this.crossFilterCallback})})}));return[...a,...a.map((e=>{let{yKey:t,xKey:i}=e,s={};return"bubble"===e.type&&(s={sizeKey:r(e.sizeKey)}),$e(ze(ze({},e),s),{yKey:r(t),xKey:r(i),marker:$e(ze({},e.marker),{fillOpacity:.3,strokeOpacity:.3}),showInLegend:!1,listeners:$e(ze({},e.listeners),{nodeClick:e=>{const t=e.datum[r(i)],s=$e(ze({},e),{xKey:i,datum:$e(ze({},e.datum),{[i]:t})});this.crossFilterCallback(s)}})})}))]}getSeriesDefinitions(e,t){if(e.length<2)return[];const i="bubble"===this.chartType;if(t)return i?e.map(((t,i)=>i%3===0?{xField:t,yField:e[i+1],sizeField:e[i+2]}:null)).filter((e=>e&&e.yField&&e.sizeField)):e.map(((t,i)=>i%2===0?{xField:t,yField:e[i+1]}:null)).filter((e=>e&&e.yField));const s=e[0];return i?e.map(((t,i)=>i%2===1?{xField:s,yField:t,sizeField:e[i+1]}:null)).filter((e=>e&&e.sizeField)):e.filter(((e,t)=>t>0)).map((e=>({xField:s,yField:e})))}},Cr=class extends lr{constructor(e){super(e)}getAxes(e){return[{type:this.getXAxisType(e),position:st(this.chartType)?"left":"bottom"},{type:"number",position:st(this.chartType)?"bottom":"left"}]}computeSeriesStatistics(e,t){const{data:i,fields:s}=e,[r]=e.categories,a=r.id||mt.DEFAULT_CATEGORY,o=this.groupDataByCategory(a,i);return Array.from(o).map((e=>{let[i,a]=e;const o={[r.id]:i};return s.forEach(((e,i)=>{const s=a.map((t=>t[e.colId])).filter((e=>"number"==typeof e&&!isNaN(e)));Object.entries(t(s)).forEach((e=>{let[t,r]=e;o[`${t}:${i}`]=s.length>0?r:null}))})),o}))}groupDataByCategory(e,t){return t.reduce(((t,i)=>{let s=(t=>{if(e===mt.DEFAULT_CATEGORY)return 1;const i=t[e];return null==i?"":i instanceof Date?i.getTime():i})(i);const r=t.get(s);return r?r.push(i):t.set(s,[i]),t}),new Map)}},fr=class extends Cr{constructor(e){super(e)}getSeries(e){const[t]=e.categories;return e.fields.map(((e,i)=>{var s;return{type:this.standaloneChartType,xKey:t.id,xName:t.name,yName:null!=(s=e.displayName)?s:void 0,yLowName:"Min",yHighName:"Max",yLowKey:`min:${i}`,yHighKey:`max:${i}`}}))}getData(e){return this.computeSeriesStatistics(e,(e=>({min:Math.min(...e),max:Math.max(...e)})))}},yr=class extends lr{constructor(e){super(e)}getSeries(e){const t=e.fields[0];return[{type:this.standaloneChartType,xKey:t.colId,xName:t.displayName,yName:this.chartProxyParams.translate("histogramFrequency"),areaPlot:!1}]}getAxes(e){return[{type:"number",position:"bottom"},{type:"number",position:"left"}]}},Sr=class extends Cr{constructor(e){super(e)}getSeries(e){const[t]=e.categories;return e.fields.map(((e,i)=>{var s;return{type:this.standaloneChartType,direction:st(this.chartType)?"horizontal":"vertical",xKey:t.id,xName:t.name,yName:null!=(s=e.displayName)?s:void 0,minName:"Min",q1Name:"Q1",medianName:"Median",q3Name:"Q3",maxName:"Max",minKey:`min:${i}`,q1Key:`q1:${i}`,medianKey:`median:${i}`,q3Key:`q3:${i}`,maxKey:`max:${i}`}}))}getData(e){return this.computeSeriesStatistics(e,(e=>{const t=e.sort(((e,t)=>e-t));return{min:t[0],q1:this.quantile(t,.25),median:this.quantile(t,.5),q3:this.quantile(t,.75),max:t[t.length-1]}}))}quantile(e,t){const i=(e.length-1)*t,s=Math.floor(i),r=i-s;return void 0!==e[s+1]?e[s]+r*(e[s+1]-e[s]):e[s]}},Er="AG-GRID-DEFAULT-LABEL-KEY";function br(e,t){return wr(Ar(e,(function(e){return t.length}),(function(e,i){const s=t[i];return function(e){return null==e?null:String(e)}(e[s])})))}function wr(e){const{depth:t,leaves:i,children:s}=e;if(0===t)return i.map((e=>ze({[Er]:null},e)));const r=new Array;for(const[a,o]of s.entries())0===o.depth?r.push(...o.leaves.map((e=>ze({[Er]:a},e)))):r.push({[Er]:a,children:wr(o)});return r}function Ar(e,t,i){const s={depth:0,leaves:[],children:new Map};return e.reduce(((e,s)=>r(s,t(s),i,0,e)),s);function r(e,t,i,s,a){if(s===t)return a.leaves.push(e),a;{const o=i(e,s),n=r(e,t,i,s+1,a.children.get(o)||{depth:0,leaves:[],children:new Map});return a.children.set(o,n),a.depth=Math.max(1+n.depth,a.depth),a}}}var xr=class extends nr{constructor(e){super(e),this.chartProxyParams=e}update(e){const t=$e(ze({},this.getCommonChartOptions(e.updatedOverrides)),{series:this.getSeries(e,Er),data:this.getData(e)});r.c.update(this.getChartRef(),t)}getData(e){const{categories:t,data:i,grouping:s}=e;if(s)return function(e,t){return wr(Ar(e,(function(e){var i,s;return null!=(s=null==(i=t(e))?void 0:i.length)?s:0}),(function(e,i){const s=t(e);if(!s)return null;return s[s.length-1-i]})))}(i,Tr);return br(i,t.map((e=>{let{id:t}=e;return t})))}};function Tr(e){var t,i;return null!=(i=null==(t=e[s.aG])?void 0:t.labels)?i:null}var Mr=class extends xr{constructor(e){super(e)}getSeries(e,t){var i,s;const{fields:r}=e,[a,o]=r;return[{type:this.standaloneChartType,labelKey:t,sizeKey:null==a?void 0:a.colId,sizeName:null!=(i=null==a?void 0:a.displayName)?i:void 0,colorKey:null==o?void 0:o.colId,colorName:null!=(s=null==o?void 0:o.displayName)?s:void 0}]}getChartThemeDefaults(){return{treemap:{gradientLegend:{gradient:{preferredLength:200}}}}}transformData(e,t,i){return e}crossFilteringReset(){}},Pr=class extends xr{constructor(e){super(e)}getSeries(e,t){var i,s;const{fields:r}=e,[a,o]=r;return[{type:this.standaloneChartType,labelKey:t,sizeKey:null==a?void 0:a.colId,sizeName:null!=(i=null==a?void 0:a.displayName)?i:void 0,colorKey:null==o?void 0:o.colId,colorName:null!=(s=null==o?void 0:o.displayName)?s:void 0}]}getChartThemeDefaults(){return{sunburst:{gradientLegend:{gradient:{preferredLength:200}}}}}transformData(e,t,i){return e}crossFilteringReset(){}};var Fr=class extends nr{constructor(e){super(e)}update(e){const t="AG-GRID-DEFAULT-HEATMAP-SERIES-KEY",i="AG-GRID-DEFAULT-HEATMAP-VALUE-KEY",s="AG-GRID-DEFAULT-HEATMAP-CATEGORY-KEY",a=$e(ze({},this.getCommonChartOptions(e.updatedOverrides)),{series:this.getSeries(e,t,i,s),data:this.getData(e,t,i,s)});r.c.update(this.getChartRef(),a)}getSeries(e,t,i,s){const[r]=e.categories;return[{type:this.standaloneChartType,yKey:s,xKey:t,colorKey:i,yName:r.name,xName:void 0,colorName:void 0}]}getData(e,t,i,s){const[r]=e.categories;return function(e,t){return e.reduce(((e,i,s,r)=>e.concat(t(i,s,r))),new Array)}(e.data,((a,o)=>{const n=a[r.id],l=null==n?"":String(n),d={id:o,value:n,toString:()=>l};return e.fields.map((e=>{let{colId:r,displayName:o}=e;return $e(ze({},a),{[t]:o,[i]:a[r],[s]:d})}))}))}getChartThemeDefaults(){return{heatmap:{gradientLegend:{gradient:{preferredLength:200}},series:{tooltip:{renderer:Dr}}}}}transformData(e,t,i){return e}crossFilteringReset(){}};function Dr(e){const{xKey:t,yKey:i,colorKey:s,yName:r,datum:a}=e;return{title:"",content:[{label:r,value:a[i]},{label:a[t],value:s&&a[s]}].map((e=>{let{label:t,value:i}=e;return`<b>${Rr(String(t))}:</b> ${Rr(String(i))}`})).join("<br>")}}function Rr(e){const t={"&":"&amp;","<":"&lt;",">":"&gt;"},i=`[${Object.keys(t).join("")}]`,s=new RegExp(i,"g");return e.replace(s,(e=>t[e]))}var Lr=class extends lr{constructor(e){super(e)}getAxes(e){return[{type:this.getXAxisType(e),position:st(this.chartType)?"left":"bottom"},{type:"number",position:st(this.chartType)?"bottom":"left"}]}getSeries(e){var t;const[i]=e.categories,[s]=e.fields;return[{type:this.standaloneChartType,direction:st(this.chartType)?"horizontal":"vertical",xKey:i.id,xName:i.name,yKey:s.colId,yName:null!=(t=s.displayName)?t:void 0}]}},Ir=["number","category","time","grouped-category"],Or=[...Ir,"angle-category","angle-number","radius-category","radius-number"],Nr=class e extends s.B{constructor(e){super(),this.chartController=e}getChartThemeOverridesProxy(){return{getValue:e=>this.getChartOption(e),setValue:(e,t)=>this.setChartThemeOverrides([{expression:e,value:t}]),setValues:e=>this.setChartThemeOverrides(e)}}getAxisThemeOverridesProxy(){return{getValue:e=>this.getAxisProperty(e),setValue:(e,t)=>this.setAxisThemeOverrides([{expression:e,value:t}]),setValues:e=>this.setAxisThemeOverrides(e)}}getCartesianAxisOptionsProxy(e){return{getValue:t=>this.getCartesianAxisProperty(e,t),setValue:(t,i)=>this.setCartesianAxisOptions(e,[{expression:t,value:i}]),setValues:t=>this.setCartesianAxisOptions(e,t)}}getCartesianAxisThemeOverridesProxy(e){return{getValue:t=>this.getCartesianAxisProperty(e,t),setValue:(t,i)=>this.setCartesianAxisThemeOverrides(e,[{expression:t,value:i}]),setValues:t=>this.setCartesianAxisThemeOverrides(e,t)}}getCartesianAxisAppliedThemeOverridesProxy(e){return{getValue:t=>this.getCartesianAxisThemeOverride(e,"*"===t?null:t),setValue:(t,i)=>this.setCartesianAxisThemeOverrides(e,[{expression:"*"===t?null:t,value:i}]),setValues:t=>this.setCartesianAxisThemeOverrides(e,t)}}getSeriesOptionsProxy(e){return{getValue:(t,i)=>this.getSeriesOption(e(),t,i),setValue:(t,i)=>this.setSeriesOptions(e(),[{expression:t,value:i}]),setValues:t=>this.setSeriesOptions(e(),t)}}getPersistedChartThemeOverrides(e,t,i,s){const r=this.getRetainedChartThemeOverrideKeys(i,s),a=this.getRetainedChartAxisThemeOverrideKeys(null,i,s),o=this.createChartOptions();for(const n of r){const t=this.retrieveChartOptionsThemeOverride(e,i,n);void 0!==t&&this.assignChartOptionsThemeOverride(o,s,n,t)}if(t)for(const{expression:n,targetAxisTypes:l}of a)for(const r of t.map((e=>e.type))){const t=this.retrieveChartOptionsThemeOverride(e,i,["axes",r,n].join("."));if(void 0!==t)for(const e of l)this.assignChartOptionsThemeOverride(o,s,["axes",e,n].join("."),t)}return o.theme.overrides}getRetainedChartThemeOverrideKeys(e,t){const i=["zoom","navigator"];return["animation",...((e,t)=>{const s=new Array;return ot(e)&&ot(t)&&s.push(...i),s})(e,t)]}getRetainedChartAxisThemeOverrideKeys(e,t,i){return ot(t)&&ot(i)?this.getRetainedCartesianAxisThemeOverrideKeys(e).map((e=>({expression:e,targetAxisTypes:Ir}))):[]}getRetainedCartesianAxisThemeOverrideKeys(e){const t="xAxis"===e?["",".top",".bottom"]:"yAxis"===e?["",".left",".right"]:["",".left",".right",".top",".bottom"],i=["crosshair"],s=new Array;for(const r of i)for(const e of t)s.push(`${e}${r}`);return s}getChartOption(e){return At(this.getChart(),e,void 0)}setChartThemeOverrides(e){const t=this.getChartType(),i=this.createChartOptions();for(const{expression:s,value:r}of e)this.assignChartOptionsThemeOverride(i,t,s,r);this.applyChartOptions(i)}applyChartOptions(e,t){0!==Object.keys(e).length&&(this.updateChart(e),(null==t||!t.silent)&&this.raiseChartOptionsChangedEvent())}awaitChartOptionUpdate(e){this.chartController.getChartProxy().getChart().waitForUpdate().then((()=>e())).catch((e=>console.error("AG Grid - chart update failed",e)))}getAxisProperty(e){var t;return At(null==(t=this.getChart().axes)?void 0:t[0],e,void 0)}setAxisThemeOverrides(e){var t;const i=this.getChart(),s=this.getChartType();let r=this.createChartOptions();for(const{expression:a,value:o}of e){const e=null==(t=i.axes)?void 0:t.filter((e=>{const t=a.split(".");let i=e;for(const s of t){if(!(s in i))return!1;i=i[s]}return!0}));if(e)for(const t of e)this.isValidAxisType(t)&&this.assignChartAxisThemeOverride(r,s,t.type,null,a,o)}this.applyChartOptions(r)}getCartesianAxisProperty(e,t){const i=this.getChartAxes();return At(this.getCartesianAxis(i,e),t,void 0)}getCartesianAxisThemeOverride(e,t){const i=this.getChartAxes(),s=this.getCartesianAxis(i,e);if(!s||!this.isValidAxisType(s))return;const r=this.getChartType(),a=this.getChart().getOptions();return this.retrieveChartAxisThemeOverride(a,r,s.type,"yAxis"===e?["left","right"]:["bottom","top"],t)}setCartesianAxisThemeOverrides(e,t){const i=this.getChartAxes(),s=this.getCartesianAxis(i,e);if(!s||!this.isValidAxisType(s))return;const r=this.getChartType();let a=this.createChartOptions();for(const{expression:o,value:n}of t)this.assignChartAxisThemeOverride(a,r,s.type,"yAxis"===e?["left","right"]:["bottom","top"],o,n);this.applyChartOptions(a)}setCartesianAxisOptions(e,t){const i=this.getChart().getOptions(),s="axes"in i?i.axes:void 0;if(!i||!s)return;const r=this.getChartAxes(),a=this.getCartesianAxis(r,e);if(!a)return;let o=this.createChartOptions();o.axes=s;const n=t.find((e=>{let{expression:t}=e;return"type"===t}));if(n){const t=n.value,s=this.getRetainedCartesianAxisThemeOverrideKeys(e);for(const e of s){const s=this.getChartType(),r=this.retrieveChartOptionsThemeOverride(i,s,["axes",a.type,e].join("."));void 0!==r&&this.assignChartOptionsThemeOverride(o,s,["axes",t,e].join("."),r)}}const l=r.indexOf(a);for(const{expression:d,value:h}of t)this.assignChartOption(o,`axes.${l}.${d}`,h);this.applyChartOptions(o)}getCartesianAxis(e,t){if(!(e.length<2))switch(t){case"xAxis":return"x"===e[0].direction?e[0]:e[1];case"yAxis":return"y"===e[1].direction?e[1]:e[0]}}getSeriesOption(t,i,s){const r=this.getChart().series.find((i=>e.isMatchingSeries(t,i)));return At(s?r:null==r?void 0:r.properties.toJson(),i,void 0)}setSeriesOptions(e,t){let i=this.createChartOptions();for(const{expression:s,value:r}of t)this.assignChartOptionsSeriesThemeOverride(i,e,`series.${s}`,r);this.applyChartOptions(i)}getPairedMode(){return this.chartController.getChartProxy().isPaired()}setPairedMode(e){this.chartController.getChartProxy().setPaired(e)}getChartAxes(){var e;return null!=(e=this.getChart().axes)?e:[]}retrieveChartAxisThemeOverride(e,t,i,s,r){if(!s)return this.retrieveChartOptionsThemeOverride(e,t,["axes",i,...r?[r]:[]].join("."));for(const a of s){const s=this.retrieveChartOptionsThemeOverride(e,t,["axes",i,a,...r?[r]:[]].join("."));if(void 0!==s)return s}}assignChartAxisThemeOverride(e,t,i,s,r,a){if(s)for(const o of s)this.assignChartOptionsThemeOverride(e,t,["axes",i,o,...r?[r]:[]].join("."),a);else this.assignChartOptionsThemeOverride(e,t,["axes",i,...r?[r]:[]].join("."),a)}isValidAxisType(e){return Or.includes(e.type)}getChartType(){return this.chartController.getChartType()}getChart(){return this.chartController.getChartProxy().getChart()}updateChart(e){const t=this.chartController.getChartProxy().getChartRef();t.skipAnimations(),r.c.updateDelta(t,e)}createChartOptions(){return{theme:{overrides:{}}}}retrieveChartOptionsThemeOverride(e,t,i){const s=this.getChartThemeOverridesSeriesTypeKeys(t);for(const r of s){const t=this.retrieveChartOptionsSeriesThemeOverride(e,r,i);if(void 0!==t)return t}}assignChartOptionsThemeOverride(e,t,i,s){const r=this.getChartThemeOverridesSeriesTypeKeys(t);for(const a of r)this.assignChartOptionsSeriesThemeOverride(e,a,i,s)}retrieveChartOptionsSeriesThemeOverride(e,t,i){return this.retrieveChartOption(e,["theme","overrides",t,...i?[i]:[]].join("."))}assignChartOptionsSeriesThemeOverride(e,t,i,s){this.assignChartOption(e,["theme","overrides",t,...i?[i]:[]].join("."),s)}getChartThemeOverridesSeriesTypeKeys(e){const t=this.chartController.getChartSeriesTypes(e);return this.chartController.isComboChart()&&t.push("common"),t}retrieveChartOption(e,t){return At(e,t,void 0)}assignChartOption(e,t,i){!function(e,t,i){if(null==e)return;const s=t.split(".");let r=e;s.forEach(((e,t)=>{r[e]||(r[e]={}),t<s.length-1&&(r=r[e])})),r[s[s.length-1]]=i}(e,t,i)}raiseChartOptionsChangedEvent(){const e=this.chartController.getChartModel(),t={type:s.aA.EVENT_CHART_OPTIONS_CHANGED,chartId:e.chartId,chartType:e.chartType,chartThemeName:this.chartController.getChartThemeName(),chartOptions:e.chartOptions};this.eventService.dispatchEvent(t)}static isMatchingSeries(e,t){return et.includes(e)&&t.type===e}destroy(){super.destroy()}},kr=class extends lr{constructor(e){super(e)}getAxes(e){const t=e?e.fields:[],i=new Map(t.map((e=>[e.colId,e]))),{primaryYKeys:s,secondaryYKeys:r}=this.getYKeys(t,e.seriesChartTypes),a=[{type:this.getXAxisType(e),position:"bottom"}];return s.length>0&&a.push({type:"number",keys:s,position:"left"}),r.length>0&&r.forEach((e=>{const t=i.get(e);if(!t||t.colId!==e)return;const s={type:"number",keys:[e],position:"right"};a.push(s)})),a}getSeries(e){const{fields:t,seriesChartTypes:i}=e,[s]=e.categories;return t.map((e=>{const t=i.find((t=>t.colId===e.colId));if(t){const i=t.chartType,r=["groupedColumn","groupedBar"].includes(i)?{grouped:!0}:{};return ze({type:dt(i),xKey:s.id,yKey:e.colId,yName:e.displayName,stacked:["stackedArea","stackedColumn"].includes(i)},r)}}))}getYKeys(e,t){const i=[],s=[];return e.forEach((e=>{const r=e.colId,a=t.find((e=>e.colId===r));a&&(a.secondaryAxis?s.push(r):i.push(r))})),{primaryYKeys:i,secondaryYKeys:s}}},Gr=["chartSettings","chartData","chartFormat"],Vr=["chartUnlink","chartLink","chartDownload"],Br={settings:"chartSettings",data:"chartData",format:"chartFormat"},_r=class extends s.B{isLegacyFormat(){return!this.chartService.isEnterprise()}downloadChart(e,t,i,s){e.chartController.getChartProxy().downloadChart(t,i,s)}toggleLinked(e){e.chartController.detachChartRange()}openAdvancedSettings(e,t){this.advancedSettingsMenuFactory.showMenu(e,t)}hideAdvancedSettings(){this.advancedSettingsMenuFactory.hideMenu()}getToolbarOptionsAndPanels(e){var t,i,r;const a=this.isLegacyFormat();let o,n,l;if(!!this.gridOptionsService.get("chartToolPanelsDef")||!a){const d=a?[e.isChartLinked()?"chartLink":"chartUnlink","chartDownload"]:["chartMenu"],h=this.gridOptionsService.getCallback("getChartToolbarItems");l=h?h({defaultItems:d}).filter((e=>{if(!(a?Vr:[...Vr,"chartMenu"]).includes(e)){let t;return t=Gr.includes(e)?`'${e}' is a Chart Tool Panel option and will be ignored since 'chartToolPanelsDef' is used. Please use 'chartToolPanelsDef.panels' grid option instead`:"chartMenu"===e?"'chartMenu' is only allowed as a Chart Toolbar Option when using AG Charts Enterprise":`'${e}' is not a valid Chart Toolbar Option`,s.ch.warnOnce(t),!1}return!0})):d;const c=null==(i=null==(t=this.gridOptionsService.get("chartToolPanelsDef"))?void 0:t.panels)?void 0:i.map((e=>{const t=Br[e];return t||s.ch.warnOnce(`Invalid panel in chartToolPanelsDef.panels: '${e}'`),t})).filter((e=>!!e));o=c||Object.values(Br),e.isPivotChart()&&(o=o.filter((e=>"chartData"!==e)));const u=null==(r=this.gridOptionsService.get("chartToolPanelsDef"))?void 0:r.defaultToolPanel;n=u&&Br[u]||o[0],a&&(l=o.length>0?[o[0],...l]:l)}else{let t=["chartSettings","chartData","chartFormat",e.isChartLinked()?"chartLink":"chartUnlink","chartDownload"];const i=this.gridOptionsService.getCallback("getChartToolbarItems");if(i){const e=this.gridOptionsService.get("suppressChartToolPanelsButton");t=i({defaultItems:e?t:Vr}).filter((t=>{if(!Gr.includes(t)&&!Vr.includes(t))return s.ch.warnOnce(`'${t}' is not a valid Chart Toolbar Option`),!1;if(!e&&Gr.includes(t)){const e=`'${t}' is a Chart Tool Panel option and will be ignored. Please use 'chartToolPanelsDef.panels' grid option instead`;return s.ch.warnOnce(e),!1}return!0})),e||(t=t.concat(Gr))}e.isPivotChart()&&(t=t.filter((e=>"chartData"!==e)));const r=["chartUnlink","chartLink","chartDownload"];o=t.filter((e=>-1===r.indexOf(e))),n=o[0],l=t.filter((e=>-1!==r.indexOf(e)||o.length&&e===o[0]))}return{panels:o,defaultPanel:n,chartToolbarOptions:l}}doesChartToolbarExist(e){const{chartToolbarOptions:t}=this.getToolbarOptionsAndPanels(e);return["chartMenu",...Vr].some((e=>t.includes(e)))}doChartToolPanelsExist(e){const{panels:t}=this.getToolbarOptionsAndPanels(e);return t.length>0}};Ye([(0,s.A)("chartService")],_r.prototype,"chartService",2),Ye([(0,s.A)("advancedSettingsMenuFactory")],_r.prototype,"advancedSettingsMenuFactory",2),_r=Ye([(0,s._)("chartMenuService")],_r);var Ur=class e extends s.ak{constructor(t){super(e.TEMPLATE),this.params=t}init(){const e={chartId:this.params.chartId,pivotChart:this.params.pivotChart,chartType:lt(this.params.chartType),chartThemeName:this.getThemeName(),switchCategorySeries:this.params.switchCategorySeries,aggFunc:this.params.aggFunc,cellRange:this.params.cellRange,suppressChartRanges:this.params.suppressChartRanges,unlinkChart:this.params.unlinkChart,crossFiltering:this.params.crossFiltering,seriesChartTypes:this.params.seriesChartTypes},t=this.gridOptionsService.get("enableRtl");this.addCssClass(t?"ag-rtl":"ag-ltr");const i=this.createBean(new mt(e));this.chartController=this.createManagedBean(new Bt(i)),this.chartOptionsService=this.createManagedBean(new Nr(this.chartController)),this.validateCustomThemes(),this.createChart(),this.params.insideDialog&&this.addDialog(),this.addMenu(),this.addTitleEditComp(),this.addManagedListener(this.getGui(),"focusin",this.setActiveChartCellRange.bind(this)),this.addManagedListener(this.chartController,Bt.EVENT_CHART_MODEL_UPDATE,this.update.bind(this)),this.addManagedPropertyListeners(["chartThemeOverrides","chartThemes"],this.reactivePropertyUpdate.bind(this)),this.update(),this.raiseChartCreatedEvent()}createChart(){let t;this.chartProxy&&(t=this.chartProxy.destroy({keepChartInstance:!0}));const i=this.chartController.getChartType(),s={chartType:i,chartInstance:t,getChartThemeName:this.getChartThemeName.bind(this),getChartThemes:this.getChartThemes.bind(this),customChartThemes:this.gridOptionsService.get("customChartThemes"),getGridOptionsChartThemeOverrides:()=>this.getGridOptionsChartThemeOverrides(),getExtraPaddingDirections:()=>{var e,t;return null!=(t=null==(e=this.chartMenu)?void 0:e.getExtraPaddingDirections())?t:[]},apiChartThemeOverrides:this.params.chartThemeOverrides,crossFiltering:this.params.crossFiltering,crossFilterCallback:(e,t)=>{this.params.crossFilteringContext.lastSelectedChartId=t?"":this.chartController.getChartId(),t&&this.params.crossFilteringResetCallback(),this.crossFilterService.filter(e,t)},parentElement:this.eChart,grouping:this.chartController.isGrouping(),chartThemeToRestore:this.params.chartThemeName,chartOptionsToRestore:this.params.chartOptionsToRestore,chartPaletteToRestore:this.params.chartPaletteToRestore,seriesChartTypes:this.chartController.getSeriesChartTypes(),translate:e=>this.chartTranslationService.translate(e)};if(this.params.chartOptionsToRestore=void 0,this.chartType=i,this.chartProxy=e.createChartProxy(s),!this.chartProxy)return void console.warn("AG Grid: invalid chart type supplied: ",s.chartType);const r=this.eChart.querySelector("canvas");r&&r.classList.add("ag-charts-canvas"),this.chartController.setChartProxy(this.chartProxy),this.createMenuContext(),this.titleEdit&&this.titleEdit.refreshTitle(this.chartMenuContext)}createMenuContext(){if(this.chartMenuContext)return;const e=this.createManagedBean(new ui(this.chartOptionsService.getChartThemeOverridesProxy())),t=this.createManagedBean(new ui(this.chartOptionsService.getAxisThemeOverridesProxy()));this.chartMenuContext={chartController:this.chartController,chartOptionsService:this.chartOptionsService,chartMenuParamsFactory:e,chartAxisMenuParamsFactory:t}}getChartThemeName(){return this.chartController.getChartThemeName()}getChartThemes(){return this.chartController.getThemeNames()}getGridOptionsChartThemeOverrides(){return this.gridOptionsService.get("chartThemeOverrides")}static createChartProxy(e){switch(e.chartType){case"column":case"bar":case"groupedColumn":case"stackedColumn":case"normalizedColumn":case"groupedBar":case"stackedBar":case"normalizedBar":return new cr(e);case"pie":case"donut":case"doughnut":return new mr(e);case"area":case"stackedArea":case"normalizedArea":return new ur(e);case"line":return new pr(e);case"scatter":case"bubble":return new vr(e);case"histogram":return new yr(e);case"radarLine":case"radarArea":case"nightingale":case"radialColumn":case"radialBar":return new gr(e);case"rangeBar":case"rangeArea":return new fr(e);case"boxPlot":return new Sr(e);case"treemap":return new Mr(e);case"sunburst":return new Pr(e);case"heatmap":return new Fr(e);case"waterfall":return new Lr(e);case"columnLineCombo":case"areaColumnCombo":case"customCombo":return new kr(e);default:throw`AG Grid: Unable to create chart as an invalid chartType = '${e.chartType}' was supplied.`}}addDialog(){const e=this.chartTranslationService.translate(this.params.pivotChart?"pivotChartTitle":"rangeChartTitle"),{width:t,height:i}=this.getBestDialogSize();this.chartDialog=new s.n({resizable:!0,movable:!0,maximizable:!0,title:e,width:t,height:i,component:this,centered:!0,closable:!0}),this.getContext().createBean(this.chartDialog),this.chartDialog.addEventListener(s.n.EVENT_DESTROYED,(()=>{this.destroy(),this.chartMenuService.hideAdvancedSettings()}))}getBestDialogSize(){const e=this.popupService.getPopupParent(),t=.75*s.ch.getAbsoluteWidth(e),i=.75*s.ch.getAbsoluteHeight(e),r=this.chartProxy.getChart();let a=this.params.insideDialog?850:r.width,o=this.params.insideDialog?470:r.height;return(a>t||o>i)&&(a=Math.min(a,t),o=Math.round(.553*a),o>i&&(o=i,a=Math.min(a,Math.round(o/.553)))),{width:a,height:o}}addMenu(){this.params.crossFiltering||(this.chartMenu=this.createBean(new sr(this.eChartContainer,this.eMenuContainer,this.chartMenuContext)),this.eChartContainer.appendChild(this.chartMenu.getGui()))}addTitleEditComp(){this.titleEdit=this.createBean(new ar(this.chartMenu)),this.eTitleEditContainer.appendChild(this.titleEdit.getGui()),this.chartProxy&&this.titleEdit.refreshTitle(this.chartMenuContext)}update(e){if(null!=e&&e.chartId&&!this.chartController.update(e))return;const t=this.chartTypeChanged(e),i=t||this.chartEmpty?(e=>{const t=this.chartType,i=e,s=this.chartProxy.getChart(),r=null==s?void 0:s.getOptions(),a=null==s?void 0:s.axes;return this.chartOptionsService.getPersistedChartThemeOverrides(r,a,t,i??t)})(t):void 0;t&&this.createChart();const s=i&&null!=e&&e.chartThemeOverrides?wt(i,e.chartThemeOverrides):i||(null==e?void 0:e.chartThemeOverrides);this.updateChart(s),null!=e&&e.chartId&&this.chartProxy.getChart().waitForUpdate().then((()=>{this.chartController.raiseChartApiUpdateEvent()}))}updateChart(e){const{chartProxy:t}=this,i=this.chartController.getSelectedValueColState().map((e=>({colId:e.colId,displayName:e.displayName}))),s=this.chartController.getChartData(),r=this.handleEmptyChart(s,i);if(this.chartEmpty=r,r)return void(e&&this.chartController.updateThemeOverrides(e));let a=this.chartController.getChartUpdateParams(e);t.update(a),this.chartProxy.getChart().waitForUpdate().then((()=>{this.chartController.raiseChartUpdatedEvent()})),this.titleEdit.refreshTitle(this.chartMenuContext)}chartTypeChanged(e){const[t,i]=[this.chartController.getChartType(),null==e?void 0:e.chartType],s=i?lt(i):void 0;return this.chartType!==t?s??t:s&&t!==s?s:null}getChartModel(){return this.chartController.getChartModel()}getChartImageDataURL(e){return this.chartProxy.getChartImageDataURL(e)}handleEmptyChart(e,t){const i=this.chartController.isPivotChart()&&!this.chartController.isPivotMode(),r=this.chartController.getChartType();let a=1;this.chartController.isActiveXYChart()?a="bubble"===r?3:2:nt(r)&&(a=0);const o=t.length<a||0===e.length;if(this.eChart){const e=i||o;s.ch.setDisplayed(this.eChart,!e),s.ch.setDisplayed(this.eEmpty,e)}return i?(this.eEmpty.innerText=this.chartTranslationService.translate("pivotChartRequiresPivotMode"),!0):!!o&&(this.eEmpty.innerText=this.chartTranslationService.translate("noDataToChart"),!0)}downloadChart(e,t,i){this.chartProxy.downloadChart(e,t,i)}openChartToolPanel(e){const t=e&&Br[e];this.chartMenu.showMenu({panel:t})}closeChartToolPanel(){this.chartMenu.hideMenu()}getChartId(){return this.chartController.getChartId()}getUnderlyingChart(){return this.chartProxy.getChartRef()}crossFilteringReset(){this.chartProxy.crossFilteringReset()}setActiveChartCellRange(e){this.getGui().contains(e.relatedTarget)||(this.chartController.setChartRange(!0),this.focusService.clearFocusedCell())}getThemeName(){const e=this.gridOptionsService.get("chartThemes")||Gt;if(0===e.length)throw new Error("Cannot create chart: no chart themes available.");const{chartThemeName:t}=this.params;return s.ch.includes(e,t)?t:e[0]}getAllKeysInObjects(e){const t={};return e.filter((e=>null!=e)).forEach((e=>{Object.keys(e).forEach((e=>t[e]=null))})),Object.keys(t)}validateCustomThemes(){const e=this.getChartThemes(),t=this.gridOptionsService.get("customChartThemes");t&&this.getAllKeysInObjects([t]).forEach((t=>{s.ch.includes(e,t)||console.warn("AG Grid: a custom chart theme with the name '"+t+"' has been supplied but not added to the 'chartThemes' list")}))}reactivePropertyUpdate(){this.chartController.setChartThemeName(this.getThemeName(),!0);const e=this.getChartId(),t=this.chartController.isCrossFilterChart()?"crossFilter":this.getChartModel().modelType,i=this.gridOptionsService.get("chartThemeOverrides")||{};this.update({type:`${t}ChartUpdate`,chartId:e,chartThemeOverrides:i})}raiseChartCreatedEvent(){const e={type:s.aA.EVENT_CHART_CREATED,chartId:this.chartController.getChartId()};this.chartProxy.getChart().waitForUpdate().then((()=>{this.eventService.dispatchEvent(e)}))}raiseChartDestroyedEvent(){const e={type:s.aA.EVENT_CHART_DESTROYED,chartId:this.chartController.getChartId()};this.eventService.dispatchEvent(e)}destroy(){var e;super.destroy(),this.chartProxy&&this.chartProxy.destroy(),this.destroyBean(this.chartMenu),this.destroyBean(this.titleEdit),this.chartDialog&&this.chartDialog.isAlive()&&this.destroyBean(this.chartDialog),null==(e=this.onDestroyColorSchemeChangeListener)||e.call(this);const t=this.getGui();s.ch.clearElement(t),s.ch.removeFromParent(t),this.raiseChartDestroyedEvent()}};Ur.TEMPLATE='<div class="ag-chart" tabindex="-1">\n            <div ref="eChartContainer" tabindex="-1" class="ag-chart-components-wrapper">\n                <div ref="eChart" class="ag-chart-canvas-wrapper"></div>\n                <div ref="eEmpty" class="ag-chart-empty-text ag-unselectable"></div>\n            </div>\n            <div ref="eTitleEditContainer"></div>\n            <div ref="eMenuContainer" class="ag-chart-docked-container" style="min-width: 0px;"></div>\n        </div>',Ye([(0,s.R)("eChart")],Ur.prototype,"eChart",2),Ye([(0,s.R)("eChartContainer")],Ur.prototype,"eChartContainer",2),Ye([(0,s.R)("eMenuContainer")],Ur.prototype,"eMenuContainer",2),Ye([(0,s.R)("eEmpty")],Ur.prototype,"eEmpty",2),Ye([(0,s.R)("eTitleEditContainer")],Ur.prototype,"eTitleEditContainer",2),Ye([(0,s.A)("chartCrossFilterService")],Ur.prototype,"crossFilterService",2),Ye([(0,s.A)("chartTranslationService")],Ur.prototype,"chartTranslationService",2),Ye([(0,s.A)("chartMenuService")],Ur.prototype,"chartMenuService",2),Ye([(0,s.A)("focusService")],Ur.prototype,"focusService",2),Ye([(0,s.A)("popupService")],Ur.prototype,"popupService",2),Ye([s.a],Ur.prototype,"init",1);var Hr=Ur,Wr="31.2.1";function Kr(e){return e.version,null==e.version&&(e.version=function(e){var t,i;const s=e;if(null!=e.version)return e.version;const r=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];return Object.keys(e||{}).some((e=>i.includes(e)))},a=s.chartOptions,o=r(a,"seriesDefaults")?null==a?void 0:a.seriesDefaults:null==a?void 0:a[Object.keys(a)[0]],n={"27.0.0":r(s,"seriesChartTypes"),"26.2.0":!r(a,"seriesDefaults"),"26.1.0":r(null==o?void 0:o.highlightStyle,"item"),"26.0.0":r(null==o?void 0:o.highlightStyle,"series"),"25.1.0":r(null==o?void 0:o.label,"minAngle"),"25.0.0":r(s,"modelType","aggFunc","unlinkChart","suppressChartRanges")||r(o,"lineDash","lineDashOffset"),"24.0.0":r(s,"chartThemeName","chart")||r(a,"series"),"23.2.0":r(a,"navigator"),"23.0.0":r(null==(i=null==(t=null==a?void 0:a.legend)?void 0:t.item)?void 0:i.marker,"shape"),"22.1.0":r(s,"chartPalette","chartType")},l="27.1.0",d=Object.entries(n).filter((e=>{let[t,i]=e;return i})),[h=l]=d[0];return h}(e)),e=ra("23.0.0",e,zr),e=ra("24.0.0",e,$r),e=ra("25.1.0",e,jr),e=ra("26.0.0",e,Yr),e=ra("26.1.0",e,qr),e=ra("26.2.0",e,Xr),e=ra("28.0.0",e,Zr),e=ra("28.2.0",e,Jr),e=ra("29.0.0",e,Qr),e=ra("29.1.0",e,ea),e=ra("29.2.0",e,ta),e=ra("30.0.0",e,ia),e=function(e){return e=ua("chartOptions.*.width",e),e=ua("chartOptions.*.height",e),e=na("chartOptions.*.axes.category.label.autoRotate",!0,e),e}(e=ra("31.0.0",e,sa)),e=ra(Wr,e,(e=>e))}function zr(e){return e=ca("chartOptions.legend.item.marker.type","shape",e),e=ca("chartOptions.seriesDefaults.marker.type","shape",e),e=ca("chartOptions.legend.padding","spacing",e)}function $r(e){var t;const i=e=ua("chartOptions.seriesDefaults.marker.minSize",e),{chartType:s,chartPalette:r,chartOptions:a}=i,o=a,{xAxis:n,yAxis:l}=o,d=je(o,["xAxis","yAxis"]),h=je(i,["chartType","chartPalette","chartOptions"]),c=function(e){switch(e){case"bar":case"stackedBar":case"normalizedBar":return["number","category"];case"groupedBar":return["number","grouped-category"];case"column":case"stackedColumn":case"normalizedColumn":case"line":case"area":case"stackedArea":case"normalizedArea":case"histogram":return["category","number"];case"groupedColumn":return["grouped-category","number"];case"scatter":case"bubble":return["number","number"];default:return}}(s),u=null==c?void 0:c.map(((e,t)=>ze({type:e},0===t?n:l)));return ze({chartType:s,chartThemeName:null!=(t={borneo:"ag-default",material:"ag-material",bright:"ag-vivid"}[r])?t:"ag-default",chartOptions:$e(ze({},d),{axes:u,xAxis:n,yAxis:l})},h)}function jr(e){return e=ca("chartOptions.seriesDefaults.label.minRequiredAngle","minAngle",e)}function Yr(e){return e=ua("chart",e=ga("chartOptions.seriesDefaults.highlightStyle",e,(e=>{var t=e,{dimOpacity:i}=t,s=je(t,["dimOpacity"]);return ze(ze({},s),null!=i?{series:{dimOpacity:i}}:{})}))),e=ua("chartOptions.seriesDefaults.tooltipClass",e),e=oa("chartOptions.axes[].label.rotation",0,e=ua("chartOptions.seriesDefaults.tooltipTracking",e)),e=oa("chartOptions.axes[].label.rotation",335,e)}function qr(e){const t=e=>{var t=e,{item:i,series:s}=t,r=je(t,["item","series"]);return ze({item:ze(ze({},r),i)},s?{series:s}:{})};return e=ga("chartOptions.seriesDefaults.highlightStyle",e,t),e=ga("chartOptions.series[].highlightStyle",e,t)}function Xr(e){e=da("chartOptions.seriesDefaults.fill.opacity","chartOptions.seriesDefaults.fillOpacity",e),e=da("chartOptions.seriesDefaults.stroke.opacity","chartOptions.seriesDefaults.strokeOpacity",e),e=ua("chartOptions.seriesDefaults.fill",e=da("chartOptions.seriesDefaults.stroke.width","chartOptions.seriesDefaults.strokeWidth",e)),e=ua("chartOptions.seriesDefaults.stroke",e),e=ua("chartOptions.seriesDefaults.callout.colors",e),e=ua("chartOptions.xAxis",e);const t=e=ua("chartOptions.yAxis",e),{chartType:i,chartOptions:s}=t,r=s,{axes:a,series:o,seriesDefaults:n}=r,l=je(r,["axes","series","seriesDefaults"]),d=je(t,["chartType","chartOptions"]),h=lt(i),c=dt(h),u=[c],p={};if(!ht(c)){const e={top:{},bottom:{},left:{},right:{}},t=a.map((t=>{var i=t,{type:s}=i,r=je(i,["type"]);return{[s]:ze(ze({},e),r)}})).reduce(ma,{});vt.filter((e=>null==t[e])).forEach((i=>{t[i]=ze({},e)})),p.axes=t}const g=u.map((e=>({[e]:ze($e(ze({},p),{series:n}),l)}))).reduce(ma,{});return e=$e(ze({},d),{chartType:h,chartOptions:g})}function Zr(e){return e=ua("chartOptions.*.title.padding",e),e=ua("chartOptions.*.subtitle.padding",e),e=na("chartOptions.*.axes.*.title.enabled",!1,e=ua("chartOptions.*.axes.*.title.padding",e))}function Jr(e){return e=ca("chartOptions.pie.series.callout","calloutLine",e),e=ca("chartOptions.pie.series.label","calloutLabel",e),e=ca("chartOptions.pie.series.labelKey","sectorLabelKey",e),e=ca("chartOptions.pie.series.labelName","sectorLabelName",e),e=ca("chartOptions.donut.series.callout","calloutLine",e),e=ca("chartOptions.donut.series.label","calloutLabel",e),e=ca("chartOptions.donut.series.labelKey","sectorLabelKey",e),e=ca("chartOptions.donut.series.labelName","sectorLabelName",e)}function Qr(e){return e=ha("chartOptions.scatter.series.fill","chartOptions.scatter.series.marker.fill",e),e=ha("chartOptions.scatter.series.fillOpacity","chartOptions.scatter.series.marker.fillOpacity",e),e=ha("chartOptions.scatter.series.stroke","chartOptions.scatter.series.marker.stroke",e),e=ha("chartOptions.scatter.series.strokeOpacity","chartOptions.scatter.series.marker.strokeOpacity",e),e=da("chartOptions.scatter.series.paired","chartOptions.scatter.paired",e=ha("chartOptions.scatter.series.strokeWidth","chartOptions.scatter.series.marker.strokeWidth",e))}function ea(e){return e=ua("chartOptions.axes[].tick.count",e)}function ta(e){return e=ga("chartOptions.*.tooltip",e,(e=>{var t=e,{tracking:i}=t,s=je(t,["tracking"]);const r=ze({},s);return!1===i?(null!=r.position||(r.position={type:"pointer"}),null!=r.range||(r.range="nearest")):!0===i&&(null!=r.position||(r.position={type:"node"}),null!=r.range||(r.range="nearest")),r}))}function ia(e){return e=ca("chartOptions.pie.series.labelKey","sectorLabelKey",e),e=na("chartOptions.common.legend.position","right",e=la("chartOptions.common.legend.enabled",!0,e=ua("chartOptions.*.series.flipXY",e=ta(e=ea(e=ca("chartOptions.pie.series.labelName","sectorLabelName",e))))))}function sa(e){const t=ca("chartOptions.column","bar",e),i={"ag-pastel":"ag-sheets","ag-solar":"ag-polychroma"}[t.chartThemeName]||t.chartThemeName;return $e(ze({},t),{chartThemeName:i})}function ra(e,t,i){if(aa(e)>aa(t.version)){const s=i(t);return s.version=e,s}return t}function aa(e){const{major:t,minor:i,patch:s}=function(e){const t="string"==typeof e?e.split(".").map((e=>Number(e))):[];if(3!==t.length||t.some((e=>isNaN(e))))throw new Error("AG Grid - Illegal version string: "+e);return{major:t[0],minor:t[1],patch:t[2]}}(e);return 1e4*t+100*i+s}function oa(e,t,i){return pa(e,!0,i,((e,i)=>{e[i]===t&&delete e[i]}))}function na(e,t,i){return pa(e,!1,i,((e,i)=>{null==e[i]&&(e[i]=t)}))}function la(e,t,i){var s;"string"==typeof e&&(e=e.split("."));const r=e[0];return e.length>1&&(i[r]=la(e.slice(1),t,null!=(s=i[r])?s:{})),Object.keys(i).includes(r)||(i[r]=t),i}function da(e,t,i){let s,r=!1;return i=pa(e,!0,i,((e,t)=>{r=!0,s=e[t],delete e[t]})),r?pa(t,!1,i,((e,t)=>{e[t]=s})):i}function ha(e,t,i){let s,r=!1;return i=pa(e,!0,i,((e,t)=>{r=!0,s=e[t],delete e[t]})),r?pa(t,!1,i,((e,t)=>{void 0===e[t]&&(e[t]=s)})):i}function ca(e,t,i){return pa(e,!0,i,((e,i)=>{e[t]=e[i],delete e[i]}))}function ua(e,t){return pa(e,!0,t,((e,t)=>delete e[t]))}function pa(e,t,i,s){const r=e instanceof Array?e:e.split("."),a=r.slice(0,r.length-1),o=r[r.length-1];return ga(a,i,(e=>{const i=Object.keys(e).includes(o);if(t&&!i)return e;const r=ze({},e);return s(r,o),r}))}function ga(e,t,i){const s=e instanceof Array?e:e.split(".");if(t=ze({},t),0===s.length)return i(t);if(s[0].startsWith("{")){const e=s[0].substring(1,s[0].lastIndexOf("}")).split(",");for(const r of e)null!=t[r]&&(t[r]=ga(s.slice(1),t[r],i))}else if(s[0].endsWith("[]")){const r=s[0].substring(0,e[0].indexOf("["));t[r]instanceof Array&&(t[r]=t[r].map((e=>ga(s.slice(1),e,i))))}else if("*"===s[0])for(const r in t)t[r]=ga(s.slice(1),t[r],i);else null!=t[s[0]]&&(t[s[0]]=ga(s.slice(1),t[s[0]],i));return t}var ma=(e,t)=>ze(ze({},e),t),va=class extends s.B{constructor(){super(...arguments),this.activeCharts=new Set,this.activeChartComps=new Set,this.crossFilteringContext={lastSelectedChartId:""},this.isEnterprise=()=>r.m.enterpriseModule.isEnterprise}updateChart(e){const t=e.chartType;if(t&&tt(t)&&!this.isEnterprise())return void s.e.__warnEnterpriseChartDisabled(t);if(0===this.activeChartComps.size)return void console.warn("AG Grid - No active charts to update.");const i=[...this.activeChartComps].find((t=>t.getChartId()===e.chartId));i?i.update(e):console.warn(`AG Grid - Unable to update chart. No active chart found with ID: ${e.chartId}.`)}getChartModels(){const e=[];return this.activeChartComps.forEach((t=>e.push((e=>$e(ze({},e),{version:Wr}))(t.getChartModel())))),e}getChartRef(e){let t;return this.activeCharts.forEach((i=>{i.chartId===e&&(t=i)})),t}getChartComp(e){let t;return this.activeChartComps.forEach((i=>{i.getChartId()===e&&(t=i)})),t}getChartImageDataURL(e){let t;return this.activeChartComps.forEach((i=>{i.getChartId()===e.chartId&&(t=i.getChartImageDataURL(e.fileFormat))})),t}downloadChart(e){const t=Array.from(this.activeChartComps).find((t=>t.getChartId()===e.chartId));null==t||t.downloadChart(e.dimensions,e.fileName,e.fileFormat)}openChartToolPanel(e){const t=Array.from(this.activeChartComps).find((t=>t.getChartId()===e.chartId));null==t||t.openChartToolPanel(e.panel)}closeChartToolPanel(e){const t=Array.from(this.activeChartComps).find((t=>t.getChartId()===e));null==t||t.closeChartToolPanel()}createChartFromCurrentRange(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"groupedColumn";const t=this.getSelectedRange();return this.createChart(t,e)}restoreChart(e,t){if(!e)return void console.warn("AG Grid - unable to restore chart as no chart model is provided");e.version!==Wr&&(e=Kr(e));const i={cellRange:e.cellRange,chartType:e.chartType,chartThemeName:e.chartThemeName,chartContainer:t,suppressChartRanges:e.suppressChartRanges,switchCategorySeries:e.switchCategorySeries,aggFunc:e.aggFunc,unlinkChart:e.unlinkChart,seriesChartTypes:e.seriesChartTypes},s=e=>this.rangeService?this.rangeService.createCellRangeFromCellRangeParams(e):void 0;if("pivot"===e.modelType){this.gridOptionsService.updateGridOptions({options:{pivotMode:!0},source:"pivotChart"});const t=s({rowStartIndex:null,rowStartPinned:void 0,rowEndIndex:null,rowEndPinned:void 0,columns:this.columnModel.getAllDisplayedColumns().map((e=>e.getColId()))});return t?this.createChart(t,i.chartType,i.chartThemeName,!0,!0,i.chartContainer,!1,void 0,void 0,i.unlinkChart,!1,e.chartOptions):void console.warn("AG Grid - unable to create chart as there are no columns in the grid.")}const r=s(i.cellRange);if(r)return this.createChart(r,i.chartType,i.chartThemeName,!1,i.suppressChartRanges,i.chartContainer,i.switchCategorySeries,i.aggFunc,void 0,i.unlinkChart,!1,e.chartOptions,e.chartPalette,i.seriesChartTypes);console.warn("AG Grid - unable to create chart as no range is selected")}createRangeChart(e){var t;const i=null==(t=this.rangeService)?void 0:t.createCellRangeFromCellRangeParams(e.cellRange);if(i)return this.createChart(i,e.chartType,e.chartThemeName,!1,e.suppressChartRanges,e.chartContainer,e.switchCategorySeries,e.aggFunc,e.chartThemeOverrides,e.unlinkChart,void 0,void 0,void 0,e.seriesChartTypes);console.warn("AG Grid - unable to create chart as no range is selected")}createPivotChart(e){this.gridOptionsService.updateGridOptions({options:{pivotMode:!0},source:"pivotChart"});const t={rowStartIndex:null,rowStartPinned:void 0,rowEndIndex:null,rowEndPinned:void 0,columns:this.columnModel.getAllDisplayedColumns().map((e=>e.getColId()))},i=this.rangeService?this.rangeService.createCellRangeFromCellRangeParams(t):void 0;if(i)return this.createChart(i,e.chartType,e.chartThemeName,!0,!0,e.chartContainer,!1,void 0,e.chartThemeOverrides,e.unlinkChart);console.warn("AG Grid - unable to create chart as there are no columns in the grid.")}createCrossFilterChart(e){var t;const i=null==(t=this.rangeService)?void 0:t.createCellRangeFromCellRangeParams(e.cellRange);if(!i)return void console.warn("AG Grid - unable to create chart as no range is selected");const s=!(typeof e.suppressChartRanges<"u"&&null!==e.suppressChartRanges)||e.suppressChartRanges;return this.createChart(i,e.chartType,e.chartThemeName,!1,s,e.chartContainer,!1,e.aggFunc,e.chartThemeOverrides,e.unlinkChart,!0)}createChart(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0,n=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=arguments.length>7?arguments[7]:void 0,d=arguments.length>8?arguments[8]:void 0,h=arguments.length>9&&void 0!==arguments[9]&&arguments[9],c=arguments.length>10&&void 0!==arguments[10]&&arguments[10],u=arguments.length>11?arguments[11]:void 0,p=arguments.length>12?arguments[12]:void 0,g=arguments.length>13?arguments[13]:void 0;if(tt(t)&&!this.isEnterprise())return void s.e.__warnEnterpriseChartDisabled(t);const m=this.gridOptionsService.getCallback("createChartContainer"),v={chartId:this.generateId(),pivotChart:r,cellRange:e,chartType:lt(t),chartThemeName:i,insideDialog:!(o||m),suppressChartRanges:a,switchCategorySeries:n,aggFunc:l,chartThemeOverrides:d,unlinkChart:h,crossFiltering:c,crossFilteringContext:this.crossFilteringContext,chartOptionsToRestore:u,chartPaletteToRestore:p,seriesChartTypes:g,crossFilteringResetCallback:()=>this.activeChartComps.forEach((e=>e.crossFilteringReset()))},C=new Hr(v);this.context.createBean(C);const f=this.createChartRef(C);if(o){o.appendChild(C.getGui());const e=this.environment.getTheme();e.el&&!e.el.contains(o)&&o.classList.add(e.theme)}else m?m(f):C.addEventListener(Hr.EVENT_DESTROYED,(()=>{this.activeChartComps.delete(C),this.activeCharts.delete(f)}));return f}createChartRef(e){const t={destroyChart:()=>{this.activeCharts.has(t)&&(this.context.destroyBean(e),this.activeChartComps.delete(e),this.activeCharts.delete(t))},chartElement:e.getGui(),chart:e.getUnderlyingChart(),chartId:e.getChartModel().chartId};return this.activeCharts.add(t),this.activeChartComps.add(e),t}getSelectedRange(){const e=this.rangeService.getCellRanges();return e.length>0?e[0]:{}}generateId(){return`id-${Math.random().toString(36).substring(2,18)}`}destroyAllActiveCharts(){this.activeCharts.forEach((e=>e.destroyChart()))}};va.CHARTS_VERSION=r.V,Ye([(0,s.O)("rangeService")],va.prototype,"rangeService",2),Ye([(0,s.A)("columnModel")],va.prototype,"columnModel",2),Ye([s.b],va.prototype,"destroyAllActiveCharts",1),va=Ye([(0,s._)("chartService")],va);var Ca=class extends s.B{translate(e){return this.localeService.getLocaleTextFunc()(e,Ca.DEFAULT_TRANSLATIONS[e])}};Ca.DEFAULT_TRANSLATIONS={pivotChartTitle:"Pivot Chart",rangeChartTitle:"Range Chart",settings:"Chart",data:"Data",format:"Format",categories:"Categories",defaultCategory:"(None)",series:"Series",switchCategorySeries:"Switch Category / Series",categoryValues:"Category Values",seriesLabels:"Series Labels",aggregate:"Aggregate",xyValues:"X Y Values",paired:"Paired Mode",axis:"Axis",xAxis:"Horizontal Axis",yAxis:"Vertical Axis",polarAxis:"Polar Axis",radiusAxis:"Radius Axis",navigator:"Navigator",zoom:"Zoom",animation:"Animation",crosshair:"Crosshair",color:"Color",thickness:"Thickness",preferredLength:"Preferred Length",xType:"X Type",axisType:"Axis Type",automatic:"Automatic",category:"Category",number:"Number",time:"Time",timeFormat:"Time Format",autoRotate:"Auto Rotate",labelRotation:"Rotation",circle:"Circle",orientation:"Orientation",polygon:"Polygon",fixed:"Fixed",parallel:"Parallel",perpendicular:"Perpendicular",radiusAxisPosition:"Position",ticks:"Ticks",gridLines:"Grid Lines",width:"Width",height:"Height",length:"Length",padding:"Padding",spacing:"Spacing",chart:"Chart",title:"Title",titlePlaceholder:"Chart title - double click to edit",background:"Background",font:"Font",top:"Top",right:"Right",bottom:"Bottom",left:"Left",labels:"Labels",calloutLabels:"Callout Labels",sectorLabels:"Sector Labels",positionRatio:"Position Ratio",size:"Size",shape:"Shape",minSize:"Minimum Size",maxSize:"Maximum Size",legend:"Legend",position:"Position",markerSize:"Marker Size",markerStroke:"Marker Stroke",markerPadding:"Marker Padding",itemSpacing:"Item Spacing",itemPaddingX:"Item Padding X",itemPaddingY:"Item Padding Y",layoutHorizontalSpacing:"Horizontal Spacing",layoutVerticalSpacing:"Vertical Spacing",strokeWidth:"Stroke Width",offset:"Offset",offsets:"Offsets",tooltips:"Tooltips",callout:"Callout",markers:"Markers",shadow:"Shadow",blur:"Blur",xOffset:"X Offset",yOffset:"Y Offset",lineWidth:"Line Width",lineDash:"Line Dash",lineDashOffset:"Dash Offset",scrollingZoom:"Scrolling",scrollingStep:"Scrolling Step",selectingZoom:"Selecting",durationMillis:"Duration (ms)",crosshairLabel:"Label",crosshairSnap:"Snap to Node",normal:"Normal",bold:"Bold",italic:"Italic",boldItalic:"Bold Italic",predefined:"Predefined",fillOpacity:"Fill Opacity",strokeColor:"Line Color",strokeOpacity:"Line Opacity",miniChart:"Mini-Chart",histogramBinCount:"Bin count",connectorLine:"Connector Line",seriesItems:"Series Items",seriesItemType:"Item Type",seriesItemPositive:"Positive",seriesItemNegative:"Negative",seriesItemLabels:"Item Labels",columnGroup:"Column",barGroup:"Bar",pieGroup:"Pie",lineGroup:"Line",scatterGroup:"X Y (Scatter)",areaGroup:"Area",polarGroup:"Polar",statisticalGroup:"Statistical",hierarchicalGroup:"Hierarchical",specializedGroup:"Specialized",combinationGroup:"Combination",groupedColumnTooltip:"Grouped",stackedColumnTooltip:"Stacked",normalizedColumnTooltip:"100% Stacked",groupedBarTooltip:"Grouped",stackedBarTooltip:"Stacked",normalizedBarTooltip:"100% Stacked",pieTooltip:"Pie",donutTooltip:"Donut",lineTooltip:"Line",groupedAreaTooltip:"Area",stackedAreaTooltip:"Stacked",normalizedAreaTooltip:"100% Stacked",scatterTooltip:"Scatter",bubbleTooltip:"Bubble",histogramTooltip:"Histogram",radialColumnTooltip:"Radial Column",radialBarTooltip:"Radial Bar",radarLineTooltip:"Radar Line",radarAreaTooltip:"Radar Area",nightingaleTooltip:"Nightingale",rangeBarTooltip:"Range Bar",rangeAreaTooltip:"Range Area",boxPlotTooltip:"Box Plot",treemapTooltip:"Treemap",sunburstTooltip:"Sunburst",heatmapTooltip:"Heatmap",waterfallTooltip:"Waterfall",columnLineComboTooltip:"Column & Line",areaColumnComboTooltip:"Area & Column",customComboTooltip:"Custom Combination",innerRadius:"Inner Radius",startAngle:"Start Angle",endAngle:"End Angle",reverseDirection:"Reverse Direction",groupPadding:"Group Padding",seriesPadding:"Series Padding",group:"Group",tile:"Tile",whisker:"Whisker",cap:"Cap",capLengthRatio:"Length Ratio",labelPlacement:"Placement",inside:"Inside",outside:"Outside",noDataToChart:"No data available to be charted.",pivotChartRequiresPivotMode:"Pivot Chart requires Pivot Mode enabled.",chartSettingsToolbarTooltip:"Menu",chartLinkToolbarTooltip:"Linked to Grid",chartUnlinkToolbarTooltip:"Unlinked from Grid",chartDownloadToolbarTooltip:"Download Chart",chartMenuToolbarTooltip:"Menu",chartEdit:"Edit Chart",chartAdvancedSettings:"Advanced Settings",chartLink:"Link to Grid",chartUnlink:"Unlink from Grid",chartDownload:"Download Chart",histogramFrequency:"Frequency",seriesChartType:"Series Chart Type",seriesType:"Series Type",secondaryAxis:"Secondary Axis",seriesAdd:"Add a series",categoryAdd:"Add a category",area:"Area",bar:"Bar",column:"Column",line:"Line",scatter:"Scatter",histogram:"Histogram",radialColumn:"Radial Column",radialBar:"Radial Bar",radarLine:"Radar Line",radarArea:"Radar Area",nightingale:"Nightingale",rangeBar:"Range Bar",rangeArea:"Range Area",treemap:"Treemap",sunburst:"Sunburst",waterfall:"Waterfall",boxPlot:"Box Plot",pie:"Pie",donut:"Donut",stackedArea:"StackedArea",groupedColumn:"Grouped Column",stackedColumn:"Stacked Column",advancedSettings:"Advanced Settings",ariaChartMenuClose:"Close Chart Edit Menu",timeFormatSlashesDDMMYYYY:"DD/MM/YYYY",timeFormatSlashesMMDDYYYY:"MM/DD/YYYY",timeFormatSlashesDDMMYY:"DD/MM/YY",timeFormatSlashesMMDDYY:"MM/DD/YY",timeFormatDotsDDMYY:"DD.M.YY",timeFormatDotsMDDYY:"M.DD.YY",timeFormatDashesYYYYMMDD:"YYYY-MM-DD",timeFormatSpacesDDMMMMYYYY:"DD MMMM YYYY",timeFormatHHMMSS:"HH:MM:SS",timeFormatHHMMSSAmPm:"HH:MM:SS AM/PM",sum:"Sum",first:"First",last:"Last",min:"Min",max:"Max",count:"Count",avg:"Average"},Ca=Ye([(0,s._)("chartTranslationService")],Ca);var fa=class extends s.B{filter(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=this.gridApi.getFilterModel();if(t)return void this.resetFilters(i);let s=fa.extractFilterColId(e);this.isValidColumnFilter(s)?this.updateFilters(i,e,s):console.warn("AG Grid: cross filtering requires a 'agSetColumnFilter' or 'agMultiColumnFilter' to be defined on the column with id: '"+s+"'")}resetFilters(e){Object.keys(e).length>0&&(this.gridApi.setFilterModel(null),this.gridApi.onFilterChanged())}updateFilters(e,t,i){let r=fa.extractFilterColId(t),a=t.datum[r];if(void 0===a)return;let o=a.toString();if(t.event.metaKey||t.event.ctrlKey){const t=this.getCurrentGridValuesForCategory(i);let r;s.ch.includes(t,o)?r=t.filter((e=>e!==o)):(r=t,r.push(o)),e[i]=this.getUpdatedFilterModel(i,r)}else{const t=[o];e={[i]:this.getUpdatedFilterModel(i,t)}}this.gridApi.setFilterModel(e)}getUpdatedFilterModel(e,t){return"agMultiColumnFilter"===this.getColumnFilterType(e)?{filterType:"multi",filterModels:[null,{filterType:"set",values:t}]}:{filterType:"set",values:t}}getCurrentGridValuesForCategory(e){let t=[];const i=this.getColumnById(e);return this.gridApi.forEachNodeAfterFilter((e=>{if(i&&!e.group){const s=this.valueService.getValue(i,e)+"";t.includes(s)||t.push(s)}})),t}static extractFilterColId(e){return e.xKey||e.calloutLabelKey}isValidColumnFilter(e){e.indexOf("-filtered-out")&&(e=e.replace("-filtered-out",""));let t=this.getColumnFilterType(e);return"boolean"==typeof t?t:s.ch.includes(["agSetColumnFilter","agMultiColumnFilter"],t)}getColumnFilterType(e){let t=this.getColumnById(e);if(t)return t.getColDef().filter}getColumnById(e){return this.columnModel.getGridColumn(e)}};Ye([(0,s.A)("gridApi")],fa.prototype,"gridApi",2),Ye([(0,s.A)("columnModel")],fa.prototype,"columnModel",2),Ye([(0,s.A)("valueService")],fa.prototype,"valueService",2),fa=Ye([(0,s._)("chartCrossFilterService")],fa);var ya=28,Sa=6;function Ea(e){return e&&e.match(/\d+\.\d+\.\d+/)}function ba(e){let{type:t,gridVersion:i,chartsVersion:s}=e;const r="AG Grid: AG Grid version is incompatible. Please see https://www.ag-grid.com/javascript-data-grid/modules/ for more information.";if(!i)return r;const a=function(e){if(!e||!Ea(e))return;const[t,i]=e.split(".")||[],s=`${t}.${i}.x`,r=parseInt(t,10)-ya+Sa;if(r<0)return;return{gridMajorMinor:s,chartsMajorMinor:`${r}.${i}.x`}}(i);if(!a)return r;const{gridMajorMinor:o,chartsMajorMinor:n}=a;return"incompatible"===t?`AG Grid version ${i} and AG Charts version ${s} is not supported. AG Grid version ${o} should be used with AG Chart ${n}. Please see https://www.ag-grid.com/javascript-data-grid/modules/ for more information.`:"invalidCharts"===t?`AG Grid version ${o} should be used with AG Chart ${n}. Please see https://www.ag-grid.com/javascript-data-grid/modules/ for more information.`:r}function wa(e){let{gridVersion:t,chartsVersion:i}=e;if(!Ea(i))return{isValid:!1,message:ba({type:"invalidCharts",gridVersion:t,chartsVersion:i})};if(!Ea(t))return{isValid:!1,message:ba({type:"invalidGrid",gridVersion:t,chartsVersion:i})};const[s,r]=t.split(".")||[],[a,o]=i.split(".")||[],n=function(e){let{gridMajorVersion:t,chartsMajorVersion:i}=e;const s=parseInt(t,10),r=parseInt(i,10),a=s-ya;return a===r-Sa&&a>=0}({gridMajorVersion:s,chartsMajorVersion:a});return n&&r===o?{isValid:!0}:n&&r===o?{isValid:!1,message:ba({type:"invalid",gridVersion:t,chartsVersion:i})}:{isValid:!1,message:ba({type:"incompatible",gridVersion:t,chartsVersion:i})}}var Aa=class extends s.B{showMenuList(e){const{eventSource:t,showMenu:i,chartMenuContext:s}=e,r=this.chartMenuService.doChartToolPanelsExist(s.chartController),a=this.mapWithStockItems(this.getMenuItems(s.chartController,r),s,i,t,r);if(!a.length)return;const o=this.createBean(new xa(a));this.activeChartMenuList=o;let n=-1,l="left";this.gridOptionsService.get("enableRtl")&&(n=1,l="right");const d=o.getGui();this.popupService.addPopup({modal:!0,eChild:d,closeOnEsc:!0,closedCallback:()=>{this.destroyBean(o),this.activeChartMenuList=void 0;const e=this.gridOptionsService.getDocument();e.activeElement===e.body&&t.focus({preventScroll:!0})},afterGuiAttached:e=>o.afterGuiAttached(e),positionCallback:()=>{this.popupService.positionPopupByComponent({type:"chartMenu",eventSource:t,ePopup:d,alignSide:l,nudgeX:4*n,nudgeY:4,position:"under",keepWithinBounds:!0})},ariaLabel:"Chart Menu"})}getMenuItems(e,t){const i=[...t?["chartEdit"]:[],...e.isEnterprise()?["chartAdvancedSettings"]:[],e.isChartLinked()?"chartUnlink":"chartLink","chartDownload"],s=this.gridOptionsService.get("chartMenuItems");return s?Array.isArray(s)?s:s(this.gridOptionsService.addGridCommonParams({defaultItems:i})):i}mapWithStockItems(e,t,i,s,r){if(!e)return[];const a=[];return e.forEach((e=>{let o;if(o="string"==typeof e?this.getStockMenuItem(e,t,i,s,r):ze({},e),!o)return;const{subMenu:n}=o;Array.isArray(n)&&(o.subMenu=this.mapWithStockItems(n,t,i,s,r)),a.push(o)})),a}getStockMenuItem(e,t,i,s,r){switch(e){case"chartEdit":return r?this.createMenuItem(this.chartTranslationService.translate("chartEdit"),"chartsMenuEdit",i):null;case"chartAdvancedSettings":return this.createMenuItem(this.chartTranslationService.translate("chartAdvancedSettings"),"chartsMenuAdvancedSettings",(()=>this.chartMenuService.openAdvancedSettings(t,s)));case"chartUnlink":return t.chartController.isChartLinked()?this.createMenuItem(this.chartTranslationService.translate("chartUnlink"),"unlinked",(()=>this.chartMenuService.toggleLinked(t))):null;case"chartLink":return t.chartController.isChartLinked()?null:this.createMenuItem(this.chartTranslationService.translate("chartLink"),"linked",(()=>this.chartMenuService.toggleLinked(t)));case"chartDownload":return this.createMenuItem(this.chartTranslationService.translate("chartDownload"),"save",(()=>this.chartMenuService.downloadChart(t)))}return null}createMenuItem(e,t,i){return{name:e,icon:s.ch.createIconNoSpan(t,this.gridOptionsService,null),action:i}}destroy(){this.destroyBean(this.activeChartMenuList),super.destroy()}};Ye([(0,s.A)("popupService")],Aa.prototype,"popupService",2),Ye([(0,s.A)("chartMenuService")],Aa.prototype,"chartMenuService",2),Ye([(0,s.A)("chartTranslationService")],Aa.prototype,"chartTranslationService",2),Aa=Ye([(0,s._)("chartMenuListFactory")],Aa);var xa=class extends s.ak{constructor(e){super('\n            <div ref="eChartsMenu" role="presentation" class="ag-menu ag-chart-menu-popup"></div>\n        '),this.menuItems=e}init(){this.mainMenuList=this.createManagedBean(new s.w(0)),this.mainMenuList.addMenuItems(this.menuItems),this.mainMenuList.addEventListener(s.u.EVENT_CLOSE_MENU,this.onHidePopup.bind(this)),this.eChartsMenu.appendChild(this.mainMenuList.getGui())}onHidePopup(){var e;null==(e=this.hidePopupFunc)||e.call(this)}afterGuiAttached(e){let{hidePopup:t}=e;t&&(this.hidePopupFunc=t,this.addDestroyFunc(t)),this.focusService.focusInto(this.mainMenuList.getGui())}};Ye([(0,s.A)("focusService")],xa.prototype,"focusService",2),Ye([(0,s.R)("eChartsMenu")],xa.prototype,"eChartsMenu",2),Ye([s.a],xa.prototype,"init",1);var Ta=class e extends s.ak{constructor(e){super(),this.chartMenuParamsFactory=e}init(){const t=this.chartMenuParamsFactory.addEnableParams("animation.enabled",{cssIdentifier:"charts-advanced-settings-top-level",direction:"vertical",suppressOpenCloseIcons:!0,title:this.chartTranslationService.translate("animation"),suppressEnabledCheckbox:!0,useToggle:!0}),i=this.chartMenuParamsFactory.getDefaultNumberInputParams("animation.duration","durationMillis",{min:0});this.setTemplate(e.TEMPLATE,{animationGroup:t,animationHeightInput:i})}};Ta.TEMPLATE='<div>\n            <ag-group-component ref="animationGroup">\n                <ag-input-number-field ref="animationHeightInput"></ag-input>\n            </ag-group-component>\n        </div>',Ye([(0,s.A)("chartTranslationService")],Ta.prototype,"chartTranslationService",2),Ye([s.a],Ta.prototype,"init",1);var Ma=Ta,Pa=class e extends s.ak{constructor(e){super(),this.chartMenuParamsFactory=e}init(){const t=this.chartMenuParamsFactory.addEnableParams("crosshair.enabled",{cssIdentifier:"charts-advanced-settings-top-level",direction:"vertical",suppressOpenCloseIcons:!0,title:this.chartTranslationService.translate("crosshair"),suppressEnabledCheckbox:!0,useToggle:!0}),i=this.chartMenuParamsFactory.getDefaultCheckboxParams("crosshair.label.enabled","crosshairLabel"),s=this.chartMenuParamsFactory.getDefaultCheckboxParams("crosshair.snap","crosshairSnap"),r=this.chartMenuParamsFactory.getDefaultColorPickerParams("crosshair.stroke","color");this.setTemplate(e.TEMPLATE,{crosshairGroup:t,crosshairLabelCheckbox:i,crosshairSnapCheckbox:s,crosshairStrokeColorPicker:r})}};Pa.TEMPLATE='<div>\n            <ag-group-component ref="crosshairGroup">\n                <ag-checkbox ref="crosshairLabelCheckbox"></ag-checkbox>\n                <ag-checkbox ref="crosshairSnapCheckbox"></ag-checkbox>\n                <ag-color-picker ref="crosshairStrokeColorPicker"></ag-color-picker>\n            </ag-group-component>\n        </div>',Ye([(0,s.A)("chartTranslationService")],Pa.prototype,"chartTranslationService",2),Ye([s.a],Pa.prototype,"init",1);var Fa=Pa,Da=class e extends s.ak{constructor(e){super(),this.chartMenuParamsFactory=e}init(){const t=this.chartMenuParamsFactory.addEnableParams("navigator.enabled",{cssIdentifier:"charts-advanced-settings-top-level",direction:"vertical",suppressOpenCloseIcons:!0,title:this.chartTranslationService.translate("navigator"),suppressEnabledCheckbox:!0,useToggle:!0}),i=this.chartMenuParamsFactory.getDefaultSliderParams("navigator.height","height",60);i.minValue=10;const s=this.chartMenuParamsFactory.getDefaultCheckboxParams("navigator.miniChart.enabled","miniChart");this.setTemplate(e.TEMPLATE,{navigatorGroup:t,navigatorHeightSlider:i,navigatorMiniChartCheckbox:s})}};Da.TEMPLATE='<div>\n            <ag-group-component ref="navigatorGroup">\n                <ag-slider ref="navigatorHeightSlider"></ag-slider>\n                <ag-checkbox ref="navigatorMiniChartCheckbox"></ag-checkbox>\n            </ag-group-component>\n        </div>',Ye([(0,s.A)("chartTranslationService")],Da.prototype,"chartTranslationService",2),Ye([s.a],Da.prototype,"init",1);var Ra=Da,La=class e extends s.ak{constructor(e){super(),this.chartMenuParamsFactory=e}init(){const t=this.chartMenuParamsFactory.addEnableParams("zoom.enabled",{cssIdentifier:"charts-advanced-settings-top-level",direction:"vertical",suppressOpenCloseIcons:!0,title:this.chartTranslationService.translate("zoom"),suppressEnabledCheckbox:!0,useToggle:!0}),i=this.chartMenuParamsFactory.getDefaultCheckboxParams("zoom.enableScrolling","scrollingZoom"),s=this.chartMenuParamsFactory.getDefaultSliderParams("zoom.scrollingStep","scrollingStep",1);s.step=.01,s.minValue=s.step;const r=this.chartMenuParamsFactory.getDefaultCheckboxParams("zoom.enableSelecting","selectingZoom");i.onValueChange=(e=>t=>{e&&(e(t),this.zoomScrollingStepInput.setDisabled(!t))})(i.onValueChange),this.setTemplate(e.TEMPLATE,{zoomGroup:t,zoomScrollingCheckbox:i,zoomScrollingStepInput:s,zoomSelectingCheckbox:r}),this.zoomScrollingStepInput.setDisabled(!i.value)}};La.TEMPLATE='<div>\n            <ag-group-component ref="zoomGroup">\n                <ag-checkbox ref="zoomSelectingCheckbox"></ag-checkbox>\n                <ag-checkbox ref="zoomScrollingCheckbox"></ag-checkbox>\n                <ag-slider ref="zoomScrollingStepInput"></ag-slider>\n            </ag-group-component>\n        </div>',Ye([(0,s.A)("chartTranslationService")],La.prototype,"chartTranslationService",2),Ye([(0,s.R)("zoomScrollingStepInput")],La.prototype,"zoomScrollingStepInput",2),Ye([s.a],La.prototype,"init",1);var Ia=La,Oa=["navigator","zoom","animation","crosshair"],Na=["navigator","zoom","crosshair"],ka={cartesian:Na,column:Na,bar:Na,line:Na,area:Na,scatter:Na,histogram:Na,bubble:Na,"range-bar":Na,"range-area":Na,"box-plot":Na,waterfall:Na},Ga=class e extends s.ak{constructor(t){super(e.TEMPLATE),this.chartMenuContext=t}postConstruct(){this.chartPanelFeature=this.createManagedBean(new qi(this.chartMenuContext.chartController,this.getGui(),"ag-chart-advanced-settings-section",((e,t)=>this.createPanels(e,t)))),this.chartPanelFeature.refreshPanels()}createPanels(e,t){Oa.forEach((e=>{if(!this.isGroupPanelShownForSeries(e,t))return;const i=this.createPanel(e);i&&this.chartPanelFeature.addComponent(i)}))}isGroupPanelShownForSeries(e,t){var i,s;return"animation"===e||null!=(s=null==(i=ka[t])?void 0:i.includes(e))&&s}createPanel(e){const{chartMenuParamsFactory:t,chartAxisMenuParamsFactory:i}=this.chartMenuContext;switch(e){case"navigator":return new Ra(t);case"zoom":return new Ia(t);case"animation":return new Ma(t);case"crosshair":return new Fa(i)}return s.ch.warnOnce(`Invalid charts advanced settings group name supplied: '${e}'`),null}};Ga.TEMPLATE='<div class="ag-chart-advanced-settings-wrapper"></div>',Ye([s.a],Ga.prototype,"postConstruct",1);var Va=Ga,Ba=class extends s.B{showMenu(e,t){this.hideMenu();const i=this.createBean(new Ua(e));this.activeDialog=this.createBean(new s.n({title:this.chartTranslationService.translate("advancedSettings"),component:i,width:300,height:400,resizable:!0,movable:!0,centered:!0,closable:!0,afterGuiAttached:()=>{var e;null==(e=this.focusService.findFocusableElements(i.getGui())[0])||e.focus()},closedCallback:()=>{this.activeMenu=this.destroyBean(this.activeMenu),this.activeDialog=void 0,null==t||t.focus({preventScroll:!0})}})),this.activeMenu=i}hideMenu(){this.activeDialog&&this.destroyBean(this.activeDialog)}destroy(){this.activeMenu=this.destroyBean(this.activeMenu),this.activeDialog=this.destroyBean(this.activeDialog),super.destroy()}};Ye([(0,s.A)("focusService")],Ba.prototype,"focusService",2),Ye([(0,s.A)("chartTranslationService")],Ba.prototype,"chartTranslationService",2),Ba=Ye([(0,s._)("advancedSettingsMenuFactory")],Ba);var _a=class e extends s.bY{constructor(t){super(e.TEMPLATE),this.chartMenuContext=t}postConstruct(){this.advancedSettingsPanel=this.createManagedBean(new Va(this.chartMenuContext)),this.getGui().appendChild(this.advancedSettingsPanel.getGui()),this.initialiseTabGuard({onTabKeyDown:this.onTabKeyDown.bind(this),focusTrapActive:!0})}onTabKeyDown(e){if(e.defaultPrevented)return;e.preventDefault();const t=e.shiftKey,i=this.advancedSettingsPanel.getGui(),s=this.focusService.findNextFocusableElement(i,!1,t);if(s)s.focus();else{const e=this.focusService.findFocusableElements(i);e.length&&e[t?e.length-1:0].focus()}}};_a.TEMPLATE='<div class="ag-chart-advanced-settings"></div>',Ye([(0,s.A)("focusService")],_a.prototype,"focusService",2),Ye([s.a],_a.prototype,"postConstruct",1);var Ua=_a,Ha={version:Wr,validate:()=>wa({gridVersion:Wr,chartsVersion:va.CHARTS_VERSION}),moduleName:s.M.GridChartsModule,beans:[va,Ca,fa,Aa,_r,Ba],agStackComponents:[{componentName:"AgColorPicker",componentClass:Li},{componentName:"AgAngleSelect",componentClass:ci},{componentName:"AgPillSelect",componentClass:Ut}],dependantModules:[ke,E]},Wa=0,Ka={time:r.t,AgChart:r.A},za=Object.defineProperty,$a=Object.getOwnPropertyDescriptor,ja=(e,t,i,s)=>{for(var r,a=s>1?void 0:s?$a(t,i):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s?r(t,i,a):r(a))||a);return s&&a&&za(t,i,a),a},Ya="paste",qa="dragCopy",Xa="clipboard",Za=e=>`AG Grid: Unable to use the Clipboard API (navigator.clipboard.${e}()). The reason why it could not be used has been logged in the previous line. For this reason the grid has defaulted to using a workaround which doesn't perform as well. Either fix why Clipboard API is blocked, OR stop this message from appearing by setting grid property suppressClipboardApi=true (which will default the grid to using the workaround rather than the API.`,Ja=class extends s.B{constructor(){super(...arguments),this.lastPasteOperationTime=0,this.navigatorApiFailed=!1}init(){this.logger=this.loggerFactory.create("ClipboardService"),"clientSide"===this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel),this.ctrlsService.whenReady((e=>{this.gridCtrl=e.gridCtrl}))}pasteFromClipboard(){this.logger.log("pasteFromClipboard"),!this.gridOptionsService.get("suppressClipboardApi")&&!this.navigatorApiFailed&&navigator.clipboard&&navigator.clipboard.readText?navigator.clipboard.readText().then(this.processClipboardData.bind(this)).catch((e=>{s.ch.doOnce((()=>{console.warn(e),console.warn(Za("readText"))}),"clipboardApiError"),this.navigatorApiFailed=!0,this.pasteFromClipboardLegacy()})):this.pasteFromClipboardLegacy()}pasteFromClipboardLegacy(){let e=!1;const t=t=>{const i=(new Date).getTime();i-this.lastPasteOperationTime<50&&(e=!0,t.preventDefault()),this.lastPasteOperationTime=i};this.executeOnTempElement((e=>{e.addEventListener("paste",t),e.focus({preventScroll:!0})}),(i=>{const s=i.value;e?this.refocusLastFocusedCell():this.processClipboardData(s),i.removeEventListener("paste",t)}))}refocusLastFocusedCell(){const e=this.focusService.getFocusedCell();e&&this.focusService.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0})}getClipboardDelimiter(){const e=this.gridOptionsService.get("clipboardDelimiter");return s.ch.exists(e)?e:"\t"}processClipboardData(e){if(null==e)return;let t=Ja.stringToArray(e,this.getClipboardDelimiter());const i=this.gridOptionsService.getCallback("processDataFromClipboard");if(i&&(t=i({data:t})),null==t)return;this.gridOptionsService.get("suppressLastEmptyLineOnPaste")&&this.removeLastLineIfBlank(t);this.doPasteOperation(((e,i,s,r)=>{this.rangeService&&this.rangeService.isMoreThanOneCell()&&!this.hasOnlyOneValueToPaste(t)?this.pasteIntoActiveRange(t,e,i,r):this.pasteStartingFromFocusedCell(t,e,i,s,r)}))}static stringToArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";const i=[],s=e=>"\r"===e||"\n"===e;let r=!1;if(""===e)return[[""]];for(let a=0,o=0,n=0;n<e.length;n++){const l=e[n-1],d=e[n],h=e[n+1],c=()=>{i[a]||(i[a]=[]),i[a][o]||(i[a][o]="")};if(c(),'"'===d&&(r?'"'===h?(i[a][o]+='"',n++):r=!1:(void 0===l||l===t||s(l))&&(r=!0)),!r&&'"'!==d){if(d===t){o++,c();continue}if(s(d)){o=0,a++,c(),"\r"===d&&"\n"===h&&n++;continue}}i[a][o]+=d}return i}doPasteOperation(e){const t="clipboard";let i;if(this.eventService.dispatchEvent({type:s.aA.EVENT_PASTE_START,source:t}),this.clientSideRowModel){const e=this.gridOptionsService.get("aggregateOnlyChangedColumns");i=new s.a7(e,this.clientSideRowModel.getRootNode())}const r={},a=[];e(r,a,this.focusService.getFocusedCell(),i);const o=[...a];i&&(this.clientSideRowModel.doAggregate(i),i.forEachChangedNodeDepthFirst((e=>{o.push(e)}))),this.rowRenderer.refreshCells({rowNodes:o}),this.dispatchFlashCells(r),this.fireRowChanged(a),this.refocusLastFocusedCell();const n={type:s.aA.EVENT_PASTE_END,source:t};this.eventService.dispatchEvent(n)}pasteIntoActiveRange(e,t,i,s){const r=this.getRangeSize()%e.length!=0;let a=0,o=0;this.iterateActiveRanges(!1,((n,l,d,h)=>{if(h-a>=e.length){if(r)return;a+=o,o=0}const c=e[h-a];i.push(l);const u=this.gridOptionsService.getCallback("processCellFromClipboard");d.forEach(((e,i)=>{if(!e.isCellEditable(l)||e.isSuppressPaste(l))return;i>=c.length&&(i%=c.length);const r=this.processCell(l,e,c[i],qa,u,!0);l.setDataValue(e,r,Ya),s&&s.addParentNode(l.parent,[e]);const{rowIndex:a,rowPinned:o}=n,d=this.cellPositionUtils.createIdFromValues({rowIndex:a,column:e,rowPinned:o});t[d]=!0})),o++}))}pasteStartingFromFocusedCell(e,t,i,s,r){if(!s)return;const a={rowIndex:s.rowIndex,rowPinned:s.rowPinned},o=this.columnModel.getDisplayedColumnsStartingAt(s.column);this.isPasteSingleValueIntoRange(e)?this.pasteSingleValueIntoRange(e,i,t,r):this.pasteMultipleValues(e,a,i,o,t,Xa,r)}isPasteSingleValueIntoRange(e){return this.hasOnlyOneValueToPaste(e)&&null!=this.rangeService&&!this.rangeService.isEmpty()}pasteSingleValueIntoRange(e,t,i,s){const r=e[0][0];this.iterateActiveRanges(!1,((e,a,o)=>{t.push(a),o.forEach((e=>this.updateCellValue(a,e,r,i,Xa,s)))}))}hasOnlyOneValueToPaste(e){return 1===e.length&&1===e[0].length}copyRangeDown(){if(!this.rangeService||this.rangeService.isEmpty())return;const e=[];this.doPasteOperation(((t,i,s,r)=>{const a=this.gridOptionsService.getCallback("processCellForClipboard"),o=this.gridOptionsService.getCallback("processCellFromClipboard");this.iterateActiveRanges(!0,((s,n,l)=>{e.length?(i.push(n),l.forEach(((i,a)=>{if(!i.isCellEditable(n)||i.isSuppressPaste(n))return;const l=this.processCell(n,i,e[a],qa,o,!0);n.setDataValue(i,l,Ya),r&&r.addParentNode(n.parent,[i]);const{rowIndex:d,rowPinned:h}=s,c=this.cellPositionUtils.createIdFromValues({rowIndex:d,column:i,rowPinned:h});t[c]=!0}))):l.forEach((t=>{const i=this.processCell(n,t,this.valueService.getValue(t,n),qa,a,!1,!0);e.push(i)}))}))}))}removeLastLineIfBlank(e){const t=s.ch.last(e);if(t&&1===t.length&&""===t[0]){if(1===e.length)return;s.ch.removeFromArray(e,t)}}fireRowChanged(e){"fullRow"===this.gridOptionsService.get("editType")&&e.forEach((e=>{const t={type:s.aA.EVENT_ROW_VALUE_CHANGED,node:e,data:e.data,rowIndex:e.rowIndex,rowPinned:e.rowPinned};this.eventService.dispatchEvent(t)}))}pasteMultipleValues(e,t,i,s,r,a,o){let n=t;const l=null!=this.clientSideRowModel&&!this.gridOptionsService.get("enableGroupEdit")&&!this.gridOptionsService.get("treeData"),d=()=>{for(;;){if(!n)return null;const e=this.rowPositionUtils.getRowNode(n);if(n=this.cellNavigationService.getRowBelow({rowPinned:n.rowPinned,rowIndex:n.rowIndex}),null==e)return null;if(!(e.detail||e.footer||l&&e.group))return e}};e.forEach((e=>{const t=d();t&&(e.forEach(((e,i)=>this.updateCellValue(t,s[i],e,r,a,o))),i.push(t))}))}updateCellValue(e,t,i,s,r,a){if(!e||!t||!t.isCellEditable(e)||t.isSuppressPaste(e)||e.group&&t.isValueActive())return;const o=this.processCell(e,t,i,r,this.gridOptionsService.getCallback("processCellFromClipboard"),!0);e.setDataValue(t,o,Ya);const{rowIndex:n,rowPinned:l}=e;s[this.cellPositionUtils.createIdFromValues({rowIndex:n,column:t,rowPinned:l})]=!0,a&&a.addParentNode(e.parent,[t])}copyToClipboard(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.copyOrCutToClipboard(e)}cutToClipboard(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";if(this.gridOptionsService.get("suppressCutToClipboard"))return;const i={type:s.aA.EVENT_CUT_START,source:t};this.eventService.dispatchEvent(i),this.copyOrCutToClipboard(e,!0);const r={type:s.aA.EVENT_CUT_END,source:t};this.eventService.dispatchEvent(r)}copyOrCutToClipboard(e,t){let{includeHeaders:i,includeGroupHeaders:s}=e;this.logger.log(`copyToClipboard: includeHeaders = ${i}`),null==i&&(i=this.gridOptionsService.get("copyHeadersToClipboard")),null==s&&(s=this.gridOptionsService.get("copyGroupHeadersToClipboard"));const r={includeHeaders:i,includeGroupHeaders:s},a=!this.gridOptionsService.get("suppressCopyRowsToClipboard");let o=null;!this.rangeService||this.rangeService.isEmpty()||this.shouldSkipSingleCellRange()?a&&!this.selectionService.isEmpty()?(this.copySelectedRowsToClipboard(r),o=1):this.focusService.isAnyCellFocused()&&(this.copyFocusedCellToClipboard(r),o=2):(this.copySelectedRangeToClipboard(r),o=0),t&&null!==o&&this.clearCellsAfterCopy(o)}clearCellsAfterCopy(e){if(this.eventService.dispatchEvent({type:s.aA.EVENT_KEY_SHORTCUT_CHANGED_CELL_START}),0===e)this.rangeService.clearCellRangeCellValues({cellEventSource:"clipboardService"});else if(1===e)this.clearSelectedRows();else{const e=this.focusService.getFocusedCell();if(null==e)return;const t=this.rowPositionUtils.getRowNode(e);t&&this.clearCellValue(t,e.column)}this.eventService.dispatchEvent({type:s.aA.EVENT_KEY_SHORTCUT_CHANGED_CELL_END})}clearSelectedRows(){const e=this.selectionService.getSelectedNodes(),t=this.columnModel.getAllDisplayedColumns();for(const i of e)for(const e of t)this.clearCellValue(i,e)}clearCellValue(e,t){t.isCellEditable(e)&&e.setDataValue(t,null,"clipboardService")}shouldSkipSingleCellRange(){return this.gridOptionsService.get("suppressCopySingleCellRanges")&&!this.rangeService.isMoreThanOneCell()}iterateActiveRanges(e,t,i){if(!this.rangeService||this.rangeService.isEmpty())return;const s=this.rangeService.getCellRanges();e?this.iterateActiveRange(s[0],t,i,!0):s.forEach(((e,r)=>this.iterateActiveRange(e,t,i,r===s.length-1)))}iterateActiveRange(e,t,i,s){if(!this.rangeService)return;let r=this.rangeService.getRangeStartRow(e);const a=this.rangeService.getRangeEndRow(e);i&&e.columns&&i(e.columns);let o=0,n=!1;for(;!n&&null!=r;){const i=this.rowPositionUtils.getRowNode(r);n=this.rowPositionUtils.sameRow(r,a),t(r,i,e.columns,o++,n&&s),r=this.cellNavigationService.getRowBelow(r)}}copySelectedRangeToClipboard(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.rangeService||this.rangeService.isEmpty())return;const t=this.rangeService.areAllRangesAbleToMerge(),{data:i,cellsToFlash:s}=t?this.buildDataFromMergedRanges(e):this.buildDataFromRanges(e);this.copyDataToClipboard(i),this.dispatchFlashCells(s)}buildDataFromMergedRanges(e){const t=new Set,i=this.rangeService.getCellRanges(),s=new Map,r=[],a={};i.forEach((e=>{e.columns.forEach((e=>t.add(e)));const{rowPositions:i,cellsToFlash:o}=this.getRangeRowPositionsAndCellsToFlash(e);i.forEach((e=>{const t=`${e.rowIndex}-${e.rowPinned||"null"}`;s.get(t)||(s.set(t,!0),r.push(e))})),Object.assign(a,o)}));const o=this.columnModel.getAllDisplayedColumns(),n=Array.from(t);return n.sort(((e,t)=>o.indexOf(e)-o.indexOf(t))),{data:this.buildExportParams({columns:n,rowPositions:r,includeHeaders:e.includeHeaders,includeGroupHeaders:e.includeGroupHeaders}),cellsToFlash:a}}buildDataFromRanges(e){const t=this.rangeService.getCellRanges(),i=[],s={};return t.forEach((t=>{const{rowPositions:r,cellsToFlash:a}=this.getRangeRowPositionsAndCellsToFlash(t);Object.assign(s,a),i.push(this.buildExportParams({columns:t.columns,rowPositions:r,includeHeaders:e.includeHeaders,includeGroupHeaders:e.includeGroupHeaders}))})),{data:i.join("\n"),cellsToFlash:s}}getRangeRowPositionsAndCellsToFlash(e){const t=[],i={},s=this.rangeService.getRangeStartRow(e),r=this.rangeService.getRangeEndRow(e);let a=s;for(;a&&(t.push(a),e.columns.forEach((e=>{const{rowIndex:t,rowPinned:s}=a,r=this.cellPositionUtils.createIdFromValues({rowIndex:t,column:e,rowPinned:s});i[r]=!0})),!this.rowPositionUtils.sameRow(a,r));)a=this.cellNavigationService.getRowBelow(a);return{rowPositions:t,cellsToFlash:i}}getCellsToFlashFromRowNodes(e){const t=this.columnModel.getAllDisplayedColumns(),i={};for(let s=0;s<e.length;s++){const{rowIndex:r,rowPinned:a}=e[s];if(null!=r)for(let e=0;e<t.length;e++){const s=t[e];i[this.cellPositionUtils.createIdFromValues({rowIndex:r,column:s,rowPinned:a})]=!0}}return i}copyFocusedCellToClipboard(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.focusService.getFocusedCell();if(null==t)return;const i=this.cellPositionUtils.createId(t),s={rowPinned:t.rowPinned,rowIndex:t.rowIndex},r=t.column,a=this.buildExportParams({columns:[r],rowPositions:[s],includeHeaders:e.includeHeaders,includeGroupHeaders:e.includeGroupHeaders});this.copyDataToClipboard(a),this.dispatchFlashCells({[i]:!0})}copySelectedRowsToClipboard(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{columnKeys:t,includeHeaders:i,includeGroupHeaders:s}=e,r=this.buildExportParams({columns:t,includeHeaders:i,includeGroupHeaders:s});this.copyDataToClipboard(r);const a=this.selectionService.getSelectedNodes()||[];this.dispatchFlashCells(this.getCellsToFlashFromRowNodes(a))}buildExportParams(e){const{columns:t,rowPositions:i,includeHeaders:s=!1,includeGroupHeaders:r=!1}=e,a={columnKeys:t,rowPositions:i,skipColumnHeaders:!s,skipColumnGroupHeaders:!r,suppressQuotes:!0,columnSeparator:this.getClipboardDelimiter(),onlySelected:!i,processCellCallback:this.gridOptionsService.getCallback("processCellForClipboard"),processRowGroupCallback:e=>this.processRowGroupCallback(e),processHeaderCallback:this.gridOptionsService.getCallback("processHeaderForClipboard"),processGroupHeaderCallback:this.gridOptionsService.getCallback("processGroupHeaderForClipboard")};return this.csvCreator.getDataAsCsv(a,!0)}processRowGroupCallback(e){const{node:t,column:i}=e,s=this.gridOptionsService.get("treeData"),r=this.gridOptionsService.get("suppressGroupMaintainValueType");let a=(()=>{var e,a;if(s||r||!i)return t.key;const o=null==(e=t.groupData)?void 0:e[i.getId()];return o&&t.rowGroupColumn&&!1!==t.rowGroupColumn.getColDef().useValueFormatterForExport&&null!=(a=this.valueFormatterService.formatValue(t.rowGroupColumn,t,o))?a:o})();if(e.node.footer){let e="";a&&a.length&&(e=` ${a}`),a=`Total${e}`}const o=this.gridOptionsService.getCallback("processCellForClipboard");if(o){let e=t.rowGroupColumn;return!e&&t.footer&&-1===t.level&&(e=this.columnModel.getRowGroupColumns()[0]),o({value:a,node:t,column:e,type:"clipboard",formatValue:i=>{var s;return null!=(s=this.valueFormatterService.formatValue(e,t,i))?s:i},parseValue:i=>this.valueParserService.parseValue(e,t,i,this.valueService.getValue(e,t))})}return a}dispatchFlashCells(e){window.setTimeout((()=>{const t={type:s.aA.EVENT_FLASH_CELLS,cells:e};this.eventService.dispatchEvent(t)}),0)}processCell(e,t,i,s,r,a,o){var n;return r?r({column:t,node:e,value:i,type:s,formatValue:i=>{var s;return null!=(s=this.valueFormatterService.formatValue(t,e??null,i))?s:i},parseValue:i=>this.valueParserService.parseValue(t,e??null,i,this.valueService.getValue(t,e))}):a&&!1!==t.getColDef().useValueParserForImport?this.valueParserService.parseValue(t,e??null,i,this.valueService.getValue(t,e)):o&&!1!==t.getColDef().useValueFormatterForExport&&null!=(n=this.valueFormatterService.formatValue(t,e??null,i))?n:i}copyDataToClipboard(e){const t=this.gridOptionsService.getCallback("sendToClipboard");t?t({data:e}):this.gridOptionsService.get("suppressClipboardApi")||!navigator.clipboard?this.copyDataToClipboardLegacy(e):navigator.clipboard.writeText(e).catch((t=>{s.ch.doOnce((()=>{console.warn(t),console.warn(Za("writeText"))}),"clipboardApiError"),this.copyDataToClipboardLegacy(e)}))}copyDataToClipboardLegacy(e){this.executeOnTempElement((t=>{const i=this.gridOptionsService.getDocument(),s=i.activeElement;t.value=e||" ",t.select(),t.focus({preventScroll:!0}),i.execCommand("copy")||console.warn("AG Grid: Browser did not allow document.execCommand('copy'). Ensure api.copySelectedRowsToClipboard() is invoked via a user event, i.e. button click, otherwise the browser will prevent it for security reasons."),null!=s&&null!=s.focus&&s.focus({preventScroll:!0})}))}executeOnTempElement(e,t){const i=this.gridOptionsService.getDocument(),s=i.createElement("textarea");s.style.width="1px",s.style.height="1px",s.style.top=i.documentElement.scrollTop+"px",s.style.left=i.documentElement.scrollLeft+"px",s.style.position="absolute",s.style.opacity="0";const r=this.gridCtrl.getGui();r.appendChild(s);try{e(s)}catch{console.warn("AG Grid: Browser does not support document.execCommand('copy') for clipboard operations")}t?window.setTimeout((()=>{t(s),r.removeChild(s)}),100):r.removeChild(s)}getRangeSize(){const e=this.rangeService.getCellRanges();let t=0,i=0;return e.length>0&&(t=this.rangeService.getRangeStartRow(e[0]).rowIndex,i=this.rangeService.getRangeEndRow(e[0]).rowIndex),t-i+1}};ja([(0,s.A)("csvCreator")],Ja.prototype,"csvCreator",2),ja([(0,s.A)("loggerFactory")],Ja.prototype,"loggerFactory",2),ja([(0,s.A)("selectionService")],Ja.prototype,"selectionService",2),ja([(0,s.O)("rangeService")],Ja.prototype,"rangeService",2),ja([(0,s.A)("rowModel")],Ja.prototype,"rowModel",2),ja([(0,s.A)("ctrlsService")],Ja.prototype,"ctrlsService",2),ja([(0,s.A)("valueService")],Ja.prototype,"valueService",2),ja([(0,s.A)("focusService")],Ja.prototype,"focusService",2),ja([(0,s.A)("rowRenderer")],Ja.prototype,"rowRenderer",2),ja([(0,s.A)("columnModel")],Ja.prototype,"columnModel",2),ja([(0,s.A)("cellNavigationService")],Ja.prototype,"cellNavigationService",2),ja([(0,s.A)("cellPositionUtils")],Ja.prototype,"cellPositionUtils",2),ja([(0,s.A)("rowPositionUtils")],Ja.prototype,"rowPositionUtils",2),ja([(0,s.A)("valueFormatterService")],Ja.prototype,"valueFormatterService",2),ja([(0,s.A)("valueParserService")],Ja.prototype,"valueParserService",2),ja([s.a],Ja.prototype,"init",1),Ja=ja([(0,s._)("clipboardService")],Ja);var Qa={version:"31.2.1",moduleName:s.M.ClipboardModule,beans:[Ja],dependantModules:[E,s.C]},eo=Object.defineProperty,to=Object.defineProperties,io=Object.getOwnPropertyDescriptor,so=Object.getOwnPropertyDescriptors,ro=Object.getOwnPropertySymbols,ao=Object.prototype.hasOwnProperty,oo=Object.prototype.propertyIsEnumerable,no=(e,t,i)=>t in e?eo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,lo=(e,t,i,s)=>{for(var r,a=s>1?void 0:s?io(t,i):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s?r(t,i,a):r(a))||a);return s&&a&&eo(t,i,a),a},ho=class extends s.B{execute(e){const t=s.ch.missingOrEmpty(this.columnModel.getValueColumns()),i=!this.gridOptionsService.getCallback("getGroupRowAgg"),r=e.changedPath&&e.changedPath.isActive();if(t&&i&&r)return;const a=this.createAggDetails(e);this.recursivelyCreateAggData(a)}createAggDetails(e){const t=this.columnModel.isPivotActive(),i=this.columnModel.getValueColumns(),s=t?this.columnModel.getPivotColumns():[];return{alwaysAggregateAtRootLevel:this.gridOptionsService.get("alwaysAggregateAtRootLevel"),groupIncludeTotalFooter:this.gridOptionsService.get("groupIncludeTotalFooter"),changedPath:e.changedPath,valueColumns:i,pivotColumns:s,filteredOnly:!this.isSuppressAggFilteredOnly(),userAggFunc:this.gridOptionsService.getCallback("getGroupRowAgg")}}isSuppressAggFilteredOnly(){return void 0!==this.gridOptionsService.getGroupAggFiltering()||this.gridOptionsService.get("suppressAggFilteredOnly")}recursivelyCreateAggData(e){e.changedPath.forEachChangedNodeDepthFirst((t=>{if(t.hasChildren()){if(-1===t.level&&!e.groupIncludeTotalFooter){const i=!this.columnModel.isPivotMode();if(!e.alwaysAggregateAtRootLevel&&i)return void t.setAggData(null)}this.aggregateRowNode(t,e)}else t.aggData&&t.setAggData(null)}),!0)}aggregateRowNode(e,t){const i=0===t.valueColumns.length,s=0===t.pivotColumns.length;let r;r=t.userAggFunc?t.userAggFunc({nodes:e.childrenAfterFilter}):i?null:s?this.aggregateRowNodeUsingValuesOnly(e,t):this.aggregateRowNodeUsingValuesAndPivot(e),e.setAggData(r),e.sibling&&e.sibling.setAggData(r)}aggregateRowNodeUsingValuesAndPivot(e){var t,i;const s={},r=null!=(t=this.columnModel.getSecondaryColumns())?t:[];let a=!0;for(let o=0;o<r.length;o++){const t=r[o],n=t.getColDef();if(null!=n.pivotTotalColumnIds){a=!1;continue}const l=null!=(i=n.pivotKeys)?i:[];let d;d=e.leafGroup?this.getValuesFromMappedSet(e.childrenMapped,l,n.pivotValueColumn):this.getValuesPivotNonLeaf(e,n.colId),s[n.colId]=this.aggregateValues(d,n.pivotValueColumn.getAggFunc(),n.pivotValueColumn,e,t)}if(!a)for(let o=0;o<r.length;o++){const t=r[o],i=t.getColDef();if(null==i.pivotTotalColumnIds||!i.pivotTotalColumnIds.length)continue;const a=i.pivotTotalColumnIds.map((e=>s[e]));s[i.colId]=this.aggregateValues(a,i.pivotValueColumn.getAggFunc(),i.pivotValueColumn,e,t)}return s}aggregateRowNodeUsingValuesOnly(e,t){const i={},s=t.changedPath.isActive()?t.changedPath.getValueColumnsForNode(e,t.valueColumns):t.valueColumns,r=t.changedPath.isActive()?t.changedPath.getNotValueColumnsForNode(e,t.valueColumns):null,a=this.getValuesNormal(e,s,t.filteredOnly),o=e.aggData;return s.forEach(((t,s)=>{i[t.getId()]=this.aggregateValues(a[s],t.getAggFunc(),t,e)})),r&&o&&r.forEach((e=>{i[e.getId()]=o[e.getId()]})),i}getValuesPivotNonLeaf(e,t){return e.childrenAfterFilter.map((e=>e.aggData[t]))}getValuesFromMappedSet(e,t,i){let s=e;for(let r=0;r<t.length;r++){const e=t[r];s=s?s[e]:null}return s?s.map((e=>this.valueService.getValue(i,e))):[]}getValuesNormal(e,t,i){const s=[];t.forEach((()=>s.push([])));const r=t.length,a=i?e.childrenAfterFilter:e.childrenAfterGroup,o=a.length;for(let n=0;n<o;n++){const e=a[n];for(let i=0;i<r;i++){const r=t[i],a=this.valueService.getValue(r,e);s[i].push(a)}}return s}aggregateValues(e,t,i,s,r){const a="string"==typeof t?this.aggFuncService.getAggFunc(t):t;if("function"!=typeof a)return console.error(`AG Grid: unrecognised aggregation function ${t}`),null;return a(this.gridOptionsService.addGridCommonParams({values:e,column:i,colDef:i?i.getColDef():void 0,pivotResultColumn:r,rowNode:s,data:s?s.data:void 0}))}};lo([(0,s.A)("columnModel")],ho.prototype,"columnModel",2),lo([(0,s.A)("valueService")],ho.prototype,"valueService",2),lo([(0,s.A)("aggFuncService")],ho.prototype,"aggFuncService",2),ho=lo([(0,s._)("aggregationStage")],ho);var co=class{constructor(){this.allSets={},this.allParents=[]}removeFromChildrenAfterGroup(e,t){this.getSet(e).removeFromChildrenAfterGroup[t.id]=!0}isRemoveFromAllLeafChildren(e,t){return!!this.getSet(e).removeFromAllLeafChildren[t.id]}preventRemoveFromAllLeafChildren(e,t){delete this.getSet(e).removeFromAllLeafChildren[t.id]}removeFromAllLeafChildren(e,t){this.getSet(e).removeFromAllLeafChildren[t.id]=!0}getSet(e){return this.allSets[e.id]||(this.allSets[e.id]={removeFromAllLeafChildren:{},removeFromChildrenAfterGroup:{}},this.allParents.push(e)),this.allSets[e.id]}getAllParents(){return this.allParents}flush(){this.allParents.forEach((e=>{const t=this.allSets[e.id];e.childrenAfterGroup=e.childrenAfterGroup.filter((e=>!t.removeFromChildrenAfterGroup[e.id])),e.allLeafChildren=e.allLeafChildren.filter((e=>!t.removeFromAllLeafChildren[e.id])),e.updateHasChildren(),e.sibling&&(e.sibling.childrenAfterGroup=e.childrenAfterGroup,e.sibling.allLeafChildren=e.allLeafChildren)})),this.allSets={},this.allParents.length=0}},uo=class extends s.B{execute(e){const t=this.createGroupingDetails(e);if(t.transactions)this.handleTransaction(t);else{const i=!0===e.afterColumnsChanged;this.shotgunResetEverything(t,i)}t.usingTreeData||(this.positionLeafsAndGroups(e.changedPath),this.orderGroups(t)),this.selectableService.updateSelectableAfterGrouping()}positionLeafsAndGroups(e){e.forEachChangedNodeDepthFirst((e=>{if(e.childrenAfterGroup){const t=[],i=[];let s;e.childrenAfterGroup.forEach((e=>{var r;null!=(r=e.childrenAfterGroup)&&r.length?""!==e.key||s?i.push(e):s=e:t.push(e)})),s&&i.push(s),e.childrenAfterGroup=[...t,...i]}}),!1)}createGroupingDetails(e){var t;const{rowNode:i,changedPath:s,rowNodeTransactions:r,rowNodeOrder:a}=e,o=this.gridOptionsService.get("treeData"),n=o?null:this.columnModel.getRowGroupColumns();return{includeParents:!this.gridOptionsService.get("suppressParentsInRowNodes"),expandByDefault:this.gridOptionsService.get("groupDefaultExpanded"),groupedCols:n,rootNode:i,pivotMode:this.columnModel.isPivotMode(),groupedColCount:o||!n?0:n.length,rowNodeOrder:a,transactions:r,changedPath:s,groupAllowUnbalanced:this.gridOptionsService.get("groupAllowUnbalanced"),isGroupOpenByDefault:this.gridOptionsService.getCallback("isGroupOpenByDefault"),initialGroupOrderComparator:this.gridOptionsService.getCallback("initialGroupOrderComparator"),usingTreeData:o,suppressGroupMaintainValueType:this.gridOptionsService.get("suppressGroupMaintainValueType"),getDataPath:o?this.gridOptionsService.get("getDataPath"):void 0,keyCreators:null!=(t=null==n?void 0:n.map((e=>e.getColDef().keyCreator)))?t:[]}}handleTransaction(e){e.transactions.forEach((t=>{const i=e.usingTreeData?void 0:new co;if(s.ch.existsAndNotEmpty(t.remove)&&this.removeNodes(t.remove,e,i),s.ch.existsAndNotEmpty(t.update)&&this.moveNodesInWrongPath(t.update,e,i),s.ch.existsAndNotEmpty(t.add)&&this.insertNodes(t.add,e,!1),i){const t=i.getAllParents().slice();i.flush(),this.removeEmptyGroups(t,e)}})),e.rowNodeOrder&&this.sortChildren(e)}sortChildren(e){e.changedPath.forEachChangedNodeDepthFirst((t=>{t.childrenAfterGroup&&s.ch.sortRowNodesByOrder(t.childrenAfterGroup,e.rowNodeOrder)&&e.changedPath.addParentNode(t)}),!1,!0)}orderGroups(e){const t=e.initialGroupOrderComparator;s.ch.exists(t)&&function e(i){s.ch.exists(i.childrenAfterGroup)&&!i.leafGroup&&(i.childrenAfterGroup.sort(((e,i)=>t({nodeA:e,nodeB:i}))),i.childrenAfterGroup.forEach((t=>e(t))))}(e.rootNode)}getExistingPathForNode(e,t){const i=[];let s=t.usingTreeData?e:e.parent;for(;s&&s!==t.rootNode;)i.push({key:s.key,rowGroupColumn:s.rowGroupColumn,field:s.field}),s=s.parent;return i.reverse(),i}moveNodesInWrongPath(e,t,i){e.forEach((e=>{t.changedPath.isActive()&&t.changedPath.addParentNode(e.parent);const r=e=>e.key,a=this.getExistingPathForNode(e,t).map(r),o=this.getGroupInfo(e,t).map(r);s.ch.areEqual(a,o)||this.moveNode(e,t,i)}))}moveNode(e,t,i){if(this.removeNodesInStages([e],t,i),this.insertOneNode(e,t,!0,i),e.setData(e.data),t.changedPath.isActive()){const i=e.parent;t.changedPath.addParentNode(i)}}removeNodes(e,t,i){this.removeNodesInStages(e,t,i),t.changedPath.isActive()&&e.forEach((e=>t.changedPath.addParentNode(e.parent)))}removeNodesInStages(e,t,i){if(this.removeNodesFromParents(e,t,i),t.usingTreeData){this.postRemoveCreateFillerNodes(e,t);const i=e.map((e=>e.parent));this.removeEmptyGroups(i,t)}}forEachParentGroup(e,t,i){let s=t;for(;s&&s!==e.rootNode;)i(s),s=s.parent}removeNodesFromParents(e,t,i){const s=null==i,r=i||new co;e.forEach((e=>{this.removeFromParent(e,r),this.forEachParentGroup(t,e.parent,(t=>{r.removeFromAllLeafChildren(t,e)}))})),s&&r.flush()}postRemoveCreateFillerNodes(e,t){e.forEach((e=>{if(e.hasChildren()){const i=this.getExistingPathForNode(e,t),s=this.findParentForNode(e,i,t);s.expanded=e.expanded,s.allLeafChildren=e.allLeafChildren,s.childrenAfterGroup=e.childrenAfterGroup,s.childrenMapped=e.childrenMapped,s.updateHasChildren(),s.childrenAfterGroup.forEach((e=>e.parent=s))}}))}removeEmptyGroups(e,t){let i=!0;const s=e=>{const t=this.getChildrenMappedKey(e.key,e.rowGroupColumn),i=e.parent;return!!(i&&i.childrenMapped&&i.childrenMapped[t])&&!!e.isEmptyRowGroupNode()};for(;i;){i=!1;const r=new co;e.forEach((e=>{this.forEachParentGroup(t,e,(e=>{s(e)&&(i=!0,this.removeFromParent(e,r),e.setSelectedParams({newValue:!1,source:"rowGroupChanged"}))}))})),r.flush()}}removeFromParent(e,t){e.parent&&(t?t.removeFromChildrenAfterGroup(e.parent,e):(s.ch.removeFromArray(e.parent.childrenAfterGroup,e),e.parent.updateHasChildren()));const i=this.getChildrenMappedKey(e.key,e.rowGroupColumn);e.parent&&e.parent.childrenMapped&&(e.parent.childrenMapped[i]=void 0),e.setRowTop(null),e.setRowIndex(null)}addToParent(e,t){const i=this.getChildrenMappedKey(e.key,e.rowGroupColumn);t&&(null!=t.childrenMapped&&(t.childrenMapped[i]=e),t.childrenAfterGroup.push(e),t.updateHasChildren())}areGroupColsEqual(e,t){return null!=e&&null!=t&&e.pivotMode===t.pivotMode&&(s.ch.areEqual(e.groupedCols,t.groupedCols)&&s.ch.areEqual(e.keyCreators,t.keyCreators))}checkAllGroupDataAfterColsChanged(e){const t=i=>{i&&i.forEach((i=>{if(!e.usingTreeData&&!i.group)return;const s={field:i.field,key:i.key,rowGroupColumn:i.rowGroupColumn,leafNode:i.allLeafChildren[0]};this.setGroupData(i,s,e),t(i.childrenAfterGroup)}))};t(e.rootNode.childrenAfterGroup)}shotgunResetEverything(e,t){if(this.noChangeInGroupingColumns(e,t))return;this.selectionService.filterFromSelection((e=>e&&!e.group));const{rootNode:i,groupedCols:s}=e;i.leafGroup=!e.usingTreeData&&0===s.length,i.childrenAfterGroup=[],i.childrenMapped={},i.updateHasChildren();const r=i.sibling;r&&(r.childrenAfterGroup=i.childrenAfterGroup,r.childrenMapped=i.childrenMapped),this.insertNodes(i.allLeafChildren,e,!1)}noChangeInGroupingColumns(e,t){let i=!1;const s=this.columnModel.getGroupDisplayColumns(),r=s?s.map((e=>e.getId())).join("-"):"";return t&&(i=e.usingTreeData||this.areGroupColsEqual(e,this.oldGroupingDetails),this.oldGroupDisplayColIds!==r&&this.checkAllGroupDataAfterColsChanged(e)),this.oldGroupingDetails=e,this.oldGroupDisplayColIds=r,i}insertNodes(e,t,i){e.forEach((e=>{this.insertOneNode(e,t,i),t.changedPath.isActive()&&t.changedPath.addParentNode(e.parent)}))}insertOneNode(e,t,i,s){const r=this.getGroupInfo(e,t),a=this.findParentForNode(e,r,t,s);a.group||console.warn("AG Grid: duplicate group keys for row data, keys should be unique",[a.data,e.data]),t.usingTreeData?this.swapGroupWithUserNode(a,e,i):(e.parent=a,e.level=r.length,a.childrenAfterGroup.push(e),a.updateHasChildren())}findParentForNode(e,t,i,s){let r=i.rootNode;return t.forEach(((t,a)=>{r=this.getOrCreateNextNode(r,t,a,i),null!=s&&s.isRemoveFromAllLeafChildren(r,e)?null==s||s.preventRemoveFromAllLeafChildren(r,e):r.allLeafChildren.push(e)})),r}swapGroupWithUserNode(e,t,i){t.parent=e.parent,t.key=e.key,t.field=e.field,t.groupData=e.groupData,t.level=e.level,i||(t.expanded=e.expanded),t.leafGroup=e.leafGroup,t.rowGroupIndex=e.rowGroupIndex,t.allLeafChildren=e.allLeafChildren,t.childrenAfterGroup=e.childrenAfterGroup,t.childrenMapped=e.childrenMapped,t.sibling=e.sibling,t.updateHasChildren(),this.removeFromParent(e),t.childrenAfterGroup.forEach((e=>e.parent=t)),this.addToParent(t,e.parent)}getOrCreateNextNode(e,t,i,s){const r=this.getChildrenMappedKey(t.key,t.rowGroupColumn);let a=e.childrenMapped?e.childrenMapped[r]:void 0;return a||(a=this.createGroup(t,e,i,s),this.addToParent(a,e)),a}createGroup(e,t,i,r){const a=new s.bF(this.beans);return a.group=!0,a.field=e.field,a.rowGroupColumn=e.rowGroupColumn,this.setGroupData(a,e,r),a.key=e.key,a.id=this.createGroupId(a,t,r.usingTreeData,i),a.level=i,a.leafGroup=!r.usingTreeData&&i===r.groupedColCount-1,a.allLeafChildren=[],a.setAllChildrenCount(0),a.rowGroupIndex=r.usingTreeData?null:i,a.childrenAfterGroup=[],a.childrenMapped={},a.updateHasChildren(),a.parent=r.includeParents?t:null,this.setExpandedInitialValue(r,a),a}createGroupId(e,t,i,r){let a;return a=i?(e,t,i)=>{if(i<0)return null;const s=t?a(t,t.parent,i-1):null;return`${null==s?"":s+"-"}${i}-${e.key}`}:(e,t)=>{if(!e.rowGroupColumn)return null;const i=t?a(t,t.parent,0):null;return`${null==i?"":i+"-"}${e.rowGroupColumn.getColId()}-${e.key}`},s.bF.ID_PREFIX_ROW_GROUP+a(e,t,r)}setGroupData(e,t,i){e.groupData={},this.columnModel.getGroupDisplayColumns().forEach((s=>{if(i.usingTreeData)return void(e.groupData[s.getColId()]=t.key);const r=e.rowGroupColumn;null!==r&&s.isRowGroupDisplayed(r.getId())&&(i.suppressGroupMaintainValueType?e.groupData[s.getColId()]=t.key:e.groupData[s.getColId()]=this.valueService.getValue(r,t.leafNode))}))}getChildrenMappedKey(e,t){return t?t.getId()+"-"+e:e}setExpandedInitialValue(e,t){if(e.pivotMode&&t.leafGroup)return void(t.expanded=!1);const i=e.isGroupOpenByDefault;if(i){const e={rowNode:t,field:t.field,key:t.key,level:t.level,rowGroupColumn:t.rowGroupColumn};return void(t.expanded=1==i(e))}const{expandByDefault:s}=e;-1!==e.expandByDefault?t.expanded=t.level<s:t.expanded=!0}getGroupInfo(e,t){return t.usingTreeData?this.getGroupInfoFromCallback(e,t):this.getGroupInfoFromGroupColumns(e,t)}getGroupInfoFromCallback(e,t){const i=t.getDataPath?t.getDataPath(e.data):null;(null==i||0===i.length)&&s.ch.warnOnce(`getDataPath() should not return an empty path for data ${e.data}`);return i?i.map((e=>({key:e,field:null,rowGroupColumn:null}))):[]}getGroupInfoFromGroupColumns(e,t){const i=[];return t.groupedCols.forEach((s=>{let r=this.valueService.getKeyForNode(s,e),a=null!=r&&""!==r;if((t.pivotMode||!t.groupAllowUnbalanced)&&!a&&(r="",a=!0),a){const t={key:r,field:s.getColDef().field,rowGroupColumn:s,leafNode:e};i.push(t)}})),i}};lo([(0,s.A)("columnModel")],uo.prototype,"columnModel",2),lo([(0,s.A)("selectableService")],uo.prototype,"selectableService",2),lo([(0,s.A)("valueService")],uo.prototype,"valueService",2),lo([(0,s.A)("beans")],uo.prototype,"beans",2),lo([(0,s.A)("selectionService")],uo.prototype,"selectionService",2),uo=lo([(0,s._)("groupStage")],uo);var po=class extends s.B{init(){const e=()=>{var e;return null!=(e=this.gos.get("serverSidePivotResultFieldSeparator"))?e:"_"};this.fieldSeparator=e(),this.addManagedPropertyListener("serverSidePivotResultFieldSeparator",(()=>{this.fieldSeparator=e()}));const t=()=>this.gos.get("pivotDefaultExpanded");this.pivotDefaultExpanded=t(),this.addManagedPropertyListener("pivotDefaultExpanded",(()=>{this.pivotDefaultExpanded=t()}))}createPivotColumnDefs(e){const t=this.createPivotColumnsFromUniqueValues(e);const i=function e(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.forEach((t=>{void 0!==t.children?e(t.children,i):i.push(t)})),i}(t);this.addRowGroupTotals(t,i),this.addExpandablePivotGroups(t,i),this.addPivotTotalsToGroups(t,i);return{pivotColumnGroupDefs:t,pivotColumnDefs:i.map((e=>s.ch.cloneObject(e)))}}createPivotColumnsFromUniqueValues(e){const t=this.columnModel.getPivotColumns(),i=t.length;return this.recursivelyBuildGroup(0,e,[],i,t)}recursivelyBuildGroup(e,t,i,r,a){const o=this.columnModel.getValueColumns();if(e>=r)return this.buildMeasureCols(i);const n=a[e].getColDef(),l=this.headerNameComparator.bind(this,n.pivotComparator);if(1===o.length&&this.gridOptionsService.get("removePivotHeaderRowWhenSingleValueColumn")&&e===r-1){const e=[];return s.ch.iterateObject(t,(t=>{const s=[...i,t],r=this.createColDef(o[0],t,s);r.columnGroupShow="open",e.push(r)})),e.sort(l),e}const d=[];return s.ch.iterateObject(t,((t,s)=>{const o=-1===this.pivotDefaultExpanded||e<this.pivotDefaultExpanded,n=[...i,t];d.push({children:this.recursivelyBuildGroup(e+1,s,n,r,a),headerName:t,pivotKeys:n,columnGroupShow:"open",openByDefault:o,groupId:this.generateColumnGroupId(n)})})),d.sort(l),d}buildMeasureCols(e){const t=this.columnModel.getValueColumns();return 0===t.length?[this.createColDef(null,"-",e)]:t.map((t=>{const i=this.columnModel.getDisplayNameForColumn(t,"header");return((e,t)=>to(e,so(t)))(((e,t)=>{for(var i in t||(t={}))ao.call(t,i)&&no(e,i,t[i]);if(ro)for(var i of ro(t))oo.call(t,i)&&no(e,i,t[i]);return e})({},this.createColDef(t,i,e)),{columnGroupShow:"open"})}))}addExpandablePivotGroups(e,t){if(this.gridOptionsService.get("suppressExpandablePivotGroups")||this.gridOptionsService.get("pivotColumnGroupTotals"))return;const i=(e,t,s)=>{const r=e;if(r.children){const a=new Map;r.children.forEach((e=>{i(e,t,a)}));const o=!r.children.some((e=>e.children));this.columnModel.getValueColumns().forEach((i=>{const s=this.columnModel.getDisplayNameForColumn(i,"header"),r=this.createColDef(i,s,e.pivotKeys);r.pivotTotalColumnIds=a.get(i.getColId()),r.columnGroupShow="closed",r.aggFunc=i.getAggFunc(),o||(e.children.push(r),t.push(r))})),this.merge(s,a)}else{const t=e;if(!t.pivotValueColumn)return;const i=t.pivotValueColumn.getColId(),r=s.has(i)?s.get(i):[];r.push(t.colId),s.set(i,r)}};e.forEach((e=>{i(e,t,new Map)}))}addPivotTotalsToGroups(e,t){if(!this.gridOptionsService.get("pivotColumnGroupTotals"))return;const i="after"===this.gridOptionsService.get("pivotColumnGroupTotals"),s=this.columnModel.getValueColumns(),r=s.map((e=>e.getAggFunc()));if(!r||r.length<1||!this.sameAggFuncs(r))return;const a=s[0];e.forEach((e=>{this.recursivelyAddPivotTotal(e,t,a,i)}))}recursivelyAddPivotTotal(e,t,i,s){const r=e;if(!r.children){const t=e;return t.colId?[t.colId]:null}let a=[];if(r.children.forEach((e=>{const r=this.recursivelyAddPivotTotal(e,t,i,s);r&&(a=a.concat(r))})),r.children.length>1){const r=this.localeService.getLocaleTextFunc()("pivotColumnGroupTotals","Total"),o=this.createColDef(i,r,e.pivotKeys,!0);o.pivotTotalColumnIds=a,o.aggFunc=i.getAggFunc();const n=e.children;s?n.push(o):n.unshift(o),t.push(o)}return a}addRowGroupTotals(e,t){if(!this.gridOptionsService.get("pivotRowTotals"))return;const i="after"===this.gridOptionsService.get("pivotRowTotals"),s=this.columnModel.getValueColumns(),r=i?s.slice():s.slice().reverse();for(let a=0;a<r.length;a++){const s=r[a];let o=[];e.forEach((e=>{o=o.concat(this.extractColIdsForValueColumn(e,s))}));const n=r.length>1||!this.gridOptionsService.get("removePivotHeaderRowWhenSingleValueColumn");this.createRowGroupTotal(e,t,s,o,i,n)}}extractColIdsForValueColumn(e,t){const i=e;if(!i.children){const e=i;return e.pivotValueColumn===t&&e.colId?[e.colId]:[]}let s=[];return i.children.forEach((e=>{this.extractColIdsForValueColumn(e,t);const i=this.extractColIdsForValueColumn(e,t);s=s.concat(i)})),s}createRowGroupTotal(e,t,i,s,r,a){let o;if(0===this.columnModel.getValueColumns().length)o=this.createColDef(null,"-",[]);else{const e=this.columnModel.getDisplayNameForColumn(i,"header");o=this.createColDef(i,e,[]),o.pivotTotalColumnIds=s}o.colId=po.PIVOT_ROW_TOTAL_PREFIX+o.colId,t.push(o);const n=a?{children:[o],pivotKeys:[],groupId:`${po.PIVOT_ROW_TOTAL_PREFIX}_pivotGroup_${i.getColId()}`}:o;r?e.push(n):e.unshift(n)}createColDef(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r={};if(e){const t=e.getColDef();Object.assign(r,t),r.hide=!1}return r.headerName=t,r.colId=this.generateColumnId(i||[],e&&!s?e.getColId():""),r.field=r.colId,r.valueGetter=e=>{var t;return null==(t=e.data)?void 0:t[e.colDef.field]},r.pivotKeys=i,r.pivotValueColumn=e,!0===r.filter&&(r.filter="agNumberColumnFilter"),r}sameAggFuncs(e){if(1==e.length)return!0;for(let t=1;t<e.length;t++)if(e[t]!==e[0])return!1;return!0}headerNameComparator(e,t,i){return e?e(t.headerName,i.headerName):t.headerName&&!i.headerName?1:!t.headerName&&i.headerName?-1:t.headerName&&i.headerName?t.headerName<i.headerName?-1:t.headerName>i.headerName?1:0:0}merge(e,t){t.forEach(((t,i,s)=>{const r=[...e.has(i)?e.get(i):[],...t];e.set(i,r)}))}generateColumnGroupId(e){return`pivotGroup_${this.columnModel.getPivotColumns().map((e=>e.getColId())).join("-")}_${e.join("-")}`}generateColumnId(e,t){return`pivot_${this.columnModel.getPivotColumns().map((e=>e.getColId())).join("-")}_${e.join("-")}_${t}`}createColDefsFromFields(e){const t={};for(let r=0;r<e.length;r++){const i=e[r].split(this.fieldSeparator);let s=t;for(let e=0;e<i.length;e++){const t=i[e];null==s[t]&&(s[t]={}),s=s[t]}}const i=(e,t,s,r)=>{var a;const o=[];for(let n in s){const t=s[n],a=i(`${e}${this.fieldSeparator}${n}`,n,t,r+1);o.push(a)}if(0===o.length){const i=this.columnModel.getPrimaryColumn(t);if(i){const s=null!=(a=this.columnModel.getDisplayNameForColumn(i,"header"))?a:t,r=this.createColDef(i,s,void 0,!1);return r.colId=e,r.aggFunc=i.getAggFunc(),r.valueGetter=t=>{var i;return null==(i=t.data)?void 0:i[e]},r}return{colId:e,headerName:t,valueGetter:t=>{var i;return null==(i=t.data)?void 0:i[e]}}}return this.gridOptionsService.get("removePivotHeaderRowWhenSingleValueColumn")&&1===o.length&&"colId"in o[0]?(o[0].headerName=t,o[0]):{openByDefault:-1===this.pivotDefaultExpanded||r<this.pivotDefaultExpanded,groupId:e,headerName:t,children:o}},s=[];for(let r in t){const e=i(r,r,t[r],0);s.push(e)}return s}};po.PIVOT_ROW_TOTAL_PREFIX="PivotRowTotal_",lo([(0,s.A)("columnModel")],po.prototype,"columnModel",2),lo([(0,s.A)("gridOptionsService")],po.prototype,"gos",2),lo([s.a],po.prototype,"init",1),po=lo([(0,s._)("pivotColDefService")],po);var go=class extends s.B{constructor(){super(...arguments),this.uniqueValues={},this.lastTimeFailed=!1,this.maxUniqueValues=-1,this.currentUniqueCount=0}execute(e){const t=e.changedPath;this.columnModel.isPivotActive()?this.executePivotOn(t):this.executePivotOff(t)}executePivotOff(e){this.aggregationColumnsHashLastTime=null,this.uniqueValues={},this.columnModel.isSecondaryColumnsPresent()&&(this.columnModel.setSecondaryColumns(null,"rowModelUpdated"),e&&e.setInactive())}executePivotOn(e){var t;const i=null!=(t=this.columnModel.getValueColumns().length)?t:1,r=this.gridOptionsService.get("pivotMaxGeneratedColumns");let a;this.maxUniqueValues=-1===r?-1:r/i;try{a=this.bucketUpRowNodes(e)}catch(y){if(y.message===go.EXCEEDED_MAX_UNIQUE_VALUES){this.columnModel.setSecondaryColumns([],"rowModelUpdated");const e={type:s.aA.EVENT_PIVOT_MAX_COLUMNS_EXCEEDED,message:y.message};return this.eventService.dispatchEvent(e),void(this.lastTimeFailed=!0)}throw y}const o=this.setUniqueValues(a),n=this.columnModel.getValueColumns(),l=n.map((e=>`${e.getId()}-${e.getColDef().headerName}`)).join("#"),d=n.map((e=>e.getAggFunc().toString())).join("#"),h=this.aggregationColumnsHashLastTime!==l,c=this.aggregationFuncsHashLastTime!==d;this.aggregationColumnsHashLastTime=l,this.aggregationFuncsHashLastTime=d;const u=this.columnModel.getRowGroupColumns().map((e=>e.getId())).join("#"),p=u!==this.groupColumnsHashLastTime;this.groupColumnsHashLastTime=u;const g=this.gridOptionsService.get("pivotRowTotals"),m=this.gridOptionsService.get("pivotColumnGroupTotals"),v=this.gridOptionsService.get("suppressExpandablePivotGroups"),C=this.gridOptionsService.get("removePivotHeaderRowWhenSingleValueColumn"),f=g!==this.pivotRowTotalsLastTime||m!==this.pivotColumnGroupTotalsLastTime||v!==this.suppressExpandablePivotGroupsLastTime||C!==this.removePivotHeaderRowWhenSingleValueColumnLastTime;if(this.pivotRowTotalsLastTime=g,this.pivotColumnGroupTotalsLastTime=m,this.suppressExpandablePivotGroupsLastTime=v,this.removePivotHeaderRowWhenSingleValueColumnLastTime=C,this.lastTimeFailed||o||h||p||c||f){const{pivotColumnGroupDefs:t,pivotColumnDefs:i}=this.pivotColDefService.createPivotColumnDefs(this.uniqueValues);this.pivotColumnDefs=i,this.columnModel.setSecondaryColumns(t,"rowModelUpdated"),e&&e.setInactive()}this.lastTimeFailed=!1}setUniqueValues(e){return JSON.stringify(e)!==JSON.stringify(this.uniqueValues)&&(this.uniqueValues=e,!0)}bucketUpRowNodes(e){this.currentUniqueCount=0;const t={};e.forEachChangedNodeDepthFirst((e=>{e.leafGroup&&(e.childrenMapped=null)}));const i=e=>{var s;e.leafGroup?this.bucketRowNode(e,t):null==(s=e.childrenAfterFilter)||s.forEach(i)};return e.executeFromRootNode(i),t}bucketRowNode(e,t){const i=this.columnModel.getPivotColumns();0===i.length?e.childrenMapped=null:e.childrenMapped=this.bucketChildren(e.childrenAfterFilter,i,0,t),e.sibling&&(e.sibling.childrenMapped=e.childrenMapped)}bucketChildren(e,t,i,r){const a={},o=t[i];if(e.forEach((e=>{let t=this.valueService.getKeyForNode(o,e);if(s.ch.missing(t)&&(t=""),!r[t]){this.currentUniqueCount+=1,r[t]={};const e=-1!==this.maxUniqueValues,i=this.currentUniqueCount>this.maxUniqueValues;if(e&&i)throw Error(go.EXCEEDED_MAX_UNIQUE_VALUES)}a[t]||(a[t]=[]),a[t].push(e)})),i===t.length-1)return a;{const e={};return s.ch.iterateObject(a,((s,a)=>{e[s]=this.bucketChildren(a,t,i+1,r[s])})),e}}getPivotColumnDefs(){return this.pivotColumnDefs}};go.EXCEEDED_MAX_UNIQUE_VALUES="Exceeded maximum allowed pivot column count.",lo([(0,s.A)("valueService")],go.prototype,"valueService",2),lo([(0,s.A)("columnModel")],go.prototype,"columnModel",2),lo([(0,s.A)("pivotColDefService")],go.prototype,"pivotColDefService",2),go=lo([(0,s._)("pivotStage")],go);var mo=typeof BigInt>"u"?null:BigInt,vo={sum:"Sum",first:"First",last:"Last",min:"Min",max:"Max",count:"Count",avg:"Average"},Co=class extends s.B{constructor(){super(...arguments),this.aggFuncsMap={},this.initialised=!1}init(){this.initialised||(this.initialiseWithDefaultAggregations(),this.addAggFuncs(this.gridOptionsService.get("aggFuncs")))}initialiseWithDefaultAggregations(){this.aggFuncsMap[Co.AGG_SUM]=fo,this.aggFuncsMap[Co.AGG_FIRST]=yo,this.aggFuncsMap[Co.AGG_LAST]=So,this.aggFuncsMap[Co.AGG_MIN]=Eo,this.aggFuncsMap[Co.AGG_MAX]=bo,this.aggFuncsMap[Co.AGG_COUNT]=wo,this.aggFuncsMap[Co.AGG_AVG]=Ao,this.initialised=!0}isAggFuncPossible(e,t){const i=this.getFuncNames(e),r=s.ch.includes(i,t),a=s.ch.exists(this.aggFuncsMap[t]);return r&&a}getDefaultFuncLabel(e){var t;return null!=(t=vo[e])?t:e}getDefaultAggFunc(e){const t=e.getColDef().defaultAggFunc;if(s.ch.exists(t)&&this.isAggFuncPossible(e,t))return t;if(this.isAggFuncPossible(e,Co.AGG_SUM))return Co.AGG_SUM;const i=this.getFuncNames(e);return s.ch.existsAndNotEmpty(i)?i[0]:null}addAggFuncs(e){this.init(),s.ch.iterateObject(e,((e,t)=>{this.aggFuncsMap[e]=t}))}getAggFunc(e){return this.init(),this.aggFuncsMap[e]}getFuncNames(e){return e.getColDef().allowedAggFuncs??Object.keys(this.aggFuncsMap).sort()}clear(){this.aggFuncsMap={}}};function fo(e){const{values:t}=e;let i=null;for(let s=0;s<t.length;s++){const e=t[s];"number"==typeof e?null===i?i=e:i+=mo?"number"==typeof i?e:mo(e):e:"bigint"==typeof e&&(i=null===i?e:("bigint"==typeof i?i:mo(i))+e)}return i}function yo(e){return e.values.length>0?e.values[0]:null}function So(e){return e.values.length>0?s.ch.last(e.values):null}function Eo(e){const{values:t}=e;let i=null;for(let s=0;s<t.length;s++){const e=t[s];("number"==typeof e||"bigint"==typeof e)&&(null===i||i>e)&&(i=e)}return i}function bo(e){const{values:t}=e;let i=null;for(let s=0;s<t.length;s++){const e=t[s];("number"==typeof e||"bigint"==typeof e)&&(null===i||i<e)&&(i=e)}return i}function wo(e){var t,i;const{values:s}=e;let r=0;for(let o=0;o<s.length;o++){const e=s[o];r+=null!=e&&"number"==typeof e.value?e.value:1}const a=null==(i=null==(t=e.rowNode)?void 0:t.aggData)?void 0:i[e.column.getColId()];return a&&a.value===r?a:{value:r,toString:function(){return this.value.toString()},toNumber:function(){return this.value}}}function Ao(e){var t,i,s;const{values:r}=e;let a=0,o=0;for(let d=0;d<r.length;d++){const e=r[d];let t=null;"number"==typeof e||"bigint"==typeof e?(t=e,o++):null!=e&&("number"==typeof e.value||"bigint"==typeof e.value)&&"number"==typeof e.count&&(t=mo?e.value*("number"==typeof e.value?e.count:mo(e.count)):e.value*e.count,o+=e.count),"number"==typeof t?a+=mo?"number"==typeof a?t:mo(t):t:"bigint"==typeof t&&(a=("bigint"==typeof a?a:mo(a))+t)}let n=null;o>0&&(n=mo?a/("number"==typeof a?o:mo(o)):a/o);const l=null==(s=null==(t=e.rowNode)?void 0:t.aggData)?void 0:s[null==(i=e.column)?void 0:i.getColId()];return l&&l.count===o&&l.value===n?l:{count:o,value:n,toString:function(){return"number"==typeof this.value||"bigint"==typeof this.value?this.value.toString():""},toNumber:function(){return this.value}}}Co.AGG_SUM="sum",Co.AGG_FIRST="first",Co.AGG_LAST="last",Co.AGG_MIN="min",Co.AGG_MAX="max",Co.AGG_COUNT="count",Co.AGG_AVG="avg",lo([s.a],Co.prototype,"init",1),Co=lo([(0,s._)("aggFuncService")],Co);var xo=class extends s.bl{constructor(e,t,i,s,r){super(t,i,r,'\n                <span role="option">\n                    <span ref="eDragHandle" class="ag-drag-handle ag-column-drop-cell-drag-handle" role="presentation"></span>\n                    <span ref="eText" class="ag-column-drop-cell-text" aria-hidden="true"></span>\n                    <ag-sort-indicator ref="eSortIndicator"></ag-sort-indicator>\n                    <span ref="eButton" class="ag-column-drop-cell-button" role="presentation"></span>\n                </span>\n            '),this.column=e,this.dropZonePurpose=s,this.popupShowing=!1}init(){this.displayName=this.columnModel.getDisplayNameForColumn(this.column,"columnDrop"),super.init(),this.setupSort(),this.addManagedListener(this.eventService,s.ad.EVENT_SORT_CHANGED,(()=>{this.setupAria()})),this.isGroupingZone()&&this.addManagedPropertyListener("groupLockGroupColumns",(()=>{this.refreshRemove(),this.refreshDraggable(),this.setupAria()}))}getItem(){return this.column}getDisplayName(){return this.displayName}getTooltip(){return this.column.getColDef().headerTooltip}addAdditionalAriaInstructions(e,t){const i=this.gridOptionsService.get("rowGroupPanelSuppressSort"),s=this.gridOptionsService.get("functionsReadOnly");if(this.isAggregationZone()&&!s){const i=t("ariaDropZoneColumnValueItemDescription","Press ENTER to change the aggregation type");e.push(i)}if(this.isGroupingZone()&&this.column.isSortable()&&!i){const i=t("ariaDropZoneColumnGroupItemDescription","Press ENTER to sort");e.push(i)}super.addAdditionalAriaInstructions(e,t)}isDraggable(){return this.isReadOnly()}isRemovable(){return this.isReadOnly()}isReadOnly(){return!this.isGroupingAndLocked()&&!this.gridOptionsService.get("functionsReadOnly")}getAriaDisplayName(){const e=this.localeService.getLocaleTextFunc(),{name:t,aggFuncName:i}=this.getColumnAndAggFuncName(),s=e("ariaDropZoneColumnComponentAggFuncSeparator"," of "),r={asc:e("ariaDropZoneColumnComponentSortAscending","ascending"),desc:e("ariaDropZoneColumnComponentSortDescending","descending")},a=this.column.getSort(),o=this.gridOptionsService.get("rowGroupPanelSuppressSort");return[i&&`${i}${s}`,t,this.isGroupingZone()&&!o&&a&&`, ${r[a]}`].filter((e=>!!e)).join("")}getColumnAndAggFuncName(){const e=this.displayName;let t="";if(this.isAggregationZone()){const e=this.column.getAggFunc(),i="string"==typeof e?e:"agg";t=this.localeService.getLocaleTextFunc()(i,i)}return{name:e,aggFuncName:t}}setupSort(){const e=this.column.isSortable(),t=this.isGroupingZone();if(e&&t&&!this.gridOptionsService.get("rowGroupPanelSuppressSort")){this.eSortIndicator.setupSort(this.column,!0);const e=e=>{e.preventDefault();const t="ctrl"===this.gridOptionsService.get("multiSortKey")?e.ctrlKey||e.metaKey:e.shiftKey;this.sortController.progressSort(this.column,t,"uiColumnSorted")};this.addGuiEventListener("click",e),this.addGuiEventListener("keydown",(t=>{t.key===s.b6.ENTER&&this.isGroupingZone()&&e(t)}))}}getDefaultIconName(){return s.av.ICON_HIDE}createGetDragItem(){const{column:e}=this;return()=>{const t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t}}}setupComponents(){super.setupComponents(),this.isAggregationZone()&&!this.gridOptionsService.get("functionsReadOnly")&&this.addGuiEventListener("click",this.onShowAggFuncSelection.bind(this))}onKeyDown(e){super.onKeyDown(e),e.key===s.b6.ENTER&&this.isAggregationZone()&&!this.gridOptionsService.get("functionsReadOnly")&&(e.preventDefault(),this.onShowAggFuncSelection())}getDisplayValue(){const{name:e,aggFuncName:t}=this.getColumnAndAggFuncName();return this.isAggregationZone()?`${t}(${e})`:e}onShowAggFuncSelection(){if(this.popupShowing)return;this.popupShowing=!0;const e=new s.cf({cssIdentifier:"select-agg-func"}),t=this.aggFuncService.getFuncNames(this.column),i=this.getGui(),r=e.getGui();e.setModel({getRow:function(e){return t[e]},getRowCount:function(){return t.length}}),this.getContext().createBean(e);const a=s.ch.loadTemplate('<div class="ag-select-agg-func-popup"></div>');a.style.top="0px",a.style.left="0px",a.appendChild(r),a.style.width=`${i.clientWidth}px`;const o=this.addManagedListener(a,"focusout",(e=>{!a.contains(e.relatedTarget)&&l&&l.hideFunc()})),n=this.localeService.getLocaleTextFunc(),l=this.popupService.addPopup({modal:!0,eChild:a,closeOnEsc:!0,closedCallback:t=>{this.destroyBean(e),this.popupShowing=!1,"Escape"===(null==t?void 0:t.key)&&i.focus(),o&&o()},ariaLabel:n("ariaLabelAggregationFunction","Aggregation Function")});l&&e.setComponentCreator(this.createAggSelect.bind(this,l.hideFunc)),e.addGuiEventListener("keydown",(t=>{if(t.key===s.b6.ENTER||t.key===s.b6.SPACE){const t=e.getLastFocusedRow();if(null==t)return;const i=e.getComponentAt(t);i&&i.selectItem()}})),this.popupService.positionPopupByComponent({type:"aggFuncSelect",eventSource:i,ePopup:a,keepWithinBounds:!0,column:this.column,position:"under"}),e.refresh();let d=t.findIndex((e=>e===this.column.getAggFunc()));-1===d&&(d=0),e.focusRow(d)}createAggSelect(e,t){const i=this.localeService.getLocaleTextFunc(),r=t.toString(),a=i(r,r);return new To((()=>{if(e(),this.gridOptionsService.get("functionsPassive")){const e={type:s.aA.EVENT_COLUMN_AGG_FUNC_CHANGE_REQUEST,columns:[this.column],aggFunc:t};this.eventService.dispatchEvent(e)}else this.columnModel.setColumnAggFunc(this.column,t,"toolPanelDragAndDrop")}),a)}isGroupingAndLocked(){return this.isGroupingZone()&&this.columnModel.isColumnGroupingLocked(this.column)}isAggregationZone(){return"aggregation"===this.dropZonePurpose}isGroupingZone(){return"rowGroup"===this.dropZonePurpose}getDragSourceType(){return s.ax.ToolPanel}destroy(){super.destroy(),this.column=null}};lo([(0,s.A)("popupService")],xo.prototype,"popupService",2),lo([(0,s.O)("aggFuncService")],xo.prototype,"aggFuncService",2),lo([(0,s.A)("sortController")],xo.prototype,"sortController",2),lo([(0,s.A)("columnModel")],xo.prototype,"columnModel",2),lo([(0,s.R)("eSortIndicator")],xo.prototype,"eSortIndicator",2);var To=class extends s.ak{constructor(e,t){super('<div class="ag-select-agg-func-item"/>'),this.selectItem=e,this.getGui().innerText=t,this.addGuiEventListener("click",this.selectItem)}},Mo=class extends s.bm{constructor(e,t){super(e),this.dropZonePurpose=t}init(e){super.init(e),this.addManagedListener(this.eventService,s.aA.EVENT_NEW_COLUMNS_LOADED,this.refreshGui.bind(this)),this.addManagedPropertyListeners(["functionsReadOnly","rowGroupPanelSuppressSort","groupLockGroupColumns"],this.refreshGui.bind(this))}getItems(e){var t;return null!=(t=e.columns)?t:[]}isInterestedIn(e){return e===s.ax.HeaderCell||e===s.ax.ToolPanel}minimumAllowedNewInsertIndex(){const e=this.gridOptionsService.get("groupLockGroupColumns"),t=this.columnModel.getRowGroupColumns().length;return-1===e?t:Math.min(e,t)}showOrHideColumnOnExit(e){return this.isRowGroupPanel()&&!this.gridOptionsService.get("suppressRowGroupHidesColumns")&&!e.fromNudge}handleDragEnterEnd(e){if(this.showOrHideColumnOnExit(e)){const t=e.dragSource.getDragItem().columns;this.setColumnsVisible(t,!1,"uiColumnDragged")}}handleDragLeaveEnd(e){if(this.showOrHideColumnOnExit(e)){const t=e.dragSource.getDragItem();this.setColumnsVisible(t.columns,!0,"uiColumnDragged")}}setColumnsVisible(e,t,i){if(e){const s=e.filter((e=>!e.getColDef().lockVisible));this.columnModel.setColumnsVisible(s,t,i)}}isRowGroupPanel(){return"rowGroup"===this.dropZonePurpose}refreshOnDragStop(){return!this.gridOptionsService.get("functionsPassive")}createPillComponent(e,t,i,s){return new xo(e,t,i,this.dropZonePurpose,s)}};lo([(0,s.A)("columnModel")],Mo.prototype,"columnModel",2);var Po=class extends Mo{constructor(e){super(e,"rowGroup")}passBeansUp(){const e=this.localeService.getLocaleTextFunc(),t=e("rowGroupColumnsEmptyMessage","Drag here to set row groups"),i=e("groups","Row Groups");super.init({icon:s.ch.createIconNoSpan("rowGroupPanel",this.gridOptionsService,null),emptyMessage:t,title:i}),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_ROW_GROUP_CHANGED,this.refreshGui.bind(this))}getAriaLabel(){return this.localeService.getLocaleTextFunc()("ariaRowGroupDropZonePanelLabel","Row Groups")}getTooltipParams(){const e=super.getTooltipParams();return e.location="rowGroupColumnsList",e}isItemDroppable(e,t){return!(this.gridOptionsService.get("functionsReadOnly")||!e.isPrimary())&&(e.isAllowRowGroup()&&(!e.isRowGroupActive()||this.isSourceEventFromTarget(t)))}updateItems(e){if(this.gridOptionsService.get("functionsPassive")){const t={type:s.aA.EVENT_COLUMN_ROW_GROUP_CHANGE_REQUEST,columns:e};this.eventService.dispatchEvent(t)}else this.columnModel.setRowGroupColumns(e,"toolPanelUi")}getIconName(){return this.isPotentialDndItems()?s.av.ICON_GROUP:s.av.ICON_NOT_ALLOWED}getExistingItems(){return this.columnModel.getRowGroupColumns()}};lo([s.a],Po.prototype,"passBeansUp",1);var Fo=class extends Mo{constructor(e){super(e,"pivot")}passBeansUp(){const e=this.localeService.getLocaleTextFunc(),t=e("pivotColumnsEmptyMessage","Drag here to set column labels"),i=e("pivots","Column Labels");super.init({icon:s.ch.createIconNoSpan("pivotPanel",this.gridOptionsService,null),emptyMessage:t,title:i}),this.addManagedListener(this.eventService,s.aA.EVENT_NEW_COLUMNS_LOADED,this.refresh.bind(this)),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_PIVOT_CHANGED,this.refresh.bind(this)),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.checkVisibility.bind(this)),this.refresh()}getAriaLabel(){return this.localeService.getLocaleTextFunc()("ariaPivotDropZonePanelLabel","Column Labels")}getTooltipParams(){const e=super.getTooltipParams();return e.location="pivotColumnsList",e}refresh(){this.checkVisibility(),this.refreshGui()}checkVisibility(){const e=this.columnModel.isPivotMode();if(this.isHorizontal())switch(this.gridOptionsService.get("pivotPanelShow")){case"always":this.setDisplayed(e);break;case"onlyWhenPivoting":const t=this.columnModel.isPivotActive();this.setDisplayed(e&&t);break;default:this.setDisplayed(!1)}else this.setDisplayed(e)}isItemDroppable(e,t){return!(this.gridOptionsService.get("functionsReadOnly")||!e.isPrimary())&&(e.isAllowPivot()&&(!e.isPivotActive()||this.isSourceEventFromTarget(t)))}updateItems(e){if(this.gridOptionsService.get("functionsPassive")){const t={type:s.aA.EVENT_COLUMN_PIVOT_CHANGE_REQUEST,columns:e};this.eventService.dispatchEvent(t)}else this.columnModel.setPivotColumns(e,"toolPanelUi")}getIconName(){return this.isPotentialDndItems()?s.av.ICON_PIVOT:s.av.ICON_NOT_ALLOWED}getExistingItems(){return this.columnModel.getPivotColumns()}};lo([s.a],Fo.prototype,"passBeansUp",1);var Do=class extends s.ak{constructor(){super()}postConstruct(){this.setGui(this.createNorthPanel()),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_ROW_GROUP_CHANGED,(()=>this.onRowGroupChanged())),this.addManagedListener(this.eventService,s.aA.EVENT_NEW_COLUMNS_LOADED,(()=>this.onRowGroupChanged())),this.addManagedPropertyListener("rowGroupPanelShow",(()=>this.onRowGroupChanged())),this.addManagedPropertyListener("pivotPanelShow",(()=>this.onPivotPanelShow())),this.onRowGroupChanged()}createNorthPanel(){const e=document.createElement("div");return e.classList.add("ag-column-drop-wrapper"),s.ch.setAriaRole(e,"presentation"),this.rowGroupComp=new Po(!0),this.createManagedBean(this.rowGroupComp),this.pivotComp=new Fo(!0),this.createManagedBean(this.pivotComp),e.appendChild(this.rowGroupComp.getGui()),e.appendChild(this.pivotComp.getGui()),this.addManagedListener(this.rowGroupComp,s.ak.EVENT_DISPLAYED_CHANGED,(()=>this.onDropPanelVisible())),this.addManagedListener(this.pivotComp,s.ak.EVENT_DISPLAYED_CHANGED,(()=>this.onDropPanelVisible())),this.onDropPanelVisible(),e}onDropPanelVisible(){const e=this.rowGroupComp.isDisplayed()&&this.pivotComp.isDisplayed();this.rowGroupComp.addOrRemoveCssClass("ag-column-drop-horizontal-half-width",e),this.pivotComp.addOrRemoveCssClass("ag-column-drop-horizontal-half-width",e)}onRowGroupChanged(){if(!this.rowGroupComp)return;const e=this.gridOptionsService.get("rowGroupPanelShow");if("always"===e)this.rowGroupComp.setDisplayed(!0);else if("onlyWhenGrouping"===e){const e=!this.columnModel.isRowGroupEmpty();this.rowGroupComp.setDisplayed(e)}else this.rowGroupComp.setDisplayed(!1)}onPivotPanelShow(){if(!this.pivotComp)return;const e=this.gridOptionsService.get("pivotPanelShow");if("always"===e)this.pivotComp.setDisplayed(!0);else if("onlyWhenPivoting"===e){const e=this.columnModel.isPivotActive();this.pivotComp.setDisplayed(e)}else this.pivotComp.setDisplayed(!1)}};lo([(0,s.A)("columnModel")],Do.prototype,"columnModel",2),lo([s.a],Do.prototype,"postConstruct",1);var Ro=class extends s.B{execute(e){var t=this;const i=this.columnModel.isPivotMode(),s=this.filterManager.isAggregateFilterPresent()||this.filterManager.isAggregateQuickFilterPresent(),r=this.gridOptionsService.getGroupAggFiltering()||(i?e=>e.node.leafGroup:e=>!e.node.group),{changedPath:a}=e,o=function(e){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.childrenAfterFilter&&(e.childrenAfterAggFilter=e.childrenAfterFilter,i&&e.childrenAfterAggFilter.forEach((e=>o(e,i))),t.setAllChildrenCount(e)),e.sibling&&(e.sibling.childrenAfterAggFilter=e.childrenAfterAggFilter)};a.forEachChangedNodeDepthFirst(s?e=>{var t;e.childrenAfterAggFilter=(null==(t=e.childrenAfterFilter)?void 0:t.filter((e=>{var t;return r({node:e})&&this.filterManager.doesRowPassAggregateFilters({rowNode:e})?(o(e,!0),!0):null==(t=e.childrenAfterAggFilter)?void 0:t.length})))||null,this.setAllChildrenCount(e),e.sibling&&(e.sibling.childrenAfterAggFilter=e.childrenAfterAggFilter)}:o,!0)}setAllChildrenCountTreeData(e){let t=0;e.childrenAfterAggFilter.forEach((e=>{t++,t+=e.allChildrenCount})),e.setAllChildrenCount(t)}setAllChildrenCountGridGrouping(e){let t=0;e.childrenAfterAggFilter.forEach((e=>{e.group?t+=e.allChildrenCount:t++})),e.setAllChildrenCount(t)}setAllChildrenCount(e){e.hasChildren()?this.gridOptionsService.get("treeData")?this.setAllChildrenCountTreeData(e):this.setAllChildrenCountGridGrouping(e):e.setAllChildrenCount(null)}};lo([(0,s.A)("filterManager")],Ro.prototype,"filterManager",2),lo([(0,s.A)("columnModel")],Ro.prototype,"columnModel",2),Ro=lo([(0,s._)("filterAggregatesStage")],Ro);var Lo=class e extends s.bY{constructor(){super('\n            <div class="ag-group-filter">\n                <div ref="eGroupField"></div>\n                <div ref="eUnderlyingFilter"></div>\n            </div>\n        ')}postConstruct(){this.initialiseTabGuard({})}init(e){return this.params=e,this.validateParams(),this.updateGroups().then((()=>{this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_ROW_GROUP_CHANGED,(()=>this.onColumnRowGroupChanged()))}))}validateParams(){const{colDef:e}=this.params;e.field&&s.ch.warnOnce('Group Column Filter does not work with the colDef property "field". This property will be ignored.'),e.filterValueGetter&&s.ch.warnOnce('Group Column Filter does not work with the colDef property "filterValueGetter". This property will be ignored.'),e.filterParams&&s.ch.warnOnce('Group Column Filter does not work with the colDef property "filterParams". This property will be ignored.')}updateGroups(){const e=this.updateGroupField();return this.getUnderlyingFilters(e)}getSourceColumns(){if(this.groupColumn=this.params.column,this.gridOptionsService.get("treeData"))return s.ch.warnOnce("Group Column Filter does not work with Tree Data enabled. Please disable Tree Data, or use a different filter."),[];return this.columnModel.getSourceColumnsForGroupColumn(this.groupColumn)||(s.ch.warnOnce("Group Column Filter only works on group columns. Please use a different filter."),[])}updateGroupField(){s.ch.clearElement(this.eGroupField),this.eGroupFieldSelect&&this.destroyBean(this.eGroupFieldSelect);const e=this.getSourceColumns(),t=e.filter((e=>e.isFilterAllowed()));return t.length?(1===e.length?(this.selectedColumn=t[0],s.ch.setDisplayed(this.eGroupField,!1)):((!this.selectedColumn||!t.some((e=>e.getId()===this.selectedColumn.getId())))&&(this.selectedColumn=t[0]),this.createGroupFieldSelectElement(t),this.eGroupField.appendChild(this.eGroupFieldSelect.getGui()),this.eGroupField.appendChild(s.ch.loadTemplate('<div class="ag-filter-separator"></div>')),s.ch.setDisplayed(this.eGroupField,!0)),t):(this.selectedColumn=void 0,s.ch.setDisplayed(this.eGroupField,!1),null)}createGroupFieldSelectElement(e){this.eGroupFieldSelect=this.createManagedBean(new s.K);const t=this.localeService.getLocaleTextFunc();this.eGroupFieldSelect.setLabel(t("groupFilterSelect","Select field:")),this.eGroupFieldSelect.setLabelAlignment("top"),this.eGroupFieldSelect.addOptions(e.map((e=>{var t;return{value:e.getId(),text:null!=(t=this.columnModel.getDisplayNameForColumn(e,"groupFilter",!1))?t:void 0}}))),this.eGroupFieldSelect.setValue(this.selectedColumn.getId()),this.eGroupFieldSelect.onValueChange((e=>this.updateSelectedColumn(e))),this.eGroupFieldSelect.addCssClass("ag-group-filter-field-select-wrapper"),1===e.length&&this.eGroupFieldSelect.setDisabled(!0)}getUnderlyingFilters(e){if(!e)return this.filterColumnPairs=void 0,this.selectedFilter=void 0,this.groupColumn.setFilterActive(!1,"columnRowGroupChanged"),s.D.resolve();const t=[],i=[];return e.forEach((e=>{const s=this.filterManager.getOrCreateFilterWrapper(e,"COLUMN_MENU");null!=s&&s.filterPromise&&t.push(s.filterPromise.then((t=>(t&&i.push({filter:t,column:e}),e.getId()===this.selectedColumn.getId()&&(this.selectedFilter=t??void 0),t))))})),s.D.all(t).then((()=>{this.filterColumnPairs=i,this.groupColumn.setFilterActive(this.isFilterActive(),"columnRowGroupChanged")}))}addUnderlyingFilterElement(){if(s.ch.clearElement(this.eUnderlyingFilter),!this.selectedColumn)return s.D.resolve();const e=this.filterManager.getOrCreateFilterWrapper(this.selectedColumn,"COLUMN_MENU");return e?e.guiPromise.then((t=>{var i;this.eUnderlyingFilter.appendChild(t),null==(i=e.filterPromise)||i.then((e=>{var t,i;null==(t=null==e?void 0:e.afterGuiAttached)||t.call(e,this.afterGuiAttachedParams),(null==(i=this.afterGuiAttachedParams)||!i.suppressFocus)&&this.eGroupFieldSelect&&!this.eGroupFieldSelect.isDisabled()&&this.eGroupFieldSelect.getFocusableElement().focus()}))})):s.D.resolve()}updateSelectedColumn(t){var i,s;if(!t)return;null==(s=null==(i=this.selectedFilter)?void 0:i.afterGuiDetached)||s.call(i);const r=this.getFilterColumnPair(t);this.selectedColumn=null==r?void 0:r.column,this.selectedFilter=null==r?void 0:r.filter,this.dispatchEvent({type:e.EVENT_SELECTED_COLUMN_CHANGED}),this.addUnderlyingFilterElement()}isFilterActive(){var e;return!(null==(e=this.filterColumnPairs)||!e.some((e=>{let{filter:t}=e;return t.isFilterActive()})))}doesFilterPass(){return!0}getModel(){return null}setModel(){return s.D.resolve()}afterGuiAttached(e){this.afterGuiAttachedParams=e,this.addUnderlyingFilterElement()}afterGuiDetached(){var e,t;s.ch.clearElement(this.eUnderlyingFilter),null==(t=null==(e=this.selectedFilter)?void 0:e.afterGuiDetached)||t.call(e)}onColumnRowGroupChanged(){this.updateGroups().then((()=>{this.dispatchEvent({type:e.EVENT_COLUMN_ROW_GROUP_CHANGED}),this.eventService.dispatchEvent({type:"filterAllowedUpdated"})}))}getFilterColumnPair(e){var t;if(e)return null==(t=this.filterColumnPairs)?void 0:t.find((t=>{let{column:i}=t;return i.getId()===e}))}getSelectedFilter(){return this.selectedFilter}getSelectedColumn(){return this.selectedColumn}isFilterAllowed(){return!!this.selectedColumn}destroy(){super.destroy()}};Lo.EVENT_COLUMN_ROW_GROUP_CHANGED="columnRowGroupChanged",Lo.EVENT_SELECTED_COLUMN_CHANGED="selectedColumnChanged",lo([(0,s.A)("filterManager")],Lo.prototype,"filterManager",2),lo([(0,s.A)("columnModel")],Lo.prototype,"columnModel",2),lo([(0,s.R)("eGroupField")],Lo.prototype,"eGroupField",2),lo([(0,s.R)("eUnderlyingFilter")],Lo.prototype,"eUnderlyingFilter",2),lo([s.a],Lo.prototype,"postConstruct",1);var Io=Lo,Oo=class extends s.ak{constructor(){super('\n            <div ref="eFloatingFilter" class="ag-group-floating-filter ag-floating-filter-input" role="presentation"></div>\n        '),this.haveAddedColumnListeners=!1}init(e){this.params=e;const t="multipleColumns"===this.gridOptionsService.get("groupDisplayType");return new s.D((e=>{this.params.parentFilterInstance((i=>{this.parentFilterInstance=i,t?this.setupUnderlyingFloatingFilterElement().then((()=>e())):(this.setupReadOnlyFloatingFilterElement(),e())}))})).then((()=>{this.addManagedListener(this.parentFilterInstance,Io.EVENT_SELECTED_COLUMN_CHANGED,(()=>this.onSelectedColumnChanged())),this.addManagedListener(this.parentFilterInstance,Io.EVENT_COLUMN_ROW_GROUP_CHANGED,(()=>this.onColumnRowGroupChanged()))}))}onParamsUpdated(e){this.refresh(e)}refresh(e){this.params=e,this.setParams()}setParams(){var e;const t=this.columnModel.getDisplayNameForColumn(this.params.column,"header",!0),i=this.localeService.getLocaleTextFunc();null==(e=this.eFloatingFilterText)||e.setInputAriaLabel(`${t} ${i("ariaFilterInput","Filter Input")}`)}setupReadOnlyFloatingFilterElement(){this.eFloatingFilterText||(this.eFloatingFilterText=this.createManagedBean(new s.t),this.eFloatingFilterText.setDisabled(!0).addGuiEventListener("click",(()=>this.params.showParentFilter())),this.setParams()),this.updateDisplayedValue(),this.eFloatingFilter.appendChild(this.eFloatingFilterText.getGui())}setupUnderlyingFloatingFilterElement(){this.showingUnderlyingFloatingFilter=!1,this.underlyingFloatingFilter=void 0,s.ch.clearElement(this.eFloatingFilter);const e=this.parentFilterInstance.getSelectedColumn();if(e&&!e.isVisible()){const t=this.filterManager.getFloatingFilterCompDetails(e,this.params.showParentFilter);if(t)return this.compDetails=t,this.haveAddedColumnListeners||(this.haveAddedColumnListeners=!0,this.addManagedListener(e,s.ad.EVENT_VISIBLE_CHANGED,this.onColumnVisibleChanged.bind(this)),this.addManagedListener(e,s.ad.EVENT_COL_DEF_CHANGED,this.onColDefChanged.bind(this))),t.newAgStackInstance().then((e=>{var t,i;this.underlyingFloatingFilter=e,null==(i=this.underlyingFloatingFilter)||i.onParentModelChanged(null==(t=this.parentFilterInstance.getSelectedFilter())?void 0:t.getModel()),this.appendChild(e.getGui()),this.showingUnderlyingFloatingFilter=!0}))}return this.setupReadOnlyFloatingFilterElement(),s.D.resolve()}onColumnVisibleChanged(){this.setupUnderlyingFloatingFilterElement()}onColDefChanged(e){var t,i,s;if(!e.column)return;const r=this.filterManager.getFloatingFilterCompDetails(e.column,this.params.showParentFilter);r&&(null!=(t=this.underlyingFloatingFilter)&&t.refresh?this.underlyingFloatingFilter.refresh(r.params):null==(s=null==(i=this.underlyingFloatingFilter)?void 0:i.onParamsUpdated)||s.call(i,r.params))}onParentModelChanged(e,t){var i,s;this.showingUnderlyingFloatingFilter?null==(s=this.underlyingFloatingFilter)||s.onParentModelChanged(null==(i=this.parentFilterInstance.getSelectedFilter())?void 0:i.getModel(),t):this.updateDisplayedValue()}updateDisplayedValue(){if(!this.parentFilterInstance||!this.eFloatingFilterText)return;const e=this.parentFilterInstance.getSelectedFilter();if(!e)return this.eFloatingFilterText.setValue(""),void this.eFloatingFilterText.setDisplayed(!1);if(this.eFloatingFilterText.setDisplayed(!0),e.getModelAsString){const t=e.getModel();this.eFloatingFilterText.setValue(null==t?"":e.getModelAsString(t))}else this.eFloatingFilterText.setValue("")}onSelectedColumnChanged(){this.showingUnderlyingFloatingFilter||this.updateDisplayedValue()}onColumnRowGroupChanged(){this.showingUnderlyingFloatingFilter||this.updateDisplayedValue()}destroy(){super.destroy()}};lo([(0,s.A)("columnModel")],Oo.prototype,"columnModel",2),lo([(0,s.A)("filterManager")],Oo.prototype,"filterManager",2),lo([(0,s.R)("eFloatingFilter")],Oo.prototype,"eFloatingFilter",2);var No={version:"31.2.1",moduleName:s.M.RowGroupingModule,beans:[ho,Ro,uo,po,go,Co],agStackComponents:[{componentName:"AgGridHeaderDropZones",componentClass:Do}],userComponents:[{componentName:"agGroupColumnFilter",componentClass:Io},{componentName:"agGroupColumnFloatingFilter",componentClass:Oo}],dependantModules:[E]},ko=class extends Mo{constructor(e){super(e,"aggregation")}passBeansUp(){const e=this.localeService.getLocaleTextFunc(),t=e("valueColumnsEmptyMessage","Drag here to aggregate"),i=e("values","Values");super.init({icon:s.ch.createIconNoSpan("valuePanel",this.gridOptionsService,null),emptyMessage:t,title:i}),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_VALUE_CHANGED,this.refreshGui.bind(this))}getAriaLabel(){return this.localeService.getLocaleTextFunc()("ariaValuesDropZonePanelLabel","Values")}getTooltipParams(){const e=super.getTooltipParams();return e.location="valueColumnsList",e}getIconName(){return this.isPotentialDndItems()?s.av.ICON_AGGREGATE:s.av.ICON_NOT_ALLOWED}isItemDroppable(e,t){return!(this.gridOptionsService.get("functionsReadOnly")||!e.isPrimary())&&(e.isAllowValue()&&(!e.isValueActive()||this.isSourceEventFromTarget(t)))}updateItems(e){if(this.gridOptionsService.get("functionsPassive")){const t={type:s.aA.EVENT_COLUMN_VALUE_CHANGE_REQUEST,columns:e};this.eventService.dispatchEvent(t)}else this.columnModel.setValueColumns(e,"toolPanelUi")}getExistingItems(){return this.columnModel.getValueColumns()}};lo([s.a],ko.prototype,"passBeansUp",1);var Go=Object.defineProperty,Vo=Object.defineProperties,Bo=Object.getOwnPropertyDescriptor,_o=Object.getOwnPropertyDescriptors,Uo=Object.getOwnPropertySymbols,Ho=Object.prototype.hasOwnProperty,Wo=Object.prototype.propertyIsEnumerable,Ko=(e,t,i)=>t in e?Go(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,zo=(e,t,i,s)=>{for(var r,a=s>1?void 0:s?Bo(t,i):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s?r(t,i,a):r(a))||a);return s&&a&&Go(t,i,a),a},$o=class extends s.ak{constructor(){super('<div class="ag-tool-panel-horizontal-resize"></div>'),this.minWidth=100,this.maxWidth=null}setElementToResize(e){this.elementToResize=e}postConstruct(){const e=this.horizontalResizeService.addResizeBar({eResizeBar:this.getGui(),dragStartPixels:1,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this),onResizeEnd:this.onResizeEnd.bind(this)});this.addDestroyFunc(e),this.setInverted(this.gridOptionsService.get("enableRtl"))}dispatchResizeEvent(e,t,i){const r={type:s.aA.EVENT_TOOL_PANEL_SIZE_CHANGED,width:i,started:e,ended:t};this.eventService.dispatchEvent(r)}onResizeStart(){this.startingWidth=this.elementToResize.offsetWidth,this.dispatchResizeEvent(!0,!1,this.startingWidth)}onResizeEnd(e){return this.onResizing(e,!0)}onResizing(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=this.inverted?-1:1;let s=Math.max(this.minWidth,Math.floor(this.startingWidth-e*i));null!=this.maxWidth&&(s=Math.min(this.maxWidth,s)),this.elementToResize.style.width=`${s}px`,this.dispatchResizeEvent(!1,t,s)}setInverted(e){this.inverted=e}setMaxWidth(e){this.maxWidth=e}setMinWidth(e){this.minWidth=null!=e?e:100}};zo([(0,s.A)("horizontalResizeService")],$o.prototype,"horizontalResizeService",2),zo([s.a],$o.prototype,"postConstruct",1);var jo=class e extends s.ak{constructor(e){super(),this.toolPanelDef=e}getToolPanelId(){return this.toolPanelDef.id}postConstruct(){const e=this.createTemplate();this.setTemplate(e),this.setLabel(),this.setIcon(),this.addManagedListener(this.eToggleButton,"click",this.onButtonPressed.bind(this)),this.eToggleButton.setAttribute("id",`ag-${this.getCompId()}-button`)}createTemplate(){return'<div class="ag-side-button" role="presentation">\n                <button type="button" ref="eToggleButton" tabindex="-1" role="tab" aria-expanded="false" class="ag-button ag-side-button-button">\n                    <div ref="eIconWrapper" class="ag-side-button-icon-wrapper" aria-hidden="true"></div>\n                    <span ref ="eLabel" class="ag-side-button-label"></span>\n                </button>\n            </div>'}setLabel(){const e=this.localeService.getLocaleTextFunc(),t=this.toolPanelDef,i=e(t.labelKey,t.labelDefault);this.eLabel.innerText=i}setIcon(){this.eIconWrapper.insertAdjacentElement("afterbegin",s.ch.createIconNoSpan(this.toolPanelDef.iconKey,this.gridOptionsService))}onButtonPressed(){this.dispatchEvent({type:e.EVENT_TOGGLE_BUTTON_CLICKED})}setSelected(e){this.addOrRemoveCssClass("ag-selected",e),s.ch.setAriaExpanded(this.eToggleButton,e)}getButtonElement(){return this.eToggleButton}};jo.EVENT_TOGGLE_BUTTON_CLICKED="toggleButtonClicked",zo([(0,s.R)("eToggleButton")],jo.prototype,"eToggleButton",2),zo([(0,s.R)("eIconWrapper")],jo.prototype,"eIconWrapper",2),zo([(0,s.R)("eLabel")],jo.prototype,"eLabel",2),zo([s.a],jo.prototype,"postConstruct",1);var Yo=jo,qo=class e extends s.ak{constructor(){super(e.TEMPLATE),this.buttonComps=[]}postConstruct(){this.addManagedListener(this.getFocusableElement(),"keydown",this.handleKeyDown.bind(this))}handleKeyDown(e){if(e.key!==s.b6.TAB||!e.shiftKey)return;const t=s.ch.last(this.columnModel.getAllDisplayedColumns());this.focusService.focusGridView(t,!0)&&e.preventDefault()}setActiveButton(e){this.buttonComps.forEach((t=>{t.setSelected(e===t.getToolPanelId())}))}addButtonComp(t){const i=this.createBean(new Yo(t));return this.buttonComps.push(i),this.appendChild(i),i.addEventListener(Yo.EVENT_TOGGLE_BUTTON_CLICKED,(()=>{this.dispatchEvent({type:e.EVENT_SIDE_BAR_BUTTON_CLICKED,toolPanelId:t.id})})),i}clearButtons(){this.buttonComps=this.destroyBeans(this.buttonComps),s.ch.clearElement(this.getGui())}};qo.EVENT_SIDE_BAR_BUTTON_CLICKED="sideBarButtonClicked",qo.TEMPLATE='<div class="ag-side-buttons" role="tablist"></div>',zo([(0,s.A)("focusService")],qo.prototype,"focusService",2),zo([(0,s.A)("columnModel")],qo.prototype,"columnModel",2),zo([s.a],qo.prototype,"postConstruct",1),zo([s.b],qo.prototype,"clearButtons",1);var Xo=qo,Zo=class e{static parse(t){if(t){if(!0===t)return{toolPanels:[e.DEFAULT_COLUMN_COMP,e.DEFAULT_FILTER_COMP],defaultToolPanel:"columns"};if("string"==typeof t)return e.parse([t]);if(Array.isArray(t)){const i=[];return t.forEach((t=>{const s=e.DEFAULT_BY_KEY[t];s?i.push(s):console.warn(`AG Grid: the key ${t} is not a valid key for specifying a tool panel, valid keys are: ${Object.keys(e.DEFAULT_BY_KEY).join(",")}`)})),0===i.length?void 0:{toolPanels:i,defaultToolPanel:i[0].id}}return{toolPanels:e.parseComponents(t.toolPanels),defaultToolPanel:t.defaultToolPanel,hiddenByDefault:t.hiddenByDefault,position:t.position}}}static parseComponents(t){const i=[];return t&&t.forEach((t=>{let s=null;if("string"==typeof t){const i=e.DEFAULT_BY_KEY[t];if(!i)return void console.warn(`AG Grid: the key ${t} is not a valid key for specifying a tool panel, valid keys are: ${Object.keys(e.DEFAULT_BY_KEY).join(",")}`);s=i}else s=t;i.push(s)})),i}};Zo.DEFAULT_COLUMN_COMP={id:"columns",labelDefault:"Columns",labelKey:"columns",iconKey:"columns",toolPanel:"agColumnsToolPanel"},Zo.DEFAULT_FILTER_COMP={id:"filters",labelDefault:"Filters",labelKey:"filters",iconKey:"filter",toolPanel:"agFiltersToolPanel"},Zo.DEFAULT_BY_KEY={columns:Zo.DEFAULT_COLUMN_COMP,filters:Zo.DEFAULT_FILTER_COMP};var Jo=Zo,Qo=class e extends s.ak{constructor(){super(e.TEMPLATE)}setupResize(){const e=this.getGui(),t=this.resizeBar=this.createManagedBean(new $o);e.setAttribute("id",`ag-${this.getCompId()}`),t.setElementToResize(e),this.appendChild(t)}getToolPanelId(){return this.toolPanelId}setToolPanelDef(e,t){const{id:i,minWidth:s,maxWidth:r,width:a}=e;this.toolPanelId=i,this.width=a;const o=this.userComponentFactory.getToolPanelCompDetails(e,t),n=o.newAgStackInstance();this.params=o.params,null!=n?(n.then(this.setToolPanelComponent.bind(this)),null!=s&&this.resizeBar.setMinWidth(s),null!=r&&this.resizeBar.setMaxWidth(r)):console.warn(`AG Grid: error processing tool panel component ${i}. You need to specify 'toolPanel'`)}setToolPanelComponent(e){this.toolPanelCompInstance=e,this.appendChild(e.getGui()),this.addDestroyFunc((()=>{this.destroyBean(e)})),this.width&&(this.getGui().style.width=`${this.width}px`)}getToolPanelInstance(){return this.toolPanelCompInstance}setResizerSizerSide(e){const t="left"===e,i=this.gridOptionsService.get("enableRtl")?t:!t;this.resizeBar.setInverted(i)}refresh(){this.toolPanelCompInstance.refresh(this.params)}};Qo.TEMPLATE='<div class="ag-tool-panel-wrapper" role="tabpanel"/>',zo([(0,s.A)("userComponentFactory")],Qo.prototype,"userComponentFactory",2),zo([s.a],Qo.prototype,"setupResize",1);var en=Qo,tn=class e extends s.ak{constructor(){super(e.TEMPLATE),this.toolPanelWrappers=[]}postConstruct(){var e;this.sideBarButtonsComp.addEventListener(Xo.EVENT_SIDE_BAR_BUTTON_CLICKED,this.onToolPanelButtonClicked.bind(this));const{sideBar:t}=null!=(e=this.gridOptionsService.get("initialState"))?e:{};this.setSideBarDef({sideBarDef:Jo.parse(this.gridOptionsService.get("sideBar")),sideBarState:t}),this.addManagedPropertyListener("sideBar",this.onSideBarUpdated.bind(this)),this.sideBarService.registerSideBarComp(this),this.createManagedBean(new s.bc(this.getFocusableElement(),{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this)}))}onTabKeyDown(e){if(e.defaultPrevented)return;const{focusService:t,sideBarButtonsComp:i}=this,s=this.getGui(),r=i.getGui(),a=this.gridOptionsService.getDocument().activeElement,o=s.querySelector(".ag-tool-panel-wrapper:not(.ag-hidden)"),n=e.target;if(!o)return;if(r.contains(a))return void(t.focusInto(o,e.shiftKey)&&e.preventDefault());if(!e.shiftKey)return;let l=null;o.contains(a)?l=this.focusService.findNextFocusableElement(o,void 0,!0):t.isTargetUnderManagedComponent(o,n)&&e.shiftKey&&(l=this.focusService.findFocusableElementBeforeTabGuard(o,n)),l||(l=r.querySelector(".ag-selected button")),l&&l!==e.target&&(e.preventDefault(),l.focus())}handleKeyDown(e){const t=this.gridOptionsService.getDocument();if(!this.sideBarButtonsComp.getGui().contains(t.activeElement))return;const i=this.sideBarButtonsComp.getGui(),r=Array.prototype.slice.call(i.querySelectorAll(".ag-side-button")),a=t.activeElement,o=r.findIndex((e=>e.contains(a)));let n=null;switch(e.key){case s.b6.LEFT:case s.b6.UP:n=Math.max(0,o-1);break;case s.b6.RIGHT:case s.b6.DOWN:n=Math.min(o+1,r.length-1)}if(null===n)return;const l=r[n].querySelector("button");l&&(l.focus(),e.preventDefault())}onToolPanelButtonClicked(e){const t=e.toolPanelId;this.openedItem()===t?this.openToolPanel(void 0,"sideBarButtonClicked"):this.openToolPanel(t,"sideBarButtonClicked")}clearDownUi(){this.sideBarButtonsComp.clearButtons(),this.destroyToolPanelWrappers()}setSideBarDef(e){let{sideBarDef:t,sideBarState:i,existingToolPanelWrappers:s}=e;if(this.setDisplayed(!1),this.sideBar=t,this.sideBar&&this.sideBar.toolPanels){const e=this.sideBar.toolPanels;if(this.createToolPanelsAndSideButtons(e,i,s),!this.toolPanelWrappers.length)return;const t=i?i.visible:!this.sideBar.hiddenByDefault;if(this.setDisplayed(t),this.setSideBarPosition(i?i.position:this.sideBar.position),t)if(i){const{openToolPanel:e}=i;e&&this.openToolPanel(e,"sideBarInitializing")}else this.openToolPanel(this.sideBar.defaultToolPanel,"sideBarInitializing")}}getDef(){return this.sideBar}setSideBarPosition(e){e||(e="right"),this.position=e;const t="left"===e,i=t?"right":"left";return this.addOrRemoveCssClass("ag-side-bar-left",t),this.addOrRemoveCssClass("ag-side-bar-right",!t),this.toolPanelWrappers.forEach((e=>{e.setResizerSizerSide(i)})),this.eventService.dispatchEvent({type:s.aA.EVENT_SIDE_BAR_UPDATED}),this}setDisplayed(e,t){super.setDisplayed(e,t),this.eventService.dispatchEvent({type:s.aA.EVENT_SIDE_BAR_UPDATED})}getState(){const e={};return this.toolPanelWrappers.forEach((t=>{var i,s;e[t.getToolPanelId()]=null==(s=null==(i=t.getToolPanelInstance())?void 0:i.getState)?void 0:s.call(i)})),{visible:this.isDisplayed(),position:this.position,openToolPanel:this.openedItem(),toolPanels:e}}createToolPanelsAndSideButtons(e,t,i){var s;for(const r of e)this.createToolPanelAndSideButton(r,null==(s=null==t?void 0:t.toolPanels)?void 0:s[r.id],null==i?void 0:i[r.id])}validateDef(e){if(null==e.id)return console.warn("AG Grid: please review all your toolPanel components, it seems like at least one of them doesn't have an id"),!1;if("agColumnsToolPanel"===e.toolPanel&&!s.e.__assertRegistered(s.M.ColumnsToolPanelModule,"Column Tool Panel",this.context.getGridId()))return!1;if("agFiltersToolPanel"===e.toolPanel){if(!s.e.__assertRegistered(s.M.FiltersToolPanelModule,"Filters Tool Panel",this.context.getGridId()))return!1;if(this.filterManager.isAdvancedFilterEnabled())return s.ch.warnOnce("Advanced Filter does not work with Filters Tool Panel. Filters Tool Panel has been disabled."),!1}return!0}createToolPanelAndSideButton(e,t,i){if(!this.validateDef(e))return;const r=this.sideBarButtonsComp.addButtonComp(e);let a;i?a=i:(a=this.getContext().createBean(new en),a.setToolPanelDef(e,{initialState:t,onStateUpdated:()=>this.eventService.dispatchEvent({type:s.aA.EVENT_SIDE_BAR_UPDATED})})),a.setDisplayed(!1);const o=a.getGui();this.appendChild(o),this.toolPanelWrappers.push(a),s.ch.setAriaControls(r.getButtonElement(),o)}refresh(){this.toolPanelWrappers.forEach((e=>e.refresh()))}openToolPanel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";const i=this.openedItem();if(i===e)return;this.toolPanelWrappers.forEach((t=>{const i=e===t.getToolPanelId();t.setDisplayed(i)}));i!==this.openedItem()&&(this.sideBarButtonsComp.setActiveButton(e),this.raiseToolPanelVisibleEvent(e,i??void 0,t))}getToolPanelInstance(e){const t=this.toolPanelWrappers.filter((t=>t.getToolPanelId()===e))[0];if(t)return t.getToolPanelInstance();console.warn(`AG Grid: unable to lookup Tool Panel as invalid key supplied: ${e}`)}raiseToolPanelVisibleEvent(e,t,i){const r=!!e&&!!t;if(t){const e={type:s.aA.EVENT_TOOL_PANEL_VISIBLE_CHANGED,source:i,key:t,visible:!1,switchingToolPanel:r};this.eventService.dispatchEvent(e)}if(e){const t={type:s.aA.EVENT_TOOL_PANEL_VISIBLE_CHANGED,source:i,key:e,visible:!0,switchingToolPanel:r};this.eventService.dispatchEvent(t)}}close(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"api";this.openToolPanel(void 0,e)}isToolPanelShowing(){return!!this.openedItem()}openedItem(){let e=null;return this.toolPanelWrappers.forEach((t=>{t.isDisplayed()&&(e=t.getToolPanelId())})),e}onSideBarUpdated(){var e;const t=Jo.parse(this.gridOptionsService.get("sideBar"));let i={};t&&this.sideBar&&(null==(e=t.toolPanels)||e.forEach((e=>{var t,r;const{id:a}=e;if(!a)return;const o=null==(t=this.sideBar.toolPanels)?void 0:t.find((e=>e.id===a));if(!o||e.toolPanel!==o.toolPanel)return;const n=this.toolPanelWrappers.find((e=>e.getToolPanelId()===a));if(!n)return;const l=this.gridOptionsService.addGridCommonParams(((e,t)=>Vo(e,_o(t)))(((e,t)=>{for(var i in t||(t={}))Ho.call(t,i)&&Ko(e,i,t[i]);if(Uo)for(var i of Uo(t))Wo.call(t,i)&&Ko(e,i,t[i]);return e})({},null!=(r=e.toolPanelParams)?r:{}),{onStateUpdated:()=>this.eventService.dispatchEvent({type:s.aA.EVENT_SIDE_BAR_UPDATED})}));!0===n.getToolPanelInstance().refresh(l)&&(this.toolPanelWrappers=this.toolPanelWrappers.filter((e=>e!==n)),s.ch.removeFromParent(n.getGui()),i[a]=n)}))),this.clearDownUi(),this.setSideBarDef({sideBarDef:t,existingToolPanelWrappers:i})}destroyToolPanelWrappers(){this.toolPanelWrappers.forEach((e=>{s.ch.removeFromParent(e.getGui()),this.destroyBean(e)})),this.toolPanelWrappers.length=0}destroy(){this.destroyToolPanelWrappers(),super.destroy()}};tn.TEMPLATE='<div class="ag-side-bar ag-unselectable">\n            <ag-side-bar-buttons ref="sideBarButtons"></ag-side-bar-buttons>\n        </div>',zo([(0,s.A)("focusService")],tn.prototype,"focusService",2),zo([(0,s.A)("filterManager")],tn.prototype,"filterManager",2),zo([(0,s.A)("sideBarService")],tn.prototype,"sideBarService",2),zo([(0,s.R)("sideBarButtons")],tn.prototype,"sideBarButtonsComp",2),zo([s.a],tn.prototype,"postConstruct",1);var sn=tn,rn=class extends s.B{constructor(){super(...arguments),this.isColGroupDef=e=>e&&typeof e.children<"u",this.getId=e=>this.isColGroupDef(e)?e.groupId:e.colId}createColumnTree(e){const t=[],i=(e,r)=>{if(this.isColGroupDef(e)){const t=e,a=typeof t.groupId<"u"?t.groupId:t.headerName,o=new s.bt(t,a,!1,r),n=[];return t.children.forEach((e=>{const t=i(e,r+1);t&&n.push(t)})),o.setChildren(n),o}{const i=e,s=i.colId?i.colId:i.field,r=this.columnModel.getPrimaryColumn(s);return r||t.push(i),r}},r=[];return e.forEach((e=>{const t=i(e,0);t&&r.push(t)})),t.length>0&&console.warn("AG Grid: unable to find grid columns for the supplied colDef(s):",t),r}syncLayoutWithGrid(e){const t=this.getLeafPathTrees();e(this.mergeLeafPathTrees(t))}getLeafPathTrees(){const e=(t,i)=>{let r;if(t instanceof s.bt)if(t.isPadding())r=i;else{const e=Object.assign({},t.getColGroupDef());e.groupId=t.getGroupId(),e.children=[i],r=e}else{const e=Object.assign({},t.getColDef());e.colId=t.getColId(),r=e}const a=t.getOriginalParent();return a?e(a,r):r};return this.columnModel.getAllGridColumns().filter((e=>{const t=e.getColDef();return e.isPrimary()&&!t.showRowGroup})).map((t=>e(t,t.getColDef())))}mergeLeafPathTrees(e){const t=(e,t)=>this.isColGroupDef(e)&&this.isColGroupDef(t)&&this.getId(e)===this.getId(t),i=(e,t)=>{if(!this.isColGroupDef(t))return e;const s=e,r=t;return r.children&&r.groupId&&this.addChildrenToGroup(s,r.groupId,r.children[0])||r.children.forEach((e=>i(s,e))),s},s=[];for(let r=1;r<=e.length;r++){const a=e[r-1],o=e[r];t(a,o)?e[r]=i(a,o):s.push(a)}return s}addChildrenToGroup(e,t,i){if(!this.isColGroupDef(e))return!0;const r=e,a=i;if(((e,t)=>{const i=e.children.map(this.getId),r=s.ch.includes(i,this.getId(t)),a=s.ch.last(e.children),o=a&&this.getId(a)!==this.getId(t);return r&&o})(r,a))return r.children.push(a),!0;if(r.groupId===t){const e=r.children.map(this.getId);if(!s.ch.includes(e,this.getId(a)))return r.children.push(a),!0}return r.children.forEach((e=>this.addChildrenToGroup(e,t,i))),!1}};zo([(0,s.A)("columnModel")],rn.prototype,"columnModel",2),rn=zo([(0,s._)("toolPanelColDefService")],rn);var an=class extends s.B{registerSideBarComp(e){this.sideBarComp=e}getSideBarComp(){return this.sideBarComp}};an=zo([(0,s._)("sideBarService")],an);var on={version:"31.2.1",moduleName:s.M.SideBarModule,beans:[rn,an],agStackComponents:[{componentName:"AgHorizontalResize",componentClass:$o},{componentName:"AgSideBar",componentClass:sn},{componentName:"AgSideBarButtons",componentClass:Xo}],dependantModules:[E]},nn=Object.defineProperty,ln=Object.getOwnPropertyDescriptor,dn=Object.getOwnPropertySymbols,hn=Object.prototype.hasOwnProperty,cn=Object.prototype.propertyIsEnumerable,un=(e,t,i)=>t in e?nn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,pn=(e,t)=>{for(var i in t||(t={}))hn.call(t,i)&&un(e,i,t[i]);if(dn)for(var i of dn(t))cn.call(t,i)&&un(e,i,t[i]);return e},gn=(e,t,i,s)=>{for(var r,a=s>1?void 0:s?ln(t,i):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s?r(t,i,a):r(a))||a);return s&&a&&nn(t,i,a),a},mn=class e extends s.ak{constructor(){super(e.TEMPLATE)}postConstruct(){this.createExpandIcons(),this.addManagedListener(this.eExpand,"click",this.onExpandClicked.bind(this)),this.addManagedListener(this.eExpand,"keydown",(e=>{e.key===s.b6.SPACE&&(e.preventDefault(),this.onExpandClicked())})),this.addManagedListener(this.eSelect.getInputElement(),"click",this.onSelectClicked.bind(this)),this.addManagedPropertyListener("functionsReadOnly",(()=>this.onFunctionsReadOnlyPropChanged())),this.eFilterTextField.setAutoComplete(!1).onValueChange((()=>this.onFilterTextChanged())),this.addManagedListener(this.eFilterTextField.getInputElement(),"keydown",this.onMiniFilterKeyDown.bind(this)),this.addManagedListener(this.eventService,s.aA.EVENT_NEW_COLUMNS_LOADED,this.showOrHideOptions.bind(this));const e=this.localeService.getLocaleTextFunc();this.eSelect.setInputAriaLabel(e("ariaColumnSelectAll","Toggle Select All Columns")),this.eFilterTextField.setInputAriaLabel(e("ariaFilterColumnsInput","Filter Columns Input")),this.activateTabIndex([this.eExpand])}onFunctionsReadOnlyPropChanged(){const e=this.gridOptionsService.get("functionsReadOnly");this.eSelect.setReadOnly(e),this.eSelect.addOrRemoveCssClass("ag-column-select-column-readonly",e)}init(e){this.params=e;const t=this.gridOptionsService.get("functionsReadOnly");this.eSelect.setReadOnly(t),this.eSelect.addOrRemoveCssClass("ag-column-select-column-readonly",t),this.columnModel.isReady()&&this.showOrHideOptions()}createExpandIcons(){this.eExpand.appendChild(this.eExpandChecked=s.ch.createIconNoSpan("columnSelectOpen",this.gridOptionsService)),this.eExpand.appendChild(this.eExpandUnchecked=s.ch.createIconNoSpan("columnSelectClosed",this.gridOptionsService)),this.eExpand.appendChild(this.eExpandIndeterminate=s.ch.createIconNoSpan("columnSelectIndeterminate",this.gridOptionsService)),this.setExpandState(0)}showOrHideOptions(){const e=!this.params.suppressColumnFilter,t=!this.params.suppressColumnSelectAll,i=!this.params.suppressColumnExpandAll,r=this.columnModel.isPrimaryColumnGroupsPresent(),a=this.localeService.getLocaleTextFunc();this.eFilterTextField.setInputPlaceholder(a("searchOoo","Search...")),s.ch.setDisplayed(this.eFilterTextField.getGui(),e),s.ch.setDisplayed(this.eSelect.getGui(),t),s.ch.setDisplayed(this.eExpand,i&&r)}onFilterTextChanged(){this.onFilterTextChangedDebounced||(this.onFilterTextChangedDebounced=s.ch.debounce((()=>{const e=this.eFilterTextField.getValue();this.dispatchEvent({type:"filterChanged",filterText:e})}),e.DEBOUNCE_DELAY)),this.onFilterTextChangedDebounced()}onMiniFilterKeyDown(t){t.key===s.b6.ENTER&&setTimeout((()=>this.onSelectClicked()),e.DEBOUNCE_DELAY)}onSelectClicked(){this.dispatchEvent({type:this.selectState?"unselectAll":"selectAll"})}onExpandClicked(){this.dispatchEvent({type:0===this.expandState?"collapseAll":"expandAll"})}setExpandState(e){this.expandState=e,s.ch.setDisplayed(this.eExpandChecked,0===this.expandState),s.ch.setDisplayed(this.eExpandUnchecked,1===this.expandState),s.ch.setDisplayed(this.eExpandIndeterminate,2===this.expandState)}setSelectionState(e){this.selectState=e,this.eSelect.setValue(this.selectState)}};mn.DEBOUNCE_DELAY=300,mn.TEMPLATE='<div class="ag-column-select-header" role="presentation">\n            <div ref="eExpand" class="ag-column-select-header-icon"></div>\n            <ag-checkbox ref="eSelect" class="ag-column-select-header-checkbox"></ag-checkbox>\n            <ag-input-text-field class="ag-column-select-header-filter-wrapper" ref="eFilterTextField"></ag-input-text-field>\n        </div>',gn([(0,s.A)("columnModel")],mn.prototype,"columnModel",2),gn([(0,s.R)("eExpand")],mn.prototype,"eExpand",2),gn([(0,s.R)("eSelect")],mn.prototype,"eSelect",2),gn([(0,s.R)("eFilterTextField")],mn.prototype,"eFilterTextField",2),gn([s.a],mn.prototype,"postConstruct",1);var vn=mn,Cn=class e{constructor(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0;this.eventService=new s.az,this.displayName=e,this.dept=i,this.group=r,r?(this.columnGroup=t,this.expanded=a,this.children=[]):this.column=t}isGroup(){return this.group}getDisplayName(){return this.displayName}getColumnGroup(){return this.columnGroup}getColumn(){return this.column}getDept(){return this.dept}isExpanded(){return!!this.expanded}getChildren(){return this.children}isPassesFilter(){return this.passesFilter}setExpanded(t){t!==this.expanded&&(this.expanded=t,this.eventService.dispatchEvent({type:e.EVENT_EXPANDED_CHANGED}))}setPassesFilter(e){this.passesFilter=e}addEventListener(e,t){this.eventService.addEventListener(e,t)}removeEventListener(e,t){this.eventService.removeEventListener(e,t)}};Cn.EVENT_EXPANDED_CHANGED="expandedChanged";var fn=Cn,yn=class extends s.ak{constructor(e,t,i){super('<div class="ag-menu"></div>'),this.column=e,this.mouseEvent=t,this.parentEl=i,this.displayName=null}postConstruct(){if(this.initializeProperties(this.column),this.buildMenuItemMap(),this.column instanceof s.ad?this.displayName=this.columnModel.getDisplayNameForColumn(this.column,"columnToolPanel"):this.displayName=this.columnModel.getDisplayNameForProvidedColumnGroup(null,this.column,"columnToolPanel"),this.isActive()){this.mouseEvent.preventDefault();const e=this.getMappedMenuItems();if(0===e.length)return;this.displayContextMenu(e)}}initializeProperties(e){e instanceof s.bt?this.columns=e.getLeafColumns():this.columns=[e],this.allowGrouping=this.columns.some((e=>e.isPrimary()&&e.isAllowRowGroup())),this.allowValues=this.columns.some((e=>e.isPrimary()&&e.isAllowValue())),this.allowPivoting=this.columnModel.isPivotMode()&&this.columns.some((e=>e.isPrimary()&&e.isAllowPivot()))}buildMenuItemMap(){const e=this.localeService.getLocaleTextFunc();this.menuItemMap=new Map,this.menuItemMap.set("rowGroup",{allowedFunction:e=>e.isPrimary()&&e.isAllowRowGroup()&&!this.columnModel.isColumnGroupingLocked(e),activeFunction:e=>e.isRowGroupActive(),activateLabel:()=>`${e("groupBy","Group by")} ${this.displayName}`,deactivateLabel:()=>`${e("ungroupBy","Un-Group by")} ${this.displayName}`,activateFunction:()=>{const e=this.columnModel.getRowGroupColumns();this.columnModel.setRowGroupColumns(this.addColumnsToList(e),"toolPanelUi")},deActivateFunction:()=>{const e=this.columnModel.getRowGroupColumns();this.columnModel.setRowGroupColumns(this.removeColumnsFromList(e),"toolPanelUi")},addIcon:"menuAddRowGroup",removeIcon:"menuRemoveRowGroup"}),this.menuItemMap.set("value",{allowedFunction:e=>e.isPrimary()&&e.isAllowValue(),activeFunction:e=>e.isValueActive(),activateLabel:()=>e("addToValues",`Add ${this.displayName} to values`,[this.displayName]),deactivateLabel:()=>e("removeFromValues",`Remove ${this.displayName} from values`,[this.displayName]),activateFunction:()=>{const e=this.columnModel.getValueColumns();this.columnModel.setValueColumns(this.addColumnsToList(e),"toolPanelUi")},deActivateFunction:()=>{const e=this.columnModel.getValueColumns();this.columnModel.setValueColumns(this.removeColumnsFromList(e),"toolPanelUi")},addIcon:"valuePanel",removeIcon:"valuePanel"}),this.menuItemMap.set("pivot",{allowedFunction:e=>this.columnModel.isPivotMode()&&e.isPrimary()&&e.isAllowPivot(),activeFunction:e=>e.isPivotActive(),activateLabel:()=>e("addToLabels",`Add ${this.displayName} to labels`,[this.displayName]),deactivateLabel:()=>e("removeFromLabels",`Remove ${this.displayName} from labels`,[this.displayName]),activateFunction:()=>{const e=this.columnModel.getPivotColumns();this.columnModel.setPivotColumns(this.addColumnsToList(e),"toolPanelUi")},deActivateFunction:()=>{const e=this.columnModel.getPivotColumns();this.columnModel.setPivotColumns(this.removeColumnsFromList(e),"toolPanelUi")},addIcon:"pivotPanel",removeIcon:"pivotPanel"})}addColumnsToList(e){return[...e].concat(this.columns.filter((t=>-1===e.indexOf(t))))}removeColumnsFromList(e){return e.filter((e=>-1===this.columns.indexOf(e)))}displayContextMenu(e){const t=this.getGui(),i=this.createBean(new s.w),r=this.localeService.getLocaleTextFunc();let a=()=>{};t.appendChild(i.getGui()),i.addMenuItems(e),i.addManagedListener(i,s.u.EVENT_CLOSE_MENU,(()=>{this.parentEl.focus(),a()}));const o=this.popupService.addPopup({modal:!0,eChild:t,closeOnEsc:!0,afterGuiAttached:()=>this.focusService.focusInto(i.getGui()),ariaLabel:r("ariaLabelContextMenu","Context Menu"),closedCallback:e=>{e instanceof KeyboardEvent&&this.parentEl.focus(),this.destroyBean(i)}});o&&(a=o.hideFunc),this.popupService.positionPopupUnderMouseEvent({type:"columnContextMenu",mouseEvent:this.mouseEvent,ePopup:t})}isActive(){return this.allowGrouping||this.allowValues||this.allowPivoting}getMappedMenuItems(){const e=[];for(const t of this.menuItemMap.values()){const i=this.columns.some((e=>t.allowedFunction(e)&&!t.activeFunction(e))),r=this.columns.some((e=>t.allowedFunction(e)&&t.activeFunction(e)));i&&e.push({name:t.activateLabel(this.displayName),icon:s.ch.createIconNoSpan(t.addIcon,this.gridOptionsService,null),action:()=>t.activateFunction()}),r&&e.push({name:t.deactivateLabel(this.displayName),icon:s.ch.createIconNoSpan(t.removeIcon,this.gridOptionsService,null),action:()=>t.deActivateFunction()})}return e}};gn([(0,s.A)("columnModel")],yn.prototype,"columnModel",2),gn([(0,s.A)("popupService")],yn.prototype,"popupService",2),gn([(0,s.A)("focusService")],yn.prototype,"focusService",2),gn([s.a],yn.prototype,"postConstruct",1);var Sn=class e extends s.ak{constructor(e,t,i,s){super(),this.modelItem=e,this.allowDragging=t,this.eventType=i,this.focusWrapper=s,this.processingColumnStateChange=!1,this.modelItem=e,this.columnGroup=e.getColumnGroup(),this.columnDept=e.getDept(),this.displayName=e.getDisplayName(),this.allowDragging=t}init(){this.setTemplate(e.TEMPLATE),this.eDragHandle=s.ch.createIconNoSpan("columnDrag",this.gridOptionsService),this.eDragHandle.classList.add("ag-drag-handle","ag-column-select-column-group-drag-handle");const t=this.cbSelect.getGui(),i=this.cbSelect.getInputElement();t.insertAdjacentElement("afterend",this.eDragHandle),i.setAttribute("tabindex","-1"),this.eLabel.innerHTML=this.displayName?this.displayName:"",this.setupExpandContract(),this.addCssClass("ag-column-select-indent-"+this.columnDept),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(this.eLabel,"click",this.onLabelClicked.bind(this)),this.addManagedListener(this.cbSelect,s.aA.EVENT_FIELD_VALUE_CHANGED,this.onCheckboxChanged.bind(this)),this.addManagedListener(this.modelItem,fn.EVENT_EXPANDED_CHANGED,this.onExpandChanged.bind(this)),this.addManagedListener(this.focusWrapper,"keydown",this.handleKeyDown.bind(this)),this.addManagedListener(this.focusWrapper,"contextmenu",this.onContextMenu.bind(this)),this.setOpenClosedIcons(),this.setupDragging(),this.onColumnStateChanged(),this.addVisibilityListenersToAllChildren(),this.refreshAriaExpanded(),this.refreshAriaLabel(),this.setupTooltip(),s.an.getToolPanelClassesFromColDef(this.columnGroup.getColGroupDef(),this.gridOptionsService,null,this.columnGroup).forEach((e=>this.addOrRemoveCssClass(e,!0)))}getColumns(){return this.columnGroup.getLeafColumns()}setupTooltip(){const e=this.columnGroup.getColGroupDef();if(!e)return;let t;"whenTruncated"===this.gridOptionsService.get("tooltipShowMode")&&(t=()=>this.eLabel.scrollWidth>this.eLabel.clientWidth);const i=()=>{const i=e.headerTooltip;this.setTooltip({newTooltipText:i,location:"columnToolPanelColumnGroup",shouldDisplayTooltip:t})};i(),this.addManagedListener(this.eventService,s.aA.EVENT_NEW_COLUMNS_LOADED,i)}getTooltipParams(){const e=super.getTooltipParams();return e.location="columnToolPanelColumnGroup",e}handleKeyDown(e){switch(e.key){case s.b6.LEFT:e.preventDefault(),this.modelItem.setExpanded(!1);break;case s.b6.RIGHT:e.preventDefault(),this.modelItem.setExpanded(!0);break;case s.b6.SPACE:e.preventDefault(),this.isSelectable()&&this.onSelectAllChanged(!this.isSelected())}}onContextMenu(e){const{columnGroup:t,gridOptionsService:i}=this;if(i.get("functionsReadOnly"))return;const s=this.createBean(new yn(t,e,this.focusWrapper));this.addDestroyFunc((()=>{s.isAlive()&&this.destroyBean(s)}))}addVisibilityListenersToAllChildren(){this.columnGroup.getLeafColumns().forEach((e=>{this.addManagedListener(e,s.ad.EVENT_VISIBLE_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(e,s.ad.EVENT_VALUE_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(e,s.ad.EVENT_PIVOT_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(e,s.ad.EVENT_ROW_GROUP_CHANGED,this.onColumnStateChanged.bind(this))}))}setupDragging(){if(!this.allowDragging)return void s.ch.setDisplayed(this.eDragHandle,!1);let e=!this.gridOptionsService.get("suppressDragLeaveHidesColumns");const t={type:s.ax.ToolPanel,eElement:this.eDragHandle,dragItemName:this.displayName,getDefaultIconName:()=>e?s.av.ICON_HIDE:s.av.ICON_NOT_ALLOWED,getDragItem:()=>this.createDragItem(),onDragStarted:()=>{e=!this.gridOptionsService.get("suppressDragLeaveHidesColumns");const t={type:s.aA.EVENT_COLUMN_PANEL_ITEM_DRAG_START,column:this.columnGroup};this.eventService.dispatchEvent(t)},onDragStopped:()=>{const e={type:s.aA.EVENT_COLUMN_PANEL_ITEM_DRAG_END};this.eventService.dispatchEvent(e)},onGridEnter:t=>{e&&this.modelItemUtils.updateColumns({columns:this.columnGroup.getLeafColumns(),visibleState:null==t?void 0:t.visibleState,pivotState:null==t?void 0:t.pivotState,eventType:this.eventType})},onGridExit:()=>{e&&this.onChangeCommon(!1)}};this.dragAndDropService.addDragSource(t,!0),this.addDestroyFunc((()=>this.dragAndDropService.removeDragSource(t)))}createDragItem(){const e=this.columnGroup.getLeafColumns(),t={},i={};return e.forEach((e=>{const s=e.getId();t[s]=e.isVisible(),i[s]=this.modelItemUtils.createPivotState(e)})),{columns:e,visibleState:t,pivotState:i}}setupExpandContract(){this.eGroupClosedIcon.appendChild(s.ch.createIcon("columnSelectClosed",this.gridOptionsService,null)),this.eGroupOpenedIcon.appendChild(s.ch.createIcon("columnSelectOpen",this.gridOptionsService,null)),this.addManagedListener(this.eGroupClosedIcon,"click",this.onExpandOrContractClicked.bind(this)),this.addManagedListener(this.eGroupOpenedIcon,"click",this.onExpandOrContractClicked.bind(this));const e=new s.c6(this.eColumnGroupIcons,!0);this.addManagedListener(e,s.c6.EVENT_TAP,this.onExpandOrContractClicked.bind(this)),this.addDestroyFunc(e.destroy.bind(e))}onLabelClicked(){const e=!this.cbSelect.getValue();this.onChangeCommon(e)}onCheckboxChanged(e){this.onChangeCommon(e.selected)}getVisibleLeafColumns(){const e=[],t=i=>{i.forEach((i=>{i.isPassesFilter()&&(i.isGroup()?t(i.getChildren()):e.push(i.getColumn()))}))};return t(this.modelItem.getChildren()),e}onChangeCommon(e){this.refreshAriaLabel(),!this.processingColumnStateChange&&this.modelItemUtils.selectAllChildren(this.modelItem.getChildren(),e,this.eventType)}refreshAriaLabel(){const e=this.localeService.getLocaleTextFunc(),t=e("ariaColumnGroup","Column Group"),i=this.cbSelect.getValue(),r=void 0===i?e("ariaIndeterminate","indeterminate"):i?e("ariaVisible","visible"):e("ariaHidden","hidden"),a=e("ariaToggleVisibility","Press SPACE to toggle visibility");s.ch.setAriaLabel(this.focusWrapper,`${this.displayName} ${t}`),this.cbSelect.setInputAriaLabel(`${a} (${r})`),s.ch.setAriaDescribedBy(this.focusWrapper,this.cbSelect.getInputElement().id)}onColumnStateChanged(){const e=this.workOutSelectedValue(),t=this.workOutReadOnlyValue();this.processingColumnStateChange=!0,this.cbSelect.setValue(e),this.cbSelect.setReadOnly(t),this.addOrRemoveCssClass("ag-column-select-column-group-readonly",t),this.processingColumnStateChange=!1}workOutSelectedValue(){const e=this.columnModel.isPivotMode(),t=this.getVisibleLeafColumns();let i=0,s=0;if(t.forEach((t=>{!e&&t.getColDef().lockVisible||(this.isColumnChecked(t,e)?i++:s++)})),!(i>0&&s>0))return i>0}workOutReadOnlyValue(){const e=this.columnModel.isPivotMode();let t=0;return this.columnGroup.getLeafColumns().forEach((i=>{e?i.isAnyFunctionAllowed()&&t++:i.getColDef().lockVisible||t++})),0===t}isColumnChecked(e,t){if(t){const t=e.isPivotActive(),i=e.isRowGroupActive(),s=e.isValueActive();return t||i||s}return e.isVisible()}onExpandOrContractClicked(){const e=this.modelItem.isExpanded();this.modelItem.setExpanded(!e)}onExpandChanged(){this.setOpenClosedIcons(),this.refreshAriaExpanded()}setOpenClosedIcons(){const e=this.modelItem.isExpanded();s.ch.setDisplayed(this.eGroupClosedIcon,!e),s.ch.setDisplayed(this.eGroupOpenedIcon,e)}refreshAriaExpanded(){s.ch.setAriaExpanded(this.focusWrapper,this.modelItem.isExpanded())}getDisplayName(){return this.displayName}onSelectAllChanged(e){const t=this.cbSelect.getValue();!this.cbSelect.isReadOnly()&&(e&&!t||!e&&t)&&this.cbSelect.toggle()}isSelected(){return this.cbSelect.getValue()}isSelectable(){return!this.cbSelect.isReadOnly()}setSelected(e){this.cbSelect.setValue(e,!0)}};Sn.TEMPLATE='<div class="ag-column-select-column-group" aria-hidden="true">\n            <span class="ag-column-group-icons" ref="eColumnGroupIcons" >\n                <span class="ag-column-group-closed-icon" ref="eGroupClosedIcon"></span>\n                <span class="ag-column-group-opened-icon" ref="eGroupOpenedIcon"></span>\n            </span>\n            <ag-checkbox ref="cbSelect" class="ag-column-select-checkbox"></ag-checkbox>\n            <span class="ag-column-select-column-label" ref="eLabel"></span>\n        </div>',gn([(0,s.A)("columnModel")],Sn.prototype,"columnModel",2),gn([(0,s.A)("dragAndDropService")],Sn.prototype,"dragAndDropService",2),gn([(0,s.A)("modelItemUtils")],Sn.prototype,"modelItemUtils",2),gn([(0,s.R)("cbSelect")],Sn.prototype,"cbSelect",2),gn([(0,s.R)("eLabel")],Sn.prototype,"eLabel",2),gn([(0,s.R)("eGroupOpenedIcon")],Sn.prototype,"eGroupOpenedIcon",2),gn([(0,s.R)("eGroupClosedIcon")],Sn.prototype,"eGroupClosedIcon",2),gn([(0,s.R)("eColumnGroupIcons")],Sn.prototype,"eColumnGroupIcons",2),gn([s.a],Sn.prototype,"init",1);var En=Sn,bn=class extends s.B{constructor(e,t){super(),this.comp=e,this.virtualList=t}postConstruct(){this.createManagedBean(new s.cg(this.comp,this.virtualList,{dragSourceType:s.ax.ToolPanel,listItemDragStartEvent:s.aA.EVENT_COLUMN_PANEL_ITEM_DRAG_START,listItemDragEndEvent:s.aA.EVENT_COLUMN_PANEL_ITEM_DRAG_END,eventSource:this.eventService,getCurrentDragValue:e=>this.getCurrentDragValue(e),isMoveBlocked:e=>this.isMoveBlocked(e),getNumRows:e=>e.getDisplayedColsList().length,moveItem:(e,t)=>this.moveItem(e,t)}))}getCurrentDragValue(e){return e.column}isMoveBlocked(e){return!!this.gridOptionsService.get("suppressMovableColumns")||!!this.getCurrentColumns(e).find((e=>{const t=e.getColDef();return!!t.suppressMovable||!!t.lockPosition}))}moveItem(e,t){const i=this.getTargetIndex(e,t),s=this.getCurrentColumns(e);null!=i&&this.columnModel.moveColumns(s,i,"toolPanelUi")}getMoveDiff(e,t){const i=this.columnModel.getAllGridColumns(),s=this.getCurrentColumns(e),r=s[0],a=s.length;return i.indexOf(r)<t?a:0}getCurrentColumns(e){return e instanceof s.bt?e.getLeafColumns():[e]}getTargetIndex(e,t){if(!t)return null;const i=t.component;let s,r="top"===t.position;if(i instanceof En?(s=i.getColumns()[0],r=!0):s=i.getColumn(),-1!==this.getCurrentColumns(e).indexOf(s))return null;const a=this.columnModel.getAllGridColumns().indexOf(s),o=r?a:a+1;return o-this.getMoveDiff(e,o)}};gn([(0,s.A)("columnModel")],bn.prototype,"columnModel",2),gn([(0,s.A)("gridOptionsService")],bn.prototype,"gridOptionsService",2),gn([s.a],bn.prototype,"postConstruct",1);var wn=class e extends s.ak{constructor(e,t,i,s){super(),this.allowDragging=t,this.groupsExist=i,this.focusWrapper=s,this.processingColumnStateChange=!1,this.column=e.getColumn(),this.columnDept=e.getDept(),this.displayName=e.getDisplayName()}init(){this.setTemplate(e.TEMPLATE),this.eDragHandle=s.ch.createIconNoSpan("columnDrag",this.gridOptionsService),this.eDragHandle.classList.add("ag-drag-handle","ag-column-select-column-drag-handle");const t=this.cbSelect.getGui(),i=this.cbSelect.getInputElement();t.insertAdjacentElement("afterend",this.eDragHandle),i.setAttribute("tabindex","-1");const r=s.ch.escapeString(this.displayName);this.eLabel.innerHTML=r;const a=this.columnDept;this.groupsExist&&this.addCssClass("ag-column-select-add-group-indent"),this.addCssClass(`ag-column-select-indent-${a}`),this.setupDragging(),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(this.column,s.ad.EVENT_VALUE_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(this.column,s.ad.EVENT_PIVOT_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(this.column,s.ad.EVENT_ROW_GROUP_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(this.column,s.ad.EVENT_VISIBLE_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(this.focusWrapper,"keydown",this.handleKeyDown.bind(this)),this.addManagedListener(this.focusWrapper,"contextmenu",this.onContextMenu.bind(this)),this.addManagedPropertyListener("functionsReadOnly",this.onColumnStateChanged.bind(this)),this.addManagedListener(this.cbSelect,s.aA.EVENT_FIELD_VALUE_CHANGED,this.onCheckboxChanged.bind(this)),this.addManagedListener(this.eLabel,"click",this.onLabelClicked.bind(this)),this.onColumnStateChanged(),this.refreshAriaLabel(),this.setupTooltip(),s.an.getToolPanelClassesFromColDef(this.column.getColDef(),this.gridOptionsService,this.column,null).forEach((e=>this.addOrRemoveCssClass(e,!0)))}getColumn(){return this.column}setupTooltip(){let e;"whenTruncated"===this.gridOptionsService.get("tooltipShowMode")&&(e=()=>this.eLabel.scrollWidth>this.eLabel.clientWidth);const t=()=>{const t=this.column.getColDef().headerTooltip;this.setTooltip({newTooltipText:t,location:"columnToolPanelColumn",shouldDisplayTooltip:e})};t(),this.addManagedListener(this.eventService,s.aA.EVENT_NEW_COLUMNS_LOADED,t)}getTooltipParams(){const e=super.getTooltipParams();return e.location="columnToolPanelColumn",e.colDef=this.column.getColDef(),e}onContextMenu(e){const{column:t,gridOptionsService:i}=this;if(i.get("functionsReadOnly"))return;const s=this.createBean(new yn(t,e,this.focusWrapper));this.addDestroyFunc((()=>{s.isAlive()&&this.destroyBean(s)}))}handleKeyDown(e){e.key===s.b6.SPACE&&(e.preventDefault(),this.isSelectable()&&this.onSelectAllChanged(!this.isSelected()))}onLabelClicked(){if(this.gridOptionsService.get("functionsReadOnly"))return;const e=!this.cbSelect.getValue();this.onChangeCommon(e)}onCheckboxChanged(e){this.onChangeCommon(e.selected)}onChangeCommon(e){this.cbSelect.isReadOnly()||(this.refreshAriaLabel(),!this.processingColumnStateChange&&this.modelItemUtils.setColumn(this.column,e,"toolPanelUi"))}refreshAriaLabel(){const e=this.localeService.getLocaleTextFunc(),t=e("ariaColumn","Column"),i=this.cbSelect.getValue()?e("ariaVisible","visible"):e("ariaHidden","hidden"),r=e("ariaToggleVisibility","Press SPACE to toggle visibility");s.ch.setAriaLabel(this.focusWrapper,`${this.displayName} ${t}`),this.cbSelect.setInputAriaLabel(`${r} (${i})`),s.ch.setAriaDescribedBy(this.focusWrapper,this.cbSelect.getInputElement().id)}setupDragging(){if(!this.allowDragging)return void s.ch.setDisplayed(this.eDragHandle,!1);let e=!this.gridOptionsService.get("suppressDragLeaveHidesColumns");const t={type:s.ax.ToolPanel,eElement:this.eDragHandle,dragItemName:this.displayName,getDefaultIconName:()=>e?s.av.ICON_HIDE:s.av.ICON_NOT_ALLOWED,getDragItem:()=>this.createDragItem(),onDragStarted:()=>{e=!this.gridOptionsService.get("suppressDragLeaveHidesColumns");const t={type:s.aA.EVENT_COLUMN_PANEL_ITEM_DRAG_START,column:this.column};this.eventService.dispatchEvent(t)},onDragStopped:()=>{const e={type:s.aA.EVENT_COLUMN_PANEL_ITEM_DRAG_END};this.eventService.dispatchEvent(e)},onGridEnter:t=>{e&&this.modelItemUtils.updateColumns({columns:[this.column],visibleState:null==t?void 0:t.visibleState,pivotState:null==t?void 0:t.pivotState,eventType:"toolPanelUi"})},onGridExit:()=>{e&&this.onChangeCommon(!1)}};this.dragAndDropService.addDragSource(t,!0),this.addDestroyFunc((()=>this.dragAndDropService.removeDragSource(t)))}createDragItem(){const e=this.column.getColId(),t={[e]:this.column.isVisible()},i={[e]:this.modelItemUtils.createPivotState(this.column)};return{columns:[this.column],visibleState:t,pivotState:i}}onColumnStateChanged(){this.processingColumnStateChange=!0;const e=this.columnModel.isPivotMode();if(e){const e=this.column.isAnyFunctionActive();this.cbSelect.setValue(e)}else this.cbSelect.setValue(this.column.isVisible());let t=!0,i=!0;if(e){const e=this.gridOptionsService.get("functionsReadOnly"),s=!this.column.isAnyFunctionAllowed();t=!e&&!s,i=t}else{const{enableRowGroup:e,enableValue:s,lockPosition:r,suppressMovable:a,lockVisible:o}=this.column.getColDef();t=!o,i=!!e||!!s||!(!!r||!!a)}this.cbSelect.setReadOnly(!t),this.eDragHandle.classList.toggle("ag-column-select-column-readonly",!i),this.addOrRemoveCssClass("ag-column-select-column-readonly",!i&&!t);const s=e&&this.gridOptionsService.get("functionsPassive");this.cbSelect.setPassive(s),this.processingColumnStateChange=!1}getDisplayName(){return this.displayName}onSelectAllChanged(e){e!==this.cbSelect.getValue()&&(this.cbSelect.isReadOnly()||this.cbSelect.toggle())}isSelected(){return this.cbSelect.getValue()}isSelectable(){return!this.cbSelect.isReadOnly()}isExpandable(){return!1}setExpanded(e){console.warn("AG Grid: can not expand a column item that does not represent a column group header")}};wn.TEMPLATE='<div class="ag-column-select-column" aria-hidden="true">\n            <ag-checkbox ref="cbSelect" class="ag-column-select-checkbox"></ag-checkbox>\n            <span class="ag-column-select-column-label" ref="eLabel"></span>\n        </div>',gn([(0,s.A)("columnModel")],wn.prototype,"columnModel",2),gn([(0,s.A)("dragAndDropService")],wn.prototype,"dragAndDropService",2),gn([(0,s.A)("modelItemUtils")],wn.prototype,"modelItemUtils",2),gn([(0,s.R)("eLabel")],wn.prototype,"eLabel",2),gn([(0,s.R)("cbSelect")],wn.prototype,"cbSelect",2),gn([s.a],wn.prototype,"init",1);var An=wn,xn=class{constructor(e){this.items=e}getRowCount(){return this.items.length}getRow(e){return this.items[e]}},Tn=class e extends s.ak{constructor(){super(e.TEMPLATE),this.destroyColumnItemFuncs=[],this.hasLoadedInitialState=!1,this.isInitialState=!1}destroyColumnTree(){this.allColsTree=[],this.destroyColumnItemFuncs.forEach((e=>e())),this.destroyColumnItemFuncs=[]}init(e,t,i){this.params=e,this.allowDragging=t,this.eventType=i,this.params.suppressSyncLayoutWithGrid||this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_MOVED,this.onColumnsChanged.bind(this)),this.addManagedListener(this.eventService,s.aA.EVENT_NEW_COLUMNS_LOADED,this.onColumnsChanged.bind(this)),[s.aA.EVENT_COLUMN_PIVOT_CHANGED,s.aA.EVENT_COLUMN_PIVOT_MODE_CHANGED,s.aA.EVENT_COLUMN_ROW_GROUP_CHANGED,s.aA.EVENT_COLUMN_VALUE_CHANGED,s.aA.EVENT_COLUMN_VISIBLE,s.aA.EVENT_NEW_COLUMNS_LOADED].forEach((e=>{this.addManagedListener(this.eventService,e,this.fireSelectionChangedEvent.bind(this))})),this.expandGroupsByDefault=!this.params.contractColumnSelection,this.virtualList=this.createManagedBean(new s.cf({cssIdentifier:"column-select",ariaRole:"tree"})),this.appendChild(this.virtualList.getGui()),this.virtualList.setComponentCreator(((e,t)=>(s.ch.setAriaLevel(t,e.getDept()+1),this.createComponentFromItem(e,t)))),this.columnModel.isReady()&&this.onColumnsChanged(),!this.params.suppressColumnMove&&this.createManagedBean(new bn(this,this.virtualList))}createComponentFromItem(e,t){if(e.isGroup()){const i=new En(e,this.allowDragging,this.eventType,t);return this.getContext().createBean(i),i}const i=new An(e,this.allowDragging,this.groupsExist,t);return this.getContext().createBean(i),i}onColumnsChanged(){this.hasLoadedInitialState||(this.hasLoadedInitialState=!0,this.isInitialState=!!this.params.initialState);const e=this.getExpandedStates(),t=this.columnModel.isPivotMode();this.params.suppressSyncLayoutWithGrid||t?this.buildTreeFromProvidedColumnDefs():this.buildTreeFromWhatGridIsDisplaying(),this.setExpandedStates(e),this.markFilteredColumns(),this.flattenAndFilterModel(),this.isInitialState=!1}getDisplayedColsList(){return this.displayedColsList}getExpandedStates(){const e={};if(this.isInitialState){const{expandedGroupIds:t}=this.params.initialState;return t.forEach((t=>{e[t]=!0})),e}return this.allColsTree?(this.forEachItem((t=>{if(!t.isGroup())return;const i=t.getColumnGroup();i&&(e[i.getId()]=t.isExpanded())})),e):{}}setExpandedStates(e){if(!this.allColsTree)return;const{isInitialState:t}=this;this.forEachItem((i=>{if(!i.isGroup())return;const s=i.getColumnGroup();if(s){const r=e[s.getId()];(null!=r||t)&&i.setExpanded(!!r)}}))}buildTreeFromWhatGridIsDisplaying(){this.colDefService.syncLayoutWithGrid(this.setColumnLayout.bind(this))}setColumnLayout(e){const t=this.colDefService.createColumnTree(e);this.buildListModel(t),this.groupsExist=e.some((e=>e&&typeof e.children<"u")),this.markFilteredColumns(),this.flattenAndFilterModel()}buildTreeFromProvidedColumnDefs(){this.buildListModel(this.columnModel.getPrimaryColumnTree()),this.groupsExist=this.columnModel.isPrimaryColumnGroupsPresent()}buildListModel(e){const t=this.onColumnExpanded.bind(this),i=e=>{e.addEventListener(fn.EVENT_EXPANDED_CHANGED,t);const i=e.removeEventListener.bind(e,fn.EVENT_EXPANDED_CHANGED,t);this.destroyColumnItemFuncs.push(i)},r=(e,t,i)=>{e.forEach((e=>{e instanceof s.bt?a(e,t,i):o(e,t,i)}))},a=(e,t,s)=>{const a=e.getColGroupDef();if(a&&a.suppressColumnsToolPanel)return;if(e.isPadding())return void r(e.getChildren(),t,s);const o=this.columnModel.getDisplayNameForProvidedColumnGroup(null,e,"columnToolPanel"),n=new fn(o,e,t,!0,this.expandGroupsByDefault);s.push(n),i(n),r(e.getChildren(),t+1,n.getChildren())},o=(e,t,i)=>{if(e.getColDef()&&e.getColDef().suppressColumnsToolPanel)return;const s=this.columnModel.getDisplayNameForColumn(e,"columnToolPanel");i.push(new fn(s,e,t))};this.destroyColumnTree(),r(e,0,this.allColsTree)}onColumnExpanded(){this.flattenAndFilterModel()}flattenAndFilterModel(){this.displayedColsList=[];const e=t=>{t.isPassesFilter()&&(this.displayedColsList.push(t),t.isGroup()&&t.isExpanded()&&t.getChildren().forEach(e))};this.allColsTree.forEach(e),this.virtualList.setModel(new xn(this.displayedColsList));const t=this.virtualList.getLastFocusedRow();this.virtualList.refresh(),null!=t&&this.focusRowIfAlive(t),this.notifyListeners(),this.refreshAriaLabel()}refreshAriaLabel(){const e=this.localeService.getLocaleTextFunc(),t=e("ariaColumnPanelList","Column List"),i=e("columns","Columns"),r=this.displayedColsList.length;s.ch.setAriaLabel(this.virtualList.getAriaElement(),`${t} ${r} ${i}`)}focusRowIfAlive(e){window.setTimeout((()=>{this.isAlive()&&this.virtualList.focusRow(e)}),0)}forEachItem(e){const t=i=>{i.forEach((i=>{e(i),i.isGroup()&&t(i.getChildren())}))};this.allColsTree&&t(this.allColsTree)}doSetExpandedAll(e){this.forEachItem((t=>{t.isGroup()&&t.setExpanded(e)}))}setGroupsExpanded(e,t){if(!t)return void this.doSetExpandedAll(e);const i=[];this.forEachItem((s=>{if(!s.isGroup())return;const r=s.getColumnGroup().getId();t.indexOf(r)>=0&&(s.setExpanded(e),i.push(r))}));const r=t.filter((e=>!s.ch.includes(i,e)));r.length>0&&console.warn("AG Grid: unable to find group(s) for supplied groupIds:",r)}getExpandState(){let e=0,t=0;return this.forEachItem((i=>{i.isGroup()&&(i.isExpanded()?e++:t++)})),e>0&&t>0?2:t>0?1:0}doSetSelectedAll(e){this.modelItemUtils.selectAllChildren(this.allColsTree,e,this.eventType)}getSelectionState(){let e=0,t=0;const i=this.columnModel.isPivotMode();if(this.forEachItem((s=>{if(s.isGroup()||!s.isPassesFilter())return;const r=s.getColumn(),a=r.getColDef();let o;if(i){if(!r.isAllowPivot()&&!r.isAllowRowGroup()&&!r.isAllowValue())return;o=r.isValueActive()||r.isPivotActive()||r.isRowGroupActive()}else{if(a.lockVisible)return;o=r.isVisible()}o?e++:t++})),!(e>0&&t>0))return!(0===e||t>0)}setFilterText(e){this.filterText=s.ch.exists(e)?e.toLowerCase():null,this.markFilteredColumns(),this.flattenAndFilterModel()}markFilteredColumns(){const e=e=>{if(!s.ch.exists(this.filterText))return!0;const t=e.getDisplayName();return null==t||-1!==t.toLowerCase().indexOf(this.filterText)},t=(i,s)=>{let r=!1;if(i.isGroup()){const a=e(i);i.getChildren().forEach((e=>{const i=t(e,a||s);i&&(r=i)}))}const a=!(!s&&!r)||e(i);return i.setPassesFilter(a),a};this.allColsTree.forEach((e=>t(e,!1)))}notifyListeners(){this.fireGroupExpandedEvent(),this.fireSelectionChangedEvent()}fireGroupExpandedEvent(){const e=this.getExpandState();this.dispatchEvent({type:"groupExpanded",state:e})}fireSelectionChangedEvent(){if(!this.allColsTree)return;const e=this.getSelectionState();this.dispatchEvent({type:"selectionChanged",state:e})}getExpandedGroups(){const e=[];return this.allColsTree&&this.forEachItem((t=>{t.isGroup()&&t.isExpanded()&&e.push(t.getColumnGroup().getId())})),e}};Tn.TEMPLATE='<div class="ag-column-select-list" role="presentation"></div>',gn([(0,s.A)("columnModel")],Tn.prototype,"columnModel",2),gn([(0,s.A)("toolPanelColDefService")],Tn.prototype,"colDefService",2),gn([(0,s.A)("modelItemUtils")],Tn.prototype,"modelItemUtils",2),gn([s.b],Tn.prototype,"destroyColumnTree",1);var Mn=Tn,Pn=class extends s.ak{createTemplate(){return'<div class="ag-pivot-mode-panel">\n                <ag-toggle-button ref="cbPivotMode" class="ag-pivot-mode-select"></ag-toggle-button>\n            </div>'}init(){this.setTemplate(this.createTemplate()),this.cbPivotMode.setValue(this.columnModel.isPivotMode());const e=this.localeService.getLocaleTextFunc();this.cbPivotMode.setLabel(e("pivotMode","Pivot Mode")),this.addManagedListener(this.cbPivotMode,s.aA.EVENT_FIELD_VALUE_CHANGED,this.onBtPivotMode.bind(this)),this.addManagedListener(this.eventService,s.aA.EVENT_NEW_COLUMNS_LOADED,this.onPivotModeChanged.bind(this)),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onPivotModeChanged.bind(this))}onBtPivotMode(){const e=!!this.cbPivotMode.getValue();if(e!==this.columnModel.isPivotMode()){this.gridOptionsService.updateGridOptions({options:{pivotMode:e},source:"toolPanelUi"});const{api:t}=this;t&&t.refreshHeader()}}onPivotModeChanged(){const e=this.columnModel.isPivotMode();this.cbPivotMode.setValue(e)}};gn([(0,s.A)("columnModel")],Pn.prototype,"columnModel",2),gn([(0,s.A)("gridApi")],Pn.prototype,"api",2),gn([(0,s.R)("cbPivotMode")],Pn.prototype,"cbPivotMode",2),gn([s.P],Pn.prototype,"init",1);var Fn=class e extends s.ak{constructor(){super(e.TEMPLATE)}init(e,t,i){this.allowDragging=e,this.params=t,this.eventType=i,this.primaryColsHeaderPanel.init(this.params);const r=this.params.suppressColumnFilter,a=this.params.suppressColumnSelectAll;this.params.suppressColumnExpandAll&&r&&a&&this.primaryColsHeaderPanel.setDisplayed(!1),this.addManagedListener(this.primaryColsListPanel,"groupExpanded",this.onGroupExpanded.bind(this)),this.addManagedListener(this.primaryColsListPanel,"selectionChanged",this.onSelectionChange.bind(this)),this.primaryColsListPanel.init(this.params,this.allowDragging,this.eventType),this.addManagedListener(this.primaryColsHeaderPanel,"expandAll",this.onExpandAll.bind(this)),this.addManagedListener(this.primaryColsHeaderPanel,"collapseAll",this.onCollapseAll.bind(this)),this.addManagedListener(this.primaryColsHeaderPanel,"selectAll",this.onSelectAll.bind(this)),this.addManagedListener(this.primaryColsHeaderPanel,"unselectAll",this.onUnselectAll.bind(this)),this.addManagedListener(this.primaryColsHeaderPanel,"filterChanged",this.onFilterChanged.bind(this)),this.positionableFeature=new s.br(this.getGui(),{minHeight:100}),this.createManagedBean(this.positionableFeature)}toggleResizable(e){this.positionableFeature.setResizable(!!e&&{bottom:!0})}onExpandAll(){this.primaryColsListPanel.doSetExpandedAll(!0)}onCollapseAll(){this.primaryColsListPanel.doSetExpandedAll(!1)}expandGroups(e){this.primaryColsListPanel.setGroupsExpanded(!0,e)}collapseGroups(e){this.primaryColsListPanel.setGroupsExpanded(!1,e)}setColumnLayout(e){this.primaryColsListPanel.setColumnLayout(e)}onFilterChanged(e){this.primaryColsListPanel.setFilterText(e.filterText)}syncLayoutWithGrid(){this.primaryColsListPanel.onColumnsChanged()}onSelectAll(){this.primaryColsListPanel.doSetSelectedAll(!0)}onUnselectAll(){this.primaryColsListPanel.doSetSelectedAll(!1)}onGroupExpanded(e){this.primaryColsHeaderPanel.setExpandState(e.state),this.params.onStateUpdated()}onSelectionChange(e){this.primaryColsHeaderPanel.setSelectionState(e.state)}getExpandedGroups(){return this.primaryColsListPanel.getExpandedGroups()}};Fn.TEMPLATE='<div class="ag-column-select">\n            <ag-primary-cols-header ref="primaryColsHeaderPanel"></ag-primary-cols-header>\n            <ag-primary-cols-list ref="primaryColsListPanel"></ag-primary-cols-list>\n        </div>',gn([(0,s.R)("primaryColsHeaderPanel")],Fn.prototype,"primaryColsHeaderPanel",2),gn([(0,s.R)("primaryColsListPanel")],Fn.prototype,"primaryColsListPanel",2);var Dn=Fn,Rn=class e extends s.ak{constructor(){super(e.TEMPLATE),this.initialised=!1,this.childDestroyFuncs=[]}setVisible(e){super.setDisplayed(e),e&&!this.initialised&&this.init(this.params)}init(e){const t=this.gridOptionsService.addGridCommonParams({suppressColumnMove:!1,suppressColumnSelectAll:!1,suppressColumnFilter:!1,suppressColumnExpandAll:!1,contractColumnSelection:!1,suppressPivotMode:!1,suppressRowGroups:!1,suppressValues:!1,suppressPivots:!1,suppressSyncLayoutWithGrid:!1});if(this.params=pn(pn({},t),e),this.isRowGroupingModuleLoaded()&&!this.params.suppressPivotMode&&(this.pivotModePanel=this.createBean(new Pn),this.childDestroyFuncs.push((()=>this.destroyBean(this.pivotModePanel))),this.appendChild(this.pivotModePanel)),this.primaryColsPanel=this.createBean(new Dn),this.childDestroyFuncs.push((()=>this.destroyBean(this.primaryColsPanel))),this.primaryColsPanel.init(!0,this.params,"toolPanelUi"),this.primaryColsPanel.addCssClass("ag-column-panel-column-select"),this.appendChild(this.primaryColsPanel),this.isRowGroupingModuleLoaded()){this.params.suppressRowGroups||(this.rowGroupDropZonePanel=this.createBean(new Po(!1)),this.childDestroyFuncs.push((()=>this.destroyBean(this.rowGroupDropZonePanel))),this.appendChild(this.rowGroupDropZonePanel)),this.params.suppressValues||(this.valuesDropZonePanel=this.createBean(new ko(!1)),this.childDestroyFuncs.push((()=>this.destroyBean(this.valuesDropZonePanel))),this.appendChild(this.valuesDropZonePanel)),this.params.suppressPivots||(this.pivotDropZonePanel=this.createBean(new Fo(!1)),this.childDestroyFuncs.push((()=>this.destroyBean(this.pivotDropZonePanel))),this.appendChild(this.pivotDropZonePanel)),this.setLastVisible();const e=this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_PIVOT_MODE_CHANGED,(()=>{this.resetChildrenHeight(),this.setLastVisible()}));this.childDestroyFuncs.push((()=>e()))}this.initialised=!0}setPivotModeSectionVisible(e){this.isRowGroupingModuleLoaded()&&(this.pivotModePanel?this.pivotModePanel.setDisplayed(e):e&&(this.pivotModePanel=this.createBean(new Pn),this.getGui().insertBefore(this.pivotModePanel.getGui(),this.getGui().firstChild),this.childDestroyFuncs.push((()=>this.destroyBean(this.pivotModePanel)))),this.setLastVisible())}setRowGroupsSectionVisible(e){this.isRowGroupingModuleLoaded()&&(this.rowGroupDropZonePanel?this.rowGroupDropZonePanel.setDisplayed(e):e&&(this.rowGroupDropZonePanel=this.createManagedBean(new Po(!1)),this.appendChild(this.rowGroupDropZonePanel)),this.setLastVisible())}setValuesSectionVisible(e){this.isRowGroupingModuleLoaded()&&(this.valuesDropZonePanel?this.valuesDropZonePanel.setDisplayed(e):e&&(this.valuesDropZonePanel=this.createManagedBean(new ko(!1)),this.appendChild(this.valuesDropZonePanel)),this.setLastVisible())}setPivotSectionVisible(e){this.isRowGroupingModuleLoaded()&&(this.pivotDropZonePanel?this.pivotDropZonePanel.setDisplayed(e):e&&(this.pivotDropZonePanel=this.createManagedBean(new Fo(!1)),this.appendChild(this.pivotDropZonePanel),this.pivotDropZonePanel.setDisplayed(e)),this.setLastVisible())}setResizers(){[this.primaryColsPanel,this.rowGroupDropZonePanel,this.valuesDropZonePanel,this.pivotDropZonePanel].forEach((e=>{if(!e)return;const t=e.getGui();e.toggleResizable(!t.classList.contains("ag-last-column-drop")&&!t.classList.contains("ag-hidden"))}))}setLastVisible(){const e=this.getGui();Array.prototype.slice.call(e.querySelectorAll(".ag-column-drop")).forEach((e=>e.classList.remove("ag-last-column-drop")));const t=e.querySelectorAll(".ag-column-drop:not(.ag-hidden)"),i=s.ch.last(t);i&&i.classList.add("ag-last-column-drop"),this.setResizers()}resetChildrenHeight(){const e=this.getGui().children;for(let t=0;t<e.length;t++){const i=e[t];i.style.removeProperty("height"),i.style.removeProperty("flex")}}isRowGroupingModuleLoaded(){return s.e.__assertRegistered(s.M.RowGroupingModule,"Row Grouping",this.context.getGridId())}expandColumnGroups(e){this.primaryColsPanel.expandGroups(e)}collapseColumnGroups(e){this.primaryColsPanel.collapseGroups(e)}setColumnLayout(e){this.primaryColsPanel.setColumnLayout(e)}syncLayoutWithGrid(){this.primaryColsPanel.syncLayoutWithGrid()}destroyChildren(){this.childDestroyFuncs.forEach((e=>e())),this.childDestroyFuncs.length=0,s.ch.clearElement(this.getGui())}refresh(e){return this.destroyChildren(),this.init(e),!0}getState(){return{expandedGroupIds:this.primaryColsPanel.getExpandedGroups()}}destroy(){this.destroyChildren(),super.destroy()}};Rn.TEMPLATE='<div class="ag-column-panel"></div>';var Ln=Rn,In=class{selectAllChildren(e,t,i){const s=this.extractAllLeafColumns(e);this.setAllColumns(s,t,i)}setColumn(e,t,i){this.setAllColumns([e],t,i)}setAllColumns(e,t,i){this.columnModel.isPivotMode()?this.setAllPivot(e,t,i):this.setAllVisible(e,t,i)}extractAllLeafColumns(e){const t=[],i=e=>{e.forEach((e=>{e.isPassesFilter()&&(e.isGroup()?i(e.getChildren()):t.push(e.getColumn()))}))};return i(e),t}setAllVisible(e,t,i){const s=[];e.forEach((e=>{e.getColDef().lockVisible||e.isVisible()!=t&&s.push({colId:e.getId(),hide:!t})})),s.length>0&&this.columnModel.applyColumnState({state:s},i)}setAllPivot(e,t,i){this.gridOptionsService.get("functionsPassive")?this.setAllPivotPassive(e,t):this.setAllPivotActive(e,t,i)}setAllPivotPassive(e,t){const i=this.columnModel.getPivotColumns().slice(),r=this.columnModel.getValueColumns().slice(),a=this.columnModel.getRowGroupColumns().slice();let o=!1,n=!1,l=!1;const d=t?e=>{e.isAnyFunctionActive()||(e.isAllowValue()?(r.push(e),n=!0):e.isAllowRowGroup()?(a.push(e),o=!0):e.isAllowPivot()&&(i.push(e),l=!0))}:e=>{e.isAnyFunctionActive()&&(i.indexOf(e)>=0&&(s.ch.removeFromArray(i,e),o=!0),r.indexOf(e)>=0&&(s.ch.removeFromArray(r,e),n=!0),a.indexOf(e)>=0&&(s.ch.removeFromArray(a,e),l=!0))};if(e.forEach(d),o){const e={type:s.aA.EVENT_COLUMN_PIVOT_CHANGE_REQUEST,columns:i};this.eventService.dispatchEvent(e)}if(l){const e={type:s.aA.EVENT_COLUMN_ROW_GROUP_CHANGE_REQUEST,columns:a};this.eventService.dispatchEvent(e)}if(n){const e={type:s.aA.EVENT_COLUMN_VALUE_CHANGE_REQUEST,columns:a};this.eventService.dispatchEvent(e)}}setAllPivotActive(e,t,i){const s=[],r=t?e=>{if(!e.isAnyFunctionActive())if(e.isAllowValue()){const t="string"==typeof e.getAggFunc()?e.getAggFunc():this.aggFuncService.getDefaultAggFunc(e);s.push({colId:e.getId(),aggFunc:t})}else e.isAllowRowGroup()?s.push({colId:e.getId(),rowGroup:!0}):e.isAllowPivot()&&s.push({colId:e.getId(),pivot:!0})}:e=>{(e.isPivotActive()||e.isRowGroupActive()||e.isValueActive())&&s.push({colId:e.getId(),pivot:!1,rowGroup:!1,aggFunc:null})};e.forEach(r),s.length>0&&this.columnModel.applyColumnState({state:s},i)}updateColumns(e){const{columns:t,visibleState:i,pivotState:s,eventType:r}=e,a=t.map((e=>{const t=e.getColId();if(this.columnModel.isPivotMode()){const e=null==s?void 0:s[t];return{colId:t,pivot:null==e?void 0:e.pivot,rowGroup:null==e?void 0:e.rowGroup,aggFunc:null==e?void 0:e.aggFunc}}return{colId:t,hide:!(null!=i&&i[t])}}));this.columnModel.applyColumnState({state:a},r)}createPivotState(e){return{pivot:e.isPivotActive(),rowGroup:e.isRowGroupActive(),aggFunc:e.isValueActive()?e.getAggFunc():void 0}}};gn([(0,s.A)("aggFuncService")],In.prototype,"aggFuncService",2),gn([(0,s.A)("columnModel")],In.prototype,"columnModel",2),gn([(0,s.A)("gridOptionsService")],In.prototype,"gridOptionsService",2),gn([(0,s.A)("eventService")],In.prototype,"eventService",2),In=gn([(0,s._)("modelItemUtils")],In);var On={version:"31.2.1",moduleName:s.M.ColumnsToolPanelModule,beans:[In],agStackComponents:[{componentName:"AgPrimaryColsHeader",componentClass:vn},{componentName:"AgPrimaryColsList",componentClass:Mn},{componentName:"AgPrimaryCols",componentClass:Dn}],userComponents:[{componentName:"agColumnsToolPanel",componentClass:Ln}],dependantModules:[E,No,on]},Nn=Object.defineProperty,kn=Object.defineProperties,Gn=Object.getOwnPropertyDescriptor,Vn=Object.getOwnPropertyDescriptors,Bn=Object.getOwnPropertySymbols,_n=Object.prototype.hasOwnProperty,Un=Object.prototype.propertyIsEnumerable,Hn=(e,t,i)=>t in e?Nn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Wn=(e,t)=>{for(var i in t||(t={}))_n.call(t,i)&&Hn(e,i,t[i]);if(Bn)for(var i of Bn(t))Un.call(t,i)&&Hn(e,i,t[i]);return e},Kn=(e,t)=>kn(e,Vn(t)),zn=(e,t,i,s)=>{for(var r,a=s>1?void 0:s?Gn(t,i):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s?r(t,i,a):r(a))||a);return s&&a&&Nn(t,i,a),a},$n={getTemplate(e){const t=(new Date).toJSON();return{name:"cp:coreProperties",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance"}}]},children:[{name:"dc:creator",textNode:e},{name:"dc:title",textNode:"Workbook"},{name:"dcterms:created",properties:{rawMap:{"xsi:type":"dcterms:W3CDTF"}},textNode:t},{name:"dcterms:modified",properties:{rawMap:{"xsi:type":"dcterms:W3CDTF"}},textNode:t}]}}},jn={getTemplate(e){const{name:t,ContentType:i,Extension:s,PartName:r}=e;return{name:t,properties:{rawMap:{Extension:s,PartName:r,ContentType:i}}}}},Yn={getTemplate(e){const t=new Array(e).fill(void 0).map(((e,t)=>({name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",PartName:`/xl/worksheets/sheet${t+1}.xml`}))),i=Fd.worksheetImages.size,s=Fd.worksheetDataTables.size,r={};Fd.workbookImageIds.forEach((e=>{r[e.type]=!0}));const a=new Array(i).fill(void 0).map(((e,t)=>({name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml",PartName:`/xl/drawings/drawing${t+1}.xml`}))),o=new Array(s).fill(void 0).map(((e,t)=>({name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml",PartName:`/xl/tables/${Fd.getTableNameFromIndex(t)}.xml`})));return{name:"Types",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"}},children:[...Object.keys(r).map((e=>({name:"Default",ContentType:`image/${e}`,Extension:e}))),{name:"Default",Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"},{name:"Default",ContentType:"application/xml",Extension:"xml"},{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",PartName:"/xl/workbook.xml"},...t,{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml",PartName:"/xl/theme/theme1.xml"},{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",PartName:"/xl/styles.xml"},{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",PartName:"/xl/sharedStrings.xml"},...a,...o,{name:"Override",ContentType:"application/vnd.openxmlformats-package.core-properties+xml",PartName:"/docProps/core.xml"}].map((e=>jn.getTemplate(e)))}}},qn={0:1,"0.00":2,"#,##0":3,"#,##0.00":4,"0%":9,"0.00%":10,"0.00E+00":11,"# ?/?":12,"# ??/??":13,"mm-dd-yy":14,"d-mmm-yy":15,"d-mmm":16,"mmm-yy":17,"h:mm AM/PM":18,"h:mm:ss AM/PM":19,"h:mm":20,"h:mm:ss":21,"m/d/yy h:mm":22,"#,##0 ;(#,##0)":37,"#,##0 ;[Red](#,##0)":38,"#,##0.00;(#,##0.00)":39,"#,##0.00;[Red](#,##0.00)":40,"mm:ss":45,"[h]:mm:ss":46,"mmss.0":47,"##0.0E+0":48,"@":49},Xn=e=>Math.round(96*e/72),Zn=e=>Math.ceil(9525*e),Jn=(e,t)=>{if(!t)return;let i;return i="number"==typeof t?t:t({rowIndex:e}),(e=>Math.round(72*e/96))(i)},Qn=e=>`${s.cp.createHeader({encoding:"UTF-8",standalone:"yes"})}${s.cp.createXml(e)}`,el=e=>{const t=String.fromCharCode,i=Math.floor(e/26),s=e%26;return i&&26!==e?s?i<26?t(65+i-1)+t(65+s-1):el(i)+t(65+s-1):el(i-1)+"Z":t(65+e-1)},tl=(e,t)=>({name:`xdr:${e}`,children:[{name:"xdr:col",textNode:t.col.toString()},{name:"xdr:colOff",textNode:t.offsetX.toString()},{name:"xdr:row",textNode:t.row.toString()},{name:"xdr:rowOff",textNode:t.offsetY.toString()}]}),il=e=>{const t=[{name:"a:ext",properties:{rawMap:{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}},children:[{name:"a16:creationId",properties:{rawMap:{id:"{822E6D20-D7BC-2841-A643-D49A6EF008A2}","xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main"}}}]}];switch(e.recolor&&e.recolor.toLowerCase()){case"grayscale":case"sepia":case"washout":t.push({name:"a:ext",properties:{rawMap:{uri:"{C183D7F6-B498-43B3-948B-1728B52AA6E4}"}},children:[{name:"adec:decorative",properties:{rawMap:{val:"0","xmlns:adec":"http://schemas.microsoft.com/office/drawing/2017/decorative"}}}]})}return{name:"a:extLst",children:t}},sl=(e,t)=>({name:"xdr:nvPicPr",children:[{name:"xdr:cNvPr",properties:{rawMap:{id:t,name:e.id,descr:null!=e.altText?e.altText:void 0}},children:[il(e)]},{name:"xdr:cNvPicPr",properties:{rawMap:{preferRelativeResize:"0"}},children:[{name:"a:picLocks"}]}]}),rl=e=>{if(!e.saturation&&!e.tint)return;const t=[];return e.saturation&&t.push({name:"a:satMod",properties:{rawMap:{val:1e3*e.saturation}}}),e.tint&&t.push({name:"a:tint",properties:{rawMap:{val:1e3*e.tint}}}),t},al=(e,t)=>{let i;if(e.transparency){const t=Math.min(Math.max(e.transparency,0),100);i=[{name:"a:alphaModFix",properties:{rawMap:{amt:1e5-Math.round(1e3*t)}}}]}if(e.recolor)switch(i||(i=[]),e.recolor.toLocaleLowerCase()){case"grayscale":i.push({name:"a:grayscl"});break;case"sepia":i.push(((e,t)=>({name:"a:duotone",children:[{name:"a:prstClr",properties:{rawMap:{val:e.color}},children:rl(e)},{name:"a:srgbClr",properties:{rawMap:{val:t.color}},children:rl(t)}]}))({color:"black"},{color:"D9C3A5",tint:50,saturation:180}));break;case"washout":i.push({name:"a:lum",properties:{rawMap:{bright:"70000",contrast:"-70000"}}})}return{name:"xdr:blipFill",children:[{name:"a:blip",properties:{rawMap:{cstate:"print","r:embed":`rId${t}`,"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}},children:i},{name:"a:stretch",children:[{name:"a:fillRect"}]}]}},ol=(e,t)=>{const i={name:"a:xfrm",children:[{name:"a:off",properties:{rawMap:{x:0,y:0}}},{name:"a:ext",properties:{rawMap:{cx:t.width,cy:t.height}}}]};if(e.rotation){const t=e.rotation;i.properties={rawMap:{rot:6e4*Math.min(Math.max(t,0),360)}}}return{name:"xdr:spPr",children:[i,{name:"a:prstGeom",properties:{rawMap:{prst:"rect"}},children:[{name:"a:avLst"}]}]}},nl=(e,t,i,s)=>({name:"xdr:pic",children:[sl(e,t+1),al(e,i+1),ol(e,s)]}),ll={getTemplate(e){const{sheetIndex:t}=e,i=Fd.worksheetImages.get(t),s=Fd.worksheetImageIds.get(t),r=i.map(((e,t)=>{const i=(e=>{e.fitCell=!!e.fitCell||!e.width||!e.height;const{position:t={},fitCell:i,width:s=0,height:r=0,totalHeight:a,totalWidth:o}=e,{offsetX:n=0,offsetY:l=0,row:d=1,rowSpan:h=1,column:c=1,colSpan:u=1}=t;return{from:{row:d-1,col:c-1,offsetX:Zn(n),offsetY:Zn(l)},to:{row:d-1+(i?1:h-1),col:c-1+(i?1:u-1),offsetX:Zn(s+n),offsetY:Zn(r+l)},height:Zn(a||r),width:Zn(o||s)}})(e);return{name:"xdr:twoCellAnchor",properties:{rawMap:{editAs:"absolute"}},children:[tl("from",i.from),tl("to",i.to),nl(e,t,s.get(e.id).index,i),{name:"xdr:clientData"}]}}));return{name:"xdr:wsDr",properties:{rawMap:{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main","xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing"}},children:r}}},dl={getTemplate(e,t){const{name:i,columns:s,rowCount:r,displayName:a,headerRowIndex:o,showRowStripes:n,showColumnStripes:l,showFilterButtons:d,highlightFirstColumn:h,highlightLastColumn:c}=e||{};if(!e||!i||!Array.isArray(s)||!s.length||!r)return{name:"table"};const u=s.map(((e,t)=>({name:"filterColumn",properties:{rawMap:{colId:t.toString(),hiddenButton:d[t]?0:1}}}))),p=o+1,g=(t+1).toString(),m=`${`A${p}`}:${`${String.fromCharCode(64+s.length)}${p+r}`}`;return{name:"table",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3",name:i,displayName:t?`${a}_${t+1}`:a,ref:m,totalsRowShown:0,id:g}},children:[{name:"autoFilter",properties:{rawMap:{ref:m}},children:u},{name:"tableColumns",properties:{rawMap:{count:s.length}},children:s.map(((e,t)=>({name:"tableColumn",properties:{rawMap:{id:(t+1).toString(),name:e,dataCellStyle:"Normal"}}})))},{name:"tableStyleInfo",properties:{rawMap:{name:"TableStyleLight1",showFirstColumn:h?1:0,showLastColumn:c?1:0,showRowStripes:n?1:0,showColumnStripes:l?1:0}}}]}}},hl=e=>{const[t,i,s,r]=e;return{name:`a:${t}`,children:[{name:`a:${i}`,properties:{rawMap:{val:s,lastClr:r}}}]}},cl={getTemplate:()=>({name:"a:clrScheme",properties:{rawMap:{name:"Office"}},children:[hl(["dk1","sysClr","windowText","000000"]),hl(["lt1","sysClr","window","FFFFFF"]),hl(["dk2","srgbClr","44546A"]),hl(["lt2","srgbClr","E7E6E6"]),hl(["accent1","srgbClr","4472C4"]),hl(["accent2","srgbClr","ED7D31"]),hl(["accent3","srgbClr","A5A5A5"]),hl(["accent4","srgbClr","FFC000"]),hl(["accent5","srgbClr","5B9BD5"]),hl(["accent6","srgbClr","70AD47"]),hl(["hlink","srgbClr","0563C1"]),hl(["folHlink","srgbClr","954F72"])]})},ul=e=>{const[t,i,s,r]=e;return{name:`a:${t}`,properties:{rawMap:{script:s,typeface:i,panose:r}}}},pl={getTemplate:()=>({name:"a:fontScheme",properties:{rawMap:{name:"Office"}},children:[{name:"a:majorFont",children:[ul(["latin","Calibri Light",void 0,"020F0302020204030204"]),ul(["ea",""]),ul(["cs",""]),ul(["font","\u6e38\u30b4\u30b7\u30c3\u30af Light","Jpan"]),ul(["font","\ub9d1\uc740 \uace0\ub515","Hang"]),ul(["font","\u7b49\u7ebf Light","Hans"]),ul(["font","\u65b0\u7d30\u660e\u9ad4","Hant"]),ul(["font","Times New Roman","Arab"]),ul(["font","Times New Roman","Hebr"]),ul(["font","Tahoma","Thai"]),ul(["font","Nyala","Ethi"]),ul(["font","Vrinda","Beng"]),ul(["font","Shruti","Gujr"]),ul(["font","MoolBoran","Khmr"]),ul(["font","Tunga","Knda"]),ul(["font","Raavi","Guru"]),ul(["font","Euphemia","Cans"]),ul(["font","Plantagenet Cherokee","Cher"]),ul(["font","Microsoft Yi Baiti","Yiii"]),ul(["font","Microsoft Himalaya","Tibt"]),ul(["font","MV Boli","Thaa"]),ul(["font","Mangal","Deva"]),ul(["font","Gautami","Telu"]),ul(["font","Latha","Taml"]),ul(["font","Estrangelo Edessa","Syrc"]),ul(["font","Kalinga","Orya"]),ul(["font","Kartika","Mlym"]),ul(["font","DokChampa","Laoo"]),ul(["font","Iskoola Pota","Sinh"]),ul(["font","Mongolian Baiti","Mong"]),ul(["font","Times New Roman","Viet"]),ul(["font","Microsoft Uighur","Uigh"]),ul(["font","Sylfaen","Geor"]),ul(["font","Arial","Armn"]),ul(["font","Leelawadee UI","Bugi"]),ul(["font","Microsoft JhengHei","Bopo"]),ul(["font","Javanese Text","Java"]),ul(["font","Segoe UI","Lisu"]),ul(["font","Myanmar Text","Mymr"]),ul(["font","Ebrima","Nkoo"]),ul(["font","Nirmala UI","Olck"]),ul(["font","Ebrima","Osma"]),ul(["font","Phagspa","Phag"]),ul(["font","Estrangelo Edessa","Syrn"]),ul(["font","Estrangelo Edessa","Syrj"]),ul(["font","Estrangelo Edessa","Syre"]),ul(["font","Nirmala UI","Sora"]),ul(["font","Microsoft Tai Le","Tale"]),ul(["font","Microsoft New Tai Lue","Talu"]),ul(["font","Ebrima","Tfng"])]},{name:"a:minorFont",children:[ul(["latin","Calibri",void 0,"020F0502020204030204"]),ul(["ea",""]),ul(["cs",""]),ul(["font","\u6e38\u30b4\u30b7\u30c3\u30af","Jpan"]),ul(["font","\ub9d1\uc740 \uace0\ub515","Hang"]),ul(["font","\u7b49\u7ebf","Hans"]),ul(["font","\u65b0\u7d30\u660e\u9ad4","Hant"]),ul(["font","Arial","Arab"]),ul(["font","Arial","Hebr"]),ul(["font","Tahoma","Thai"]),ul(["font","Nyala","Ethi"]),ul(["font","Vrinda","Beng"]),ul(["font","Shruti","Gujr"]),ul(["font","DaunPenh","Khmr"]),ul(["font","Tunga","Knda"]),ul(["font","Raavi","Guru"]),ul(["font","Euphemia","Cans"]),ul(["font","Plantagenet Cherokee","Cher"]),ul(["font","Microsoft Yi Baiti","Yiii"]),ul(["font","Microsoft Himalaya","Tibt"]),ul(["font","MV Boli","Thaa"]),ul(["font","Mangal","Deva"]),ul(["font","Gautami","Telu"]),ul(["font","Latha","Taml"]),ul(["font","Estrangelo Edessa","Syrc"]),ul(["font","Kalinga","Orya"]),ul(["font","Kartika","Mlym"]),ul(["font","DokChampa","Laoo"]),ul(["font","Iskoola Pota","Sinh"]),ul(["font","Mongolian Baiti","Mong"]),ul(["font","Arial","Viet"]),ul(["font","Microsoft Uighur","Uigh"]),ul(["font","Sylfaen","Geor"]),ul(["font","Arial","Armn"]),ul(["font","Leelawadee UI","Bugi"]),ul(["font","Microsoft JhengHei","Bopo"]),ul(["font","Javanese Text","Java"]),ul(["font","Segoe UI","Lisu"]),ul(["font","Myanmar Text","Mymr"]),ul(["font","Ebrima","Nkoo"]),ul(["font","Nirmala UI","Olck"]),ul(["font","Ebrima","Osma"]),ul(["font","Phagspa","Phag"]),ul(["font","Estrangelo Edessa","Syrn"]),ul(["font","Estrangelo Edessa","Syrj"]),ul(["font","Estrangelo Edessa","Syre"]),ul(["font","Nirmala UI","Sora"]),ul(["font","Microsoft Tai Le","Tale"]),ul(["font","Microsoft New Tai Lue","Talu"]),ul(["font","Ebrima","Tfng"])]}]})},gl=(e,t,i)=>({name:`a:${e}`,properties:{rawMap:{val:t}},children:i}),ml=e=>{const[t,i,s,r,a,o]=e,n=[];return n.push(gl("satMod",s)),r&&n.push(gl("lumMod",r)),a&&n.push(gl("tint",a)),o&&n.push(gl("shade",o)),{name:"a:gs",properties:{rawMap:{pos:t}},children:[{name:"a:schemeClr",properties:{rawMap:{val:i}},children:n}]}},vl=(e,t)=>({name:"a:solidFill",children:[gl("schemeClr",e,t)]}),Cl=e=>{const[t,i,s,r,a]=e,[o,n]=a;return{name:"a:gradFill",properties:{rawMap:{rotWithShape:t}},children:[{name:"a:gsLst",children:[ml(i),ml(s),ml(r)]},{name:"a:lin",properties:{rawMap:{ang:o,scaled:n}}}]}},fl=e=>{const[t,i,s,r]=e;return{name:"a:ln",properties:{rawMap:{w:t,cap:i,cmpd:s,algn:r}},children:[vl("phClr"),gl("prstDash","solid"),{name:"a:miter",properties:{rawMap:{lim:"800000"}}}]}},yl=e=>{const t=[];if(e){const[i,s,r,a,o]=e;t.push({name:"a:outerShdw",properties:{rawMap:{blurRad:i,dist:s,dir:r,algn:a,rotWithShape:o}},children:[gl("srgbClr","000000",[gl("alpha","63000")])]})}return{name:"a:effectStyle",children:[Object.assign({},{name:"a:effectLst"},t.length?{children:t}:{})]}},Sl={getTemplate:()=>({name:"a:fmtScheme",properties:{rawMap:{name:"Office"}},children:[{name:"a:fillStyleLst",children:[vl("phClr"),Cl(["1",["0","phClr","105000","110000","67000"],["50000","phClr","103000","105000","73000"],["100000","phClr","109000","105000","81000"],["5400000","0"]]),Cl(["1",["0","phClr","103000","102000","94000"],["50000","phClr","110000","100000",void 0,"100000"],["100000","phClr","120000","99000",void 0,"78000"],["5400000","0"]])]},{name:"a:lnStyleLst",children:[fl(["6350","flat","sng","ctr"]),fl(["12700","flat","sng","ctr"]),fl(["19050","flat","sng","ctr"])]},{name:"a:effectStyleLst",children:[yl(),yl(),yl(["57150","19050","5400000","ctr","0"])]},{name:"a:bgFillStyleLst",children:[vl("phClr"),vl("phClr",[gl("tint","95000"),gl("satMod","170000")]),Cl(["1",["0","phClr","150000","102000","93000","98000"],["50000","phClr","130000","103000","98000","90000"],["100000","phClr","120000",void 0,void 0,"63000"],["5400000","0"]])]}]})},El={getTemplate:()=>({name:"a:themeElements",children:[cl.getTemplate(),pl.getTemplate(),Sl.getTemplate()]})},bl={getTemplate:()=>({name:"a:theme",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{a:"http://schemas.openxmlformats.org/drawingml/2006/main"}}],rawMap:{name:"Office Theme"}},children:[El.getTemplate(),{name:"a:objectDefaults"},{name:"a:extraClrSchemeLst"}]})},wl=e=>{const t=[];for(const i of e.keys()){const e=i.toString(),r={name:"t",textNode:s.ch.escapeString(e)};e.trim().length!==e.length&&(r.properties={rawMap:{"xml:space":"preserve"}}),t.push({name:"si",children:[r]})}return t},Al={getTemplate:e=>({name:"sst",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:e.size,uniqueCount:e.size}},children:wl(e)})};var xl,Tl,Ml,Pl,Fl,Dl,Rl,Ll,Il,Ol={getTemplate(e){let{formatCode:t,numFmtId:i}=e;return t.length&&(t=function(e){const t=e.split(/(\[[^\]]*\])/);for(let i=0;i<t.length;i++){let e=t[i];e.length&&(e.startsWith("[")||(e=e.replace(/\$/g,'"$"')),t[i]=s.ch.escapeString(e))}return t.join("")}(t)),{name:"numFmt",properties:{rawMap:{formatCode:t,numFmtId:i}}}}},Nl={getTemplate:e=>({name:"numFmts",properties:{rawMap:{count:e.length}},children:e.map((e=>Ol.getTemplate(e)))})},kl={getTemplate(e){const{size:t,colorTheme:i,color:s="FF000000",fontName:r="Calibri",family:a,scheme:o,italic:n,bold:l,strikeThrough:d,outline:h,shadow:c,underline:u,verticalAlign:p}=e,g=[{name:"sz",properties:{rawMap:{val:t}}},{name:"color",properties:{rawMap:{theme:i,rgb:s}}},{name:"name",properties:{rawMap:{val:r}}}];return a&&g.push({name:"family",properties:{rawMap:{val:a}}}),o&&g.push({name:"scheme",properties:{rawMap:{val:o}}}),n&&g.push({name:"i"}),l&&g.push({name:"b"}),d&&g.push({name:"strike"}),h&&g.push({name:"outline"}),c&&g.push({name:"shadow"}),u&&g.push({name:"u",properties:{rawMap:{val:u}}}),p&&g.push({name:"vertAlign",properties:{rawMap:{val:p}}}),{name:"font",children:g}}},Gl={getTemplate:e=>({name:"fonts",properties:{rawMap:{count:e.length}},children:e.map((e=>kl.getTemplate(e)))})},Vl={getTemplate(e){const{patternType:t,fgTheme:i,fgTint:s,fgRgb:r,bgRgb:a,bgIndexed:o}=e,n={name:"patternFill",properties:{rawMap:{patternType:t}}};return(i||s||r)&&(n.children=[{name:"fgColor",properties:{rawMap:{theme:i,tint:s,rgb:r}}}]),(o||a)&&(n.children||(n.children=[]),n.children.push({name:"bgColor",properties:{rawMap:{indexed:o,rgb:a}}})),{name:"fill",children:[n]}}},Bl={getTemplate:e=>({name:"fills",properties:{rawMap:{count:e.length}},children:e.map((e=>Vl.getTemplate(e)))})},_l={None:"None",Dot:"Dotted",Dash:"Dashed",Double:"Double",DashDot:"DashDot",DashDotDot:"DashDotDot",SlantDashDot:"SlantDashDot"},Ul=["Dashed","DashDot","DashDotDot"],Hl={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinDiagStripe:"lightUp",ThinHorzCross:"lightGrid",ThinDiagCross:"lightTrellis",Gray125:"gray125",Gray0625:"gray0625"},Wl={Automatic:"general",Left:"left",Center:"center",Right:"right",Fill:"fill",Justify:"justify",CenterAcrossSelection:"centerContinuous",Distributed:"distributed",JustifyDistributed:"justify"},Kl={Automatic:void 0,Top:"top",Bottom:"bottom",Center:"center",Justify:"justify",Distributed:"distributed",JustifyDistributed:"justify"},zl=e=>null==e?e:("#"===e.charAt(0)&&(e=e.substring(1)),6===e.length?"FF"+e:e),$l=(e,t)=>{if(!e)return"thin";const i=(e=>{switch(e){case 1:return"thin";case 2:return"medium";case 3:return"thick";default:return"hair"}})(t),s=_l[e];return"Continuous"===e?i:"medium"===i&&-1!==Ul.indexOf(s)?`medium${s}`:s.charAt(0).toLowerCase()+s.substring(1)},jl=e=>Wl[e]||"general",Yl=e=>Kl[e]||void 0,ql=e=>({name:"color",properties:{rawMap:{rgb:zl(e||"#000000")}}}),Xl={getTemplate(e){const{left:t,right:i,top:s,bottom:r,diagonal:a}=e,o=t?[ql(t.color)]:void 0,n=i?[ql(i.color)]:void 0,l=s?[ql(s.color)]:void 0,d=r?[ql(r.color)]:void 0,h=a?[ql(a.color)]:void 0;return{name:"border",children:[{name:"left",properties:{rawMap:{style:t&&t.style}},children:o},{name:"right",properties:{rawMap:{style:i&&i.style}},children:n},{name:"top",properties:{rawMap:{style:s&&s.style}},children:l},{name:"bottom",properties:{rawMap:{style:r&&r.style}},children:d},{name:"diagonal",properties:{rawMap:{style:a&&a.style}},children:h}]}}},Zl={getTemplate:e=>({name:"borders",properties:{rawMap:{count:e.length}},children:e.map((e=>Xl.getTemplate(e)))})},Jl=e=>{const t=["Context","LeftToRight","RightToLeft"].indexOf(e);return Math.max(t,0)},Ql={getTemplate(e){const{horizontal:t,indent:i,readingOrder:s,rotate:r,shrinkToFit:a,vertical:o,wrapText:n}=e;return{name:"alignment",properties:{rawMap:{horizontal:t&&jl(t),indent:i,readingOrder:s&&Jl(s),textRotation:r,shrinkToFit:a,vertical:o&&Yl(o),wrapText:n}}}}},ed={getTemplate(e){const t=!1===e.protected?0:1;return{name:"protection",properties:{rawMap:{hidden:!0===e.hideFormula?1:0,locked:t}}}}},td={getTemplate(e){const{alignment:t,borderId:i,fillId:s,fontId:r,numFmtId:a,protection:o,quotePrefix:n,xfId:l}=e,d=[];return t&&d.push(Ql.getTemplate(t)),o&&d.push(ed.getTemplate(o)),{name:"xf",properties:{rawMap:{applyAlignment:t?1:void 0,applyProtection:o?1:void 0,applyBorder:i?1:void 0,applyFill:s?1:void 0,borderId:i,fillId:s,applyFont:r?1:void 0,fontId:r,applyNumberFormat:a?1:void 0,numFmtId:a,quotePrefix:n?1:void 0,xfId:l}},children:d.length?d:void 0}}},id={getTemplate:e=>({name:"cellStyleXfs",properties:{rawMap:{count:e.length}},children:e.map((e=>td.getTemplate(e)))})},sd={getTemplate:e=>({name:"cellXfs",properties:{rawMap:{count:e.length}},children:e.map((e=>td.getTemplate(e)))})},rd={getTemplate(e){const{builtinId:t,name:i,xfId:s}=e;return{name:"cellStyle",properties:{rawMap:{builtinId:t,name:i,xfId:s}}}}},ad={getTemplate:e=>({name:"cellStyles",properties:{rawMap:{count:e.length}},children:e.map((e=>rd.getTemplate(e)))})},od=(e,t)=>(-1!==e.indexOf("mixedStyle")&&t>1&&(e+=`_${t}`),e),nd=()=>{xl={base:0},Tl=[],Ml=[{fontName:"Calibri",colorTheme:"1",family:"2",scheme:"minor"}],Pl=[{patternType:"none"},{patternType:"gray125"}],Fl=[{left:void 0,right:void 0,top:void 0,bottom:void 0,diagonal:void 0}],Dl=[{borderId:0,fillId:0,fontId:0,numFmtId:0}],Rl=[{borderId:0,fillId:0,fontId:0,numFmtId:0,xfId:0}],Ll=[{builtinId:0,name:"Normal",xfId:0}]},ld=e=>{const t=(e=>e?Hl[e]||e:"none")(e.pattern),i=zl(e.color),s=zl(e.patternColor);let r=Pl.findIndex((e=>{const{patternType:r,fgRgb:a,bgRgb:o}=e;return!(r!=t||a!=i||o!=s)}));return-1===r&&(r=Pl.length,Pl.push({patternType:t,fgRgb:i,bgRgb:s})),r},dd=e=>{const{fontName:t="Calibri",color:i,size:s,bold:r,italic:a,outline:o,shadow:n,strikeThrough:l,underline:d,family:h,verticalAlign:c}=e,u=zl(i),p=(e=>{if(void 0===e)return;const t=["Automatic","Roman","Swiss","Modern","Script","Decorative"].indexOf(e||"Automatic");return Math.max(t,0)})(h),g=d?d.toLocaleLowerCase():void 0,m=c?c.toLocaleLowerCase():void 0;let v=Ml.findIndex((e=>!(e.fontName!=t||e.color!=u||e.size!=s||e.bold!=r||e.italic!=a||e.outline!=o||e.shadow!=n||e.strikeThrough!=l||e.underline!=g||e.verticalAlign!=m||e.family!=p)));return-1===v&&(v=Ml.length,Ml.push({fontName:t,color:u,size:s,bold:r,italic:a,outline:o,shadow:n,strikeThrough:l,underline:g,verticalAlign:m,family:null!=p?p.toString():void 0})),v},hd=e=>{const{alignment:t,borders:i,font:s,interior:r,numberFormat:a,protection:o,quotePrefix:n}=e;let{id:l}=e,d=0,h=0,c=0,u=0;l&&(l=od(l,Il),null==xl[l]&&(r&&(d=ld(r)),i&&(h=(e=>{const{borderBottom:t,borderTop:i,borderLeft:s,borderRight:r}=e;let a,o,n,l,d,h,c,u;s&&(n=$l(s.lineStyle,s.weight),c=zl(s.color)),r&&(l=$l(r.lineStyle,r.weight),u=zl(r.color)),t&&(a=$l(t.lineStyle,t.weight),d=zl(t.color)),i&&(o=$l(i.lineStyle,i.weight),h=zl(i.color));let p=Fl.findIndex((e=>{const{left:t,right:i,top:s,bottom:r}=e;if(!t&&(n||c)||!i&&(l||u)||!s&&(o||h)||!r&&(a||d))return!1;const{style:p,color:g}=t||{},{style:m,color:v}=i||{},{style:C,color:f}=s||{},{style:y,color:S}=r||{};return!(p!=n||g!=c||m!=l||v!=u||C!=o||f!=h||y!=a||S!=d)}));return-1===p&&(p=Fl.length,Fl.push({left:{style:n,color:c},right:{style:l,color:u},top:{style:o,color:h},bottom:{style:a,color:d},diagonal:{style:void 0,color:void 0}})),p})(i)),s&&(c=dd(s)),a&&(u=(e=>{if(qn[e])return qn[e];let t=Tl.findIndex((t=>t.formatCode===e));return-1===t?(t=Tl.length+164,Tl.push({formatCode:e,numFmtId:t})):t=Tl[t].numFmtId,t})(a.format)),xl[l]=Rl.length,Rl.push({alignment:t,borderId:h||0,fillId:d||0,fontId:c||0,numFmtId:u||0,protection:o,quotePrefix:n,xfId:0})))},cd=(e,t)=>xl[od(e,t)]||0,ud={getTemplate(e){const t=Nl.getTemplate(Tl),i=Gl.getTemplate(Ml.map((t=>Kn(Wn({},t),{size:null!=t.size?t.size:e})))),s=Bl.getTemplate(Pl),r=Zl.getTemplate(Fl),a=id.getTemplate(Dl),o=sd.getTemplate(Rl),n=ad.getTemplate(Ll);return nd(),{name:"styleSheet",properties:{rawMap:{"mc:Ignorable":"x14ac x16r2 xr",xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision"}},children:[t,i,s,r,a,o,n,{name:"tableStyles",properties:{rawMap:{count:0,defaultPivotStyle:"PivotStyleLight16",defaultTableStyle:"TableStyleMedium2"}}}]}}},pd={getTemplate(e,t){const i=(t+1).toString();return{name:"sheet",properties:{rawMap:{name:e,sheetId:i,"r:id":`rId${i}`}}}}},gd={getTemplate:e=>({name:"sheets",children:e.map(((e,t)=>pd.getTemplate(e,t)))})},md={getTemplate:e=>({name:"workbook",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}}],rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},children:[gd.getTemplate(e)]})},vd={getTemplate(e){const{min:t,max:i,outlineLevel:s,s:r,width:a,hidden:o,bestFit:n}=e;let l=1,d="0";return a>1&&(l=(e=>Math.ceil((e-12)/7+1))(a),d="1"),{name:"col",properties:{rawMap:{min:t,max:i,outlineLevel:s??void 0,width:l,style:r,hidden:o?"1":"0",bestFit:n?"1":"0",customWidth:d}}}}},Cd={getTemplate(e,t,i){const{ref:r,data:a,styleId:o}=e,{type:n,value:l}=a||{type:"empty",value:null};let d=n;"f"===n?d="str":n.charAt(0)===n.charAt(0).toUpperCase()&&(d=(e=>{const t=e.charAt(0).toLowerCase();return"s"===t?"inlineStr":t})(n));const h={name:"c",properties:{rawMap:{r:r,t:"empty"===d?void 0:d,s:o?cd(o,i):void 0}}};if("empty"===d)return h;let c;return c="str"===d&&"f"===n?[{name:"f",textNode:s.ch.escapeString(l)}]:"inlineStr"===d?[{name:"is",children:[{name:"t",textNode:s.ch.escapeString(l)}]}]:[{name:"v",textNode:l}],Object.assign({},h,{children:c})}},fd=e=>{var t;return""!==(null==(t=e.data)?void 0:t.value)||void 0!==e.styleId},yd={getTemplate(e,t,i){const{collapsed:s,hidden:r,height:a,outlineLevel:o,cells:n=[]}=e;((e,t)=>{const i=[];let s=0;for(let r=0;r<e.length;r++){const t=e[r];t.mergeAcross&&(i.push({pos:r,excelPos:s}),s+=t.mergeAcross),s++}if(i.length)for(let r=i.length-1;r>=0;r--){const s=[],a=e[i[r].pos];for(let e=1;e<=a.mergeAcross;e++)s.push({ref:`${el(i[r].excelPos+1+e)}${t+1}`,styleId:a.styleId,data:{type:"empty",value:null}});s.length&&e.splice(i[r].pos+1,0,...s)}})(n,t);return{name:"row",properties:{rawMap:{r:t+1,collapsed:s?"1":"0",hidden:r?"1":"0",ht:a,customHeight:null!=a?"1":"0",spans:"1:1",outlineLevel:o||void 0}},children:n.filter(fd).map(((e,t)=>Cd.getTemplate(e,t,i)))}}},Sd={getTemplate:e=>({name:"mergeCell",properties:{rawMap:{ref:e}}})},Ed=e=>!e||"Portrait"!==e&&"Landscape"!==e?"portrait":e.toLocaleLowerCase(),bd=e=>{if(null==e)return 1;const t=["Letter","Letter Small","Tabloid","Ledger","Legal","Statement","Executive","A3","A4","A4 Small","A5","A6","B4","B5","Folio","Envelope","Envelope DL","Envelope C5","Envelope B5","Envelope C3","Envelope C4","Envelope C6","Envelope Monarch","Japanese Postcard","Japanese Double Postcard"].indexOf(e);return-1===t?1:t+1},wd=e=>e.reduce(((e,t)=>{const i=(e=>"Center"===e?"C":"Right"===e?"R":"L")(t.position);return`${((e,t)=>(t&&(e+="&amp;&quot;",e+=t.fontName||"Calibri",t.bold!==t.italic?e+=t.bold?",Bold":",Italic":t.bold?e+=",Bold Italic":e+=",Regular",e+="&quot;",t.size&&(e+=`&amp;${t.size}`),t.strikeThrough&&(e+="&amp;S"),t.underline&&(e+="&amp;"+("Double"===t.underline?"E":"U")),t.color&&(e+=`&amp;K${t.color.replace("#","").toUpperCase()}`)),e))(`${e}&amp;${i}`,t.font)}${s.ch.escapeString((e=>(s.ch.iterateObject({"&[Page]":"&P","&[Pages]":"&N","&[Date]":"&D","&[Time]":"&T","&[Tab]":"&A","&[Path]":"&Z","&[File]":"&F"},((t,i)=>{e=e.replace(t,i)})),e))(t.value))}`}),""),Ad=e=>{const t=[];return["all","first","even"].forEach((i=>{const r=e[i],a="all"===i?"odd":i;!r||!r.header&&!r.footer||s.ch.iterateObject(r,((e,i)=>{const s=`${e.charAt(0).toUpperCase()}${e.slice(1)}`;i&&t.push({name:`${a}${s}`,properties:{rawMap:{"xml:space":"preserve"}},textNode:wd(i)})}))})),t},xd={getTemplate(e){const{worksheet:t,currentSheet:i,config:r}=e,{margins:a={},pageSetup:o,headerFooterConfig:n,suppressColumnOutline:l}=r,{table:d}=t,{rows:h,columns:c}=d,u=c&&c.length?((e,t,i)=>{const s=[],r=[];e.forEach(((e,i)=>{const a=e.cells;let o,n=0;a.forEach(((e,a)=>{const l=a+n+1,d=el(l),h=i+1;if(e.mergeAcross){n+=e.mergeAcross;const t=el(a+n+1);s.push(`${d}${h}:${t}${h}`)}t[l-1]||(t[l-1]={});const{collapsibleRanges:c}=e;c&&c.forEach((e=>{r.push([l+e[0],l+e[1]])})),o=t[l-1],o.min=l,o.max=l,e.ref=`${d}${h}`}))})),r.sort(((e,t)=>e[0]!==t[0]?e[0]-t[0]:t[1]-e[1]));const a=new Map,o=new Map;return r.filter((e=>{const t=e.toString();return!a.get(t)&&(a.set(t,!0),!0)})).forEach((e=>{const s=t.find((t=>t.min==e[0]&&t.max==e[1])),r=o.get(e[0]);t.push({min:e[0],max:e[1],outlineLevel:i?void 0:r||1,width:(s||{width:100}).width}),o.set(e[0],(r||0)+1)})),s})(h,c,!!l):[],p=Fd.worksheetDataTables.get(i),g=s.ch.compose((e=>(e.push({name:"sheetPr",children:[{name:"outlinePr",properties:{rawMap:{summaryBelow:0}}}]}),e)),(e=>t=>{const i=e.reduce(((e,t)=>t.outlineLevel&&t.outlineLevel>e?t.outlineLevel:e),0);return t.push({name:"sheetFormatPr",properties:{rawMap:{baseColWidth:10,defaultRowHeight:16,outlineLevelRow:i||void 0}}}),t})(h),(e=>t=>(e.length&&t.push({name:"cols",children:e.map((e=>vd.getTemplate(e)))}),t))(c),((e,t)=>i=>(e.length&&i.push({name:"sheetData",children:e.map(((e,i)=>yd.getTemplate(e,i,t)))}),i))(h,i+1),(e=>t=>(e.length&&t.push({name:"mergeCells",properties:{rawMap:{count:e.length}},children:e.map((e=>Sd.getTemplate(e)))}),t))(u),(e=>t=>{const{top:i=.75,right:s=.7,bottom:r=.75,left:a=.7,header:o=.3,footer:n=.3}=e;return t.push({name:"pageMargins",properties:{rawMap:{bottom:r,footer:n,header:o,left:a,right:s,top:i}}}),t})(a),(e=>t=>(e&&t.push({name:"pageSetup",properties:{rawMap:{horizontalDpi:0,verticalDpi:0,orientation:Ed(e.orientation),paperSize:bd(e.pageSize)}}}),t))(o),(e=>t=>{if(!e)return t;const i=null!=e.first?1:0,s=null!=e.even?1:0;return t.push({name:"headerFooter",properties:{rawMap:{differentFirst:i,differentOddEven:s}},children:Ad(e)}),t})(n),(e=>t=>(Fd.worksheetImages.get(e)&&t.push({name:"drawing",properties:{rawMap:{"r:id":"rId1"}}}),t))(i),((e,t)=>{if(!e)return e=>e;const i=Fd.getTableRelIdFromIndex(t||0);return e=>(e.push({name:"tableParts",properties:{rawMap:{count:"1"}},children:[{name:"tablePart",properties:{rawMap:{"r:id":i}}}]}),e)})(p,i))([]);return{name:"worksheet",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}}],rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},children:g}}},Td={getTemplate(e){const{Id:t,Type:i,Target:s}=e;return{name:"Relationship",properties:{rawMap:{Id:t,Type:i,Target:s}}}}},Md={getTemplate:e=>({name:"Relationships",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}},children:e.map((e=>Td.getTemplate(e)))})},Pd=class e{static createExcel(e,t,i){this.addSheetName(t),((e,t)=>{1===(Il=t)&&nd(),e.forEach(hd)})(e,this.sheetNames.length);let s=Object.assign({},i);return i.exportAsExcelTable&&(i.columnModel.isPivotActive()&&(this.showExcelTableNonCompatibleFeaturesWarning("pivot mode"),s.exportAsExcelTable=!1),i.gridOptionsService.get("masterDetail")&&(this.showExcelTableNonCompatibleFeaturesWarning("master/detail"),s.exportAsExcelTable=!1)),this.processTableConfig(t,s),this.createWorksheet(t,s)}static showExcelTableNonCompatibleFeaturesWarning(e){console.warn(`AG Grid: Excel table export does not work with ${e}. The exported Excel file will not contain any Excel tables.\nPlease turn off ${e} to enable Excel table exports.`)}static getTableNameFromIndex(e){return`table${e+1}`}static getTableRelIdFromIndex(e){return`tableRelId${e+1}`}static getSanitizedTableName(e){return e.replace(/^[^a-zA-Z_]+/,"_").replace(/\s/g,"_").replace(/[^a-zA-Z0-9_]/g,"_")}static addTableToSheet(e,t){this.worksheetDataTables.has(e)?console.warn("Unable to add data table to Excel sheet: A table already exists."):this.worksheetDataTables.set(e,t)}static buildImageMap(e,t,i,s,r){const a=this.sheetNames.length,o=this.images.get(e.id);(!e.position||!e.position.row||!e.position.column)&&(e.position||(e.position={}),e.position=Object.assign({},e.position,{row:t,column:s.indexOf(i)+1}));const n=e;if(((e,t)=>{const{colSpan:i,column:s}=e.position;if(e.width)if(i){const r=t.slice(s-1,s+i-1);let a=0;for(let t=0;t<r.length;t++){const i=r[t].getActualWidth();if(e.width<a+i){e.position.colSpan=t+1,e.totalWidth=e.width,e.width=e.totalWidth-a;break}a+=i}}else e.totalWidth=e.width})(n,s),((e,t)=>{const{rowSpan:i,row:s}=e.position;if(e.height)if(i){let r=0,a=0;for(let o=s;o<s+i;o++){const i=Xn(Jn(o,t)||20);if(e.height<r+i){e.position.rowSpan=a+1,e.totalHeight=e.height,e.height=e.totalHeight-r;break}r+=i,a++}}else e.totalHeight=e.height})(n,r),o){const e=o.find((e=>e.sheetId===a));e?e.image.push(n):o.push({sheetId:a,image:[n]})}else this.images.set(n.id,[{sheetId:a,image:[n]}]),this.workbookImageIds.set(n.id,{type:n.imageType,index:this.workbookImageIds.size});this.buildSheetImageMap(a,n)}static processTableConfig(t,i){var s;if(!i.exportAsExcelTable)return;const r="boolean"==typeof i.exportAsExcelTable?{}:i.exportAsExcelTable,{name:a,showColumnStripes:o,showRowStripes:n,showFilterButton:l,highlightFirstColumn:d,highlightLastColumn:h}=r,c=this.getSanitizedTableName(a||e.defaultTableDisplayName),u=this.sheetNames.length-1,{table:p}=t,{rows:g,columns:m}=p,v=i.columnModel.getHeaderRowCount(),C=v-1,f=g.length,y=m.length,S=[],E=[];for(let e=0;e<y;e++){const t=m[e];S.push(t.displayName||""),E.push("match"===l||void 0===l?null!=(s=t.filterAllowed)&&s:l)}S&&S.length&&f&&c?this.addTableToSheet(u,{name:this.getTableNameFromIndex(u),displayName:c,columns:S,showFilterButtons:E,headerRowIndex:C,rowCount:f-v,showRowStripes:n??!0,showColumnStripes:o??!1,highlightFirstColumn:d??!1,highlightLastColumn:h??!1}):console.warn("Unable to add data table to Excel sheet: Missing required parameters.")}static buildSheetImageMap(e,t){let i=this.worksheetImageIds.get(e);i||(i=new Map,this.worksheetImageIds.set(e,i));const s=this.worksheetImages.get(e);s?(s.push(t),i.get(t.id)||i.set(t.id,{index:i.size,type:t.imageType})):(this.worksheetImages.set(e,[t]),i.set(t.id,{index:0,type:t.imageType}))}static addSheetName(e){const t=s.ch.escapeString(e.name)||"";let i="";for(;-1!==this.sheetNames.indexOf(`${t}${i}`);)i=""===i?"_1":`_${parseInt(i.slice(1),10)+1}`;e.name=`${t}${i}`,this.sheetNames.push(e.name)}static getStringPosition(e){return this.sharedStrings.has(e)?this.sharedStrings.get(e):(this.sharedStrings.set(e,this.sharedStrings.size),this.sharedStrings.size-1)}static resetFactory(){this.sharedStrings=new Map,this.images=new Map,this.worksheetImages=new Map,this.workbookImageIds=new Map,this.worksheetImageIds=new Map,this.worksheetDataTables=new Map,this.sheetNames=[],this.factoryMode=s.E.SINGLE_SHEET}static createWorkbook(){return Qn(md.getTemplate(this.sheetNames))}static createStylesheet(e){return Qn(ud.getTemplate(e))}static createSharedStrings(){return Qn(Al.getTemplate(this.sharedStrings))}static createCore(e){return Qn($n.getTemplate(e))}static createContentTypes(e){return Qn(Yn.getTemplate(e))}static createRels(){const e=Md.getTemplate([{Id:"rId1",Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Target:"xl/workbook.xml"},{Id:"rId2",Type:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",Target:"docProps/core.xml"}]);return Qn(e)}static createTheme(){return Qn(bl.getTemplate())}static createTable(e,t){return Qn(dl.getTemplate(e,t))}static createWorkbookRels(e){const t=new Array(e).fill(void 0).map(((e,t)=>({Id:`rId${t+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",Target:`worksheets/sheet${t+1}.xml`}))),i=Md.getTemplate([...t,{Id:`rId${e+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Target:"theme/theme1.xml"},{Id:`rId${e+2}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Target:"styles.xml"},{Id:`rId${e+3}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Target:"sharedStrings.xml"}]);return Qn(i)}static createDrawing(e){return Qn(ll.getTemplate({sheetIndex:e}))}static createDrawingRel(e){const t=this.worksheetImageIds.get(e),i=[];return t.forEach(((e,t)=>{i.push({Id:`rId${e.index+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/image${this.workbookImageIds.get(t).index+1}.${e.type}`})})),Qn(Md.getTemplate(i))}static createWorksheetDrawingRel(e){const t=Md.getTemplate([{Id:"rId1",Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/drawing${e+1}.xml`}]);return Qn(t)}static createWorksheetTableRel(e){const t=this.getTableNameFromIndex(e),i=this.getTableRelIdFromIndex(e),s=Md.getTemplate([{Id:i,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",Target:`../tables/${t}.xml`}]);return Qn(s)}static createRelationships(){let{drawingIndex:e,tableIndex:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(void 0===e&&void 0===t)return"";const i=[];if("number"==typeof e&&i.push({Id:"rId1",Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/drawing${e+1}.xml`}),"number"==typeof t){const e=this.getTableNameFromIndex(t),s=this.getTableRelIdFromIndex(t);i.push({Id:s,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",Target:`../tables/${e}.xml`})}const s=Md.getTemplate(i);return Qn(s)}static createWorksheet(e,t){return Qn(xd.getTemplate({worksheet:e,currentSheet:this.sheetNames.length-1,config:t}))}};Pd.sharedStrings=new Map,Pd.sheetNames=[],Pd.images=new Map,Pd.worksheetImages=new Map,Pd.workbookImageIds=new Map,Pd.worksheetImageIds=new Map,Pd.worksheetDataTables=new Map,Pd.defaultTableDisplayName="AG-GRID-TABLE",Pd.factoryMode=s.E.SINGLE_SHEET;var Fd=Pd,Dd=class extends s.co{constructor(e){super(e),this.mixedStyles={},this.mixedStyleCounter=0,this.rows=[],this.config=Object.assign({},e),this.stylesByIds={},this.config.baseExcelStyles.forEach((e=>{this.stylesByIds[e.id]=e})),this.excelStyles=[...this.config.baseExcelStyles,{id:"_quotePrefix",quotePrefix:1}]}addCustomContent(e){e.forEach((e=>{const t=this.rows.length+1;let i;!this.config.suppressRowOutline&&null!=e.outlineLevel&&(i=e.outlineLevel);const s={height:Jn(t,e.height||this.config.rowHeight),cells:(e.cells||[]).map(((e,i)=>{var s,r,a;const o=this.addImage(t,this.columnsToExport[i],null==(s=e.data)?void 0:s.value);let n=null;e.styleId&&(n="string"==typeof e.styleId?[e.styleId]:e.styleId);const l=this.getStyleId(n);if(o)return this.createCell(l,this.getDataTypeForValue(o.value),null==o.value?"":o.value);const d=null!=(a=null==(r=e.data)?void 0:r.value)?a:"",h=this.getDataTypeForValue(d);return e.mergeAcross?this.createMergedCell(l,h,d,e.mergeAcross):this.createCell(l,h,d)})),outlineLevel:i};null!=e.collapsed&&(s.collapsed=e.collapsed),null!=e.hidden&&(s.hidden=e.hidden),this.rows.push(s)}))}onNewHeaderGroupingRow(){const e=[];return this.rows.push({cells:e,height:Jn(this.rows.length+1,this.config.headerRowHeight)}),{onColumn:(t,i,r,a,o)=>{const n=this.config.styleLinker({rowType:s.cn.HEADER_GROUPING,rowIndex:1,value:`grouping-${i}`,columnGroup:t});e.push(Kn(Wn({},this.createMergedCell(this.getStyleId(n),this.getDataTypeForValue("string"),i,a)),{collapsibleRanges:o}))}}}onNewHeaderRow(){return this.onNewRow(this.onNewHeaderColumn,this.config.headerRowHeight)}onNewBodyRow(e){const t=this.onNewRow(this.onNewBodyColumn,this.config.rowHeight);return e&&this.addRowOutlineIfNecessary(e),t}prepare(e){super.prepare(e),this.columnsToExport=[...e],this.cols=e.map(((e,t)=>this.convertColumnToExcel(e,t)))}parse(){const e=this.rows.reduce(((e,t)=>Math.max(e,t.cells.length)),0);for(;this.cols.length<e;)this.cols.push(this.convertColumnToExcel(null,this.cols.length+1));const t={name:this.config.sheetName,table:{columns:this.cols,rows:this.rows}};return this.createExcel(t)}addRowOutlineIfNecessary(e){const{gridOptionsService:t,suppressRowOutline:i,rowGroupExpandState:r="expanded"}=this.config;if(t.get("groupHideOpenParents")||i||null==e.level)return;const a=e.footer?1:0,o=s.ch.last(this.rows);if(o.outlineLevel=e.level+a,"expanded"===r)return;const n="collapsed"===r;if(e.isExpandable()){const t=!n&&e.expanded;o.collapsed=!t}o.hidden=!!e.parent&&-1!==e.parent.level&&(n||this.isAnyParentCollapsed(e.parent))}isAnyParentCollapsed(e){for(;e&&-1!==e.level;){if(!e.expanded)return!0;e=e.parent}return!1}convertColumnToExcel(e,t){const i=this.config.columnWidth,s=(e?this.extractHeaderValue(e):void 0)??"",r=!!e&&e.isFilterAllowed();return i?"number"==typeof i?{width:i,displayName:s,filterAllowed:r}:{width:i({column:e,index:t}),displayName:s,filterAllowed:r}:e?{width:Math.max(e.getActualWidth(),75),displayName:s,filterAllowed:r}:{displayName:s,filterAllowed:r}}onNewHeaderColumn(e,t){return i=>{const r=this.extractHeaderValue(i),a=this.config.styleLinker({rowType:s.cn.HEADER,rowIndex:e,value:r,column:i});t.push(this.createCell(this.getStyleId(a),this.getDataTypeForValue("string"),r))}}onNewBodyColumn(e,t){let i=0;return(r,a,o)=>{if(i>0)return void(i-=1);const{value:n,valueFormatted:l}=this.extractRowCellValue(r,a,e,"excel",o),d=this.config.styleLinker({rowType:s.cn.BODY,rowIndex:e,value:n,column:r,node:o}),h=this.getStyleId(d),c=r.getColSpan(o),u=this.addImage(e,r,n);u?t.push(this.createCell(h,this.getDataTypeForValue(u.value),null==u.value?"":u.value)):c>1?(i=c-1,t.push(this.createMergedCell(h,this.getDataTypeForValue(n),n,c-1))):t.push(this.createCell(h,this.getDataTypeForValue(n),n,l))}}onNewRow(e,t){const i=[];return this.rows.push({cells:i,height:Jn(this.rows.length+1,t)}),{onColumn:e.bind(this,this.rows.length,i)()}}createExcel(e){const{excelStyles:t,config:i}=this;return Fd.createExcel(t,e,i)}getDataTypeForValue(e){return void 0===e?"empty":this.isNumerical(e)?"n":"s"}getTypeFromStyle(e,t){if(this.isFormula(t))return"f";if(e&&e.dataType)switch(e.dataType.toLocaleLowerCase()){case"formula":return"f";case"string":return"s";case"number":return"n";case"datetime":return"d";case"error":return"e";case"boolean":return"b";default:console.warn(`AG Grid: Unrecognized data type for excel export [${e.id}.dataType=${e.dataType}]`)}return null}addImage(e,t,i){if(!this.config.addImageToCell)return;const s=this.config.addImageToCell(e,t,i);return s?(Fd.buildImageMap(s.image,e,t,this.columnsToExport,this.config.rowHeight),s):void 0}createCell(e,t,i,s){const r=this.getStyleById(e);(null==r||!r.dataType)&&"s"===t&&s&&(i=s);const a=this.getTypeFromStyle(r,i)||t,{value:o,escaped:n}=this.getCellValue(a,i),l=[];return r&&l.push(e),n&&l.push("_quotePrefix"),{styleId:e=this.getStyleId(l)||void 0,data:{type:a,value:o}}}createMergedCell(e,t,i,s){const r=i??"";return{styleId:this.getStyleById(e)?e:void 0,data:{type:t,value:"s"===t?Fd.getStringPosition(r).toString():i},mergeAcross:s}}getCellValue(e,t){let i=!1;return null==t&&(e="s",t=""),"s"===e?(t&&"'"===t[0]&&(i=!0,t=t.slice(1)),t=Fd.getStringPosition(t).toString()):"f"===e?t=t.slice(1):"n"===e&&(t=Number(t).toString()),{value:t,escaped:i}}getStyleId(e){if(!e||!e.length)return null;if(1===e.length)return e[0];const t=e.join("-");return this.mixedStyles[t]||this.addNewMixedStyle(e),this.mixedStyles[t].excelID}deepCloneObject(e){return JSON.parse(JSON.stringify(e))}addNewMixedStyle(e){this.mixedStyleCounter+=1;const t=`mixedStyle${this.mixedStyleCounter}`,i={};for(const a of e)for(const e of this.excelStyles)e.id===a&&s.ch.mergeDeep(i,this.deepCloneObject(e));i.id=t,i.name=t;const r=e.join("-");this.mixedStyles[r]={excelID:t,key:r,result:i},this.excelStyles.push(i),this.stylesByIds[t]=i}isFormula(e){return null!=e&&(this.config.autoConvertFormulas&&e.toString().startsWith("="))}isNumerical(e){return"bigint"==typeof e||isFinite(e)&&""!==e&&!isNaN(parseFloat(e))}getStyleById(e){return null==e?null:this.stylesByIds[e]||null}},Rd=(e,t)=>{const i="xl/drawings",r=`${i}/drawing${t+1}.xml`,a=`${i}/_rels/drawing${t+1}.xml.rels`;s.ck.addFile(a,Fd.createDrawingRel(e)),s.ck.addFile(r,Fd.createDrawing(e))},Ld=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e||0===e.length)return console.warn("AG Grid: Invalid params supplied to createExcelFileForExcel() - `ExcelExportParams.data` is empty."),Fd.resetFactory(),!1;const{fontSize:i=11,author:r="AG Grid"}=t;return(()=>{if(s.ck.addFolders(["_rels/","docProps/","xl/","xl/theme/","xl/_rels/","xl/worksheets/"]),!Fd.images.size)return;s.ck.addFolders(["xl/worksheets/_rels","xl/drawings/","xl/drawings/_rels","xl/media/"]);let e=0;Fd.images.forEach((t=>{const i=t[0].image[0],r=i.imageType;s.ck.addFile(`xl/media/image${++e}.${r}`,i.base64,!0)}))})(),(()=>{const e=Fd.worksheetDataTables,t=Array.from(e.keys());for(let i=0;i<t.length;i++){const r=t[i],a=e.get(r);a&&s.ck.addFile(`xl/tables/${a.name}.xml`,Fd.createTable(a,i))}})(),(e=>{let t=0,i=0;for(let r=0;r<e.length;r++){const a=e[r];s.ck.addFile(`xl/worksheets/sheet${r+1}.xml`,a,!1);const o=Fd.images.size>0&&Fd.worksheetImages.has(r),n=Fd.worksheetDataTables.size>0&&Fd.worksheetDataTables.has(r);if(!o&&!n)continue;let l,d;o&&(Rd(r,t),d=t,t++),n&&(l=i,i++);const h=`xl/worksheets/_rels/sheet${r+1}.xml.rels`;s.ck.addFile(h,Fd.createRelationships({tableIndex:l,drawingIndex:d}))}})(e),((e,t,i)=>{s.ck.addFile("xl/workbook.xml",Fd.createWorkbook()),s.ck.addFile("xl/styles.xml",Fd.createStylesheet(e)),s.ck.addFile("xl/sharedStrings.xml",Fd.createSharedStrings()),s.ck.addFile("xl/theme/theme1.xml",Fd.createTheme()),s.ck.addFile("xl/_rels/workbook.xml.rels",Fd.createWorkbookRels(i)),s.ck.addFile("docProps/core.xml",Fd.createCore(t)),s.ck.addFile("[Content_Types].xml",Fd.createContentTypes(i)),s.ck.addFile("_rels/.rels",Fd.createRels())})(i,r,e.length),Fd.resetFactory(),!0},Id=e=>{const{data:t,fontSize:i,author:r}=e,a=e.mimeType||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";return Ld(t,{author:r,fontSize:i})?s.ck.getZipFile(a):Promise.resolve(void 0)},Od=e=>{const{data:t,fontSize:i,author:r}=e,a=e.mimeType||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";if(Ld(t,{author:r,fontSize:i}))return s.ck.getUncompressedZipFile(a)},Nd=e=>{const{fileName:t="export.xlsx"}=e;Id(e).then((e=>{if(e){const i="function"==typeof t?t():t;s.cl.download(i,e)}}))},kd=class extends s.cm{postConstruct(){this.setBeans({gridSerializer:this.gridSerializer,gridOptionsService:this.gridOptionsService})}getMergedParams(e){const t=this.gridOptionsService.get("defaultExcelExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed())return void console.warn("AG Grid: Export cancelled. Export is not allowed as per your configuration.");const t=this.getMergedParams(e),i={data:[this.getData(t)],fontSize:t.fontSize,author:t.author,mimeType:t.mimeType};this.packageCompressedFile(i).then((e=>{if(e){const{fileName:i}=t,r="function"==typeof i?i(this.gridOptionsService.getGridCommonParams()):i;s.cl.download(this.getFileName(r),e)}}))}exportDataAsExcel(e){this.export(e)}getDataAsExcel(e){const t=this.getMergedParams(e),i={data:[this.getData(t)],fontSize:t.fontSize,author:t.author,mimeType:t.mimeType};return this.packageFile(i)}setFactoryMode(e){Fd.factoryMode=e}getFactoryMode(){return Fd.factoryMode}getSheetDataForExcel(e){const t=this.getMergedParams(e);return this.getData(t)}getMultipleSheetsAsExcel(e){return Od(e)}exportMultipleSheetsAsExcel(e){Nd(e)}getDefaultFileExtension(){return"xlsx"}createSerializingSession(e){const{columnModel:t,valueService:i,gridOptionsService:s,valueFormatterService:r,valueParserService:a}=this;let o;if(null!=e.sheetName){const{sheetName:t}=e,i="function"==typeof t?t(this.gridOptionsService.getGridCommonParams()):t;o=String(i).substring(0,31)}else o="ag-grid";const n=Kn(Wn({},e),{sheetName:o,columnModel:t,valueService:i,gridOptionsService:s,valueFormatterService:r,valueParserService:a,suppressRowOutline:e.suppressRowOutline||e.skipRowGroups,headerRowHeight:e.headerRowHeight||e.rowHeight,baseExcelStyles:this.gridOptionsService.get("excelStyles")||[],styleLinker:this.styleLinker.bind(this)});return new Dd(n)}styleLinker(e){const{rowType:t,rowIndex:i,value:r,column:a,columnGroup:o,node:n}=e,l=t===s.cn.HEADER,d=t===s.cn.HEADER_GROUPING,h=l?a:o;let c=[];if(l||d)return c.push("header"),d&&c.push("headerGroup"),h&&(c=c.concat(s.an.getHeaderClassesFromColDef(h.getDefinition(),this.gridOptionsService,a||null,o||null))),c;const u=this.gridOptionsService.get("excelStyles"),p=["cell"];if(!u||!u.length)return p;const g=u.map((e=>e.id));return this.stylingService.processAllCellClasses(a.getDefinition(),this.gridOptionsService.addGridCommonParams({value:r,data:n.data,node:n,colDef:a.getDefinition(),column:a,rowIndex:i}),(e=>{g.indexOf(e)>-1&&p.push(e)})),p.sort(((e,t)=>g.indexOf(e)<g.indexOf(t)?-1:1))}isExportSuppressed(){return this.gridOptionsService.get("suppressExcelExport")}packageCompressedFile(e){return Id(e)}packageFile(e){return Od(e)}};zn([(0,s.A)("columnModel")],kd.prototype,"columnModel",2),zn([(0,s.A)("valueService")],kd.prototype,"valueService",2),zn([(0,s.A)("stylingService")],kd.prototype,"stylingService",2),zn([(0,s.A)("gridSerializer")],kd.prototype,"gridSerializer",2),zn([(0,s.A)("gridOptionsService")],kd.prototype,"gridOptionsService",2),zn([(0,s.A)("valueFormatterService")],kd.prototype,"valueFormatterService",2),zn([(0,s.A)("valueParserService")],kd.prototype,"valueParserService",2),zn([s.a],kd.prototype,"postConstruct",1),kd=zn([(0,s._)("excelCreator")],kd);var Gd={version:"31.2.1",moduleName:s.M.ExcelExportModule,beans:[kd,s.G,s.d],dependantModules:[s.C,E]},Vd=Object.defineProperty,Bd=Object.getOwnPropertyDescriptor,_d=Object.getOwnPropertySymbols,Ud=Object.prototype.hasOwnProperty,Hd=Object.prototype.propertyIsEnumerable,Wd=(e,t,i)=>t in e?Vd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Kd=(e,t)=>{for(var i in t||(t={}))Ud.call(t,i)&&Wd(e,i,t[i]);if(_d)for(var i of _d(t))Hd.call(t,i)&&Wd(e,i,t[i]);return e},zd=(e,t,i,s)=>{for(var r,a=s>1?void 0:s?Bd(t,i):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s?r(t,i,a):r(a))||a);return s&&a&&Vd(t,i,a),a},$d=class extends s.ak{preConstruct(){this.setTemplate('<div class="ag-filter-toolpanel-search" role="presentation">\n                <div ref="eExpand" class="ag-filter-toolpanel-expand"></div>\n                <ag-input-text-field ref="eFilterTextField" class="ag-filter-toolpanel-search-input"></ag-input-text-field>\n            </div>')}postConstruct(){const e=this.localeService.getLocaleTextFunc();this.eFilterTextField.setAutoComplete(!1).setInputAriaLabel(e("ariaFilterColumnsInput","Filter Columns Input")).onValueChange(this.onSearchTextChanged.bind(this)),this.createExpandIcons(),this.setExpandState(0),this.addManagedListener(this.eExpand,"click",this.onExpandClicked.bind(this)),this.addManagedListener(this.eventService,s.aA.EVENT_NEW_COLUMNS_LOADED,this.showOrHideOptions.bind(this))}init(e){this.params=e,this.columnModel.isReady()&&this.showOrHideOptions()}createExpandIcons(){this.eExpand.appendChild(this.eExpandChecked=s.ch.createIconNoSpan("columnSelectOpen",this.gridOptionsService)),this.eExpand.appendChild(this.eExpandUnchecked=s.ch.createIconNoSpan("columnSelectClosed",this.gridOptionsService)),this.eExpand.appendChild(this.eExpandIndeterminate=s.ch.createIconNoSpan("columnSelectIndeterminate",this.gridOptionsService))}showOrHideOptions(){const e=!this.params.suppressFilterSearch,t=!this.params.suppressExpandAll,i=this.localeService.getLocaleTextFunc();this.eFilterTextField.setInputPlaceholder(i("searchOoo","Search..."));const r=this.columnModel.getAllGridColumns().some((e=>e.getOriginalParent()&&e.isFilterAllowed()));s.ch.setDisplayed(this.eFilterTextField.getGui(),e),s.ch.setDisplayed(this.eExpand,t&&r)}onSearchTextChanged(){this.onSearchTextChangedDebounced||(this.onSearchTextChangedDebounced=s.ch.debounce((()=>{this.dispatchEvent({type:"searchChanged",searchText:this.eFilterTextField.getValue()})}),300)),this.onSearchTextChangedDebounced()}onExpandClicked(){const e=0===this.currentExpandState?{type:"collapseAll"}:{type:"expandAll"};this.dispatchEvent(e)}setExpandState(e){this.currentExpandState=e,s.ch.setDisplayed(this.eExpandChecked,0===this.currentExpandState),s.ch.setDisplayed(this.eExpandUnchecked,1===this.currentExpandState),s.ch.setDisplayed(this.eExpandIndeterminate,2===this.currentExpandState)}};zd([(0,s.A)("columnModel")],$d.prototype,"columnModel",2),zd([(0,s.R)("eExpand")],$d.prototype,"eExpand",2),zd([(0,s.R)("eFilterTextField")],$d.prototype,"eFilterTextField",2),zd([s.P],$d.prototype,"preConstruct",1),zd([s.a],$d.prototype,"postConstruct",1);var jd=class e extends s.ak{constructor(t,i){super(e.TEMPLATE),this.expandedCallback=i,this.expanded=!1,this.hideHeader=t}postConstruct(){this.eExpandChecked=s.ch.createIconNoSpan("columnSelectOpen",this.gridOptionsService),this.eExpandUnchecked=s.ch.createIconNoSpan("columnSelectClosed",this.gridOptionsService),this.eExpand.appendChild(this.eExpandChecked),this.eExpand.appendChild(this.eExpandUnchecked)}setColumn(e){this.column=e,this.eFilterName.innerText=this.columnModel.getDisplayNameForColumn(this.column,"filterToolPanel",!1)||"",this.addManagedListener(this.eFilterToolPanelHeader,"click",this.toggleExpanded.bind(this)),this.addManagedListener(this.eFilterToolPanelHeader,"keydown",(e=>{(e.key===s.b6.ENTER||e.key===s.b6.SPACE)&&(e.preventDefault(),this.toggleExpanded())})),this.addManagedListener(this.eventService,s.aA.EVENT_FILTER_OPENED,this.onFilterOpened.bind(this)),this.addInIcon("filter",this.eFilterIcon,this.column),s.ch.setDisplayed(this.eFilterIcon,this.isFilterActive(),{skipAriaHidden:!0}),s.ch.setDisplayed(this.eExpandChecked,!1),this.hideHeader?(s.ch.setDisplayed(this.eFilterToolPanelHeader,!1),this.eFilterToolPanelHeader.removeAttribute("tabindex")):this.eFilterToolPanelHeader.setAttribute("tabindex","0"),this.addManagedListener(this.column,s.ad.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,s.aA.EVENT_FILTER_DESTROYED,this.onFilterDestroyed.bind(this))}getColumn(){return this.column}getColumnFilterName(){return this.columnModel.getDisplayNameForColumn(this.column,"filterToolPanel",!1)}addCssClassToTitleBar(e){this.eFilterToolPanelHeader.classList.add(e)}addInIcon(e,t,i){if(null==t)return;const r=s.ch.createIconNoSpan(e,this.gridOptionsService,i);t.appendChild(r)}isFilterActive(){return this.filterManager.isFilterActive(this.column)}onFilterChanged(){s.ch.setDisplayed(this.eFilterIcon,this.isFilterActive(),{skipAriaHidden:!0}),this.dispatchEvent({type:s.ad.EVENT_FILTER_CHANGED})}onFilterDestroyed(e){this.expanded&&("api"===e.source||"paramsUpdated"===e.source)&&e.column.getId()===this.column.getId()&&this.columnModel.getPrimaryColumn(this.column)&&(this.removeFilterElement(),this.addFilterElement(!0))}toggleExpanded(){this.expanded?this.collapse():this.expand()}expand(){this.expanded||(this.expanded=!0,s.ch.setAriaExpanded(this.eFilterToolPanelHeader,!0),s.ch.setDisplayed(this.eExpandChecked,!0),s.ch.setDisplayed(this.eExpandUnchecked,!1),this.addFilterElement(),this.expandedCallback())}addFilterElement(e){const t=s.ch.loadTemplate('<div class="ag-filter-toolpanel-instance-filter"></div>'),i=this.filterManager.getOrCreateFilterWrapper(this.column,"TOOLBAR");if(!i)return;const{filterPromise:r,guiPromise:a}=i;null==r||r.then((i=>{this.underlyingFilter=i,i&&a.then((s=>{s&&t.appendChild(s),this.agFilterToolPanelBody.appendChild(t),i.afterGuiAttached&&i.afterGuiAttached({container:"toolPanel",suppressFocus:e})}))}))}collapse(){var e,t;this.expanded&&(this.expanded=!1,s.ch.setAriaExpanded(this.eFilterToolPanelHeader,!1),this.removeFilterElement(),s.ch.setDisplayed(this.eExpandChecked,!1),s.ch.setDisplayed(this.eExpandUnchecked,!0),null==(t=null==(e=this.underlyingFilter)?void 0:e.afterGuiDetached)||t.call(e),this.expandedCallback())}removeFilterElement(){s.ch.clearElement(this.agFilterToolPanelBody)}isExpanded(){return this.expanded}refreshFilter(e){var t;if(!this.expanded)return;const i=this.underlyingFilter;i&&(e?"function"==typeof i.refreshVirtualList&&i.refreshVirtualList():null==(t=i.afterGuiDetached)||t.call(i))}onFilterOpened(e){"COLUMN_MENU"===e.source&&e.column===this.column&&this.expanded&&this.collapse()}};jd.TEMPLATE='\n        <div class="ag-filter-toolpanel-instance">\n            <div class="ag-filter-toolpanel-header ag-filter-toolpanel-instance-header" ref="eFilterToolPanelHeader" role="button" aria-expanded="false">\n                <div ref="eExpand" class="ag-filter-toolpanel-expand"></div>\n                <span ref="eFilterName" class="ag-header-cell-text"></span>\n                <span ref="eFilterIcon" class="ag-header-icon ag-filter-icon ag-filter-toolpanel-instance-header-icon" aria-hidden="true"></span>\n            </div>\n            <div class="ag-filter-toolpanel-instance-body ag-filter" ref="agFilterToolPanelBody"></div>\n        </div>',zd([(0,s.R)("eFilterToolPanelHeader")],jd.prototype,"eFilterToolPanelHeader",2),zd([(0,s.R)("eFilterName")],jd.prototype,"eFilterName",2),zd([(0,s.R)("agFilterToolPanelBody")],jd.prototype,"agFilterToolPanelBody",2),zd([(0,s.R)("eFilterIcon")],jd.prototype,"eFilterIcon",2),zd([(0,s.R)("eExpand")],jd.prototype,"eExpand",2),zd([(0,s.A)("filterManager")],jd.prototype,"filterManager",2),zd([(0,s.A)("columnModel")],jd.prototype,"columnModel",2),zd([s.a],jd.prototype,"postConstruct",1);var Yd=jd,qd=class e extends s.ak{constructor(e,t,i,s,r){super(),this.columnGroup=e,this.childFilterComps=t,this.depth=s,this.expandedCallback=i,this.showingColumn=r}preConstruct(){this.setTemplate(e.TEMPLATE,{filterGroupComp:{cssIdentifier:"filter-toolpanel",direction:"vertical"}})}init(){this.setGroupTitle(),this.filterGroupComp.setAlignItems("stretch"),this.filterGroupComp.addCssClass(`ag-filter-toolpanel-group-level-${this.depth}`),this.filterGroupComp.addCssClassToTitleBar(`ag-filter-toolpanel-group-level-${this.depth}-header`),this.childFilterComps.forEach((e=>{this.filterGroupComp.addItem(e),e.addCssClassToTitleBar(`ag-filter-toolpanel-group-level-${this.depth+1}-header`)})),this.refreshFilterClass(),this.addExpandCollapseListeners(),this.addFilterChangedListeners(),this.setupTooltip()}setupTooltip(){if(!this.showingColumn)return;let e;"whenTruncated"===this.gridOptionsService.get("tooltipShowMode")&&(e=()=>{const e=this.filterGroupComp.getGui().querySelector(".ag-group-title");return!e||e.scrollWidth>e.clientWidth});const t=()=>{const t=this.columnGroup.getColDef().headerTooltip;this.setTooltip({newTooltipText:t,location:"filterToolPanelColumnGroup",shouldDisplayTooltip:e})};t(),this.addManagedListener(this.eventService,s.aA.EVENT_NEW_COLUMNS_LOADED,t)}getTooltipParams(){const e=super.getTooltipParams();return e.location="filterToolPanelColumnGroup",e}addCssClassToTitleBar(e){this.filterGroupComp.addCssClassToTitleBar(e)}refreshFilters(t){this.childFilterComps.forEach((i=>{i instanceof e?i.refreshFilters(t):i.refreshFilter(t)}))}isColumnGroup(){return this.columnGroup instanceof s.bt}isExpanded(){return this.filterGroupComp.isExpanded()}getChildren(){return this.childFilterComps}getFilterGroupName(){return this.filterGroupName?this.filterGroupName:""}getFilterGroupId(){return this.columnGroup.getId()}hideGroupItem(e,t){this.filterGroupComp.hideItem(e,t)}hideGroup(e){this.setDisplayed(!e)}forEachToolPanelFilterChild(e){this.childFilterComps.forEach((t=>{t instanceof Yd&&e(t)}))}addExpandCollapseListeners(){const e=this.isColumnGroup()?()=>this.expandedCallback():()=>this.forEachToolPanelFilterChild((e=>e.expand())),t=this.isColumnGroup()?()=>this.expandedCallback():()=>this.forEachToolPanelFilterChild((e=>e.collapse()));this.addManagedListener(this.filterGroupComp,s.o.EVENT_EXPANDED,e),this.addManagedListener(this.filterGroupComp,s.o.EVENT_COLLAPSED,t)}getColumns(){return this.columnGroup instanceof s.bt?this.columnGroup.getLeafColumns():[this.columnGroup]}addFilterChangedListeners(){this.getColumns().forEach((e=>{this.addManagedListener(e,s.ad.EVENT_FILTER_CHANGED,(()=>this.refreshFilterClass()))})),this.columnGroup instanceof s.bt||this.addManagedListener(this.eventService,s.aA.EVENT_FILTER_OPENED,this.onFilterOpened.bind(this))}refreshFilterClass(){const e=this.getColumns();this.filterGroupComp.addOrRemoveCssClass("ag-has-filter",e.some((e=>e.isFilterActive())))}onFilterOpened(e){"COLUMN_MENU"===e.source&&e.column===this.columnGroup&&this.isExpanded()&&this.collapse()}expand(){this.filterGroupComp.toggleGroupExpand(!0)}collapse(){this.filterGroupComp.toggleGroupExpand(!1)}setGroupTitle(){this.filterGroupName=this.columnGroup instanceof s.bt?this.getColumnGroupName(this.columnGroup):this.getColumnName(this.columnGroup),this.filterGroupComp.setTitle(this.filterGroupName||"")}getColumnGroupName(e){return this.columnModel.getDisplayNameForProvidedColumnGroup(null,e,"filterToolPanel")}getColumnName(e){return this.columnModel.getDisplayNameForColumn(e,"filterToolPanel",!1)}destroyFilters(){this.childFilterComps=this.destroyBeans(this.childFilterComps),s.ch.clearElement(this.getGui())}destroy(){this.destroyFilters(),super.destroy()}};qd.TEMPLATE='<div class="ag-filter-toolpanel-group-wrapper">\n            <ag-group-component ref="filterGroupComp"></ag-group-component>\n        </div>',zd([(0,s.R)("filterGroupComp")],qd.prototype,"filterGroupComp",2),zd([(0,s.A)("columnModel")],qd.prototype,"columnModel",2),zd([s.P],qd.prototype,"preConstruct",1),zd([s.a],qd.prototype,"init",1);var Xd=qd,Zd=class e extends s.ak{constructor(){super(e.TEMPLATE),this.initialised=!1,this.hasLoadedInitialState=!1,this.isInitialState=!1,this.filterGroupComps=[],this.suppressOnColumnsChanged=!1,this.onColumnsChangedPending=!1}init(e){this.initialised=!0;const t=this.gridOptionsService.addGridCommonParams({suppressExpandAll:!1,suppressFilterSearch:!1,suppressSyncLayoutWithGrid:!1});s.ch.mergeDeep(t,e),this.params=t,this.params.suppressSyncLayoutWithGrid||this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_MOVED,(()=>this.onColumnsChanged())),this.addManagedListener(this.eventService,s.aA.EVENT_NEW_COLUMNS_LOADED,(()=>this.onColumnsChanged())),this.addManagedListener(this.eventService,s.aA.EVENT_TOOL_PANEL_VISIBLE_CHANGED,(e=>{"filters"===e.key&&this.refreshFilters(e.visible)})),this.addManagedListener(this.eventService,s.aA.EVENT_DRAG_STARTED,(()=>{this.suppressOnColumnsChanged=!0})),this.addManagedListener(this.eventService,s.aA.EVENT_DRAG_STOPPED,(()=>{this.suppressOnColumnsChanged=!1,this.onColumnsChangedPending&&(this.onColumnsChangedPending=!1,this.onColumnsChanged())})),this.columnModel.isReady()&&this.onColumnsChanged()}onColumnsChanged(){if(this.suppressOnColumnsChanged)return void(this.onColumnsChangedPending=!0);const e=this.columnModel.isPivotMode();this.params.suppressSyncLayoutWithGrid||e?this.buildTreeFromProvidedColumnDefs():this.syncFilterLayout(),this.refreshAriaLabel()}syncFilterLayout(){this.toolPanelColDefService.syncLayoutWithGrid(this.setFiltersLayout.bind(this)),this.refreshAriaLabel()}buildTreeFromProvidedColumnDefs(){const e=this.columnModel.getPrimaryColumnTree();this.recreateFilters(e)}setFiltersLayout(e){const t=this.toolPanelColDefService.createColumnTree(e);this.recreateFilters(t)}recreateFilters(e){const t=this.gridOptionsService.getDocument().activeElement;this.hasLoadedInitialState||(this.hasLoadedInitialState=!0,this.isInitialState=!!this.params.initialState);const i=this.getExpansionState();this.destroyFilters(),this.filterGroupComps=this.recursivelyAddComps(e,0,i);const r=this.filterGroupComps.length;r&&(this.filterGroupComps.forEach((e=>this.appendChild(e))),this.setFirstAndLastVisible(0,r-1)),s.ch.exists(this.searchFilterText)&&this.searchFilters(this.searchFilterText),this.fireExpandedEvent(),this.getGui().contains(t)&&t.focus(),this.isInitialState=!1,this.refreshAriaLabel()}recursivelyAddComps(e,t,i){return s.ch.flatten(e.map((e=>{if(e instanceof s.bt)return s.ch.flatten(this.recursivelyAddFilterGroupComps(e,t,i));const r=e;if(!this.shouldDisplayFilter(r))return[];const a=new Yd(0===t,(()=>this.onFilterExpanded()));if(this.createBean(a),a.setColumn(r),i.get(r.getId())&&a.expand(),t>0)return a;const o=this.createBean(new Xd(r,[a],this.onGroupExpanded.bind(this),t,!0));return o.addCssClassToTitleBar("ag-filter-toolpanel-header"),i.get(o.getFilterGroupId())||o.collapse(),o})))}refreshAriaLabel(){const e=this.localeService.getLocaleTextFunc(),t=e("ariaFilterPanelList","Filter List"),i=e("filters","Filters"),r=this.getGui().querySelectorAll(".ag-filter-toolpanel-group-item:not(.ag-filter-toolpanel-group-wrapper, .ag-hidden)").length;s.ch.setAriaLabel(this.getAriaElement(),`${t} ${r} ${i}`)}recursivelyAddFilterGroupComps(e,t,i){if(!this.filtersExistInChildren(e.getChildren()))return;const r=e.getColGroupDef();if(r&&r.suppressFiltersToolPanel)return[];const a=e.isPadding()?t:t+1,o=s.ch.flatten(this.recursivelyAddComps(e.getChildren(),a,i));if(e.isPadding())return o;const n=new Xd(e,o,this.onGroupExpanded.bind(this),t,!1);this.createBean(n),n.addCssClassToTitleBar("ag-filter-toolpanel-header");const l=i.get(n.getFilterGroupId());return(this.isInitialState&&!l||!1===l)&&n.collapse(),[n]}filtersExistInChildren(e){return e.some((e=>e instanceof s.bt?this.filtersExistInChildren(e.getChildren()):this.shouldDisplayFilter(e)))}shouldDisplayFilter(e){const t=e.getColDef()&&e.getColDef().suppressFiltersToolPanel;return e.isFilterAllowed()&&!t}getExpansionState(){const e=new Map;if(this.isInitialState){const{expandedColIds:t,expandedGroupIds:i}=this.params.initialState;return t.forEach((t=>e.set(t,!0))),i.forEach((t=>e.set(t,!0))),e}const t=i=>{e.set(i.getFilterGroupId(),i.isExpanded()),i.getChildren().forEach((i=>{i instanceof Xd?t(i):e.set(i.getColumn().getId(),i.isExpanded())}))};return this.filterGroupComps.forEach(t),e}refresh(){}setVisible(e){super.setDisplayed(e),e&&!this.initialised&&this.init(this.params)}expandFilterGroups(e,t){const i=[],r=a=>{const o=a.getFilterGroupId();(!t||s.ch.includes(t,o))&&(e&&a.isColumnGroup()?a.expand():a.collapse(),i.push(o)),a.getChildren().forEach((e=>{e instanceof Xd&&r(e)}))};if(this.filterGroupComps.forEach(r),this.onGroupExpanded(),t){const e=t.filter((e=>i.indexOf(e)<0));e.length>0&&console.warn("AG Grid: unable to find groups for these supplied groupIds:",e)}}expandFilters(e,t){const i=[],r=a=>{if(a instanceof Xd){let t=!1;return a.getChildren().forEach((i=>{r(i)&&(e?(a.expand(),t=!0):a.isColumnGroup()||a.collapse())})),t}const o=a.getColumn().getColId(),n=!t||s.ch.includes(t,o);return n&&(e?a.expand():a.collapse(),i.push(o)),n};if(this.filterGroupComps.forEach(r),this.onGroupExpanded(),t){const e=t.filter((e=>i.indexOf(e)<0));e.length>0&&console.warn("AG Grid: unable to find columns for these supplied colIds:",e)}}onGroupExpanded(){this.fireExpandedEvent()}onFilterExpanded(){this.dispatchEvent({type:"filterExpanded"})}fireExpandedEvent(){let e=0,t=0;const i=s=>{s.isColumnGroup()&&(s.isExpanded()?e++:t++,s.getChildren().forEach((e=>{e instanceof Xd&&i(e)})))};let s;this.filterGroupComps.forEach(i),s=e>0&&t>0?2:t>0?1:0,this.dispatchEvent({type:"groupExpanded",state:s})}performFilterSearch(e){this.searchFilterText=s.ch.exists(e)?e.toLowerCase():null,this.searchFilters(this.searchFilterText)}searchFilters(e){const t=t=>!s.ch.exists(e)||-1!==t.toLowerCase().indexOf(e),i=(e,s)=>{if(!(e instanceof Xd))return t(e.getColumnFilterName()||"");const r=e.getChildren(),a=t(e.getFilterGroupName()),o=s||a;if(o){e.hideGroup(!1);for(let t=0;t<r.length;t++)i(r[t],o),e.hideGroupItem(!1,t);return!0}let n=!1;return r.forEach(((t,r)=>{const a=i(t,s);e.hideGroupItem(!a,r),a&&(n=!0)})),e.hideGroup(!n),n};let r,a;this.filterGroupComps.forEach(((e,t)=>{i(e,!1),void 0===r?e.containsCssClass("ag-hidden")||(r=t,a=t):!e.containsCssClass("ag-hidden")&&a!==t&&(a=t)})),this.setFirstAndLastVisible(r,a),this.refreshAriaLabel()}setFirstAndLastVisible(e,t){this.filterGroupComps.forEach(((i,s)=>{i.removeCssClass("ag-first-group-visible"),i.removeCssClass("ag-last-group-visible"),s===e&&i.addCssClass("ag-first-group-visible"),s===t&&i.addCssClass("ag-last-group-visible")}))}refreshFilters(e){this.filterGroupComps.forEach((t=>t.refreshFilters(e)))}getExpandedFiltersAndGroups(){const e=[],t=new Set,i=s=>{if(s instanceof Xd){s.getChildren().forEach((e=>i(e)));const r=s.getFilterGroupId();s.isExpanded()&&!t.has(r)&&e.push(r)}else s.isExpanded()&&t.add(s.getColumn().getColId())};return this.filterGroupComps.forEach(i),{expandedGroupIds:e,expandedColIds:Array.from(t)}}destroyFilters(){this.filterGroupComps=this.destroyBeans(this.filterGroupComps),s.ch.clearElement(this.getGui())}destroy(){this.destroyFilters(),super.destroy()}};Zd.TEMPLATE='<div class="ag-filter-list-panel"></div>',zd([(0,s.A)("toolPanelColDefService")],Zd.prototype,"toolPanelColDefService",2),zd([(0,s.A)("columnModel")],Zd.prototype,"columnModel",2);var Jd=Zd,Qd=class e extends s.ak{constructor(){super(e.TEMPLATE),this.initialised=!1,this.listenerDestroyFuncs=[]}init(e){this.initialised&&(this.listenerDestroyFuncs.forEach((e=>e())),this.listenerDestroyFuncs=[]),this.initialised=!0;const t=this.gridOptionsService.addGridCommonParams({suppressExpandAll:!1,suppressFilterSearch:!1,suppressSyncLayoutWithGrid:!1});this.params=Kd(Kd({},t),e),this.filtersToolPanelHeaderPanel.init(this.params),this.filtersToolPanelListPanel.init(this.params);const i=this.params.suppressExpandAll,s=this.params.suppressFilterSearch;i&&s&&this.filtersToolPanelHeaderPanel.setDisplayed(!1),this.listenerDestroyFuncs.push(this.addManagedListener(this.filtersToolPanelHeaderPanel,"expandAll",this.onExpandAll.bind(this)),this.addManagedListener(this.filtersToolPanelHeaderPanel,"collapseAll",this.onCollapseAll.bind(this)),this.addManagedListener(this.filtersToolPanelHeaderPanel,"searchChanged",this.onSearchChanged.bind(this)),this.addManagedListener(this.filtersToolPanelListPanel,"filterExpanded",this.onFilterExpanded.bind(this)),this.addManagedListener(this.filtersToolPanelListPanel,"groupExpanded",this.onGroupExpanded.bind(this)))}setVisible(e){super.setDisplayed(e),e&&!this.initialised&&this.init(this.params)}onExpandAll(){this.filtersToolPanelListPanel.expandFilterGroups(!0)}onCollapseAll(){this.filtersToolPanelListPanel.expandFilterGroups(!1)}onSearchChanged(e){this.filtersToolPanelListPanel.performFilterSearch(e.searchText)}setFilterLayout(e){this.filtersToolPanelListPanel.setFiltersLayout(e)}onFilterExpanded(){this.params.onStateUpdated()}onGroupExpanded(e){this.filtersToolPanelHeaderPanel.setExpandState(e.state),this.params.onStateUpdated()}expandFilterGroups(e){this.filtersToolPanelListPanel.expandFilterGroups(!0,e)}collapseFilterGroups(e){this.filtersToolPanelListPanel.expandFilterGroups(!1,e)}expandFilters(e){this.filtersToolPanelListPanel.expandFilters(!0,e)}collapseFilters(e){this.filtersToolPanelListPanel.expandFilters(!1,e)}syncLayoutWithGrid(){this.filtersToolPanelListPanel.syncFilterLayout()}refresh(e){return this.init(e),!0}getState(){return this.filtersToolPanelListPanel.getExpandedFiltersAndGroups()}destroy(){super.destroy()}};Qd.TEMPLATE='<div class="ag-filter-toolpanel">\n            <ag-filters-tool-panel-header ref="filtersToolPanelHeaderPanel"></ag-filters-tool-panel-header>\n            <ag-filters-tool-panel-list ref="filtersToolPanelListPanel"></ag-filters-tool-panel-list>\n         </div>',zd([(0,s.R)("filtersToolPanelHeaderPanel")],Qd.prototype,"filtersToolPanelHeaderPanel",2),zd([(0,s.R)("filtersToolPanelListPanel")],Qd.prototype,"filtersToolPanelListPanel",2);var eh=Qd,th={version:"31.2.1",moduleName:s.M.FiltersToolPanelModule,beans:[],agStackComponents:[{componentName:"AgFiltersToolPanelHeader",componentClass:$d},{componentName:"AgFiltersToolPanelList",componentClass:Jd}],userComponents:[{componentName:"agFiltersToolPanel",componentClass:eh}],dependantModules:[on,E]},ih=Object.defineProperty,sh=Object.getOwnPropertyDescriptor,rh=Object.getOwnPropertySymbols,ah=Object.prototype.hasOwnProperty,oh=Object.prototype.propertyIsEnumerable,nh=(e,t,i)=>t in e?ih(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,lh=(e,t,i,s)=>{for(var r,a=s>1?void 0:s?sh(t,i):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s?r(t,i,a):r(a))||a);return s&&a&&ih(t,i,a),a},dh=class extends s.B{constructor(){super(...arguments),this.loadRowDataVersion=0}init(e,t){this.params=t,this.comp=e,null==t.pinned&&(this.setAutoHeightClasses(),this.setupRefreshStrategy(),this.addThemeToDetailGrid(),this.createDetailGrid(),this.loadRowData(),this.addManagedListener(this.eventService,s.aA.EVENT_FULL_WIDTH_ROW_FOCUSED,this.onFullWidthRowFocused.bind(this)))}onFullWidthRowFocused(e){const t=this.params,i={rowIndex:t.node.rowIndex,rowPinned:t.node.rowPinned},s={rowIndex:e.rowIndex,rowPinned:e.rowPinned};this.rowPositionUtils.sameRow(i,s)&&this.focusService.focusInto(this.comp.getGui(),e.fromBelow)}setAutoHeightClasses(){const e=this.gridOptionsService.get("detailRowAutoHeight"),t=e?"ag-details-row-auto-height":"ag-details-row-fixed-height",i=e?"ag-details-grid-auto-height":"ag-details-grid-fixed-height";this.comp.addOrRemoveCssClass(t,!0),this.comp.addOrRemoveDetailGridCssClass(i,!0)}setupRefreshStrategy(){const e=this.params.refreshStrategy;"everything"!=e&&"nothing"!=e&&"rows"!=e?(null!=e&&console.warn("AG Grid: invalid cellRendererParams.refreshStrategy = '"+e+"' supplied, defaulting to refreshStrategy = 'rows'."),this.refreshStrategy="rows"):this.refreshStrategy=e}addThemeToDetailGrid(){const{theme:e}=this.environment.getTheme();e&&this.comp.addOrRemoveDetailGridCssClass(e,!0)}createDetailGrid(){if(s.ch.missing(this.params.detailGridOptions))return void console.warn("AG Grid: could not find detail grid options for master detail, please set gridOptions.detailCellRendererParams.detailGridOptions");const e=this.gridOptionsService.get("detailRowAutoHeight"),t=((e,t)=>{for(var i in t||(t={}))ah.call(t,i)&&nh(e,i,t[i]);if(rh)for(var i of rh(t))oh.call(t,i)&&nh(e,i,t[i]);return e})({},this.params.detailGridOptions);e&&(t.domLayout="autoHeight"),this.comp.setDetailGrid(t)}registerDetailWithMaster(e,t){const i=this.params.node.id,s=this.params.api,r={id:i,api:e,columnApi:t},a=this.params.node;s.addDetailGridInfo(i,r),a.detailGridInfo=r,this.addDestroyFunc((()=>{a.detailGridInfo===r&&(s.removeDetailGridInfo(i),a.detailGridInfo=null)}))}loadRowData(){var e,t,i;this.loadRowDataVersion++;const s=this.loadRowDataVersion;if("serverSide"===(null==(e=this.params.detailGridOptions)?void 0:e.rowModelType))return void(null==(i=null==(t=this.params.node.detailGridInfo)?void 0:t.api)||i.refreshServerSide({purge:!0}));const r=this.params.getDetailRowData;if(!r)return void console.warn("AG Grid: could not find getDetailRowData for master / detail, please set gridOptions.detailCellRendererParams.getDetailRowData");r({node:this.params.node,data:this.params.node.data,successCallback:e=>{this.loadRowDataVersion===s&&this.comp.setRowData(e)},context:this.gridOptionsService.getGridCommonParams().context})}refresh(){switch(this.refreshStrategy){case"nothing":return!0;case"everything":return!1}return this.loadRowData(),!0}};lh([(0,s.A)("rowPositionUtils")],dh.prototype,"rowPositionUtils",2),lh([(0,s.A)("focusService")],dh.prototype,"focusService",2);var hh=class e extends s.ak{init(e){this.params=e,this.selectAndSetTemplate();const t={addOrRemoveCssClass:(e,t)=>this.addOrRemoveCssClass(e,t),addOrRemoveDetailGridCssClass:(e,t)=>this.eDetailGrid.classList.toggle(e,t),setDetailGrid:e=>this.setDetailGrid(e),setRowData:e=>this.setRowData(e),getGui:()=>this.eDetailGrid};this.ctrl=this.createManagedBean(new dh),this.ctrl.init(t,e)}refresh(){return this.ctrl&&this.ctrl.refresh()}destroy(){super.destroy()}selectAndSetTemplate(){if(this.params.pinned)return void this.setTemplate('<div class="ag-details-row"></div>');const t=()=>{this.setTemplate(e.TEMPLATE)};if(s.ch.missing(this.params.template))t();else if("string"==typeof this.params.template)this.setTemplate(this.params.template);else if("function"==typeof this.params.template){const e=(0,this.params.template)(this.params);this.setTemplate(e)}else console.warn("AG Grid: detailCellRendererParams.template should be function or string"),t();null==this.eDetailGrid&&console.warn('AG Grid: reference to eDetailGrid was missing from the details template. Please add ref="eDetailGrid" to the template.')}setDetailGrid(e){if(!this.eDetailGrid)return;const t=this.context.getBean("agGridReact"),i=t?s.ch.cloneObject(t):void 0,r=this.context.getBean("frameworkComponentWrapper"),a=this.getFrameworkOverrides(),o=(0,s.ci)(this.eDetailGrid,e,{frameworkOverrides:a,providedBeanInstances:{agGridReact:i,frameworkComponentWrapper:r},modules:s.e.__getGridRegisteredModules(this.params.api.getGridId())});this.detailApi=o,this.ctrl.registerDetailWithMaster(o,new s.ae(o)),this.addDestroyFunc((()=>{null==o||o.destroy()}))}setRowData(e){this.detailApi&&this.detailApi.setGridOption("rowData",e)}};hh.TEMPLATE='<div class="ag-details-row" role="gridcell">\n            <div ref="eDetailGrid" class="ag-details-grid" role="presentation"></div>\n        </div>',lh([(0,s.R)("eDetailGrid")],hh.prototype,"eDetailGrid",2);var ch=hh,uh={version:"31.2.1",moduleName:s.M.MasterDetailModule,beans:[],userComponents:[{componentName:"agDetailCellRenderer",componentClass:ch}],controllers:[{controllerName:"detailCellRenderer",controllerClass:dh}],dependantModules:[E]},ph=Object.defineProperty,gh=Object.defineProperties,mh=Object.getOwnPropertyDescriptor,vh=Object.getOwnPropertyDescriptors,Ch=Object.getOwnPropertySymbols,fh=Object.prototype.hasOwnProperty,yh=Object.prototype.propertyIsEnumerable,Sh=(e,t,i)=>t in e?ph(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Eh=(e,t)=>{for(var i in t||(t={}))fh.call(t,i)&&Sh(e,i,t[i]);if(Ch)for(var i of Ch(t))yh.call(t,i)&&Sh(e,i,t[i]);return e},bh=(e,t)=>gh(e,vh(t)),wh=(e,t,i,s)=>{for(var r,a=s>1?void 0:s?mh(t,i):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s?r(t,i,a):r(a))||a);return s&&a&&ph(t,i,a),a},Ah=class extends s.B{hideActiveMenu(){this.destroyBean(this.activeMenu)}showMenuAfterMouseEvent(e,t,i,s){const r=s?"filterMenuTab":void 0;this.showMenu(e,(s=>{var a;const o=s.getGui();this.popupService.positionPopupUnderMouseEvent({type:i,column:e,mouseEvent:t,ePopup:o}),r&&(null==(a=s.showTab)||a.call(s,r)),this.dispatchVisibleChangedEvent(!0,!1,e,r)}),i,r,void 0,t.target)}showMenuAfterButtonClick(e,t,i,s){let r=-1,a="left";this.gridOptionsService.get("enableRtl")&&(r=1,a="right");const o=s?"filterMenuTab":void 0,n=o?[o]:void 0,l=this.menuService.isLegacyMenuEnabled();let d=(l?9:4)*r,h=l?-23:4;this.showMenu(e,(s=>{var r;const n=s.getGui();this.popupService.positionPopupByComponent({type:i,column:e,eventSource:t,ePopup:n,alignSide:a,nudgeX:d,nudgeY:h,position:"under",keepWithinBounds:!0}),o&&(null==(r=s.showTab)||r.call(s,o)),this.dispatchVisibleChangedEvent(!0,!1,e,o)}),i,o,n,t)}showMenu(e,t,i,r,a,o){var n;const{menu:l,eMenuGui:d,anchorToElement:h,restoreFocusParams:c}=this.getMenuParams(e,a,o),u=[];u.push((t=>{const i=l.getGui();this.destroyBean(l),e&&(e.setMenuVisible(!1,"contextMenu"),this.menuUtils.restoreFocusOnClose(c,i,t))}));const p=this.localeService.getLocaleTextFunc();if(this.popupService.addPopup({modal:!0,eChild:d,closeOnEsc:!0,closedCallback:t=>{u.forEach((e=>e(t))),this.dispatchVisibleChangedEvent(!1,!1,e,r)},afterGuiAttached:e=>l.afterGuiAttached(Object.assign({},{container:i},e)),positionCallback:r?()=>t(l):void 0,ariaLabel:p("ariaLabelColumnMenu","Column Menu")}),r||(null==(n=l.showTabBasedOnPreviousSelection)||n.call(l),t(l)),this.menuService.isColumnMenuAnchoringEnabled()){const t=this.popupService.setPopupPositionRelatedToElement(d,h);t&&e&&this.addStopAnchoring(t,e,u)}l.addEventListener(Th.EVENT_TAB_SELECTED,(t=>{this.dispatchVisibleChangedEvent(!1,!0,e),this.lastSelectedTab=t.key,this.dispatchVisibleChangedEvent(!0,!0,e)})),null==e||e.setMenuVisible(!0,"contextMenu"),this.activeMenu=l,l.addEventListener(s.B.EVENT_DESTROYED,(()=>{this.activeMenu===l&&(this.activeMenu=null)}))}addStopAnchoring(e,t,i){e.then((e=>{t.addEventListener("leftChanged",e),t.addEventListener("visibleChanged",e),i.push((()=>{t.removeEventListener("leftChanged",e),t.removeEventListener("visibleChanged",e)}))}))}getMenuParams(e,t,i){const s={column:e,headerPosition:this.focusService.getFocusedHeader(),columnIndex:this.columnModel.getAllDisplayedColumns().indexOf(e),eventSource:i},r=this.createMenu(e,s,t,i);return{menu:r,eMenuGui:r.getGui(),anchorToElement:i||this.ctrlsService.getGridBodyCtrl().getGui(),restoreFocusParams:s}}createMenu(e,t,i,s){return this.menuService.isLegacyMenuEnabled()?this.createBean(new Th(e,t,this.lastSelectedTab,i,s)):this.createBean(new Mh(e,t,s))}dispatchVisibleChangedEvent(e,t,i,r){var a,o;const n={type:s.aA.EVENT_COLUMN_MENU_VISIBLE_CHANGED,visible:e,switchingTab:t,key:null!=(o=null!=(a=this.lastSelectedTab)?a:r)?o:this.menuService.isLegacyMenuEnabled()?Th.TAB_GENERAL:"columnMenu",column:i??null};this.eventService.dispatchEvent(n)}isMenuEnabled(e){var t;if(!this.menuService.isLegacyMenuEnabled())return!0;const i=!this.filterManager.isFilterAllowed(e),s=null!=(t=e.getColDef().menuTabs)?t:Th.TABS_DEFAULT;return(i&&s.includes(Th.TAB_FILTER)?s.length-1:s.length)>0}showMenuAfterContextMenuEvent(e,t,i){this.menuUtils.onContextMenu(t,i,(t=>(this.showMenuAfterMouseEvent(e,t,"columnMenu"),!0)))}};wh([(0,s.A)("popupService")],Ah.prototype,"popupService",2),wh([(0,s.A)("focusService")],Ah.prototype,"focusService",2),wh([(0,s.A)("ctrlsService")],Ah.prototype,"ctrlsService",2),wh([(0,s.A)("columnModel")],Ah.prototype,"columnModel",2),wh([(0,s.A)("filterManager")],Ah.prototype,"filterManager",2),wh([(0,s.A)("menuUtils")],Ah.prototype,"menuUtils",2),wh([(0,s.A)("menuService")],Ah.prototype,"menuService",2),Ah=wh([(0,s._)("enterpriseMenuFactory")],Ah);var xh=class e extends s.B{constructor(t,i,s,r,a){super(),this.column=t,this.restoreFocusParams=i,this.initialSelection=s,this.restrictTo=r,this.sourceElement=a,this.tabFactories={},this.includeChecks={},this.tabFactories[e.TAB_GENERAL]=this.createMainPanel.bind(this),this.tabFactories[e.TAB_FILTER]=this.createFilterPanel.bind(this),this.tabFactories[e.TAB_COLUMNS]=this.createColumnsPanel.bind(this),this.includeChecks[e.TAB_GENERAL]=()=>!0,this.includeChecks[e.TAB_FILTER]=()=>!!t&&this.filterManager.isFilterAllowed(t),this.includeChecks[e.TAB_COLUMNS]=()=>!0}init(){const e=this.getTabsToCreate().map((e=>this.createTab(e)));this.tabbedLayout=new s.b_({items:e,cssClass:"ag-menu",onActiveItemClicked:this.onHidePopup.bind(this),onItemClicked:this.onTabItemClicked.bind(this)}),this.createBean(this.tabbedLayout),this.mainMenuList&&this.mainMenuList.setParentComponent(this.tabbedLayout),this.addDestroyFunc((()=>this.destroyBean(this.tabbedLayout)))}getTabsToCreate(){var t,i;return this.restrictTo?this.restrictTo:(null!=(i=null==(t=this.column)?void 0:t.getColDef().menuTabs)?i:e.TABS_DEFAULT).filter((e=>this.isValidMenuTabItem(e))).filter((e=>this.isNotSuppressed(e))).filter((e=>this.isModuleLoaded(e)))}isModuleLoaded(t){return t!==e.TAB_COLUMNS||s.e.__isRegistered(s.M.ColumnsToolPanelModule,this.context.getGridId())}isValidMenuTabItem(t){let i=!0,s=e.TABS_DEFAULT;return null!=this.restrictTo&&(i=this.restrictTo.indexOf(t)>-1,s=this.restrictTo),i=i&&e.TABS_DEFAULT.indexOf(t)>-1,i||console.warn(`AG Grid: Trying to render an invalid menu item '${t}'. Check that your 'menuTabs' contains one of [${s}]`),i}isNotSuppressed(e){return this.includeChecks[e]()}createTab(e){return this.tabFactories[e]()}showTabBasedOnPreviousSelection(){this.showTab(this.initialSelection)}showTab(t){this.tabItemColumns&&t===e.TAB_COLUMNS?this.tabbedLayout.showItem(this.tabItemColumns):this.tabItemFilter&&t===e.TAB_FILTER?this.tabbedLayout.showItem(this.tabItemFilter):this.tabItemGeneral&&t===e.TAB_GENERAL?this.tabbedLayout.showItem(this.tabItemGeneral):this.tabbedLayout.showFirstItem()}onTabItemClicked(t){let i=null;switch(t.item){case this.tabItemColumns:i=e.TAB_COLUMNS;break;case this.tabItemFilter:i=e.TAB_FILTER;break;case this.tabItemGeneral:i=e.TAB_GENERAL}i&&this.activateTab(i)}activateTab(t){const i={type:e.EVENT_TAB_SELECTED,key:t};this.dispatchEvent(i)}createMainPanel(){return this.mainMenuList=this.columnMenuFactory.createMenu(this,this.column,(()=>{var e;return null!=(e=this.sourceElement)?e:this.getGui()})),this.mainMenuList.addEventListener(s.u.EVENT_CLOSE_MENU,this.onHidePopup.bind(this)),this.tabItemGeneral={title:s.ch.createIconNoSpan("menu",this.gridOptionsService,this.column),titleLabel:e.TAB_GENERAL.replace("MenuTab",""),bodyPromise:s.D.resolve(this.mainMenuList.getGui()),name:e.TAB_GENERAL},this.tabItemGeneral}onHidePopup(e){this.menuUtils.closePopupAndRestoreFocusOnSelect(this.hidePopupFunc,this.restoreFocusParams,e)}createFilterPanel(){const t=this.column?this.filterManager.getOrCreateFilterWrapper(this.column,"COLUMN_MENU"):null;if(!t)throw new Error("AG Grid - Unable to instantiate filter");return this.tabItemFilter={title:s.ch.createIconNoSpan("filter",this.gridOptionsService,this.column),titleLabel:e.TAB_FILTER.replace("MenuTab",""),bodyPromise:null==t?void 0:t.guiPromise,afterAttachedCallback:e=>{null!=t&&t.filterPromise&&t.filterPromise.then((t=>{t&&t.afterGuiAttached&&t.afterGuiAttached(e)}))},afterDetachedCallback:()=>{var e;return null==(e=null==t?void 0:t.filterPromise)?void 0:e.then((e=>{var t;return null==(t=null==e?void 0:e.afterGuiDetached)?void 0:t.call(e)}))},name:e.TAB_FILTER},this.tabItemFilter}createColumnsPanel(){const t=document.createElement("div");t.classList.add("ag-menu-column-select-wrapper");const i=this.columnChooserFactory.createColumnSelectPanel(this,this.column).getGui();return i.classList.add("ag-menu-column-select"),t.appendChild(i),this.tabItemColumns={title:s.ch.createIconNoSpan("columns",this.gridOptionsService,this.column),titleLabel:e.TAB_COLUMNS.replace("MenuTab",""),bodyPromise:s.D.resolve(t),name:e.TAB_COLUMNS},this.tabItemColumns}afterGuiAttached(e){const{container:t,hidePopup:i}=e;this.tabbedLayout.setAfterAttachedParams({container:t,hidePopup:i}),i&&(this.hidePopupFunc=i,this.addDestroyFunc(i))}getGui(){return this.tabbedLayout.getGui()}};xh.EVENT_TAB_SELECTED="tabSelected",xh.TAB_FILTER="filterMenuTab",xh.TAB_GENERAL="generalMenuTab",xh.TAB_COLUMNS="columnsMenuTab",xh.TABS_DEFAULT=[xh.TAB_GENERAL,xh.TAB_FILTER,xh.TAB_COLUMNS],wh([(0,s.A)("filterManager")],xh.prototype,"filterManager",2),wh([(0,s.A)("columnChooserFactory")],xh.prototype,"columnChooserFactory",2),wh([(0,s.A)("columnMenuFactory")],xh.prototype,"columnMenuFactory",2),wh([(0,s.A)("menuUtils")],xh.prototype,"menuUtils",2),wh([s.a],xh.prototype,"init",1);var Th=xh,Mh=class extends s.ak{constructor(e,t,i){super('\n            <div ref="eColumnMenu" role="presentation" class="ag-menu ag-column-menu"></div>\n        '),this.column=e,this.restoreFocusParams=t,this.sourceElement=i}init(){this.mainMenuList=this.columnMenuFactory.createMenu(this,this.column,(()=>{var e;return null!=(e=this.sourceElement)?e:this.getGui()})),this.mainMenuList.addEventListener(s.u.EVENT_CLOSE_MENU,this.onHidePopup.bind(this)),this.eColumnMenu.appendChild(this.mainMenuList.getGui())}onHidePopup(e){this.menuUtils.closePopupAndRestoreFocusOnSelect(this.hidePopupFunc,this.restoreFocusParams,e)}afterGuiAttached(e){let{hidePopup:t}=e;t&&(this.hidePopupFunc=t,this.addDestroyFunc(t)),this.focusService.focusInto(this.mainMenuList.getGui())}};wh([(0,s.A)("columnMenuFactory")],Mh.prototype,"columnMenuFactory",2),wh([(0,s.A)("menuUtils")],Mh.prototype,"menuUtils",2),wh([(0,s.A)("focusService")],Mh.prototype,"focusService",2),wh([(0,s.R)("eColumnMenu")],Mh.prototype,"eColumnMenu",2),wh([s.a],Mh.prototype,"init",1);var Ph="ag-context-menu-open",Fh=class extends s.B{hideActiveMenu(){this.destroyBean(this.activeMenu)}getMenuItems(e,t,i){const r=[];if(s.ch.exists(e)&&s.e.__isRegistered(s.M.ClipboardModule,this.context.getGridId())&&t&&(this.gridOptionsService.get("suppressCutToClipboard")||r.push("cut"),r.push("copy","copyWithHeaders","copyWithGroupHeaders","paste","separator")),this.gridOptionsService.get("enableCharts")&&s.e.__isRegistered(s.M.GridChartsModule,this.context.getGridId())&&(this.columnModel.isPivotMode()&&r.push("pivotChart"),this.rangeService&&!this.rangeService.isEmpty()&&r.push("chartRange")),s.ch.exists(e)){const e=!s.e.__isRegistered(s.M.CsvExportModule,this.context.getGridId()),t=!s.e.__isRegistered(s.M.ExcelExportModule,this.context.getGridId()),i=this.gridOptionsService.get("suppressExcelExport")||t,a=this.gridOptionsService.get("suppressCsvExport")||e;!s.ch.isIOSUserAgent()&&(!i||!a)&&r.push("export")}const a=r.length?r:void 0,o=null==t?void 0:t.getColDef().contextMenuItems;if(Array.isArray(o))return o;if("function"==typeof o)return o(this.gridOptionsService.addGridCommonParams({column:t,node:e,value:i,defaultItems:a}));{const s=this.gridOptionsService.getCallback("getContextMenuItems");return s?s({column:t,node:e,value:i,defaultItems:a}):r}}onContextMenu(e,t,i,s,r,a){this.menuUtils.onContextMenu(e,t,(e=>this.showMenu(i,s,r,e,a)))}showMenu(e,t,i,r,a){const o=this.getMenuItems(e,t,i),n=this.ctrlsService.getGridBodyCtrl().getGui();if(void 0===o||s.ch.missingOrEmpty(o))return!1;const l=new Dh(o,t,e,i);this.createBean(l);const d=l.getGui(),h={column:t,rowNode:e,type:"contextMenu",mouseEvent:r,ePopup:d,nudgeY:1},c=this.localeService.getLocaleTextFunc(),u=this.popupService.addPopup({modal:!0,eChild:d,closeOnEsc:!0,closedCallback:()=>{n.classList.remove(Ph),this.destroyBean(l)},click:r,positionCallback:()=>{const e=this.gridOptionsService.get("enableRtl");this.popupService.positionPopupUnderMouseEvent(bh(Eh({},h),{nudgeX:e?-1*(d.offsetWidth+1):1}))},anchorToElement:a,ariaLabel:c("ariaLabelContextMenu","Context Menu")});return u&&(n.classList.add(Ph),l.afterGuiAttached({container:"contextMenu",hidePopup:u.hideFunc})),this.activeMenu&&this.hideActiveMenu(),this.activeMenu=l,l.addEventListener(s.B.EVENT_DESTROYED,(()=>{this.activeMenu===l&&(this.activeMenu=null)})),u&&l.addEventListener(s.u.EVENT_CLOSE_MENU,u.hideFunc),!0}};wh([(0,s.A)("popupService")],Fh.prototype,"popupService",2),wh([(0,s.O)("rangeService")],Fh.prototype,"rangeService",2),wh([(0,s.A)("ctrlsService")],Fh.prototype,"ctrlsService",2),wh([(0,s.A)("columnModel")],Fh.prototype,"columnModel",2),wh([(0,s.A)("menuUtils")],Fh.prototype,"menuUtils",2),Fh=wh([(0,s._)("contextMenuFactory")],Fh);var Dh=class extends s.ak{constructor(e,t,i,s){super('<div class="ag-menu" role="presentation"></div>'),this.menuItems=e,this.column=t,this.node=i,this.value=s,this.menuList=null,this.focusedCell=null}addMenuItems(){const e=this.createManagedBean(new s.w(0,{column:this.column,node:this.node,value:this.value})),t=this.menuItemMapper.mapWithStockItems(this.menuItems,null,(()=>this.getGui()));e.addMenuItems(t),this.appendChild(e),this.menuList=e,e.addEventListener(s.u.EVENT_CLOSE_MENU,(e=>this.dispatchEvent(e)))}afterGuiAttached(e){e.hidePopup&&this.addDestroyFunc(e.hidePopup),this.focusedCell=this.focusService.getFocusedCell(),this.menuList&&this.focusService.focusInto(this.menuList.getGui())}restoreFocusedCell(){const e=this.focusService.getFocusedCell();if(e&&this.focusedCell&&this.cellPositionUtils.equals(e,this.focusedCell)){const{rowIndex:e,rowPinned:t,column:i}=this.focusedCell,s=this.gridOptionsService.getDocument();s.activeElement===s.body&&this.focusService.setFocusedCell({rowIndex:e,column:i,rowPinned:t,forceBrowserFocus:!0})}}destroy(){this.restoreFocusedCell(),super.destroy()}};wh([(0,s.A)("menuItemMapper")],Dh.prototype,"menuItemMapper",2),wh([(0,s.A)("focusService")],Dh.prototype,"focusService",2),wh([(0,s.A)("cellPositionUtils")],Dh.prototype,"cellPositionUtils",2),wh([s.a],Dh.prototype,"addMenuItems",1);var Rh=class extends s.B{mapWithStockItems(e,t,i){if(!e)return[];const s=[];return e.forEach((e=>{let r;if(r="string"==typeof e?this.getStockMenuItem(e,t,i):Eh({},e),!r)return;const a=r,{subMenu:o}=a;o&&o instanceof Array&&(a.subMenu=this.mapWithStockItems(o,t,i)),null!=r&&s.push(r)})),s}getStockMenuItem(e,t,i){var r;const a=this.localeService.getLocaleTextFunc(),o=this.gridOptionsService.get("skipHeaderOnAutoSize");switch(e){case"pinSubMenu":return{name:a("pinColumn","Pin Column"),icon:s.ch.createIconNoSpan("menuPin",this.gridOptionsService,null),subMenu:["clearPinned","pinLeft","pinRight"]};case"pinLeft":return{name:a("pinLeft","Pin Left"),action:()=>this.columnModel.setColumnsPinned([t],"left","contextMenu"),checked:!!t&&t.isPinnedLeft()};case"pinRight":return{name:a("pinRight","Pin Right"),action:()=>this.columnModel.setColumnsPinned([t],"right","contextMenu"),checked:!!t&&t.isPinnedRight()};case"clearPinned":return{name:a("noPin","No Pin"),action:()=>this.columnModel.setColumnsPinned([t],null,"contextMenu"),checked:!!t&&!t.isPinned()};case"valueAggSubMenu":return s.e.__assertRegistered(s.M.RowGroupingModule,"Aggregation from Menu",this.context.getGridId())&&(null!=t&&t.isPrimary()||null!=t&&t.getColDef().pivotValueColumn)?{name:a("valueAggregation","Value Aggregation"),icon:s.ch.createIconNoSpan("menuValue",this.gridOptionsService,null),subMenu:this.createAggregationSubMenu(t)}:null;case"autoSizeThis":return{name:a("autosizeThiscolumn","Autosize This Column"),action:()=>this.columnModel.autoSizeColumn(t,"contextMenu",o)};case"autoSizeAll":return{name:a("autosizeAllColumns","Autosize All Columns"),action:()=>this.columnModel.autoSizeAllColumns("contextMenu",o)};case"rowGroup":return{name:a("groupBy","Group by")+" "+s.ch.escapeString(this.columnModel.getDisplayNameForColumn(t,"header")),disabled:(null==t?void 0:t.isRowGroupActive())||!(null!=t&&t.getColDef().enableRowGroup),action:()=>this.columnModel.addRowGroupColumns([t],"contextMenu"),icon:s.ch.createIconNoSpan("menuAddRowGroup",this.gridOptionsService,null)};case"rowUnGroup":const n=s.ch.createIconNoSpan("menuRemoveRowGroup",this.gridOptionsService,null),l=null==t?void 0:t.getColDef().showRowGroup,d=this.gridOptionsService.get("groupLockGroupColumns");if(!0===l)return{name:a("ungroupAll","Un-Group All"),disabled:-1===d||d>=this.columnModel.getRowGroupColumns().length,action:()=>this.columnModel.setRowGroupColumns(this.columnModel.getRowGroupColumns().slice(0,d),"contextMenu"),icon:n};if("string"==typeof l){const e=this.columnModel.getPrimaryColumn(l),t=null!=e?s.ch.escapeString(this.columnModel.getDisplayNameForColumn(e,"header")):l;return{name:a("ungroupBy","Un-Group by")+" "+t,disabled:null!=e&&this.columnModel.isColumnGroupingLocked(e),action:()=>this.columnModel.removeRowGroupColumns([l],"contextMenu"),icon:n}}return{name:a("ungroupBy","Un-Group by")+" "+s.ch.escapeString(this.columnModel.getDisplayNameForColumn(t,"header")),disabled:!(null!=t&&t.isRowGroupActive())||!(null!=t&&t.getColDef().enableRowGroup)||this.columnModel.isColumnGroupingLocked(t),action:()=>this.columnModel.removeRowGroupColumns([t],"contextMenu"),icon:n};case"resetColumns":return{name:a("resetColumns","Reset Columns"),action:()=>this.columnModel.resetColumnState("contextMenu")};case"expandAll":return{name:a("expandAll","Expand All Row Groups"),action:()=>this.gridApi.expandAll()};case"contractAll":return{name:a("collapseAll","Collapse All Row Groups"),action:()=>this.gridApi.collapseAll()};case"copy":return s.e.__assertRegistered(s.M.ClipboardModule,"Copy from Menu",this.context.getGridId())?{name:a("copy","Copy"),shortcut:a("ctrlC","Ctrl+C"),icon:s.ch.createIconNoSpan("clipboardCopy",this.gridOptionsService,null),action:()=>this.clipboardService.copyToClipboard()}:null;case"copyWithHeaders":return s.e.__assertRegistered(s.M.ClipboardModule,"Copy with Headers from Menu",this.context.getGridId())?{name:a("copyWithHeaders","Copy with Headers"),icon:s.ch.createIconNoSpan("clipboardCopy",this.gridOptionsService,null),action:()=>this.clipboardService.copyToClipboard({includeHeaders:!0})}:null;case"copyWithGroupHeaders":return s.e.__assertRegistered(s.M.ClipboardModule,"Copy with Group Headers from Menu",this.context.getGridId())?{name:a("copyWithGroupHeaders","Copy with Group Headers"),icon:s.ch.createIconNoSpan("clipboardCopy",this.gridOptionsService,null),action:()=>this.clipboardService.copyToClipboard({includeHeaders:!0,includeGroupHeaders:!0})}:null;case"cut":if(s.e.__assertRegistered(s.M.ClipboardModule,"Cut from Menu",this.context.getGridId())){const e=this.focusService.getFocusedCell(),t=e?this.rowPositionUtils.getRowNode(e):null,i=!!t&&(null==e?void 0:e.column.isCellEditable(t));return{name:a("cut","Cut"),shortcut:a("ctrlX","Ctrl+X"),icon:s.ch.createIconNoSpan("clipboardCut",this.gridOptionsService,null),disabled:!i||this.gridOptionsService.get("suppressCutToClipboard"),action:()=>this.clipboardService.cutToClipboard(void 0,"contextMenu")}}return null;case"paste":return s.e.__assertRegistered(s.M.ClipboardModule,"Paste from Clipboard",this.context.getGridId())?{name:a("paste","Paste"),shortcut:a("ctrlV","Ctrl+V"),disabled:!0,icon:s.ch.createIconNoSpan("clipboardPaste",this.gridOptionsService,null),action:()=>this.clipboardService.pasteFromClipboard()}:null;case"export":const h=[],c=s.e.__isRegistered(s.M.CsvExportModule,this.context.getGridId()),u=s.e.__isRegistered(s.M.ExcelExportModule,this.context.getGridId());return!this.gridOptionsService.get("suppressCsvExport")&&c&&h.push("csvExport"),!this.gridOptionsService.get("suppressExcelExport")&&u&&h.push("excelExport"),{name:a("export","Export"),subMenu:h,icon:s.ch.createIconNoSpan("save",this.gridOptionsService,null)};case"csvExport":return{name:a("csvExport","CSV Export"),icon:s.ch.createIconNoSpan("csvExport",this.gridOptionsService,null),action:()=>this.gridApi.exportDataAsCsv({})};case"excelExport":return{name:a("excelExport","Excel Export"),icon:s.ch.createIconNoSpan("excelExport",this.gridOptionsService,null),action:()=>this.gridApi.exportDataAsExcel()};case"separator":return"separator";case"pivotChart":case"chartRange":return null!=(r=this.chartMenuItemMapper.getChartItems(e))?r:null;case"columnFilter":return t?{name:a("columnFilter","Column Filter"),icon:s.ch.createIconNoSpan("filter",this.gridOptionsService,null),action:()=>this.menuService.showFilterMenu({column:t,buttonElement:i(),containerType:"columnFilter",positionBy:"button"})}:null;case"columnChooser":return s.e.__isRegistered(s.M.ColumnsToolPanelModule,this.context.getGridId())?{name:a("columnChooser","Choose Columns"),icon:s.ch.createIconNoSpan("columns",this.gridOptionsService,null),action:()=>this.menuService.showColumnChooser({column:t,eventSource:i()})}:null;case"sortAscending":return{name:a("sortAscending","Sort Ascending"),icon:s.ch.createIconNoSpan("sortAscending",this.gridOptionsService,null),action:()=>this.sortController.setSortForColumn(t,"asc",!1,"columnMenu")};case"sortDescending":return{name:a("sortDescending","Sort Descending"),icon:s.ch.createIconNoSpan("sortDescending",this.gridOptionsService,null),action:()=>this.sortController.setSortForColumn(t,"desc",!1,"columnMenu")};case"sortUnSort":return{name:a("sortUnSort","Clear Sort"),icon:s.ch.createIconNoSpan("sortUnSort",this.gridOptionsService,null),action:()=>this.sortController.setSortForColumn(t,null,!1,"columnMenu")};default:return console.warn(`AG Grid: unknown menu item type ${e}`),null}}createAggregationSubMenu(e){const t=this.localeService.getLocaleTextFunc();let i;if(e.isPrimary())i=e;else{const t=e.getColDef().pivotValueColumn;i=s.ch.exists(t)?t:void 0}const r=[];if(i){const e=i.isValueActive(),s=this.aggFuncService.getFuncNames(i);r.push({name:t("noAggregation","None"),action:()=>{this.columnModel.removeValueColumns([i],"contextMenu"),this.columnModel.setColumnAggFunc(i,void 0,"contextMenu")},checked:!e}),s.forEach((s=>{r.push({name:t(s,this.aggFuncService.getDefaultFuncLabel(s)),action:()=>{this.columnModel.setColumnAggFunc(i,s,"contextMenu"),this.columnModel.addValueColumns([i],"contextMenu")},checked:e&&i.getAggFunc()===s})}))}return r}};wh([(0,s.A)("columnModel")],Rh.prototype,"columnModel",2),wh([(0,s.A)("gridApi")],Rh.prototype,"gridApi",2),wh([(0,s.O)("clipboardService")],Rh.prototype,"clipboardService",2),wh([(0,s.O)("aggFuncService")],Rh.prototype,"aggFuncService",2),wh([(0,s.A)("focusService")],Rh.prototype,"focusService",2),wh([(0,s.A)("rowPositionUtils")],Rh.prototype,"rowPositionUtils",2),wh([(0,s.A)("chartMenuItemMapper")],Rh.prototype,"chartMenuItemMapper",2),wh([(0,s.A)("menuService")],Rh.prototype,"menuService",2),wh([(0,s.A)("sortController")],Rh.prototype,"sortController",2),Rh=wh([(0,s._)("menuItemMapper")],Rh);var Lh=class extends s.B{getChartItems(e){var t,i;if(!this.chartService)return void s.e.__assertRegistered(s.M.GridChartsModule,`the Context Menu key "${e}"`,this.context.getGridId());const r="pivotChart"===e?new Ih(this.gridOptionsService,this.chartService,this.localeService):new Oh(this.gridOptionsService,this.chartService,this.localeService),a=this.chartService.isEnterprise();let o=r.getMenuItem();if(o&&o.subMenu&&!a){const e=t=>{var i;return bh(Eh({},t),{subMenu:null==(i=t.subMenu)?void 0:i.filter((e=>!e._enterprise)).map((t=>e(t)))})};o=e(o)}const n=null==(i=null==(t=this.gridOptionsService.get("chartToolPanelsDef"))?void 0:t.settingsPanel)?void 0:i.chartGroupsDef;return n&&(o=Lh.filterAndOrderChartMenu(o,n,r.getConfigLookup())),this.cleanInternals(o)}cleanInternals(e){if(!e)return e;const t=e=>{var i;return null==e||delete e._key,null==e||delete e._enterprise,null==(i=null==e?void 0:e.subMenu)||i.forEach((e=>t(e))),e};return t(e)}static buildLookup(e){let t={};const i=e=>{t[e._key]=e,e.subMenu&&e.subMenu.forEach((e=>i(e)))};return i(e),t}static filterAndOrderChartMenu(e,t,i){var r;const a=this.buildLookup(e);let o=bh(Eh({},e),{subMenu:[]});if(Object.entries(t).forEach((e=>{let[t,r]=e;var n,l;const d=i[t];if(null===d)return;if(null==d)return void s.ch.warnOnce(`invalid chartGroupsDef config '${t}'`);const h=a[d._key];if(h)if(h.subMenu){const e=r.map((e=>{const i=d[e];if(null!=i)return a[i];s.ch.warnOnce(`invalid chartGroupsDef config '${t}.${e}'`)})).filter((e=>void 0!==e));e.length>0&&(h.subMenu=e,null==(n=o.subMenu)||n.push(h))}else null==(l=o.subMenu)||l.push(h)})),0!=(null==(r=o.subMenu)?void 0:r.length))return o}};wh([(0,s.O)("chartService")],Lh.prototype,"chartService",2),Lh=wh([(0,s._)("chartMenuItemMapper")],Lh);var Ih=class{constructor(e,t,i){this.gridOptionsService=e,this.chartService=t,this.localeService=i}getMenuItem(){var e=this;const t=this.localeService.getLocaleTextFunc(),i=function(i,s,r,a){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return{name:t(i,s),action:()=>e.chartService.createPivotChart({chartType:r}),_key:a,_enterprise:o}};return{name:t("pivotChart","Pivot Chart"),_key:"pivotChart",subMenu:[{_key:"pivotColumnChart",name:t("columnChart","Column"),subMenu:[i("groupedColumn","Grouped&lrm;","groupedColumn","pivotGroupedColumn"),i("stackedColumn","Stacked&lrm;","stackedColumn","pivotStackedColumn"),i("normalizedColumn","100% Stacked&lrm;","normalizedColumn","pivotNormalizedColumn")]},{_key:"pivotBarChart",name:t("barChart","Bar"),subMenu:[i("groupedBar","Grouped&lrm;","groupedBar","pivotGroupedBar"),i("stackedBar","Stacked&lrm;","stackedBar","pivotStackedBar"),i("normalizedBar","100% Stacked&lrm;","normalizedBar","pivotNormalizedBar")]},{_key:"pivotPieChart",name:t("pieChart","Pie"),subMenu:[i("pie","Pie&lrm;","pie","pivotPie"),i("donut","Donut&lrm;","donut","pivotDonut")]},i("line","Line&lrm;","line","pivotLineChart"),{_key:"pivotXYChart",name:t("xyChart","X Y (Scatter)"),subMenu:[i("scatter","Scatter&lrm;","scatter","pivotScatter"),i("bubble","Bubble&lrm;","bubble","pivotBubble")]},{_key:"pivotAreaChart",name:t("areaChart","Area"),subMenu:[i("area","Area&lrm;","area","pivotArea"),i("stackedArea","Stacked&lrm;","stackedArea","pivotStackedArea"),i("normalizedArea","100% Stacked&lrm;","normalizedArea","pivotNormalizedArea")]},{_key:"pivotStatisticalChart",_enterprise:!1,name:t("statisticalChart","Statistical"),subMenu:[i("histogramChart","Histogram&lrm;","histogram","pivotHistogram",!1)]},{_key:"pivotHierarchicalChart",_enterprise:!0,name:t("hierarchicalChart","Hierarchical"),subMenu:[i("treemapChart","Treemap&lrm;","treemap","pivotTreemap",!0),i("sunburstChart","Sunburst&lrm;","sunburst","pivotSunburst",!0)]},{_key:"pivotCombinationChart",name:t("combinationChart","Combination"),subMenu:[i("columnLineCombo","Column & Line&lrm;","columnLineCombo","pivotColumnLineCombo"),i("AreaColumnCombo","Area & Column&lrm;","areaColumnCombo","pivotAreaColumnCombo")]}],icon:s.ch.createIconNoSpan("chart",this.gridOptionsService,void 0)}}getConfigLookup(){return{columnGroup:{_key:"pivotColumnChart",column:"pivotGroupedColumn",stackedColumn:"pivotStackedColumn",normalizedColumn:"pivotNormalizedColumn"},barGroup:{_key:"pivotBarChart",bar:"pivotGroupedBar",stackedBar:"pivotStackedBar",normalizedBar:"pivotNormalizedBar"},pieGroup:{_key:"pivotPieChart",pie:"pivotPie",donut:"pivotDonut",doughnut:"pivotDonut"},lineGroup:{_key:"pivotLineChart",line:"pivotLineChart"},scatterGroup:{_key:"pivotXYChart",bubble:"pivotBubble",scatter:"pivotScatter"},areaGroup:{_key:"pivotAreaChart",area:"pivotArea",stackedArea:"pivotStackedArea",normalizedArea:"pivotNormalizedArea"},combinationGroup:{_key:"pivotCombinationChart",columnLineCombo:"pivotColumnLineCombo",areaColumnCombo:"pivotAreaColumnCombo",customCombo:null},hierarchicalGroup:{_key:"pivotHierarchicalChart",treemap:"pivotTreemap",sunburst:"pivotSunburst"},statisticalGroup:{_key:"pivotStatisticalChart",histogram:"pivotHistogram",rangeBar:null,rangeArea:null,boxPlot:null},polarGroup:null,specializedGroup:null}}},Oh=class{constructor(e,t,i){this.gridOptionsService=e,this.chartService=t,this.localeService=i}getMenuItem(){var e=this;const t=this.localeService.getLocaleTextFunc(),i=function(i,s,r,a){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return{name:t(i,s),action:()=>e.chartService.createChartFromCurrentRange(r),_key:a,_enterprise:o}};return{name:t("chartRange","Chart Range"),_key:"chartRange",subMenu:[{name:t("columnChart","Column"),subMenu:[i("groupedColumn","Grouped&lrm;","groupedColumn","rangeGroupedColumn"),i("stackedColumn","Stacked&lrm;","stackedColumn","rangeStackedColumn"),i("normalizedColumn","100% Stacked&lrm;","normalizedColumn","rangeNormalizedColumn")],_key:"rangeColumnChart"},{name:t("barChart","Bar"),subMenu:[i("groupedBar","Grouped&lrm;","groupedBar","rangeGroupedBar"),i("stackedBar","Stacked&lrm;","stackedBar","rangeStackedBar"),i("normalizedBar","100% Stacked&lrm;","normalizedBar","rangeNormalizedBar")],_key:"rangeBarChart"},{name:t("pieChart","Pie"),subMenu:[i("pie","Pie&lrm;","pie","rangePie"),i("donut","Donut&lrm;","donut","rangeDonut")],_key:"rangePieChart"},i("line","Line&lrm;","line","rangeLineChart"),{name:t("xyChart","X Y (Scatter)"),subMenu:[i("scatter","Scatter&lrm;","scatter","rangeScatter"),i("bubble","Bubble&lrm;","bubble","rangeBubble")],_key:"rangeXYChart"},{name:t("areaChart","Area"),subMenu:[i("area","Area&lrm;","area","rangeArea"),i("stackedArea","Stacked&lrm;","stackedArea","rangeStackedArea"),i("normalizedArea","100% Stacked&lrm;","normalizedArea","rangeNormalizedArea")],_key:"rangeAreaChart"},{name:t("polarChart","Polar"),subMenu:[i("radarLine","Radar Line&lrm;","radarLine","rangeRadarLine"),i("radarArea","Radar Area&lrm;","radarArea","rangeRadarArea"),i("nightingale","Nightingale&lrm;","nightingale","rangeNightingale"),i("radialColumn","Radial Column&lrm;","radialColumn","rangeRadialColumn"),i("radialBar","Radial Bar&lrm;","radialBar","rangeRadialBar")],_key:"rangePolarChart",_enterprise:!0},{name:t("statisticalChart","Statistical"),subMenu:[i("boxPlot","Box Plot&lrm;","boxPlot","rangeBoxPlot",!0),i("histogramChart","Histogram&lrm;","histogram","rangeHistogram",!1),i("rangeBar","Range Bar&lrm;","rangeBar","rangeRangeBar",!0),i("rangeArea","Range Area&lrm;","rangeArea","rangeRangeArea",!0)],_key:"rangeStatisticalChart",_enterprise:!1},{name:t("hierarchicalChart","Hierarchical"),subMenu:[i("treemap","Treemap&lrm;","treemap","rangeTreemap"),i("sunburst","Sunburst&lrm;","sunburst","rangeSunburst")],_key:"rangeHierarchicalChart",_enterprise:!0},{name:t("specializedChart","Specialized"),subMenu:[i("heatmap","Heatmap&lrm;","heatmap","rangeHeatmap"),i("waterfall","Waterfall&lrm;","waterfall","rangeWaterfall")],_key:"rangeSpecializedChart",_enterprise:!0},{name:t("combinationChart","Combination"),subMenu:[i("columnLineCombo","Column & Line&lrm;","columnLineCombo","rangeColumnLineCombo"),i("AreaColumnCombo","Area & Column&lrm;","areaColumnCombo","rangeAreaColumnCombo")],_key:"rangeCombinationChart"}],icon:s.ch.createIconNoSpan("chart",this.gridOptionsService,void 0)}}getConfigLookup(){return{columnGroup:{_key:"rangeColumnChart",column:"rangeGroupedColumn",stackedColumn:"rangeStackedColumn",normalizedColumn:"rangeNormalizedColumn"},barGroup:{_key:"rangeBarChart",bar:"rangeGroupedBar",stackedBar:"rangeStackedBar",normalizedBar:"rangeNormalizedBar"},pieGroup:{_key:"rangePieChart",pie:"rangePie",donut:"rangeDonut",doughnut:"rangeDonut"},lineGroup:{_key:"rangeLineChart",line:"rangeLineChart"},scatterGroup:{_key:"rangeXYChart",bubble:"rangeBubble",scatter:"rangeScatter"},areaGroup:{_key:"rangeAreaChart",area:"rangeArea",stackedArea:"rangeStackedArea",normalizedArea:"rangeNormalizedArea"},polarGroup:{_key:"rangePolarChart",radarLine:"rangeRadarLine",radarArea:"rangeRadarArea",nightingale:"rangeNightingale",radialColumn:"rangeRadialColumn",radialBar:"rangeRadialBar"},statisticalGroup:{_key:"rangeStatisticalChart",boxPlot:"rangeBoxPlot",histogram:"rangeHistogram",rangeBar:"rangeRangeBar",rangeArea:"rangeRangeArea"},hierarchicalGroup:{_key:"rangeHierarchicalChart",treemap:"rangeTreemap",sunburst:"rangeSunburst"},specializedGroup:{_key:"rangeSpecializedChart",heatmap:"rangeHeatmap",waterfall:"rangeWaterfall"},combinationGroup:{_key:"rangeCombinationChart",columnLineCombo:"rangeColumnLineCombo",areaColumnCombo:"rangeAreaColumnCombo",customCombo:null}}}},Nh=class extends s.B{createColumnSelectPanel(e,t,i,s){var r,a;const o=e.createManagedBean(new Dn),n=null!=(a=null!=(r=s??(null==t?void 0:t.getColDef().columnChooserParams))?r:null==t?void 0:t.getColDef().columnsMenuParams)?a:{},{contractColumnSelection:l,suppressColumnExpandAll:d,suppressColumnFilter:h,suppressColumnSelectAll:c,suppressSyncLayoutWithGrid:u,columnLayout:p}=n;return o.init(!!i,this.gridOptionsService.addGridCommonParams({suppressColumnMove:!1,suppressValues:!1,suppressPivots:!1,suppressRowGroups:!1,suppressPivotMode:!1,contractColumnSelection:!!l,suppressColumnExpandAll:!!d,suppressColumnFilter:!!h,suppressColumnSelectAll:!!c,suppressSyncLayoutWithGrid:!!p||!!u,onStateUpdated:()=>{}}),"columnMenu"),p&&o.setColumnLayout(p),o}showColumnChooser(e){let{column:t,chooserParams:i,eventSource:r}=e;this.hideActiveColumnChooser();const a=this.createColumnSelectPanel(this,t,!0,i),o=this.localeService.getLocaleTextFunc(),n=this.columnModel.getAllDisplayedColumns().indexOf(t),l=t?this.focusService.getFocusedHeader():null;this.activeColumnChooserDialog=this.createBean(new s.n({title:o("chooseColumns","Choose Columns"),component:a,width:300,height:300,resizable:!0,movable:!0,centered:!0,closable:!0,afterGuiAttached:()=>{var e;null==(e=this.focusService.findNextFocusableElement(a.getGui()))||e.focus(),this.dispatchVisibleChangedEvent(!0,t)},closedCallback:e=>{const i=this.activeColumnChooser.getGui();this.destroyBean(this.activeColumnChooser),this.activeColumnChooser=void 0,this.activeColumnChooserDialog=void 0,this.dispatchVisibleChangedEvent(!1,t),t&&this.menuUtils.restoreFocusOnClose({column:t,headerPosition:l,columnIndex:n,eventSource:r},i,e,!0)}})),this.activeColumnChooser=a}hideActiveColumnChooser(){this.activeColumnChooserDialog&&this.destroyBean(this.activeColumnChooserDialog)}dispatchVisibleChangedEvent(e,t){const i={type:s.aA.EVENT_COLUMN_MENU_VISIBLE_CHANGED,visible:e,switchingTab:!1,key:"columnChooser",column:t??null};this.eventService.dispatchEvent(i)}};wh([(0,s.A)("focusService")],Nh.prototype,"focusService",2),wh([(0,s.A)("menuUtils")],Nh.prototype,"menuUtils",2),wh([(0,s.A)("columnModel")],Nh.prototype,"columnModel",2),Nh=wh([(0,s._)("columnChooserFactory")],Nh);var kh=class extends s.B{createMenu(e,t,i){const r=e.createManagedBean(new s.w(0,{column:t??null,node:null,value:null})),a=this.getMenuItems(t),o=this.menuItemMapper.mapWithStockItems(a,t??null,i);return r.addMenuItems(o),r}getMenuItems(e){const t=this.getDefaultMenuOptions(e);let i;const r=null==e?void 0:e.getColDef().mainMenuItems;if(Array.isArray(r))i=r;else if("function"==typeof r)i=r(this.gridOptionsService.addGridCommonParams({column:e,defaultItems:t}));else{const s=this.gridOptionsService.getCallback("getMainMenuItems");i=s&&e?s({column:e,defaultItems:t}):t}return s.ch.removeRepeatsFromArray(i,kh.MENU_ITEM_SEPARATOR),i}getDefaultMenuOptions(e){const t=[],i=this.menuService.isLegacyMenuEnabled();if(!e)return i||t.push("columnChooser"),t.push("resetColumns"),t;const s=!e.getColDef().lockPinned,r=this.columnModel.getRowGroupColumns().length,a=r>0,o=e.isAllowValue(),n=e.isAllowRowGroup(),l=e.isPrimary(),d=this.columnModel.isPivotMode(),h="clientSide"===this.rowModel.getType(),c=this.gridOptionsService.get("treeData"),u=l&&a&&o||!l;if(!i&&e.isSortable()){const i=e.getSort();"asc"!==i&&t.push("sortAscending"),"desc"!==i&&t.push("sortDescending"),i&&t.push("sortUnSort"),t.push(kh.MENU_ITEM_SEPARATOR)}return this.menuService.isFilterMenuItemEnabled(e)&&(t.push("columnFilter"),t.push(kh.MENU_ITEM_SEPARATOR)),s&&t.push("pinSubMenu"),u&&t.push("valueAggSubMenu"),(s||u)&&t.push(kh.MENU_ITEM_SEPARATOR),t.push("autoSizeThis"),t.push("autoSizeAll"),t.push(kh.MENU_ITEM_SEPARATOR),e.getColDef().showRowGroup?t.push("rowUnGroup"):n&&e.isPrimary()&&(e.isRowGroupActive()?this.columnModel.isColumnGroupingLocked(e)||t.push("rowUnGroup"):t.push("rowGroup")),t.push(kh.MENU_ITEM_SEPARATOR),i||t.push("columnChooser"),t.push("resetColumns"),h&&(c||r>(d?1:0))&&(t.push("expandAll"),t.push("contractAll")),t}};kh.MENU_ITEM_SEPARATOR="separator",wh([(0,s.A)("menuItemMapper")],kh.prototype,"menuItemMapper",2),wh([(0,s.A)("columnModel")],kh.prototype,"columnModel",2),wh([(0,s.A)("rowModel")],kh.prototype,"rowModel",2),wh([(0,s.A)("filterManager")],kh.prototype,"filterManager",2),wh([(0,s.A)("menuService")],kh.prototype,"menuService",2),kh=wh([(0,s._)("columnMenuFactory")],kh);var Gh=class extends s.B{restoreFocusOnClose(e,t,i,s){const{eventSource:r}=e,a=i instanceof KeyboardEvent;if(!s&&!a||!r)return;const o=this.gridOptionsService.getDocument();!t.contains(o.activeElement)&&o.activeElement!==o.body||this.focusHeaderCell(e)}closePopupAndRestoreFocusOnSelect(e,t,i){let s;i&&i.event&&i.event instanceof KeyboardEvent&&(s=i.event),e(s&&{keyboardEvent:s});const r=this.focusService.getFocusedCell(),a=this.gridOptionsService.getDocument();if(a.activeElement===a.body)if(r){const{rowIndex:e,rowPinned:t,column:i}=r;this.focusService.setFocusedCell({rowIndex:e,column:i,rowPinned:t,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}else this.focusHeaderCell(t)}onContextMenu(e,t,i){if(!this.gridOptionsService.get("allowContextMenuWithControlKey")&&e&&(e.ctrlKey||e.metaKey)||(e&&this.blockMiddleClickScrollsIfNeeded(e),this.gridOptionsService.get("suppressContextMenu")))return;i(e??t.touches[0])&&(e??t).preventDefault()}focusHeaderCell(e){const{column:t,columnIndex:i,headerPosition:r,eventSource:a}=e;if(this.columnModel.getAllDisplayedColumns().some((e=>e===t))&&a&&s.ch.isVisible(a)){const e=this.focusService.findTabbableParent(a);e&&(t&&this.headerNavigationService.scrollToColumn(t),e.focus())}else if(r&&-1!==i){const e=this.columnModel.getAllDisplayedColumns(),t=e[i]||s.ch.last(e);t&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:r.headerRowIndex,column:t}})}}blockMiddleClickScrollsIfNeeded(e){const{gridOptionsService:t}=this,{which:i}=e;t.get("suppressMiddleClickScrolls")&&2===i&&e.preventDefault()}};wh([(0,s.A)("focusService")],Gh.prototype,"focusService",2),wh([(0,s.A)("headerNavigationService")],Gh.prototype,"headerNavigationService",2),wh([(0,s.A)("columnModel")],Gh.prototype,"columnModel",2),Gh=wh([(0,s._)("menuUtils")],Gh);var Vh={version:"31.2.1",moduleName:s.M.MenuModule,beans:[Ah,Fh,Rh,Lh,Nh,kh,Gh],dependantModules:[E]},Bh=Object.defineProperty,_h=Object.defineProperties,Uh=Object.getOwnPropertyDescriptor,Hh=Object.getOwnPropertyDescriptors,Wh=Object.getOwnPropertySymbols,Kh=Object.prototype.hasOwnProperty,zh=Object.prototype.propertyIsEnumerable,$h=(e,t,i)=>t in e?Bh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,jh=(e,t)=>{for(var i in t||(t={}))Kh.call(t,i)&&$h(e,i,t[i]);if(Wh)for(var i of Wh(t))zh.call(t,i)&&$h(e,i,t[i]);return e},Yh=(e,t)=>_h(e,Hh(t)),qh=(e,t,i,s)=>{for(var r,a=s>1?void 0:s?Uh(t,i):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s?r(t,i,a):r(a))||a);return s&&a&&Bh(t,i,a),a},Xh=class e extends s.bY{constructor(){super('<div class="ag-multi-filter ag-menu-list-compact"></div>'),this.filterDefs=[],this.filters=[],this.guiDestroyFuncs=[],this.filterGuis=[],this.activeFilterIndices=[],this.lastActivatedMenuItem=null,this.afterFiltersReadyFuncs=[]}postConstruct(){this.initialiseTabGuard({onFocusIn:e=>this.onFocusIn(e)})}static getFilterDefs(e){const{filters:t}=e;return t&&t.length>0?t:[{filter:"agTextColumnFilter"},{filter:"agSetColumnFilter"}]}init(t){this.params=t,this.filterDefs=e.getFilterDefs(t);const{column:i,filterChangedCallback:r}=t;this.column=i,this.filterChangedCallback=r;const a=[];return this.filterDefs.forEach(((e,t)=>{const i=this.createFilter(e,t);null!=i&&a.push(i)})),new s.D((e=>{s.D.all(a).then((t=>{this.filters=t,this.refreshGui("columnMenu").then((()=>{e()}))}))})).then((()=>{this.afterFiltersReadyFuncs.forEach((e=>e())),this.afterFiltersReadyFuncs.length=0}))}refreshGui(e){return e===this.lastOpenedInContainer?s.D.resolve():(this.removeAllChildrenExceptTabGuards(),this.destroyChildren(),s.D.all(this.filters.map(((t,i)=>{const r=this.filterDefs[i],a=this.getFilterTitle(t,r);let o;if("subMenu"===r.display&&"toolPanel"!==e)o=this.insertFilterMenu(t,a).then((e=>e.getGui()));else if("subMenu"===r.display||"accordion"===r.display){const e=this.insertFilterGroup(t,a);o=s.D.resolve(e.getGui())}else o=s.D.resolve(t.getGui());return o}))).then((t=>{t.forEach(((e,t)=>{t>0&&this.appendChild(s.ch.loadTemplate('<div class="ag-filter-separator"></div>')),this.appendChild(e)})),this.filterGuis=t,this.lastOpenedInContainer=e})))}getFilterTitle(e,t){return null!=t.title?t.title:e instanceof s.bu?e.getFilterTitle():"Filter"}destroyChildren(){this.guiDestroyFuncs.forEach((e=>e())),this.guiDestroyFuncs.length=0,this.filterGuis.length=0}insertFilterMenu(e,t){const i=this.createBean(new s.u);return i.init({menuItemDef:{name:t,subMenu:[],cssClasses:["ag-multi-filter-menu-item"],menuItem:s.v,menuItemParams:{cssClassPrefix:"ag-compact-menu-option",isCompact:!0}},level:0,isAnotherSubMenuOpen:()=>!1,childComponent:e,contextParams:{column:null,node:null,value:null}}).then((()=>{i.setParentComponent(this),this.guiDestroyFuncs.push((()=>this.destroyBean(i))),this.addManagedListener(i,s.u.EVENT_MENU_ITEM_ACTIVATED,(e=>{this.lastActivatedMenuItem&&this.lastActivatedMenuItem!==e.menuItem&&this.lastActivatedMenuItem.deactivate(),this.lastActivatedMenuItem=e.menuItem}));const e=i.getGui();return i.addManagedListener(e,"keydown",(e=>{const{key:t}=e;switch(t){case s.b6.UP:case s.b6.RIGHT:case s.b6.DOWN:case s.b6.LEFT:e.preventDefault(),t===s.b6.RIGHT&&i.openSubMenu(!0)}})),i.addManagedListener(e,"focusin",(()=>i.activate())),i.addManagedListener(e,"focusout",(()=>{!i.isSubMenuOpen()&&!i.isSubMenuOpening()&&i.deactivate()})),i}))}insertFilterGroup(e,t){const i=this.createBean(new s.o({title:t,cssIdentifier:"multi-filter"}));return this.guiDestroyFuncs.push((()=>this.destroyBean(i))),i.addItem(e.getGui()),i.toggleGroupExpand(!1),e.afterGuiAttached&&i.addManagedListener(i,s.o.EVENT_EXPANDED,(()=>e.afterGuiAttached({container:this.lastOpenedInContainer,suppressFocus:!0,hidePopup:this.hidePopup}))),i}isFilterActive(){return this.filters.some((e=>e.isFilterActive()))}getLastActiveFilterIndex(){return this.activeFilterIndices.length>0?this.activeFilterIndices[this.activeFilterIndices.length-1]:null}doesFilterPass(e,t){let i=!0;return this.filters.forEach((s=>{!i||s===t||!s.isFilterActive()||(i=s.doesFilterPass(e))})),i}getFilterType(){return"multi"}getModelFromUi(){return{filterType:this.getFilterType(),filterModels:this.filters.map((e=>{const t=e;return"function"==typeof t.getModelFromUi?t.getModelFromUi():null}))}}getModel(){return this.isFilterActive()?{filterType:this.getFilterType(),filterModels:this.filters.map((e=>e.isFilterActive()?e.getModel():null))}:null}setModel(e){const t=(e,t)=>new s.D((i=>{const s=e.setModel(t);s?s.then((()=>i())):i()}));let i=[];return null==e?i=this.filters.map(((e,i)=>t(e,null).then((()=>{this.updateActiveList(i)})))):this.filters.forEach(((s,r)=>{const a=e.filterModels.length>r?e.filterModels[r]:null,o=t(s,a).then((()=>{this.updateActiveList(r)}));i.push(o)})),s.D.all(i).then((()=>{}))}applyModel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"api",t=!1;return this.filters.forEach((i=>{i instanceof s.bu&&(t=i.applyModel(e)||t)})),t}getChildFilterInstance(e){return this.filters[e]}afterGuiAttached(e){let t;e?(this.hidePopup=e.hidePopup,t=this.refreshGui(e.container)):(this.hidePopup=void 0,t=s.D.resolve()),t.then((()=>{const{filterDefs:t}=this;let i=!1;t&&s.ch.forEachReverse(t,((t,s)=>{var r;const a=0===s,o=!a||"inline"!==t.display,n=Yh(jh({},e??{}),{suppressFocus:o}),l=null==(r=this.filters)?void 0:r[s];if(l&&(this.executeFunctionIfExistsOnFilter(l,"afterGuiAttached",n),a&&(i=!0)),a&&o){const e=this.filterGuis[s];e&&(e.focus(),i=!0)}}));const r=this.gridOptionsService.getDocument(),a=r.activeElement;!i&&(a===r.body||this.getGui().contains(a))&&this.forceFocusOutOfContainer(!0)}))}afterGuiDetached(){this.executeFunctionIfExists("afterGuiDetached")}onAnyFilterChanged(){this.executeFunctionIfExists("onAnyFilterChanged")}onNewRowsLoaded(){this.executeFunctionIfExists("onNewRowsLoaded")}destroy(){this.filters.forEach((e=>{e.setModel(null),this.destroyBean(e)})),this.filters.length=0,this.destroyChildren(),this.hidePopup=void 0,super.destroy()}executeFunctionIfExists(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];s.ch.forEachReverse(this.filters,(t=>{this.executeFunctionIfExistsOnFilter(t,e,i)}))}executeFunctionIfExistsOnFilter(e,t){const i=e[t];for(var s=arguments.length,r=new Array(s>2?s-2:0),a=2;a<s;a++)r[a-2]=arguments[a];"function"==typeof i&&i.apply(e,r)}createFilter(e,t){const{filterModifiedCallback:i,doesRowPassOtherFilter:s}=this.params;let r;const a=Yh(jh({},this.filterManager.createFilterParams(this.column,this.column.getColDef())),{filterModifiedCallback:i,filterChangedCallback:e=>{this.executeWhenAllFiltersReady((()=>this.filterChanged(t,e)))},doesRowPassOtherFilter:e=>s(e)&&this.doesFilterPass({node:e,data:e.data},r)}),o=this.userComponentFactory.getFilterDetails(e,a,"agTextColumnFilter");if(!o)return null;const n=o.newAgStackInstance();return n&&n.then((e=>r=e)),n}executeWhenAllFiltersReady(e){this.filters&&this.filters.length>0?e():this.afterFiltersReadyFuncs.push(e)}updateActiveList(e){const t=this.filters[e];s.ch.removeFromArray(this.activeFilterIndices,e),t.isFilterActive()&&this.activeFilterIndices.push(e)}filterChanged(e,t){this.updateActiveList(e),this.filterChangedCallback(t);const i=this.filters[e];this.filters.forEach((e=>{e!==i&&"function"==typeof e.onAnyFilterChanged&&e.onAnyFilterChanged()}))}onFocusIn(e){null!=this.lastActivatedMenuItem&&!this.lastActivatedMenuItem.getGui().contains(e.target)&&(this.lastActivatedMenuItem.deactivate(),this.lastActivatedMenuItem=null)}getModelAsString(e){var t,i,s,r;if(!this.filters||null==(t=null==e?void 0:e.filterModels)||!t.length)return"";const a=null!=(i=this.getLastActiveFilterIndex())?i:0,o=this.filters[a];return null!=(r=null==(s=o.getModelAsString)?void 0:s.call(o,e.filterModels[a]))?r:""}};qh([(0,s.A)("filterManager")],Xh.prototype,"filterManager",2),qh([(0,s.A)("userComponentFactory")],Xh.prototype,"userComponentFactory",2),qh([s.a],Xh.prototype,"postConstruct",1);var Zh=Xh,Jh=class extends s.ak{constructor(){super('<div class="ag-multi-floating-filter ag-floating-filter-input"></div>'),this.floatingFilters=[],this.compDetailsList=[]}init(e){this.params=e;const{compDetailsList:t}=this.getCompDetailsList(e);return this.setParams(t)}setParams(e){const t=[];return e.forEach((e=>{const i=null==e?void 0:e.newAgStackInstance();null!=i&&(this.compDetailsList.push(e),t.push(i))})),s.D.all(t).then((e=>{e.forEach(((e,t)=>{this.floatingFilters.push(e);const i=e.getGui();this.appendChild(i),t>0&&s.ch.setDisplayed(i,!1)}))}))}onParamsUpdated(e){this.refresh(e)}refresh(e){this.params=e;const{compDetailsList:t,floatingFilterParamsList:i}=this.getCompDetailsList(e);t.length===this.compDetailsList.length&&t.every(((e,t)=>!this.filterManager.areFilterCompsDifferent(this.compDetailsList[t],e)))?i.forEach(((e,t)=>{var i;const s=this.floatingFilters[t];let r=!1;s.refresh&&null!==s.refresh(e)&&(r=!0),r||null==(i=s.onParamsUpdated)||i.call(s,e)})):(s.ch.clearElement(this.getGui()),this.destroyBeans(this.floatingFilters),this.floatingFilters=[],this.compDetailsList=[],this.setParams(t))}getCompDetailsList(e){const t=[],i=[],r=e.filterParams;return Zh.getFilterDefs(r).forEach(((r,a)=>{const o=Yh(jh({},e),{parentFilterInstance:e=>{this.parentMultiFilterInstance((t=>{const i=t.getChildFilterInstance(a);null!=i&&e(i)}))}});s.ch.mergeDeep(o.filterParams,r.filterParams);const n=this.getCompDetails(r,o);n&&(t.push(n),i.push(o))})),{compDetailsList:t,floatingFilterParamsList:i}}onParentModelChanged(e,t){t&&t.afterFloatingFilter||this.parentMultiFilterInstance((i=>{if(null==e)this.floatingFilters.forEach(((e,i)=>{e.onParentModelChanged(null,t),s.ch.setDisplayed(e.getGui(),0===i)}));else{const r=i.getLastActiveFilterIndex();this.floatingFilters.forEach(((i,a)=>{const o=e.filterModels.length>a?e.filterModels[a]:null;i.onParentModelChanged(o,t);const n=null==r?0===a:a===r;s.ch.setDisplayed(i.getGui(),n)}))}}))}destroy(){this.destroyBeans(this.floatingFilters),this.floatingFilters.length=0,super.destroy()}getCompDetails(e,t){var i;let s=null!=(i=this.userComponentFactory.getDefaultFloatingFilterType(e,(()=>this.filterManager.getDefaultFloatingFilter(this.params.column))))?i:"agReadOnlyFloatingFilter";return this.userComponentFactory.getFloatingFilterCompDetails(e,t,s)}parentMultiFilterInstance(e){this.params.parentFilterInstance((t=>{if(!(t instanceof Zh))throw new Error("AG Grid - MultiFloatingFilterComp expects MultiFilter as its parent");e(t)}))}};qh([(0,s.A)("userComponentFactory")],Jh.prototype,"userComponentFactory",2),qh([(0,s.A)("filterManager")],Jh.prototype,"filterManager",2);var Qh={version:"31.2.1",moduleName:s.M.MultiFilterModule,beans:[],userComponents:[{componentName:"agMultiColumnFilter",componentClass:Zh},{componentName:"agMultiColumnFloatingFilter",componentClass:Jh}],dependantModules:[E]},ec=class extends s.bo{constructor(){super('<div class="ag-cell-edit-wrapper"></div>')}init(e){this.params=e;const{cellStartedEdit:t,cellHeight:i,values:r}=e;s.ch.missing(r)&&console.warn("AG Grid: agRichSelectCellEditor requires cellEditorParams.values to be set");const{params:a,valuesPromise:o}=this.buildRichSelectParams();this.richSelect=this.createManagedBean(new s.J(a)),this.richSelect.addCssClass("ag-cell-editor"),this.appendChild(this.richSelect),o&&o.then((e=>{this.richSelect.setValueList({valueList:e,refresh:!0});const t=this.getSearchStringCallback(e);t&&this.richSelect.setSearchStringCreator(t)})),this.addManagedListener(this.richSelect,s.aA.EVENT_FIELD_PICKER_VALUE_SELECTED,this.onEditorPickerValueSelected.bind(this)),this.addManagedListener(this.richSelect.getGui(),"focusout",this.onEditorFocusOut.bind(this)),this.focusAfterAttached=t,s.ch.exists(i)&&this.richSelect.setRowHeight(i)}onEditorPickerValueSelected(e){this.params.stopEditing(!e.fromEnterKey)}onEditorFocusOut(e){this.richSelect.getGui().contains(e.relatedTarget)||this.params.stopEditing(!0)}buildRichSelectParams(){const{cellRenderer:e,value:t,values:i,formatValue:s,searchDebounceDelay:r,valueListGap:a,valueListMaxHeight:o,valueListMaxWidth:n,allowTyping:l,filterList:d,searchType:h,highlightMatch:c,valuePlaceholder:u,eventKey:p}=this.params,g={value:t,cellRenderer:e,searchDebounceDelay:r,valueFormatter:s,pickerAriaLabelKey:"ariaLabelRichSelectField",pickerAriaLabelValue:"Rich Select Field",pickerType:"virtual-list",pickerGap:a,allowTyping:l,filterList:d,searchType:h,highlightMatch:c,maxPickerHeight:o,maxPickerWidth:n,placeholder:u,initialInputValue:1===(null==p?void 0:p.length)?p:void 0};let m,v;return m="function"==typeof i?i(this.params):i??[],Array.isArray(m)?(g.valueList=m,g.searchStringCreator=this.getSearchStringCallback(m)):v=m,{params:g,valuesPromise:v}}getSearchStringCallback(e){const{colDef:t}=this.params;if("object"==typeof e[0]&&t.keyCreator)return e=>e.map((e=>{const i=this.gridOptionsService.addGridCommonParams({value:e,colDef:this.params.colDef,column:this.params.column,node:this.params.node,data:this.params.data});return t.keyCreator(i)}))}afterGuiAttached(){const{focusAfterAttached:e,params:t}=this;setTimeout((()=>{if(!this.isAlive())return;if(e){const e=this.richSelect.getFocusableElement();e.focus();const{allowTyping:t,eventKey:i}=this.params;t&&(!i||1!==i.length)&&e.select()}this.richSelect.showPicker();const{eventKey:i}=t;i&&1===(null==i?void 0:i.length)&&this.richSelect.searchTextFromString(i)}))}getValue(){return this.richSelect.getValue()}isPopup(){return!1}},tc={version:"31.2.1",moduleName:s.M.RichSelectModule,beans:[],userComponents:[{componentName:"agRichSelect",componentClass:ec},{componentName:"agRichSelectCellEditor",componentClass:ec}],dependantModules:[E]},ic=Object.defineProperty,sc=Object.defineProperties,rc=Object.getOwnPropertyDescriptor,ac=Object.getOwnPropertyDescriptors,oc=Object.getOwnPropertySymbols,nc=Object.prototype.hasOwnProperty,lc=Object.prototype.propertyIsEnumerable,dc=(e,t,i)=>t in e?ic(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,hc=(e,t)=>{for(var i in t||(t={}))nc.call(t,i)&&dc(e,i,t[i]);if(oc)for(var i of oc(t))lc.call(t,i)&&dc(e,i,t[i]);return e},cc=(e,t)=>{var i={};for(var s in e)nc.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&oc)for(var s of oc(e))t.indexOf(s)<0&&lc.call(e,s)&&(i[s]=e[s]);return i},uc=(e,t,i,s)=>{for(var r,a=s>1?void 0:s?rc(t,i):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s?r(t,i,a):r(a))||a);return s&&a&&ic(t,i,a),a},pc=class extends s.bG{constructor(e,t,i){super(0),this.nodeIdSequence=new s.bj,this.info={},this.ssrmParams=e,this.parentRowNode=i,this.level=i.level+1,this.groupLevel=e.rowGroupCols?this.level<e.rowGroupCols.length:void 0,this.leafGroup=!!e.rowGroupCols&&this.level===e.rowGroupCols.length-1}postConstruct(){if(this.usingTreeData=this.gridOptionsService.get("treeData"),this.nodeIdPrefix=this.blockUtils.createNodeIdPrefix(this.parentRowNode),!this.usingTreeData&&this.groupLevel){const e=this.ssrmParams.rowGroupCols[this.level];this.groupField=e.field,this.rowGroupColumn=this.columnModel.getRowGroupColumns()[this.level]}let e=1;const t=-1===this.parentRowNode.level,i=this.storeUtils.getServerSideInitialRowCount();t&&null!=i&&(e=i),this.initialiseRowNodes(e),this.rowNodeBlockLoader.addBlock(this),this.addDestroyFunc((()=>this.rowNodeBlockLoader.removeBlock(this))),this.postSortFunc=this.gridOptionsService.getCallback("postSortRows"),null!=i&&this.eventService.dispatchEventOnce({type:s.aA.EVENT_ROW_COUNT_READY})}destroyRowNodes(){this.blockUtils.destroyRowNodes(this.allRowNodes),this.allRowNodes=[],this.nodesAfterSort=[],this.nodesAfterFilter=[],this.allNodesMap={}}initialiseRowNodes(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.destroyRowNodes();for(let i=0;i<e;i++){const e=this.blockUtils.createRowNode({field:this.groupField,group:this.groupLevel,leafGroup:this.leafGroup,level:this.level,parent:this.parentRowNode,rowGroupColumn:this.rowGroupColumn});t&&(e.failedLoad=!0),this.allRowNodes.push(e),this.nodesAfterFilter.push(e),this.nodesAfterSort.push(e)}}getBlockStateJson(){return{id:this.nodeIdPrefix?this.nodeIdPrefix:"",state:this.getState()}}loadFromDatasource(){this.storeUtils.loadFromDatasource({startRow:void 0,endRow:void 0,parentBlock:this,parentNode:this.parentRowNode,storeParams:this.ssrmParams,success:this.success.bind(this,this.getVersion()),fail:this.pageLoadFailed.bind(this,this.getVersion())})}getStartRow(){return 0}getEndRow(){return this.nodesAfterSort.length}createDataNode(e,t){const i=this.blockUtils.createRowNode({field:this.groupField,group:this.groupLevel,leafGroup:this.leafGroup,level:this.level,parent:this.parentRowNode,rowGroupColumn:this.rowGroupColumn});null!=t?s.ch.insertIntoArray(this.allRowNodes,i,t):this.allRowNodes.push(i);const r=this.prefixId(this.nodeIdSequence.next());return this.blockUtils.setDataIntoRowNode(i,e,r,void 0),this.nodeManager.addRowNode(i),this.blockUtils.checkOpenByDefault(i),this.allNodesMap[i.id]=i,i}prefixId(e){return this.nodeIdPrefix?this.nodeIdPrefix+"-"+e:e.toString()}processServerFail(){this.initialiseRowNodes(1,!0),this.fireStoreUpdatedEvent(),this.flushAsyncTransactions()}processServerResult(e){if(!this.isAlive())return;const t=e.groupLevelInfo;t&&Object.assign(this.info,t),e.pivotResultFields&&this.serverSideRowModel.generateSecondaryColumns(e.pivotResultFields);const i=this.allRowNodes.length>0?this.allNodesMap:void 0;this.allRowNodes=[],this.nodesAfterSort=[],this.nodesAfterFilter=[],this.allNodesMap={},e.rowData||s.ch.warnOnce('"params.data" is missing from Server-Side Row Model success() callback. Please use the "data" attribute. If no data is returned, set an empty list.'),this.createOrRecycleNodes(i,e.rowData),i&&this.blockUtils.destroyRowNodes(s.ch.getAllValuesInObject(i)),0===this.level&&this.eventService.dispatchEventOnce({type:s.aA.EVENT_ROW_COUNT_READY}),this.filterAndSortNodes(),this.fireStoreUpdatedEvent(),this.flushAsyncTransactions()}createOrRecycleNodes(e,t){if(!t)return;const i=t=>{if(!e)return;const i=this.gridOptionsService.getCallback("getRowId");if(!i)return;const s=this.parentRowNode.getGroupKeys(),r=this.level,a=i({data:t,parentKeys:s.length>0?s:void 0,level:r}),o=e[a];return o?(delete e[a],o):void 0},s=(e,t)=>{this.allNodesMap[e.id]=e,this.blockUtils.updateDataIntoRowNode(e,t),this.allRowNodes.push(e)};t.forEach((e=>{const t=i(e);t?s(t,e):this.createDataNode(e)}))}flushAsyncTransactions(){window.setTimeout((()=>this.transactionManager.flushAsyncTransactions()),0)}filterAndSortNodes(){this.filterRowNodes(),this.sortRowNodes()}sortRowNodes(){const e=this.storeUtils.isServerSideSortAllLevels()||this.storeUtils.isServerSideSortOnServer(),t=this.sortController.getSortOptions(),i=!t||0==t.length;if(e||i)this.nodesAfterSort=this.nodesAfterFilter;else if(this.nodesAfterSort=this.rowNodeSorter.doFullSort(this.nodesAfterFilter,t),this.postSortFunc){const e={nodes:this.nodesAfterSort};this.postSortFunc(e)}}filterRowNodes(){const e=!this.storeUtils.isServerSideOnlyRefreshFilteredGroups()||this.storeUtils.isServerSideFilterOnServer(),t=this.groupLevel;this.nodesAfterFilter=e||t?this.allRowNodes:this.allRowNodes.filter((e=>this.filterManager.doesRowPassFilter({rowNode:e})))}clearDisplayIndexes(){this.displayIndexStart=void 0,this.displayIndexEnd=void 0,this.allRowNodes.forEach((e=>this.blockUtils.clearDisplayIndex(e)))}getDisplayIndexEnd(){return this.displayIndexEnd}isDisplayIndexInStore(e){return 0!==this.getRowCount()&&(e>=this.displayIndexStart&&e<this.displayIndexEnd)}setDisplayIndexes(e,t){this.displayIndexStart=e.peek(),this.topPx=t.value;const i={};this.nodesAfterSort.forEach((s=>{this.blockUtils.setDisplayIndex(s,e,t),i[s.id]=!0})),this.allRowNodes.forEach((e=>{i[e.id]||this.blockUtils.clearDisplayIndex(e)})),this.displayIndexEnd=e.peek(),this.heightPx=t.value-this.topPx}forEachStoreDeep(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new s.bj;e(this,t.next()),this.allRowNodes.forEach((i=>{const s=i.childStore;s&&s.forEachStoreDeep(e,t)}))}forEachNodeDeep(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new s.bj;this.allRowNodes.forEach((i=>{e(i,t.next());const s=i.childStore;s&&s.forEachNodeDeep(e,t)}))}forEachNodeDeepAfterFilterAndSort(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new s.bj,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.nodesAfterSort.forEach((s=>{e(s,t.next());const r=s.childStore;r&&r.forEachNodeDeepAfterFilterAndSort(e,t,i)})),i&&this.parentRowNode.sibling&&e(this.parentRowNode.sibling,t.next())}getRowUsingDisplayIndex(e){return this.isDisplayIndexInStore(e)?this.blockUtils.binarySearchForDisplayIndex(e,this.nodesAfterSort):void 0}getRowBounds(e){for(let t=0;t<this.nodesAfterSort.length;t++){const i=this.nodesAfterSort[t],s=this.blockUtils.extractRowBounds(i,e);if(s)return s}return null}isPixelInRange(e){return e>=this.topPx&&e<this.topPx+this.heightPx}getRowIndexAtPixel(e){if(e<=this.topPx)return this.nodesAfterSort[0].rowIndex;if(e>=this.topPx+this.heightPx){const t=this.nodesAfterSort[this.nodesAfterSort.length-1],i=t.rowTop+t.rowHeight;if(e>=i&&t.expanded){if(t.childStore&&t.childStore.getRowCount()>0)return t.childStore.getRowIndexAtPixel(e);if(t.detailNode)return t.detailNode.rowIndex}return t.rowIndex}let t=null;return this.nodesAfterSort.forEach((i=>{const s=this.blockUtils.getIndexAtPixel(i,e);null!=s&&(t=s)})),t??this.displayIndexEnd-1}getChildStore(e){return this.storeUtils.getChildStore(e,this,(e=>this.allRowNodes.find((t=>t.key==e))))}forEachChildStoreShallow(e){this.allRowNodes.forEach((t=>{const i=t.childStore;i&&e(i)}))}refreshAfterFilter(e){const t=this.storeUtils.isServerSideFilterOnServer(),i=this.storeUtils.isServerRefreshNeeded(this.parentRowNode,this.ssrmParams.rowGroupCols,e);if(!this.storeUtils.isServerSideOnlyRefreshFilteredGroups()||t&&i)return this.refreshStore(!0),void this.sortRowNodes();this.filterRowNodes(),this.sortRowNodes(),this.forEachChildStoreShallow((t=>t.refreshAfterFilter(e)))}refreshAfterSort(e){const t=this.storeUtils.isServerSideSortOnServer(),i=this.storeUtils.isServerRefreshNeeded(this.parentRowNode,this.ssrmParams.rowGroupCols,e);if(this.storeUtils.isServerSideSortAllLevels()||t&&i)return this.refreshStore(!0),void this.filterRowNodes();this.filterRowNodes(),this.sortRowNodes(),this.forEachChildStoreShallow((t=>t.refreshAfterSort(e)))}applyTransaction(e){switch(this.getState()){case s.bG.STATE_FAILED:return{status:s.bQ.StoreLoadingFailed};case s.bG.STATE_LOADING:return{status:s.bQ.StoreLoading};case s.bG.STATE_WAITING_TO_LOAD:return{status:s.bQ.StoreWaitingToLoad}}const t=this.gridOptionsService.getCallback("isApplyServerSideTransaction");if(t){if(!t({transaction:e,parentNode:this.parentRowNode,groupLevelInfo:this.info}))return{status:s.bQ.Cancelled}}const i={status:s.bQ.Applied,remove:[],update:[],add:[]},r=[];return this.executeAdd(e,i),this.executeRemove(e,i,r),this.executeUpdate(e,i,r),this.filterAndSortNodes(),this.updateSelection(r),i}updateSelection(e){if(e.length>0){this.selectionService.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,clearSelection:!1,source:"rowDataChanged"});const t={type:s.aA.EVENT_SELECTION_CHANGED,source:"rowDataChanged"};this.eventService.dispatchEvent(t)}}executeAdd(e,t){const{add:i,addIndex:r}=e;s.ch.missingOrEmpty(i)||("number"==typeof r&&r>=0?i.reverse().forEach((e=>{const i=this.createDataNode(e,r);t.add.push(i)})):i.forEach((e=>{const i=this.createDataNode(e);t.add.push(i)})))}executeRemove(e,t,i){const{remove:s}=e;if(null==s)return;const r={};s.forEach((e=>{const s=this.lookupRowNode(e);s&&(s.isSelected()&&i.push(s),s.clearRowTopAndRowIndex(),r[s.id]=!0,delete this.allNodesMap[s.id],t.remove.push(s),this.nodeManager.removeNode(s))})),this.allRowNodes=this.allRowNodes.filter((e=>!r[e.id]))}executeUpdate(e,t,i){const{update:s}=e;null!=s&&s.forEach((e=>{const s=this.lookupRowNode(e);s&&(this.blockUtils.updateDataIntoRowNode(s,e),!s.selectable&&s.isSelected()&&i.push(s),t.update.push(s))}))}lookupRowNode(e){const t=this.gridOptionsService.getCallback("getRowId");let i;if(null!=t){const s=this.level,r=this.parentRowNode.getGroupKeys(),a=t({data:e,parentKeys:r.length>0?r:void 0,level:s});if(i=this.allNodesMap[a],!i)return console.error(`AG Grid: could not find row id=${a}, data item was not found for this id`),null}else if(i=this.allRowNodes.find((t=>t.data===e)),!i)return console.error("AG Grid: could not find data item as object was not found",e),null;return i}addStoreStates(e){e.push({suppressInfiniteScroll:!0,route:this.parentRowNode.getGroupKeys(),rowCount:this.allRowNodes.length,info:this.info}),this.forEachChildStoreShallow((t=>t.addStoreStates(e)))}refreshStore(e){if(e){const e=this.nodesAfterSort?this.nodesAfterSort.length:1;this.initialiseRowNodes(e)}this.scheduleLoad(),this.fireStoreUpdatedEvent()}retryLoads(){this.getState()===s.bG.STATE_FAILED&&(this.initialiseRowNodes(1),this.scheduleLoad()),this.forEachChildStoreShallow((e=>e.retryLoads()))}scheduleLoad(){this.setStateWaitingToLoad(),this.rowNodeBlockLoader.checkBlockToLoad()}fireStoreUpdatedEvent(){const e={type:s.aA.EVENT_STORE_UPDATED};this.eventService.dispatchEvent(e)}getRowCount(){return this.nodesAfterSort.length}getTopLevelRowDisplayedIndex(e){return this.nodesAfterSort[e].rowIndex}isLastRowIndexKnown(){return this.getState()==s.bG.STATE_LOADED}getRowNodesInRange(e,t){const i=[];let r=!1;return s.ch.missing(e)&&(r=!0),this.nodesAfterSort.forEach((s=>{const a=s===e||s===t;(r||a)&&i.push(s),a&&(r=!r)})),r?[]:i}getStoreBounds(){return{topPx:this.topPx,heightPx:this.heightPx}}};uc([(0,s.A)("ssrmStoreUtils")],pc.prototype,"storeUtils",2),uc([(0,s.A)("ssrmBlockUtils")],pc.prototype,"blockUtils",2),uc([(0,s.A)("columnModel")],pc.prototype,"columnModel",2),uc([(0,s.A)("rowNodeBlockLoader")],pc.prototype,"rowNodeBlockLoader",2),uc([(0,s.A)("rowNodeSorter")],pc.prototype,"rowNodeSorter",2),uc([(0,s.A)("sortController")],pc.prototype,"sortController",2),uc([(0,s.A)("selectionService")],pc.prototype,"selectionService",2),uc([(0,s.A)("ssrmNodeManager")],pc.prototype,"nodeManager",2),uc([(0,s.A)("filterManager")],pc.prototype,"filterManager",2),uc([(0,s.A)("ssrmTransactionManager")],pc.prototype,"transactionManager",2),uc([(0,s.A)("rowModel")],pc.prototype,"serverSideRowModel",2),uc([s.a],pc.prototype,"postConstruct",1),uc([s.b],pc.prototype,"destroyRowNodes",1);var gc=class{constructor(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];if(t.length<1)throw new Error("AG Grid: At least one index must be provided.");this.indexes=t,this.maps=new Map(this.indexes.map((e=>[e,new Map])))}getSize(){return this.maps.get(this.indexes[0]).size}getBy(e,t){const i=this.maps.get(e);if(!i)throw new Error(`AG Grid: ${String(e)} not found`);return i.get(t)}set(e){this.indexes.forEach((t=>{const i=this.maps.get(t);if(!i)throw new Error(`AG Grid: ${String(t)} not found`);i.set(e[t],e)}))}delete(e){this.indexes.forEach((t=>{const i=this.maps.get(t);if(!i)throw new Error(`AG Grid: ${String(t)} not found`);i.delete(e[t])}))}clear(){this.maps.forEach((e=>e.clear()))}getIterator(e){const t=this.maps.get(e);if(!t)throw new Error(`AG Grid: ${String(e)} not found`);return t.values()}forEach(e){const t=this.getIterator(this.indexes[0]);let i;for(;(i=t.next())&&!i.done;)e(i.value)}find(e){const t=this.getIterator(this.indexes[0]);let i;for(;(i=t.next())&&!i.done;)if(e(i.value))return i.value}filter(e){const t=this.getIterator(this.indexes[0]);let i;const s=[];for(;(i=t.next())&&!i.done;)e(i.value)&&s.push(i.value);return s}},mc=class extends s.B{constructor(){super(...arguments),this.cacheLoadingNodesMap=new Map,this.isCheckQueued=!1,this.nextBlockToLoad=void 0}init(){this.addManagedListener(this.rowNodeBlockLoader,s.bH.BLOCK_LOADED_EVENT,(()=>this.queueLoadAction()))}subscribe(e){this.cacheLoadingNodesMap.set(e,new Set)}unsubscribe(e){this.cacheLoadingNodesMap.delete(e)}queueLoadCheck(){this.isCheckQueued||(this.isCheckQueued=!0,window.queueMicrotask((()=>{this.queueLoadAction(),this.isCheckQueued=!1})))}queueLoadAction(){const e=this.getBlockToLoad();if(!e)return;const t=this.nextBlockToLoad&&this.nextBlockToLoad.cache===e.cache&&this.nextBlockToLoad.index===e.index;if(!t&&(!this.nextBlockToLoad||!t)){this.nextBlockToLoad=e,window.clearTimeout(this.loaderTimeout);const t=Number(this.nextBlockToLoad.index),i=this.nextBlockToLoad.cache,s=e.index+e.cache.getBlockSize();this.loaderTimeout=window.setTimeout((()=>{i.isAlive()&&(this.loaderTimeout=void 0,this.attemptLoad(i,t,s),this.nextBlockToLoad=void 0)}),this.gridOptionsService.get("blockLoadDebounceMillis"))}}attemptLoad(e,t,i){const s=this.rowNodeBlockLoader.getAvailableLoadingCount();null!=s&&0===s||(this.rowNodeBlockLoader.registerLoads(1),this.executeLoad(e,t,i),this.queueLoadAction())}executeLoad(e,t,i){var s;const r=e.getSsrmParams(),a={startRow:t,endRow:i,rowGroupCols:r.rowGroupCols,valueCols:r.valueCols,pivotCols:r.pivotCols,pivotMode:r.pivotMode,groupKeys:e.store.getParentNode().getGroupKeys(),filterModel:r.filterModel,sortModel:r.sortModel},o=this.cacheLoadingNodesMap.get(e),n=()=>{for(let e=0;e<i-t;e++)o.delete(t+e)},l=this.gridOptionsService.addGridCommonParams({request:a,success:s=>{e.onLoadSuccess(t,i-t,s),n(),this.rowNodeBlockLoader.loadComplete()},fail:()=>{e.onLoadFailed(t,i-t),n(),this.rowNodeBlockLoader.loadComplete()},parentNode:e.store.getParentNode()});(()=>{for(let e=0;e<i-t;e++)o.add(t+e)})(),null==(s=e.getSsrmParams().datasource)||s.getRows(l)}getBlockToLoad(){var e;const t=this.rowRenderer.getFirstVirtualRenderedRow(),i=this.rowRenderer.getLastVirtualRenderedRow();for(let l=t;l<=i;l++){const e=this.rowModel.getRow(l);if(!e)continue;const t=e.parent&&e.parent.childStore;if(!t||!(t instanceof Cc))continue;const i=t.getCache(),s=i.getNodes().getBy("node",e);if(!s)continue;const r=this.cacheLoadingNodesMap.get(i);if((null==r||!r.has(s.index))&&(e.__needsRefreshWhenVisible||e.stub&&!e.failedLoad))return{cache:i,index:i.getBlockStartIndex(s.index)}}let s=null,r=null,a=Number.MAX_SAFE_INTEGER;for(const l of this.cacheLoadingNodesMap.keys())l.getNodesToRefresh().forEach((e=>{if(null==e.rowIndex)return r=e,void(s=l);const o=l.getNodes().getBy("node",e);if(!o)return;const n=this.cacheLoadingNodesMap.get(l);if(null!=n&&n.has(o.index))return;const d=Math.abs(t-e.rowIndex),h=Math.abs(e.rowIndex-i);d<a&&(r=e,a=d,s=l),h<a&&(r=e,a=h,s=l)}));if(!s)return;const o=s,n=null==(e=o.getNodes().getBy("node",r))?void 0:e.index;return null==n?void 0:{cache:o,index:o.getBlockStartIndex(n)}}isRowLoading(e,t){var i,s;return null!=(s=null==(i=this.cacheLoadingNodesMap.get(e))?void 0:i.has(t))&&s}};mc.DEFAULT_BLOCK_SIZE=100,uc([(0,s.A)("rowNodeBlockLoader")],mc.prototype,"rowNodeBlockLoader",2),uc([(0,s.A)("rowRenderer")],mc.prototype,"rowRenderer",2),uc([(0,s.A)("rowModel")],mc.prototype,"rowModel",2),uc([s.a],mc.prototype,"init",1),mc=uc([(0,s._)("lazyBlockLoadingService")],mc);var vc=class extends s.B{constructor(e,t,i){super(),this.live=!0,this.removedNodeCache=new Map,this.store=e,this.numberOfRows=t,this.isLastRowKnown=!1,this.storeParams=i}init(){this.lazyBlockLoadingService.subscribe(this),this.nodeMap=new gc("index","id","node"),this.nodeDisplayIndexMap=new Map,this.nodesToRefresh=new Set,this.defaultNodeIdPrefix=this.blockUtils.createNodeIdPrefix(this.store.getParentNode()),this.getRowIdFunc=this.gridOptionsService.getCallback("getRowId"),this.isMasterDetail=this.gridOptionsService.get("masterDetail")}destroyRowNodes(){this.lazyBlockLoadingService.unsubscribe(this),this.numberOfRows=0,this.nodeMap.forEach((e=>this.blockUtils.destroyRowNode(e.node))),this.nodeMap.clear(),this.nodeDisplayIndexMap.clear(),this.nodesToRefresh.clear(),this.live=!1}getRowByDisplayIndex(e){var t,i,s,r;if(!this.store.isDisplayIndexInStore(e))return;const a=this.nodeDisplayIndexMap.get(e);if(a)return(a.stub||a.__needsRefreshWhenVisible)&&this.lazyBlockLoadingService.queueLoadCheck(),a;if(e===this.store.getDisplayIndexStart())return this.createStubNode(0,e);const o=this.nodeDisplayIndexMap.get(e-1);if(o){if(this.isMasterDetail&&o.master&&o.expanded)return o.detailNode;if(o.expanded&&null!=(t=o.childStore)&&t.isDisplayIndexInStore(e))return null==(i=o.childStore)?void 0:i.getRowUsingDisplayIndex(e);const s=this.nodeMap.getBy("node",o);return this.createStubNode(s.index+1,e)}const n=this.getSurroundingNodesByDisplayIndex(e);if(null==n){const t=this.store.getRowCount()-(this.store.getDisplayIndexEnd()-e);return this.createStubNode(t,e)}const{previousNode:l,nextNode:d}=n;if(l&&l.node.expanded&&null!=(s=l.node.childStore)&&s.isDisplayIndexInStore(e))return null==(r=l.node.childStore)?void 0:r.getRowUsingDisplayIndex(e);if(d){const t=d.node.rowIndex-e,i=d.index-t;return this.createStubNode(i,e)}const h=this.store.getRowCount()-(this.store.getDisplayIndexEnd()-e);return this.createStubNode(h,e)}createStubNode(e,t){const i=this.store.getRowBounds(t),s=this.createRowAtIndex(e,null,(e=>{e.setRowIndex(t),e.setRowTop(i.rowTop),this.nodeDisplayIndexMap.set(t,e)}));return this.lazyBlockLoadingService.queueLoadCheck(),s}getRowByStoreIndex(e){var t;return null==(t=this.nodeMap.getBy("index",e))?void 0:t.node}skipDisplayIndexes(e,t,i){if(0===e)return;const s=this.gridOptionsService.getRowHeightAsNumber();t.skip(e),i.value+=e*s}setDisplayIndexes(e,t){this.nodeDisplayIndexMap.clear();const i={};this.nodeMap.forEach((e=>{i[e.index]=e.node}));let s=-1;for(const a in i){const r=i[a],o=Number(a),n=o-1-s;this.skipDisplayIndexes(n,e,t),this.blockUtils.setDisplayIndex(r,e,t),this.nodeDisplayIndexMap.set(r.rowIndex,r),s=o}const r=this.numberOfRows-1-s;this.skipDisplayIndexes(r,e,t),this.purgeExcessRows()}getRowCount(){return this.numberOfRows}setRowCount(e,t){if(e<0)throw new Error("AG Grid: setRowCount can only accept a positive row count.");this.numberOfRows=e,null!=t&&(this.isLastRowKnown=t,!1===t&&(this.numberOfRows+=1)),this.fireStoreUpdatedEvent()}getNodes(){return this.nodeMap}getNodeCachedByDisplayIndex(e){var t;return null!=(t=this.nodeDisplayIndexMap.get(e))?t:null}getNodesToRefresh(){return this.nodesToRefresh}getSurroundingNodesByDisplayIndex(e){let t,i;return this.nodeMap.forEach((s=>{e>s.node.rowIndex?(null==i||i.node.rowIndex<s.node.rowIndex)&&(i=s):(null==t||t.node.rowIndex>s.node.rowIndex)&&(t=s)})),i||t?{previousNode:i,nextNode:t}:null}getDisplayIndexFromStoreIndex(e){var t,i;const s=this.nodeMap.getBy("index",e);if(s)return s.node.rowIndex;let r,a;if(this.nodeMap.forEach((t=>{e>t.index?(null==a||a.index<t.index)&&(a=t):(null==r||r.index>t.index)&&(r=t)})),!r)return this.store.getDisplayIndexEnd()-(this.numberOfRows-e);if(!a)return this.store.getDisplayIndexStart()+e;const o=e-a.index;return(null!=(i=null==(t=a.node.childStore)?void 0:t.getDisplayIndexEnd())?i:a.node.rowIndex)+o}createRowAtIndex(e,t,i){var s,r;const a=this.nodeMap.getBy("index",e);if(a){const{node:i}=a;if(i.__needsRefreshWhenVisible=!1,this.doesNodeMatch(t,i))return this.blockUtils.updateDataIntoRowNode(i,t),this.nodesToRefresh.delete(i),i;if(null==this.getRowIdFunc&&i.hasChildren()&&i.expanded)return this.nodesToRefresh.delete(i),i;this.destroyRowAtIndex(e)}if(t&&null!=this.getRowIdFunc){const i=this.getRowId(t),a=i&&(null==(s=this.removedNodeCache)?void 0:s.get(i));if(a)return null==(r=this.removedNodeCache)||r.delete(i),this.blockUtils.updateDataIntoRowNode(a,t),this.nodeMap.set({id:a.id,node:a,index:e}),a;const o=this.nodeMap.getBy("id",i);if(o){this.nodeMap.delete(o);const{node:i,index:s}=o;return this.blockUtils.updateDataIntoRowNode(i,t),this.nodeMap.set({id:i.id,node:i,index:e}),this.nodesToRefresh.delete(i),this.getBlockStartIndex(s)===this.getBlockStartIndex(e)||this.markBlockForVerify(s),i}}const o=this.blockUtils.createRowNode(this.store.getRowDetails());if(null!=t){const e=this.getPrefixedId(this.store.getIdSequence().next());this.blockUtils.setDataIntoRowNode(o,t,e,void 0),this.serverSideRowModel.setPaused(!0),this.blockUtils.checkOpenByDefault(o),this.serverSideRowModel.setPaused(!1),this.nodeManager.addRowNode(o)}return this.nodeMap.set({id:o.id,node:o,index:e}),i&&i(o),o}getBlockStates(){const e={},t={};this.nodeMap.forEach((i=>{let{node:s,index:r}=i;var a;const o=this.getBlockStartIndex(r);!s.stub&&!s.failedLoad&&(e[o]=(null!=(a=e[o])?a:0)+1);let n="loaded";s.failedLoad?n="failed":this.lazyBlockLoadingService.isRowLoading(this,o)?n="loading":(this.nodesToRefresh.has(s)||s.stub)&&(n="needsLoading"),t[o]||(t[o]=new Set),t[o].add(n)}));const i={loading:4,failed:3,needsLoading:2,loaded:1},s=this.blockUtils.createNodeIdPrefix(this.store.getParentNode()),r={};return Object.entries(t).forEach((t=>{let[a,o]=t;var n;const l=[...o].sort(((e,t)=>{var s,r;return(null!=(s=i[e])?s:0)-(null!=(r=i[t])?r:0)}))[0],d=Number(a)/this.getBlockSize(),h=s?`${s}-${d}`:String(d);r[h]={blockNumber:d,startRow:Number(a),endRow:Number(a)+this.getBlockSize(),pageStatus:l,loadedRowCount:null!=(n=e[a])?n:0}})),r}destroyRowAtIndex(e){const t=this.nodeMap.getBy("index",e);t&&(this.nodeMap.delete(t),this.nodeDisplayIndexMap.delete(t.node.rowIndex),this.nodesToRefresh.size>0?this.removedNodeCache.set(t.node.id,t.node):this.blockUtils.destroyRowNode(t.node),this.nodesToRefresh.delete(t.node))}getSsrmParams(){return this.store.getSsrmParams()}getPrefixedId(e){return this.defaultNodeIdPrefix?this.defaultNodeIdPrefix+"-"+e:e.toString()}markBlockForVerify(e){const[t,i]=this.getBlockBounds(e);this.nodeMap.filter((e=>e.index>=t&&e.index<i)).forEach((e=>{let{node:t}=e;t.__needsRefreshWhenVisible=!0}))}doesNodeMatch(e,t){if(t.stub)return!1;if(null!=this.getRowIdFunc){const i=this.getRowId(e);return t.id===i}return t.data===e}purgeStubsOutsideOfViewport(){const e=this.api.getFirstDisplayedRowIndex(),t=this.api.getLastDisplayedRowIndex(),i=this.getBlockStartIndex(e),[s,r]=this.getBlockBounds(t);this.nodeMap.forEach((e=>{this.lazyBlockLoadingService.isRowLoading(this,e.index)||e.node.failedLoad||e.node.stub&&(e.index<i||e.index>r)&&this.destroyRowAtIndex(e.index)}))}getBlocksDistanceFromRow(e,t){const i={};return e.forEach((e=>{let{node:s,index:r}=e;const[a,o]=this.getBlockBounds(r);if(a in i)return;const n=Math.abs(s.rowIndex-t);let l;const d=this.nodeMap.getBy("index",[o-1]);d&&(l=Math.abs(d.node.rowIndex-t));const h=null==l||n<l?n:l;i[a]=h})),Object.entries(i)}purgeExcessRows(){var e;if(this.purgeStubsOutsideOfViewport(),null==this.store.getDisplayIndexEnd()||null==this.storeParams.maxBlocksInCache)return;const t=this.api.getFirstDisplayedRowIndex(),i=this.api.getLastDisplayedRowIndex(),s=new Set,r=new Set;this.nodeMap.forEach((e=>{let{index:a,node:o}=e;const n=this.getBlockStartIndex(a);s.add(n),o.rowIndex>=t&&o.rowIndex<=i&&r.add(n)}));const a=Math.max(r.size,null!=(e=this.storeParams.maxBlocksInCache)?e:0),o=s.size-a;if(o<=0)return;let n=Number.MAX_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER;r.forEach((e=>{n>e&&(n=e),l<e&&(l=e)}));const d=this.nodeMap.filter((e=>{let{node:t,index:i}=e;const s=this.getBlockStartIndex(i);return!(s>=n&&s<=l)&&!this.isNodeCached(t)}));if(0===d.length)return;const h=t+(i-t)/2,c=this.getBlocksDistanceFromRow(d,h),u=this.getBlockSize();c.sort(((e,t)=>Math.sign(t[1]-e[1])));for(let p=0;p<Math.min(o,c.length);p++){const e=Number(c[p][0]);for(let t=e;t<e+u;t++){const e=this.nodeMap.getBy("index",t);!e||this.isNodeCached(e.node)||this.destroyRowAtIndex(t)}}}isNodeFocused(e){const t=this.focusService.getFocusCellToUseAfterRefresh();return!(!t||null!=t.rowPinned)&&t.rowIndex===e.rowIndex}isNodeCached(e){return e.isExpandable()&&e.expanded||this.isNodeFocused(e)}extractDuplicateIds(e){if(null==this.getRowIdFunc)return[];const t=new Set,i=new Set;return e.forEach((e=>{const s=this.getRowId(e);t.has(s)?i.add(s):t.add(s)})),[...i]}onLoadSuccess(e,t,i){if(!this.live)return;const s=i.groupLevelInfo;if(this.store.setStoreInfo(s),null!=this.getRowIdFunc){const s=this.extractDuplicateIds(i.rowData);if(s.length>0){const i=s.join(", ");return console.warn(`AG Grid: Unable to display rows as duplicate row ids (${i}) were returned by the getRowId callback. Please modify the getRowId callback to provide unique ids.`),void this.onLoadFailed(e,t)}}i.pivotResultFields&&this.serverSideRowModel.generateSecondaryColumns(i.pivotResultFields);const r=this.nodesToRefresh.size>0;if(i.rowData.forEach(((t,i)=>{var s;const r=e+i,a=this.nodeMap.getBy("index",r);if(null==(s=null==a?void 0:a.node)||!s.stub)return a&&this.doesNodeMatch(t,a.node)?(this.blockUtils.updateDataIntoRowNode(a.node,t),this.nodesToRefresh.delete(a.node),void(a.node.__needsRefreshWhenVisible=!1)):void this.createRowAtIndex(r,t);this.createRowAtIndex(r,t)})),null!=i.rowCount&&-1!==i.rowCount)this.numberOfRows=i.rowCount,this.isLastRowKnown=!0;else if(t>i.rowData.length)this.numberOfRows=e+i.rowData.length,this.isLastRowKnown=!0;else if(!this.isLastRowKnown){const t=e+i.rowData.length+1;t>this.numberOfRows&&(this.numberOfRows=t)}this.isLastRowKnown&&this.nodeMap.filter((e=>e.index>=this.numberOfRows)).forEach((e=>this.destroyRowAtIndex(e.index))),this.fireStoreUpdatedEvent();const a=0===this.nodesToRefresh.size;r&&a&&this.fireRefreshFinishedEvent()}fireRefreshFinishedEvent(){0===this.nodesToRefresh.size&&(this.removedNodeCache.forEach((e=>{this.blockUtils.destroyRowNode(e)})),this.removedNodeCache=new Map,this.store.fireRefreshFinishedEvent())}isStoreFullyLoaded(){const e=this.isLastRowKnown,t=this.nodeMap.getSize()===this.numberOfRows;if(!e||!t||this.nodesToRefresh.size>0)return;let i=-1;return null==this.nodeMap.find((e=>(i+=1,!(e.index===i&&!e.node.__needsRefreshWhenVisible&&!e.node.stub))))}isLastRowIndexKnown(){return this.isLastRowKnown}onLoadFailed(e,t){var i;if(!this.live)return;const s=this.nodesToRefresh.size>0;for(let a=e;a<e+t&&a<this.getRowCount();a++){let{node:e}=null!=(i=this.nodeMap.getBy("index",a))?i:{};e&&this.nodesToRefresh.delete(e),(!e||!e.stub)&&(e&&!e.stub&&this.destroyRowAtIndex(a),e=this.createRowAtIndex(a)),e.__needsRefreshWhenVisible=!1,e.failedLoad=!0}const r=0===this.nodesToRefresh.size;s&&r&&this.fireRefreshFinishedEvent(),this.fireStoreUpdatedEvent()}markNodesForRefresh(){this.nodeMap.forEach((e=>{e.node.stub&&!e.node.failedLoad||this.nodesToRefresh.add(e.node)})),this.lazyBlockLoadingService.queueLoadCheck(),this.isLastRowKnown&&0===this.numberOfRows&&(this.numberOfRows=1,this.isLastRowKnown=!1,this.fireStoreUpdatedEvent())}isNodeInCache(e){return!!this.nodeMap.getBy("id",e)}fireStoreUpdatedEvent(){this.live&&this.store.fireStoreUpdatedEvent()}getRowId(e){if(null==this.getRowIdFunc)return null;const{level:t}=this.store.getRowDetails(),i=this.store.getParentNode().getGroupKeys(),s=this.getRowIdFunc({data:e,parentKeys:i.length>0?i:void 0,level:t});return String(s)}getOrderedNodeMap(){const e={};return this.nodeMap.forEach((t=>e[t.index]=t)),e}clearDisplayIndexes(){this.nodeDisplayIndexMap.clear()}clientSideSortRows(){const e=this.sortController.getSortOptions();if(!e.some((e=>null!=e.sort)))return;const t=new Array(this.nodeMap.getSize());this.nodeMap.forEach((e=>t[e.index]=e.node)),this.nodeMap.clear(),this.rowNodeSorter.doFullSort(t,e).forEach(((e,t)=>{this.nodeMap.set({id:e.id,node:e,index:t})}))}updateRowNodes(e){if(null==this.getRowIdFunc)throw new Error("AG Grid: Transactions can only be applied when row ids are supplied.");const t=[];return e.forEach((e=>{const i=this.getRowId(e),s=this.nodeMap.getBy("id",i);s&&(this.blockUtils.updateDataIntoRowNode(s.node,e),t.push(s.node))})),t}insertRowNodes(e,t){const i=this.store.getRowCount()-(this.store.getParentNode().sibling?1:0),s=null==t&&this.isLastRowKnown?i:t;if(null==s||i<s)return[];if(null==this.getRowIdFunc)throw new Error("AG Grid: Transactions can only be applied when row ids are supplied.");const r={};e.forEach((e=>{const t=this.getRowId(e);t&&this.isNodeInCache(t)||(r[t]=e)}));const a=Object.values(r);let o=a.length;if(0===o)return[];const n=this.nodeMap.filter((e=>e.index>=s));return n.forEach((e=>this.nodeMap.delete(e))),n.forEach((e=>{this.nodeMap.set({node:e.node,index:e.index+o,id:e.id})})),this.numberOfRows+=o,a.map(((e,t)=>this.createRowAtIndex(s+t,e)))}removeRowNodes(e){if(null==this.getRowIdFunc)throw new Error("AG Grid: Transactions can only be applied when row ids are supplied.");const t=[],i=[];let s=0;const r=[...e],a=this.getOrderedNodeMap();let o=-1;for(let n in a){o+=1;const e=a[n],l=r.findIndex((t=>t===e.id));if(-1!==l){r.splice(l,1),this.destroyRowAtIndex(Number(n)),t.push(e.node),s+=1;continue}if(0===s)continue;const d=Number(n);o!==d&&i.push(e.node),this.nodeMap.delete(a[n]),this.nodeMap.set({id:e.id,node:e.node,index:d-s})}return this.numberOfRows-=this.isLastRowIndexKnown()?e.length:s,r.length>0&&i.length>0&&(i.forEach((e=>e.__needsRefreshWhenVisible=!0)),this.lazyBlockLoadingService.queueLoadCheck()),t}getBlockSize(){return this.storeParams.cacheBlockSize||mc.DEFAULT_BLOCK_SIZE}getBlockStartIndex(e){return e-e%this.getBlockSize()}getBlockBounds(e){const t=this.getBlockStartIndex(e);return[t,t+this.getBlockSize()]}};uc([(0,s.A)("gridApi")],vc.prototype,"api",2),uc([(0,s.A)("ssrmBlockUtils")],vc.prototype,"blockUtils",2),uc([(0,s.A)("focusService")],vc.prototype,"focusService",2),uc([(0,s.A)("ssrmNodeManager")],vc.prototype,"nodeManager",2),uc([(0,s.A)("rowModel")],vc.prototype,"serverSideRowModel",2),uc([(0,s.A)("rowNodeSorter")],vc.prototype,"rowNodeSorter",2),uc([(0,s.A)("sortController")],vc.prototype,"sortController",2),uc([(0,s.A)("lazyBlockLoadingService")],vc.prototype,"lazyBlockLoadingService",2),uc([s.a],vc.prototype,"init",1),uc([s.b],vc.prototype,"destroyRowNodes",1);var Cc=class extends s.B{constructor(e,t,i){super(),this.idSequence=new s.bj,this.ssrmParams=e,this.parentRowNode=i,this.storeParams=t,this.level=i.level+1,this.group=!!e.rowGroupCols&&this.level<e.rowGroupCols.length,this.leafGroup=!!e.rowGroupCols&&this.level===e.rowGroupCols.length-1,this.info={}}init(){var e;let t=1;if(0===this.level&&(t=null!=(e=this.storeUtils.getServerSideInitialRowCount())?e:1,this.eventService.dispatchEventOnce({type:s.aA.EVENT_ROW_COUNT_READY})),this.cache=this.createManagedBean(new vc(this,t,this.storeParams)),!this.gridOptionsService.get("treeData")&&this.group){const e=this.ssrmParams.rowGroupCols[this.level];this.groupField=e.field,this.rowGroupColumn=this.columnModel.getRowGroupColumns()[this.level]}}destroyRowNodes(){this.displayIndexStart=void 0,this.displayIndexEnd=void 0,this.destroyBean(this.cache)}applyRowData(e,t,i){this.cache.onLoadSuccess(t,i,e)}applyTransaction(e){var t,i,r;const a=this.gridOptionsService.getCallback("getRowId");if(!a)return console.warn("AG Grid: getRowId callback must be implemented for transactions to work. Transaction was ignored."),{status:s.bQ.Cancelled};const o=this.gridOptionsService.getCallback("isApplyServerSideTransaction");if(o){if(!o({transaction:e,parentNode:this.parentRowNode,groupLevelInfo:this.info}))return{status:s.bQ.Cancelled}}const n=this.cache.isStoreFullyLoaded();let l,d,h;if(null!=(t=e.update)&&t.length&&(l=this.cache.updateRowNodes(e.update)),null!=(i=e.add)&&i.length){let t=e.addIndex;null!=t&&t<0&&(t=void 0),d=this.cache.insertRowNodes(e.add,t)}if(null!=(r=e.remove)&&r.length){const t=e.remove.map((e=>a({level:this.level,parentKeys:this.parentRowNode.getGroupKeys(),data:e}))),i=[...new Set(t)];h=this.cache.removeRowNodes(i)}const c=this.gridOptionsService.get("serverSideEnableClientSideSort"),u=(null==l?void 0:l.length)||(null==d?void 0:d.length);return n&&c&&u&&this.cache.clientSideSortRows(),this.updateSelectionAfterTransaction(l,h),{status:s.bQ.Applied,update:l,add:d,remove:h}}updateSelectionAfterTransaction(e,t){const i=[];null==e||e.forEach((e=>{e.isSelected()&&!e.selectable&&i.push(e)})),null==t||t.forEach((e=>{e.isSelected()&&i.push(e)})),i.length&&this.selectionService.setNodesSelected({newValue:!1,clearSelection:!1,nodes:i,source:"rowDataChanged"})}clearDisplayIndexes(){this.displayIndexStart=void 0,this.displayIndexEnd=void 0,this.cache.getNodes().forEach((e=>this.blockUtils.clearDisplayIndex(e.node))),this.parentRowNode.sibling&&this.blockUtils.clearDisplayIndex(this.parentRowNode.sibling),this.cache.clearDisplayIndexes()}getDisplayIndexStart(){return this.displayIndexStart}getDisplayIndexEnd(){return this.displayIndexEnd}getRowCount(){return this.parentRowNode.sibling?this.cache.getRowCount()+1:this.cache.getRowCount()}setRowCount(e,t){this.cache.setRowCount(e,t)}isDisplayIndexInStore(e){return 0!==this.cache.getRowCount()&&(this.displayIndexStart<=e&&e<this.getDisplayIndexEnd())}setDisplayIndexes(e,t){this.displayIndexStart=e.peek(),this.topPx=t.value,this.cache.setDisplayIndexes(e,t),this.parentRowNode.sibling&&this.blockUtils.setDisplayIndex(this.parentRowNode.sibling,e,t),this.displayIndexEnd=e.peek(),this.heightPx=t.value-this.topPx}forEachStoreDeep(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new s.bj;e(this,t.next()),this.cache.getNodes().forEach((i=>{const s=i.node.childStore;s&&s.forEachStoreDeep(e,t)}))}forEachNodeDeep(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new s.bj;this.cache.getNodes().forEach((i=>{e(i.node,t.next());const s=i.node.childStore;s&&s.forEachNodeDeep(e,t)}))}forEachNodeDeepAfterFilterAndSort(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new s.bj,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=this.cache.getOrderedNodeMap();for(let s in r){const a=r[s];e(a.node,t.next());const o=a.node.childStore;o&&o.forEachNodeDeepAfterFilterAndSort(e,t,i)}i&&this.parentRowNode.sibling&&e(this.parentRowNode.sibling,t.next())}retryLoads(){this.cache.getNodes().forEach((e=>{let{node:t}=e;t.failedLoad&&(t.failedLoad=!1,t.__needsRefreshWhenVisible=!0,t.stub=!0)})),this.forEachChildStoreShallow((e=>e.retryLoads())),this.fireStoreUpdatedEvent()}getRowUsingDisplayIndex(e){return this.parentRowNode.sibling&&e===this.parentRowNode.sibling.rowIndex?this.parentRowNode.sibling:this.cache.getRowByDisplayIndex(e)}getRowBounds(e){var t;if(!this.isDisplayIndexInStore(e))return null;const i=this.cache.getNodeCachedByDisplayIndex(e);if(i){const t=this.blockUtils.extractRowBounds(i,e);if(t)return t}const{previousNode:s,nextNode:r}=null!=(t=this.cache.getSurroundingNodesByDisplayIndex(e))?t:{};if(s){const t=this.blockUtils.extractRowBounds(s.node,e);if(null!=t)return t}const a=this.gridOptionsService.getRowHeightAsNumber();if(r){const t=(r.node.rowIndex-e)*a;return{rowTop:r.node.rowTop-t,rowHeight:a}}return{rowTop:this.topPx+this.heightPx-(this.getDisplayIndexEnd()-e)*a,rowHeight:a}}isPixelInRange(e){return e>=this.topPx&&e<this.topPx+this.heightPx}getRowIndexAtPixel(e){if(e<this.topPx)return this.getDisplayIndexStart();if(e>=this.topPx+this.heightPx)return this.getDisplayIndexEnd()-1;let t=Number.MAX_SAFE_INTEGER,i=null,s=Number.MAX_SAFE_INTEGER,r=null;if(this.cache.getNodes().forEach((a=>{let{node:o}=a;const n=Math.abs(e-o.rowTop);o.rowTop<e?n<t&&(t=n,i=o):n<s&&(s=n,r=o)})),i){const t=this.blockUtils.getIndexAtPixel(i,e);if(null!=t)return t}const a=this.gridOptionsService.getRowHeightAsNumber();if(r){const t=r.rowTop,i=Math.ceil((t-e)/a);return r.rowIndex-i}const o=this.topPx+this.heightPx,n=Math.floor((o-e)/a);return this.getDisplayIndexEnd()-n}getChildStore(e){return this.storeUtils.getChildStore(e,this,(e=>{const t=this.cache.getNodes().find((t=>t.node.key==e));return t?t.node:null}))}forEachChildStoreShallow(e){this.cache.getNodes().forEach((t=>{let{node:i}=t;i.childStore&&e(i.childStore)}))}refreshAfterSort(e){if(this.storeUtils.isServerSideSortAllLevels()||this.storeUtils.isServerRefreshNeeded(this.parentRowNode,this.ssrmParams.rowGroupCols,e)){const e=this.cache.isStoreFullyLoaded(),t=this.gridOptionsService.get("serverSideEnableClientSideSort");if(!e||!t){const e=this.cache.getRowCount();return this.destroyBean(this.cache),void(this.cache=this.createManagedBean(new vc(this,e,this.storeParams)))}this.cache.clientSideSortRows()}this.forEachChildStoreShallow((t=>t.refreshAfterSort(e)))}refreshAfterFilter(e){this.storeUtils.isServerSideOnlyRefreshFilteredGroups()&&!this.storeUtils.isServerRefreshNeeded(this.parentRowNode,this.ssrmParams.rowGroupCols,e)?this.forEachChildStoreShallow((t=>t.refreshAfterFilter(e))):this.refreshStore(!0)}refreshStore(e){if(e)return this.destroyBean(this.cache),this.cache=this.createManagedBean(new vc(this,1,this.storeParams)),void this.fireStoreUpdatedEvent();this.cache.markNodesForRefresh()}getTopLevelRowDisplayedIndex(e){return this.cache.getDisplayIndexFromStoreIndex(e)??e}isLastRowIndexKnown(){return this.cache.isLastRowIndexKnown()}getRowNodesInRange(e,t){return s.ch.missing(e),this.cache.getNodes().filter((i=>{let{node:s}=i;return s.rowIndex>=e.rowIndex&&s.rowIndex<=t.rowIndex})).map((e=>{let{node:t}=e;return t}))}addStoreStates(e){e.push({suppressInfiniteScroll:!1,route:this.parentRowNode.getGroupKeys(),rowCount:this.getRowCount(),lastRowIndexKnown:this.isLastRowIndexKnown(),info:this.info,maxBlocksInCache:this.storeParams.maxBlocksInCache,cacheBlockSize:this.storeParams.cacheBlockSize}),this.forEachChildStoreShallow((t=>t.addStoreStates(e)))}getIdSequence(){return this.idSequence}getParentNode(){return this.parentRowNode}getRowDetails(){return{field:this.groupField,group:this.group,leafGroup:this.leafGroup,level:this.level,parent:this.parentRowNode,rowGroupColumn:this.rowGroupColumn}}getSsrmParams(){return this.ssrmParams}setStoreInfo(e){e&&Object.assign(this.info,e)}fireStoreUpdatedEvent(){const e={type:s.aA.EVENT_STORE_UPDATED};this.eventService.dispatchEvent(e)}fireRefreshFinishedEvent(){const e={type:s.aA.EVENT_STORE_REFRESHED,route:this.parentRowNode.getRoute()};this.eventService.dispatchEvent(e)}getBlockStates(){return this.cache.getBlockStates()}getStoreBounds(){return{topPx:this.topPx,heightPx:this.heightPx}}getCache(){return this.cache}};uc([(0,s.A)("ssrmBlockUtils")],Cc.prototype,"blockUtils",2),uc([(0,s.A)("ssrmStoreUtils")],Cc.prototype,"storeUtils",2),uc([(0,s.A)("columnModel")],Cc.prototype,"columnModel",2),uc([(0,s.A)("selectionService")],Cc.prototype,"selectionService",2),uc([s.a],Cc.prototype,"init",1),uc([s.b],Cc.prototype,"destroyRowNodes",1);var fc=class extends s.B{constructor(){super(...arguments),this.onRowHeightChanged_debounced=s.ch.debounce(this.onRowHeightChanged.bind(this),100),this.pauseStoreUpdateListening=!1,this.started=!1,this.managingPivotResultColumns=!1}ensureRowHeightsValid(){return!1}start(){this.started=!0,this.updateDatasource()}destroyDatasource(){this.datasource&&(this.datasource.destroy&&this.datasource.destroy(),this.rowRenderer.datasourceChanged(),this.datasource=void 0)}addEventListeners(){this.addManagedListener(this.eventService,s.aA.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverything.bind(this)),this.addManagedListener(this.eventService,s.aA.EVENT_STORE_UPDATED,this.onStoreUpdated.bind(this));const e=this.resetRootStore.bind(this);this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_VALUE_CHANGED,e),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_PIVOT_CHANGED,e),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_ROW_GROUP_CHANGED,e),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_PIVOT_MODE_CHANGED,e),this.addManagedPropertyListeners(["masterDetail","treeData","removePivotHeaderRowWhenSingleValueColumn","suppressServerSideInfiniteScroll","cacheBlockSize"],e),this.addManagedPropertyListener("rowHeight",(()=>this.resetRowHeights())),this.verifyProps(),this.addManagedPropertyListener("serverSideDatasource",(()=>this.updateDatasource()))}updateDatasource(){const e=this.gridOptionsService.get("serverSideDatasource");e&&this.setDatasource(e)}verifyProps(){this.gridOptionsService.exists("initialGroupOrderComparator")&&s.ch.warnOnce("initialGroupOrderComparator cannot be used with Server Side Row Model."),this.gridOptionsService.isRowSelection()&&!this.gridOptionsService.exists("getRowId")&&s.ch.warnOnce("getRowId callback must be provided for Server Side Row Model selection to work correctly.")}setDatasource(e){this.started&&(this.destroyDatasource(),this.datasource=e,this.resetRootStore())}applyRowData(e,t,i){const s=this.getRootStore();if(!s)return;const r=s.getChildStore(i);r&&(r instanceof Cc?r.applyRowData(e,t,e.rowData.length):r instanceof pc&&r.processServerResult(e))}isLastRowIndexKnown(){const e=this.getRootStore();return!!e&&e.isLastRowIndexKnown()}onColumnEverything(){if(!this.storeParams)return void this.resetRootStore();const e=this.columnsToValueObjects(this.columnModel.getRowGroupColumns()),t=this.columnsToValueObjects(this.columnModel.getValueColumns()),i=this.columnsToValueObjects(this.columnModel.getPivotColumns()),r=e=>{const t={};e.oldCols.forEach((e=>t[e.id]=e));const i=e.newCols.every((e=>{const i=t[e.id];return i&&delete t[e.id],i&&i.field===e.field&&i.aggFunc===e.aggFunc})),s=!e.allowRemovedColumns&&!!Object.values(t).length;return i&&!s},a=!s.ch.jsonEquals(this.storeParams.sortModel,this.sortController.getSortModel()),o=!r({oldCols:this.storeParams.rowGroupCols,newCols:e}),n=!r({oldCols:this.storeParams.pivotCols,newCols:i}),l=!(null==e||!e.length)&&!r({oldCols:this.storeParams.valueCols,newCols:t,allowRemovedColumns:!0});if(a||o||n||l)this.resetRootStore();else{const e=this.createStoreParams();this.storeParams.rowGroupCols=e.rowGroupCols,this.storeParams.pivotCols=e.pivotCols,this.storeParams.valueCols=e.valueCols}}destroyRootStore(){!this.rootNode||!this.rootNode.childStore||(this.rootNode.childStore=this.destroyBean(this.rootNode.childStore),this.nodeManager.clear())}refreshAfterSort(e,t){this.storeParams&&(this.storeParams.sortModel=e);const i=this.getRootStore();i&&(i.refreshAfterSort(t),this.onStoreUpdated())}generateSecondaryColumns(e){const t=this.pivotColDefService.createColDefsFromFields(e);this.managingPivotResultColumns=!0,this.columnModel.setSecondaryColumns(t,"rowModelUpdated")}resetRowHeights(){const e=this.resetRowHeightsForAllRowNodes(),t=this.gridOptionsService.getRowHeightForNode(this.rootNode);if(this.rootNode.setRowHeight(t.height,t.estimated),this.rootNode.sibling){const e=this.gridOptionsService.getRowHeightForNode(this.rootNode.sibling);this.rootNode.sibling.setRowHeight(e.height,e.estimated)}e&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let e=!1;return this.forEachNode((t=>{const i=this.gridOptionsService.getRowHeightForNode(t);t.setRowHeight(i.height,i.estimated);const s=t.detailNode;if(s){const e=this.gridOptionsService.getRowHeightForNode(s);s.setRowHeight(e.height,e.estimated)}if(t.sibling){const e=this.gridOptionsService.getRowHeightForNode(t.sibling);s.setRowHeight(e.height,e.estimated)}e=!0})),e}resetRootStore(){this.destroyRootStore(),this.rootNode=new s.bF(this.beans),this.rootNode.group=!0,this.rootNode.level=-1,this.datasource&&(this.storeParams=this.createStoreParams(),this.rootNode.childStore=this.createBean(this.storeFactory.createStore(this.storeParams,this.rootNode)),this.updateRowIndexesAndBounds()),this.managingPivotResultColumns&&(this.columnModel.setSecondaryColumns(null,"api"),this.managingPivotResultColumns=!1),this.dispatchModelUpdated(!0)}columnsToValueObjects(e){return e.map((e=>({id:e.getId(),aggFunc:e.getAggFunc(),displayName:this.columnModel.getDisplayNameForColumn(e,"model"),field:e.getColDef().field})))}createStoreParams(){const e=this.columnsToValueObjects(this.columnModel.getRowGroupColumns()),t=this.columnsToValueObjects(this.columnModel.getValueColumns()),i=this.columnsToValueObjects(this.columnModel.getPivotColumns()),r=this.gridOptionsService.isGetRowHeightFunction();return{valueCols:t,rowGroupCols:e,pivotCols:i,pivotMode:this.columnModel.isPivotMode(),filterModel:this.filterManager.isAdvancedFilterEnabled()?this.filterManager.getAdvancedFilterModel():this.filterManager.getFilterModel(),sortModel:this.sortController.getSortModel(),datasource:this.datasource,lastAccessedSequence:new s.bj,dynamicRowHeight:r}}getParams(){return this.storeParams}dispatchModelUpdated(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t={type:s.aA.EVENT_MODEL_UPDATED,animate:!e,keepRenderedRows:!e,newPage:!1,newData:!1};this.eventService.dispatchEvent(t)}onStoreUpdated(){this.pauseStoreUpdateListening||(this.updateRowIndexesAndBounds(),this.dispatchModelUpdated())}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}onRowHeightChanged(){this.updateRowIndexesAndBounds(),this.dispatchModelUpdated()}updateRowIndexesAndBounds(){const e=this.getRootStore();e&&e.setDisplayIndexes(new s.bj,{value:0})}retryLoads(){const e=this.getRootStore();e&&(e.retryLoads(),this.onStoreUpdated())}getRow(e){const t=this.getRootStore();if(t)return t.getRowUsingDisplayIndex(e)}setPaused(e){this.pauseStoreUpdateListening=e}expandAll(e){this.pauseStoreUpdateListening=!0,this.forEachNode((t=>{t.stub||t.hasChildren()&&t.setExpanded(e)})),this.pauseStoreUpdateListening=!1,this.onStoreUpdated()}refreshAfterFilter(e,t){this.storeParams&&(this.storeParams.filterModel=e);const i=this.getRootStore();i&&(i.refreshAfterFilter(t),this.onStoreUpdated())}getRootStore(){if(this.rootNode&&this.rootNode.childStore)return this.rootNode.childStore}getRowCount(){const e=this.getRootStore();return e?e.getDisplayIndexEnd():0}getTopLevelRowCount(){const e=this.getRootStore();return e?e.getRowCount():1}getTopLevelRowDisplayedIndex(e){const t=this.getRootStore();return t?t.getTopLevelRowDisplayedIndex(e):e}getRowBounds(e){const t=this.getRootStore();return t?t.getRowBounds(e):{rowTop:0,rowHeight:this.gridOptionsService.getRowHeightAsNumber()}}getBlockStates(){const e=this.getRootStore();if(!e)return;const t={};return e.forEachStoreDeep((e=>{if(e instanceof pc){const{id:i,state:s}=e.getBlockStateJson();t[i]=s}else{if(!(e instanceof Cc))throw new Error("AG Grid: Unsupported store type");Object.entries(e.getBlockStates()).forEach((e=>{let[i,s]=e;t[i]=s}))}})),t}getRowIndexAtPixel(e){const t=this.getRootStore();return e<=0||!t?0:t.getRowIndexAtPixel(e)}isEmpty(){return!1}isRowsToRender(){return null!=this.getRootStore()&&this.getRowCount()>0}getType(){return"serverSide"}forEachNode(e){const t=this.getRootStore();t&&t.forEachNodeDeep(e)}forEachNodeAfterFilterAndSort(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=this.getRootStore();i&&i.forEachNodeDeepAfterFilterAndSort(e,void 0,t)}executeOnStore(e,t){if(!this.started)return!1;const i=this.getRootStore();if(!i)return!0;const s=i.getChildStore(e);return s&&t(s),!0}refreshStore(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e.route?e.route:[];this.executeOnStore(t,(t=>t.refreshStore(1==e.purge)))}getStoreState(){const e=[],t=this.getRootStore();return t&&t.addStoreStates(e),e}getNodesInRangeForSelection(e,t){if(!s.ch.exists(e))return[];if(!t)return[e];const i=e.rowIndex,r=t.rowIndex;if(null===i||null===r)return[e];const a=[],[o,n]=[i,r].sort(((e,t)=>e-t));return this.forEachNode((e=>{const t=e.rowIndex;null==t||e.stub||t>=o&&t<=n&&a.push(e)})),a.length!==n-o+1?[e]:a}getRowNode(e){let t;return this.forEachNode((i=>{i.id===e&&(t=i),i.detailNode&&i.detailNode.id===e&&(t=i.detailNode)})),t}isRowPresent(e){return!!this.getRowNode(e.id)}setRowCount(e,t){const i=this.getRootStore();if(i){if(i instanceof Cc)return void i.setRowCount(e,t);console.error("AG Grid: Infinite scrolling must be enabled in order to set the row count.")}}};uc([(0,s.A)("columnModel")],fc.prototype,"columnModel",2),uc([(0,s.A)("filterManager")],fc.prototype,"filterManager",2),uc([(0,s.A)("sortController")],fc.prototype,"sortController",2),uc([(0,s.A)("rowRenderer")],fc.prototype,"rowRenderer",2),uc([(0,s.A)("ssrmNodeManager")],fc.prototype,"nodeManager",2),uc([(0,s.A)("ssrmStoreFactory")],fc.prototype,"storeFactory",2),uc([(0,s.A)("beans")],fc.prototype,"beans",2),uc([(0,s.O)("pivotColDefService")],fc.prototype,"pivotColDefService",2),uc([s.b],fc.prototype,"destroyDatasource",1),uc([s.a],fc.prototype,"addEventListeners",1),uc([s.b],fc.prototype,"destroyRootStore",1),fc=uc([(0,s._)("rowModel")],fc);var yc=class extends s.B{loadFromDatasource(e){const{storeParams:t,parentBlock:i,parentNode:s}=e,r=s.getGroupKeys();if(!t.datasource)return;const a={startRow:e.startRow,endRow:e.endRow,rowGroupCols:t.rowGroupCols,valueCols:t.valueCols,pivotCols:t.pivotCols,pivotMode:t.pivotMode,groupKeys:r,filterModel:t.filterModel,sortModel:t.sortModel},o=this.gridOptionsService.addGridCommonParams({success:e.success,fail:e.fail,request:a,parentNode:e.parentNode});window.setTimeout((()=>{t.datasource&&i.isAlive()?t.datasource.getRows(o):e.fail()}),0)}getChildStore(e,t,i){if(s.ch.missingOrEmpty(e))return t;const r=i(e[0]);if(r){if(1===e.length&&!r.childStore){const e=this.serverSideRowModel.getParams();r.childStore=this.createBean(this.storeFactory.createStore(e,r))}const t=e.slice(1,e.length),i=r.childStore;return i?i.getChildStore(t):null}return null}isServerRefreshNeeded(e,t,i){if(i.valueColChanged||i.secondaryColChanged)return!0;const s=e.level+1;if(!(s<t.length))return!0;const r=t[s].id;return i.changedColumns.indexOf(r)>-1||this.columnModel.getAllGridColumns().filter((e=>e.getColDef().showRowGroup&&i.changedColumns.includes(e.getId()))).map((e=>e.getColDef().showRowGroup)).some((e=>!0===e||e===r))}getServerSideInitialRowCount(){return this.gridOptionsService.get("serverSideInitialRowCount")}assertRowModelIsServerSide(e){return!!this.gridOptionsService.isRowModelType("serverSide")||(s.ch.warnOnce(`The '${e}' property can only be used with the Server Side Row Model.`),!1)}assertNotTreeData(e){return!this.gridOptionsService.get("treeData")||(s.ch.warnOnce(`The '${e}' property cannot be used while using tree data.`),!1)}isServerSideSortAllLevels(){return this.gridOptionsService.get("serverSideSortAllLevels")&&this.assertRowModelIsServerSide("serverSideSortAllLevels")}isServerSideOnlyRefreshFilteredGroups(){return this.gridOptionsService.get("serverSideOnlyRefreshFilteredGroups")&&this.assertRowModelIsServerSide("serverSideOnlyRefreshFilteredGroups")}isServerSideSortOnServer(){return this.gridOptionsService.get("serverSideSortOnServer")&&this.assertRowModelIsServerSide("serverSideSortOnServer")&&this.assertNotTreeData("serverSideSortOnServer")}isServerSideFilterOnServer(){return this.gridOptionsService.get("serverSideFilterOnServer")&&this.assertRowModelIsServerSide("serverSideFilterOnServer")&&this.assertNotTreeData("serverSideFilterOnServer")}};uc([(0,s.A)("columnModel")],yc.prototype,"columnModel",2),uc([(0,s.A)("rowModel")],yc.prototype,"serverSideRowModel",2),uc([(0,s.A)("ssrmStoreFactory")],yc.prototype,"storeFactory",2),yc=uc([(0,s._)("ssrmStoreUtils")],yc);var Sc=class extends s.B{createRowNode(e){const t=new s.bF(this.beans),i=null!=e.rowHeight?e.rowHeight:this.gridOptionsService.getRowHeightAsNumber();return t.setRowHeight(i),t.group=e.group,t.leafGroup=e.leafGroup,t.level=e.level,t.uiLevel=e.level,t.parent=e.parent,t.stub=!0,t.__needsRefreshWhenVisible=!1,t.group&&(t.expanded=!1,t.field=e.field,t.rowGroupColumn=e.rowGroupColumn),t}destroyRowNodes(e){e&&e.forEach((e=>this.destroyRowNode(e)))}destroyRowNode(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.childStore&&!t&&(this.destroyBean(e.childStore),e.childStore=null),e.sibling&&!e.footer&&this.destroyRowNode(e.sibling,!1),e.clearRowTopAndRowIndex(),null!=e.id&&this.nodeManager.removeNode(e)}setTreeGroupInfo(e){e.updateHasChildren();const t=this.gridOptionsService.get("getServerSideGroupKey");e.hasChildren()&&null!=t&&(e.key=t(e.data)),!e.hasChildren()&&null!=e.childStore&&(this.destroyBean(e.childStore),e.childStore=null,e.expanded=!1)}setRowGroupInfo(e){e.key=this.valueService.getValue(e.rowGroupColumn,e),(null===e.key||void 0===e.key)&&s.ch.doOnce((()=>{console.warn("AG Grid: null and undefined values are not allowed for server side row model keys"),e.rowGroupColumn&&console.warn(`column = ${e.rowGroupColumn.getId()}`),console.warn("data is ",e.data)}),"ServerSideBlock-CannotHaveNullOrUndefinedForKey"),this.beans.gridOptionsService.getGroupIncludeFooter()({node:e})&&(e.createFooter(),e.sibling&&(e.sibling.uiLevel=e.uiLevel+1))}setMasterDetailInfo(e){const t=this.gridOptionsService.get("isRowMaster");e.master=null==t||t(e.data)}updateDataIntoRowNode(e,t){e.updateData(t),this.gridOptionsService.get("treeData")?(this.setTreeGroupInfo(e),this.setChildCountIntoRowNode(e)):e.group?(this.setChildCountIntoRowNode(e),e.footer||(this.beans.gridOptionsService.getGroupIncludeFooter()({node:e})?e.sibling?e.sibling.updateData(t):e.createFooter():e.sibling&&e.destroyFooter())):this.gridOptionsService.get("masterDetail")}setDataIntoRowNode(e,t,i,r){var a;e.stub=!1;const o=this.gridOptionsService.get("treeData");s.ch.exists(t)?(e.setDataAndId(t,i),o?this.setTreeGroupInfo(e):e.group?this.setRowGroupInfo(e):this.gridOptionsService.get("masterDetail")&&this.setMasterDetailInfo(e)):(e.setDataAndId(void 0,void 0),e.key=null),(o||e.group)&&(this.setGroupDataIntoRowNode(e),this.setChildCountIntoRowNode(e)),s.ch.exists(t)&&(e.setRowHeight(this.gridOptionsService.getRowHeightForNode(e,!1,r).height),null==(a=e.sibling)||a.setRowHeight(this.gridOptionsService.getRowHeightForNode(e.sibling,!1,r).height))}setChildCountIntoRowNode(e){const t=this.gridOptionsService.get("getChildCount");t&&e.setAllChildrenCount(t(e.data))}setGroupDataIntoRowNode(e){const t=this.columnModel.getGroupDisplayColumns(),i=this.gridOptionsService.get("treeData");t.forEach((t=>{if(null==e.groupData&&(e.groupData={}),i)e.groupData[t.getColId()]=e.key;else if(t.isRowGroupDisplayed(e.rowGroupColumn.getId())){const i=this.valueService.getValue(e.rowGroupColumn,e);e.groupData[t.getColId()]=i}}))}clearDisplayIndex(e){e.clearRowTopAndRowIndex(),e.hasChildren()&&s.ch.exists(e.childStore)&&e.childStore.clearDisplayIndexes(),e.master&&e.detailNode&&e.detailNode.clearRowTopAndRowIndex()}setDisplayIndex(e,t,i){if(e.setRowIndex(t.next()),e.setRowTop(i.value),i.value+=e.rowHeight,!e.footer&&(e.master&&(e.expanded&&e.detailNode?(e.detailNode.setRowIndex(t.next()),e.detailNode.setRowTop(i.value),i.value+=e.detailNode.rowHeight):e.detailNode&&e.detailNode.clearRowTopAndRowIndex()),e.hasChildren()&&s.ch.exists(e.childStore))){const s=e.childStore;e.expanded?s.setDisplayIndexes(t,i):s.clearDisplayIndexes()}}binarySearchForDisplayIndex(e,t){let i=0,r=t.length-1;if(s.ch.missing(r)||s.ch.missing(i))console.warn(`AG Grid: error: topPointer = ${r}, bottomPointer = ${i}`);else for(;;){const s=Math.floor((i+r)/2),a=t[s];if(a.rowIndex===e)return a;const o=a.master&&a.expanded,n=a.detailNode;if(o&&n&&n.rowIndex===e)return a.detailNode;const l=a.childStore;if(a.expanded&&l&&l.isDisplayIndexInStore(e))return l.getRowUsingDisplayIndex(e);if(a.rowIndex<e)i=s+1;else{if(!(a.rowIndex>e))return void console.warn(`AG Grid: error: unable to locate rowIndex = ${e} in cache`);r=s-1}}}extractRowBounds(e,t){const i=e=>({rowHeight:e.rowHeight,rowTop:e.rowTop});if(e.rowIndex===t)return i(e);if(e.hasChildren()&&e.expanded&&s.ch.exists(e.childStore)){const i=e.childStore;if(i.isDisplayIndexInStore(t))return i.getRowBounds(t)}else if(e.master&&e.expanded&&s.ch.exists(e.detailNode)&&e.detailNode.rowIndex===t)return i(e.detailNode)}getIndexAtPixel(e,t){if(e.isPixelInRange(t))return e.rowIndex;const i=e.master&&e.expanded,r=e.detailNode;if(i&&r&&r.isPixelInRange(t))return e.detailNode.rowIndex;if(e.hasChildren()&&e.expanded&&s.ch.exists(e.childStore)){const i=e.childStore;if(i.isPixelInRange(t))return i.getRowIndexAtPixel(t)}return null}createNodeIdPrefix(e){const t=[];let i=e;for(;i&&i.level>=0;)""===i.key?t.push("ag-Grid-MissingKey"):t.push(i.key),i=i.parent;if(t.length>0)return t.reverse().join("-")}checkOpenByDefault(e){return this.expansionService.checkOpenByDefault(e)}};uc([(0,s.A)("valueService")],Sc.prototype,"valueService",2),uc([(0,s.A)("columnModel")],Sc.prototype,"columnModel",2),uc([(0,s.A)("ssrmNodeManager")],Sc.prototype,"nodeManager",2),uc([(0,s.A)("beans")],Sc.prototype,"beans",2),uc([(0,s.A)("expansionService")],Sc.prototype,"expansionService",2),Sc=uc([(0,s._)("ssrmBlockUtils")],Sc);var Ec=class{constructor(){this.rowNodes={}}addRowNode(e){const t=e.id;this.rowNodes[t]&&(console.warn(`AG Grid: Duplicate node id ${e.id}. Row ID's are provided via the getRowId() callback. Please modify the getRowId() callback code to provide unique row id values.`),console.warn("first instance",this.rowNodes[t].data),console.warn("second instance",e.data)),this.rowNodes[t]=e}removeNode(e){const t=e.id;this.rowNodes[t]&&(this.rowNodes[t]=void 0)}clear(){this.rowNodes={}}};uc([s.b],Ec.prototype,"clear",1),Ec=uc([(0,s._)("ssrmNodeManager")],Ec);var bc=class extends s.B{constructor(){super(...arguments),this.asyncTransactions=[]}postConstruct(){this.gridOptionsService.isRowModelType("serverSide")}applyTransactionAsync(e,t){null==this.asyncTransactionsTimeout&&this.scheduleExecuteAsync(),this.asyncTransactions.push({transaction:e,callback:t})}scheduleExecuteAsync(){const e=this.gridOptionsService.getAsyncTransactionWaitMillis();this.asyncTransactionsTimeout=window.setTimeout((()=>{this.executeAsyncTransactions()}),e)}executeAsyncTransactions(){if(!this.asyncTransactions)return;const e=[],t=[],i=[];let r=!1;if(this.asyncTransactions.forEach((a=>{let o;this.serverSideRowModel.executeOnStore(a.transaction.route,(e=>{o=e.applyTransaction(a.transaction)}))?null==o&&(o={status:s.bQ.StoreNotFound}):o={status:s.bQ.StoreNotStarted},t.push(o),o.status!=s.bQ.StoreLoading?(a.callback&&e.push((()=>a.callback(o))),o.status===s.bQ.Applied&&(r=!0)):i.push(a)})),e.length>0&&window.setTimeout((()=>{e.forEach((e=>e()))}),0),this.asyncTransactionsTimeout=void 0,this.asyncTransactions=i,r&&(this.valueCache.onDataChanged(),this.eventService.dispatchEvent({type:s.aA.EVENT_STORE_UPDATED})),t.length>0){const e={type:s.aA.EVENT_ASYNC_TRANSACTIONS_FLUSHED,results:t};this.eventService.dispatchEvent(e)}}flushAsyncTransactions(){null!=this.asyncTransactionsTimeout&&clearTimeout(this.asyncTransactionsTimeout),this.executeAsyncTransactions()}applyTransaction(e){let t;if(this.serverSideRowModel.executeOnStore(e.route,(i=>{t=i.applyTransaction(e)}))){if(t){if(this.valueCache.onDataChanged(),t.remove){const i=t.remove.map((e=>e.id));this.selectionService.deleteSelectionStateFromParent(e.route||[],i)}return this.eventService.dispatchEvent({type:s.aA.EVENT_STORE_UPDATED}),t}return{status:s.bQ.StoreNotFound}}return{status:s.bQ.StoreNotStarted}}};uc([(0,s.A)("rowNodeBlockLoader")],bc.prototype,"rowNodeBlockLoader",2),uc([(0,s.A)("valueCache")],bc.prototype,"valueCache",2),uc([(0,s.A)("rowModel")],bc.prototype,"serverSideRowModel",2),uc([(0,s.A)("rowRenderer")],bc.prototype,"rowRenderer",2),uc([(0,s.A)("selectionService")],bc.prototype,"selectionService",2),uc([s.a],bc.prototype,"postConstruct",1),bc=uc([(0,s._)("ssrmTransactionManager")],bc);var wc=class extends s.B{postConstruct(){this.gridOptionsService.isRowModelType("serverSide")&&this.addManagedListener(this.eventService,s.aA.EVENT_ROW_GROUP_OPENED,this.onRowGroupOpened.bind(this))}onRowGroupOpened(e){const t=e.node;if(t.expanded){if(t.master)this.createDetailNode(t);else if(s.ch.missing(t.childStore)){const e=this.serverSideRowModel.getParams();t.childStore=this.createBean(this.storeFactory.createStore(e,t))}}else this.gridOptionsService.get("purgeClosedRowNodes")&&s.ch.exists(t.childStore)&&(t.childStore=this.destroyBean(t.childStore));const i={type:s.aA.EVENT_STORE_UPDATED};this.eventService.dispatchEvent(i)}createDetailNode(e){if(s.ch.exists(e.detailNode))return e.detailNode;const t=new s.bF(this.beans);t.detail=!0,t.selectable=!1,t.parent=e,s.ch.exists(e.id)&&(t.id="detail_"+e.id),t.data=e.data,t.level=e.level+1;const i=this.gridOptionsService.getRowHeightForNode(t).height;return t.rowHeight=i||200,e.detailNode=t,t}};uc([(0,s.A)("rowModel")],wc.prototype,"serverSideRowModel",2),uc([(0,s.A)("ssrmStoreFactory")],wc.prototype,"storeFactory",2),uc([(0,s.A)("beans")],wc.prototype,"beans",2),uc([s.a],wc.prototype,"postConstruct",1),wc=uc([(0,s._)("ssrmExpandListener")],wc);var Ac=class extends s.B{postConstruct(){this.gridOptionsService.isRowModelType("serverSide")&&this.addManagedListener(this.eventService,s.aA.EVENT_SORT_CHANGED,this.onSortChanged.bind(this))}onSortChanged(){const e=this.serverSideRowModel.getParams();if(!e)return;const t=this.sortController.getSortModel(),i=e.sortModel,s=this.findChangedColumnsInSort(t,i),r={valueColChanged:this.listenerUtils.isSortingWithValueColumn(s),secondaryColChanged:this.listenerUtils.isSortingWithSecondaryColumn(s),changedColumns:s};this.serverSideRowModel.refreshAfterSort(t,r)}findChangedColumnsInSort(e,t){let i=[];[e,t].forEach((e=>{if(e){const t=e.map((e=>e.colId));i=i.concat(t)}}));return i.filter((i=>{const s=t.find((e=>e.colId===i)),r=e.find((e=>e.colId===i));return((e,t)=>(e?e.sort:null)!==(t?t.sort:null))(s,r)||((i,s)=>(i?t.indexOf(i):-1)!==(s?e.indexOf(s):-1))(s,r)}))}};uc([(0,s.A)("sortController")],Ac.prototype,"sortController",2),uc([(0,s.A)("rowModel")],Ac.prototype,"serverSideRowModel",2),uc([(0,s.A)("ssrmListenerUtils")],Ac.prototype,"listenerUtils",2),uc([s.a],Ac.prototype,"postConstruct",1),Ac=uc([(0,s._)("ssrmSortService")],Ac);var xc=class extends s.B{postConstruct(){this.gridOptionsService.isRowModelType("serverSide")&&(this.addManagedListener(this.eventService,s.aA.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,(()=>this.onFilterChanged(!0))),this.addManagedListener(this.eventService,s.aA.EVENT_FILTER_CHANGED,(()=>this.onFilterChanged())))}onFilterChanged(e){const t=this.serverSideRowModel.getParams();if(!t)return;const i=t.filterModel;let s,r;if(this.filterManager.isAdvancedFilterEnabled()){s=this.filterManager.getAdvancedFilterModel();const t=e?Object.keys(i??{}):this.getAdvancedFilterColumns(i),a=this.getAdvancedFilterColumns(s);t.forEach((e=>a.add(e))),r=Array.from(a)}else if(s=this.filterManager.getFilterModel(),e){const e=this.getAdvancedFilterColumns(i);Object.keys(s).forEach((t=>e.add(t))),r=Array.from(e)}else r=this.findChangedColumns(i,s);const a={valueColChanged:this.listenerUtils.isSortingWithValueColumn(r),secondaryColChanged:this.listenerUtils.isSortingWithSecondaryColumn(r),changedColumns:r};this.serverSideRowModel.refreshAfterFilter(s,a)}findChangedColumns(e,t){const i={};Object.keys(e).forEach((e=>i[e]=!0)),Object.keys(t).forEach((e=>i[e]=!0));const s=[];return Object.keys(i).forEach((i=>{JSON.stringify(e[i])!=JSON.stringify(t[i])&&s.push(i)})),s}getAdvancedFilterColumns(e){const t=new Set;if(!e)return t;const i=e=>{"join"===e.filterType?e.conditions.forEach((e=>i(e))):t.add(e.colId)};return i(e),t}};uc([(0,s.A)("rowModel")],xc.prototype,"serverSideRowModel",2),uc([(0,s.A)("filterManager")],xc.prototype,"filterManager",2),uc([(0,s.A)("ssrmListenerUtils")],xc.prototype,"listenerUtils",2),uc([s.a],xc.prototype,"postConstruct",1),xc=uc([(0,s._)("ssrmFilterListener")],xc);var Tc=class{createStore(e,t){const i=this.getStoreParams(e,t);return new(i.suppressInfiniteScroll?pc:Cc)(e,i,t)}getStoreParams(e,t){const i=this.getLevelSpecificParams(t),s=this.isInfiniteScroll(i);return{suppressInfiniteScroll:!s,cacheBlockSize:this.getBlockSize(s,i),maxBlocksInCache:this.getMaxBlocksInCache(s,e,i)}}getMaxBlocksInCache(e,t,i){if(!e)return;const r=i&&null!=i.maxBlocksInCache?i.maxBlocksInCache:this.gridOptionsService.get("maxBlocksInCache");return null!=r&&r>=0?t.dynamicRowHeight?void s.ch.warnOnce("Server Side Row Model does not support Dynamic Row Height and Cache Purging. Either a) remove getRowHeight() callback or b) remove maxBlocksInCache property. Purging has been disabled."):this.columnModel.isAutoRowHeightActive()?void s.ch.warnOnce("Server Side Row Model does not support Auto Row Height and Cache Purging. Either a) remove colDef.autoHeight or b) remove maxBlocksInCache property. Purging has been disabled."):r:void 0}getBlockSize(e,t){if(!e)return;const i=t&&null!=t.cacheBlockSize?t.cacheBlockSize:this.gridOptionsService.get("cacheBlockSize");return null!=i&&i>0?i:100}getLevelSpecificParams(e){const t=this.gridOptionsService.getCallback("getServerSideGroupLevelParams");if(!t)return;return t({level:e.level+1,parentRowNode:e.level>=0?e:void 0,rowGroupColumns:this.columnModel.getRowGroupColumns(),pivotColumns:this.columnModel.getPivotColumns(),pivotMode:this.columnModel.isPivotMode()})}isInfiniteScroll(e){return!(e&&null!=e.suppressInfiniteScroll?e.suppressInfiniteScroll:this.isSuppressServerSideInfiniteScroll())}isSuppressServerSideInfiniteScroll(){return this.gridOptionsService.get("suppressServerSideInfiniteScroll")}};uc([(0,s.A)("gridOptionsService")],Tc.prototype,"gridOptionsService",2),uc([(0,s.A)("columnModel")],Tc.prototype,"columnModel",2),Tc=uc([(0,s._)("ssrmStoreFactory")],Tc);var Mc=class{isSortingWithValueColumn(e){const t=this.columnModel.getValueColumns().map((e=>e.getColId()));for(let i=0;i<e.length;i++)if(t.indexOf(e[i])>-1)return!0;return!1}isSortingWithSecondaryColumn(e){if(!this.columnModel.getSecondaryColumns())return!1;const t=this.columnModel.getSecondaryColumns().map((e=>e.getColId()));for(let i=0;i<e.length;i++)if(t.indexOf(e[i])>-1)return!0;return!1}};uc([(0,s.A)("columnModel")],Mc.prototype,"columnModel",2),Mc=uc([(0,s._)("ssrmListenerUtils")],Mc);var Pc=class extends s.B{constructor(){super(...arguments),this.selectedState={selectAll:!1,toggledNodes:new Set},this.lastSelected=null,this.selectAllUsed=!1,this.selectedNodes={}}init(){this.rowSelection=this.gridOptionsService.get("rowSelection"),this.addManagedPropertyListener("rowSelection",(e=>{this.rowSelection=e.currentValue}))}getSelectedState(){return{selectAll:this.selectedState.selectAll,toggledNodes:[...this.selectedState.toggledNodes]}}setSelectedState(e){const t={selectAll:!1,toggledNodes:new Set};"object"==typeof e?"selectAll"in e&&"boolean"==typeof e.selectAll?(t.selectAll=e.selectAll,"toggledNodes"in e&&Array.isArray(e.toggledNodes)?(e.toggledNodes.forEach((e=>{"string"==typeof e?t.toggledNodes.add(e):console.warn(`AG Grid: Provided ids must be of string type. Invalid id provided: ${e}`)})),this.selectedState=t):console.error("AG Grid: `toggledNodes` must be an array of string ids.")):console.error("AG Grid: Select all status should be of boolean type."):console.error("AG Grid: The provided selection state should be an object.")}deleteSelectionStateFromParent(e,t){if(0===this.selectedState.toggledNodes.size)return!1;let i=!1;return t.forEach((e=>{this.selectedState.toggledNodes.delete(e)&&(i=!0)})),i}setNodesSelected(e){if(0===e.nodes.length)return 0;const t=e.clearSelection&&e.newValue&&!e.rangeSelect;if("multiple"!==this.rowSelection||t){if(e.nodes.length>1)throw new Error("AG Grid: cannot select multiple rows when rowSelection is set to 'single'");const t=e.nodes[0];return e.newValue?(this.selectedNodes={[t.id]:t},this.selectedState={selectAll:!1,toggledNodes:new Set([t.id])}):(this.selectedNodes={},this.selectedState={selectAll:!1,toggledNodes:new Set}),this.lastSelected=t.id,1}const i=t=>{e.newValue?this.selectedNodes[t.id]=t:delete this.selectedNodes[t.id];const i=t.selectable;e.newValue!==this.selectedState.selectAll&&i?this.selectedState.toggledNodes.add(t.id):this.selectedState.toggledNodes.delete(t.id)};if(e.rangeSelect&&this.lastSelected){if(e.nodes.length>1)throw new Error("AG Grid: cannot select multiple rows when using rangeSelect");const t=e.nodes[0],s=this.rowModel.getRowNode(this.lastSelected);return this.rowModel.getNodesInRangeForSelection(t,s??null).forEach(i),this.lastSelected=t.id,1}return e.nodes.forEach(i),this.lastSelected=e.nodes[e.nodes.length-1].id,1}processNewRow(e){this.selectedNodes[e.id]&&(this.selectedNodes[e.id]=e)}isNodeSelected(e){const t=this.selectedState.toggledNodes.has(e.id);return this.selectedState.selectAll?!t:t}getSelectedNodes(){return this.selectAllUsed&&console.warn("AG Grid: getSelectedNodes and getSelectedRows functions cannot be used with select all functionality with the server-side row model.\n                Use `api.getServerSideSelectionState()` instead."),Object.values(this.selectedNodes)}getSelectedRows(){return this.getSelectedNodes().map((e=>e.data))}getSelectionCount(){return this.selectedState.selectAll?-1:this.selectedState.toggledNodes.size}clearOtherNodes(e,t){const i=this.selectedState.selectAll?1:this.selectedState.toggledNodes.size-1;this.selectedState={selectAll:!1,toggledNodes:new Set([e.id])},this.rowModel.forEachNode((i=>{i!==e&&i.selectThisNode(!1,void 0,t)}));const r={type:s.aA.EVENT_SELECTION_CHANGED,source:t};return this.eventService.dispatchEvent(r),i}isEmpty(){var e;return!this.selectedState.selectAll&&!(null!=(e=this.selectedState.toggledNodes)&&e.size)}selectAllRowNodes(e){this.selectedState={selectAll:!0,toggledNodes:new Set},this.selectedNodes={},this.selectAllUsed=!0}deselectAllRowNodes(e){this.selectedState={selectAll:!1,toggledNodes:new Set},this.selectedNodes={}}getSelectAllState(e,t){return this.selectedState.selectAll?!(this.selectedState.toggledNodes.size>0)||null:this.selectedState.toggledNodes.size>0&&null}};uc([(0,s.A)("rowModel")],Pc.prototype,"rowModel",2),uc([s.a],Pc.prototype,"init",1);var Fc=class extends s.B{constructor(){super(...arguments),this.selectedState={selectAllChildren:!1,toggledNodes:new Map},this.lastSelected=null}init(){this.addManagedListener(this.eventService,s.aA.EVENT_MODEL_UPDATED,(()=>this.removeRedundantState())),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_ROW_GROUP_CHANGED,(()=>this.selectionService.reset("rowGroupChanged")))}getSelectedState(){const e=this.gridOptionsService.get("treeData"),t=(i,s,r)=>{const a={nodeId:r};if((e||s<=this.columnModel.getRowGroupColumns().length)&&(a.selectAllChildren=i.selectAllChildren),i.toggledNodes.size){const e=[];i.toggledNodes.forEach(((i,r)=>{const a=t(i,s+1,r);e.push(a)})),a.toggledNodes=e}return a};return t(this.selectedState,0)}setSelectedState(e){const t=(e,i)=>{var s,r;if("object"!=typeof e)throw new Error("AG Grid: Each provided state object must be an object.");if("selectAllChildren"in e&&"boolean"!=typeof e.selectAllChildren)throw new Error("AG Grid: `selectAllChildren` must be a boolean value or undefined.");if("toggledNodes"in e){if(!Array.isArray(e.toggledNodes))throw new Error("AG Grid: `toggledNodes` must be an array.");if(!e.toggledNodes.every((e=>"object"==typeof e&&"nodeId"in e&&"string"==typeof e.nodeId)))throw new Error("AG Grid: Every `toggledNode` requires an associated string id.")}const a=null!=(s=e.selectAllChildren)?s:!i,o=null==(r=e.toggledNodes)?void 0:r.map((e=>[e.nodeId,t(e,a)]));if(null==o?void 0:o.some((e=>{let[t,i]=e;return a===i.selectAllChildren&&0===i.toggledNodes.size})))throw new Error("\n                    AG Grid: AG Grid: Row selection state could not be parsed due to invalid data. Ensure all child state has toggledNodes or does not conform with the parent rule.\n                    Please rebuild the selection state and reapply it.\n                ");return{selectAllChildren:a,toggledNodes:new Map(o)}};try{this.selectedState=t(e,!!e.selectAllChildren)}catch(i){console.error(i.message)}}deleteSelectionStateFromParent(e,t){let i=this.selectedState;const s=[...e];for(;i&&s.length;)i=i.toggledNodes.get(s.pop());if(!i)return!1;let r=!1;return t.forEach((e=>{null!=i&&i.toggledNodes.delete(e)&&(r=!0)})),r&&this.removeRedundantState(),r}setNodesSelected(e){const t=e,{nodes:i}=t,s=cc(t,["nodes"]);if(0===i.length)return 0;if(e.rangeSelect){if(i.length>1)throw new Error("AG Grid: cannot select multiple rows when using rangeSelect");const e=i[0],t=this.rowModel.getNodesInRangeForSelection(e,this.lastSelected).map(this.getRouteToNode).sort(((e,t)=>t.length-e.length)),r=new Set;return t.forEach((t=>{r.has(t[t.length-1])||(t.forEach((e=>r.add(e))),this.recursivelySelectNode(t,this.selectedState,hc({node:e},s)))})),this.removeRedundantState(),this.lastSelected=e,1}return e.nodes.forEach((e=>{const t=this.getRouteToNode(e);this.recursivelySelectNode(t,this.selectedState,((e,t)=>sc(e,ac(t)))(hc({},s),{node:e}))})),this.removeRedundantState(),this.lastSelected=e.nodes[e.nodes.length-1],1}isNodeSelected(e){const t=this.getRouteToNode(e);return this.isNodePathSelected(t,this.selectedState)}isNodePathSelected(e,t){let[i,...s]=e;if(0===s.length){const e=t.toggledNodes.has(i.id);if(i.hasChildren()){const e=t.toggledNodes.get(i.id);if(e&&e.toggledNodes.size)return}return t.selectAllChildren?!e:e}if(t.toggledNodes.has(i.id)){const e=t.toggledNodes.get(i.id);if(e)return this.isNodePathSelected(s,e)}return!!t.selectAllChildren}getRouteToNode(e){const t=[];let i=e;for(;i.parent;)t.push(i),i=i.parent;return t.reverse()}removeRedundantState(){var e=this;if(this.filterManager.isAnyFilterPresent())return;const t=function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.selectedState,s=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;if(i.toggledNodes.forEach(((e,s)=>{t(e,s,i)})),s){const t=e.rowModel.getRowNode(s),r=null==t?void 0:t.childStore;if((null==r?void 0:r.isLastRowIndexKnown())&&i.toggledNodes.size>=r.getRowCount()){for(const t of i.toggledNodes.entries()){const[i,s]=t;if(s.toggledNodes.size>0||!e.rowModel.getRowNode(i))return}i.selectAllChildren=!i.selectAllChildren,i.toggledNodes.clear()}}const a=0===i.toggledNodes.size,o=(null==r?void 0:r.selectAllChildren)===i.selectAllChildren;a&&o&&(null==r||r.toggledNodes.delete(s))};t()}recursivelySelectNode(e,t,i){let[s,...r]=e;if(!s)return;if(!r.length){const e=s.selectable;if(t.selectAllChildren===i.newValue||!e)return void t.toggledNodes.delete(s.id);const r={selectAllChildren:i.newValue,toggledNodes:new Map};return void t.toggledNodes.set(s.id,r)}const a=t.toggledNodes.has(s.id),o=a?t.toggledNodes.get(s.id):{selectAllChildren:t.selectAllChildren,toggledNodes:new Map};a||t.toggledNodes.set(s.id,o),this.recursivelySelectNode(r,o,i),t.selectAllChildren===o.selectAllChildren&&0===o.toggledNodes.size&&t.toggledNodes.delete(s.id)}getSelectedNodes(){console.warn("AG Grid: `getSelectedNodes` and `getSelectedRows` functions cannot be used with `groupSelectsChildren` and the server-side row model.\n            Use `api.getServerSideSelectionState()` instead.");const e=[];return this.rowModel.forEachNode((t=>{t.isSelected()&&e.push(t)})),e}processNewRow(e){}getSelectedRows(){return this.getSelectedNodes().map((e=>e.data))}getSelectionCount(){return-1}isEmpty(){var e;return!this.selectedState.selectAllChildren&&!(null!=(e=this.selectedState.toggledNodes)&&e.size)}selectAllRowNodes(e){this.selectedState={selectAllChildren:!0,toggledNodes:new Map}}deselectAllRowNodes(e){this.selectedState={selectAllChildren:!1,toggledNodes:new Map}}getSelectAllState(e,t){return this.selectedState.selectAllChildren?!(this.selectedState.toggledNodes.size>0)||null:this.selectedState.toggledNodes.size>0&&null}};uc([(0,s.A)("rowModel")],Fc.prototype,"rowModel",2),uc([(0,s.A)("columnModel")],Fc.prototype,"columnModel",2),uc([(0,s.A)("filterManager")],Fc.prototype,"filterManager",2),uc([(0,s.A)("rowModel")],Fc.prototype,"serverSideRowModel",2),uc([(0,s.A)("selectionService")],Fc.prototype,"selectionService",2),uc([s.a],Fc.prototype,"init",1);var Dc=class extends s.B{init(){const e=this.gridOptionsService.get("groupSelectsChildren");this.addManagedPropertyListener("groupSelectsChildren",(e=>{this.destroyBean(this.selectionStrategy);const t=e.currentValue?Fc:Pc;this.selectionStrategy=this.createManagedBean(new t),this.shotgunResetNodeSelectionState();const i={type:s.aA.EVENT_SELECTION_CHANGED,source:"api"};this.eventService.dispatchEvent(i)})),this.addManagedPropertyListener("rowSelection",(()=>this.deselectAllRowNodes({source:"api"})));const t=e?Fc:Pc;this.selectionStrategy=this.createManagedBean(new t)}getSelectionState(){return this.selectionStrategy.getSelectedState()}setSelectionState(e,t){if(Array.isArray(e))return;this.selectionStrategy.setSelectedState(e),this.shotgunResetNodeSelectionState();const i={type:s.aA.EVENT_SELECTION_CHANGED,source:t};this.eventService.dispatchEvent(i)}setNodesSelected(e){const t=e,{nodes:i}=t,r=cc(t,["nodes"]),a=this.gridOptionsService.get("rowSelection");if(i.length>1&&"multiple"!==a)return console.warn("AG Grid: cannot multi select while rowSelection='single'"),0;if(i.length>1&&e.rangeSelect)return console.warn("AG Grid: cannot use range selection when multi selecting rows"),0;const o=hc({nodes:i.filter((e=>e.selectable))},r);if(!o.nodes.length)return 0;const n=this.selectionStrategy.setNodesSelected(o);this.shotgunResetNodeSelectionState(o.source);const l={type:s.aA.EVENT_SELECTION_CHANGED,source:o.source};return this.eventService.dispatchEvent(l),n}deleteSelectionStateFromParent(e,t){if(!this.selectionStrategy.deleteSelectionStateFromParent(e,t))return;this.shotgunResetNodeSelectionState();const i={type:s.aA.EVENT_SELECTION_CHANGED,source:"api"};this.eventService.dispatchEvent(i)}shotgunResetNodeSelectionState(e){this.rowModel.forEachNode((t=>{if(t.stub)return;const i=this.selectionStrategy.isNodeSelected(t);i!==t.isSelected()&&t.selectThisNode(i,void 0,e)}))}getSelectedNodes(){return this.selectionStrategy.getSelectedNodes()}getSelectedRows(){return this.selectionStrategy.getSelectedRows()}getSelectionCount(){return this.selectionStrategy.getSelectionCount()}syncInRowNode(e,t){this.selectionStrategy.processNewRow(e);const i=this.selectionStrategy.isNodeSelected(e);if(0==i||e.selectable)e.setSelectedInitialValue(i);else{this.selectionStrategy.setNodesSelected({nodes:[e],newValue:!1,source:"api"}),this.shotgunResetNodeSelectionState();const t={type:s.aA.EVENT_SELECTION_CHANGED,source:"api"};this.eventService.dispatchEvent(t)}}reset(){this.selectionStrategy.deselectAllRowNodes({source:"api"})}isEmpty(){return this.selectionStrategy.isEmpty()}hasNodesToSelect(){return!0}selectAllRowNodes(e){(e.justCurrentPage||e.justFiltered)&&console.warn("AG Grid: selecting just filtered only works when gridOptions.rowModelType='clientSide'"),this.selectionStrategy.selectAllRowNodes(e),this.rowModel.forEachNode((t=>{t.stub||t.selectThisNode(!0,void 0,e.source)}));const t={type:s.aA.EVENT_SELECTION_CHANGED,source:e.source};this.eventService.dispatchEvent(t)}deselectAllRowNodes(e){(e.justCurrentPage||e.justFiltered)&&console.warn("AG Grid: selecting just filtered only works when gridOptions.rowModelType='clientSide'"),this.selectionStrategy.deselectAllRowNodes(e),this.rowModel.forEachNode((t=>{t.stub||t.selectThisNode(!1,void 0,e.source)}));const t={type:s.aA.EVENT_SELECTION_CHANGED,source:e.source};this.eventService.dispatchEvent(t)}getSelectAllState(e,t){return this.selectionStrategy.getSelectAllState(e,t)}updateGroupsFromChildrenSelections(e,t){return!1}getBestCostNodeSelection(){console.warn("AG Grid: calling gridApi.getBestCostNodeSelection() is only possible when using rowModelType=`clientSide`.")}filterFromSelection(){}};uc([(0,s.A)("rowModel")],Dc.prototype,"rowModel",2),uc([s.a],Dc.prototype,"init",1),Dc=uc([(0,s._)("selectionService")],Dc);var Rc=class extends s.aB{constructor(){super(...arguments),this.queuedRowIds=new Set}postConstruct(){super.postConstruct(),this.addManagedListener(this.eventService,s.aA.EVENT_COLUMN_ROW_GROUP_CHANGED,(()=>{this.queuedRowIds.clear()}))}checkOpenByDefault(e){if(!e.isExpandable())return;if(this.queuedRowIds.has(e.id))return this.queuedRowIds.delete(e.id),void e.setExpanded(!0);const t=this.gridOptionsService.getCallback("isServerSideGroupOpenByDefault");if(!t)return;t({data:e.data,rowNode:e})&&e.setExpanded(!0)}expandRows(e){e.forEach((e=>{const t=this.serverSideRowModel.getRowNode(e);t?t.setExpanded(!0):this.queuedRowIds.add(e)}))}expandAll(e){this.serverSideRowModel.expandAll(e)}onGroupExpandedOrCollapsed(){}};uc([(0,s.A)("rowModel")],Rc.prototype,"serverSideRowModel",2),Rc=uc([(0,s._)("expansionService")],Rc);var Lc={version:"31.2.1",moduleName:s.M.ServerSideRowModelModule,rowModel:"serverSide",beans:[fc,wc,Ac,yc,Sc,Ec,bc,xc,Tc,Mc,Dc,Rc,mc],dependantModules:[E]},Ic=Object.defineProperty,Oc=Object.getOwnPropertyDescriptor,Nc=(e,t,i,s)=>{for(var r,a=s>1?void 0:s?Oc(t,i):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s?r(t,i,a):r(a))||a);return s&&a&&Ic(t,i,a),a},kc=class{constructor(e,t,i,s,r,a,o,n,l,d,h){this.rowModel=e,this.filterParams=t,this.createKey=i,this.caseFormat=s,this.columnModel=r,this.valueService=a,this.treeDataOrGrouping=o,this.treeData=n,this.getDataPath=l,this.groupAllowUnbalanced=d,this.addManagedListener=h}extractUniqueValuesAsync(e,t){return new s.D((i=>{if(this.rowModel.isRowDataLoaded())i(this.extractUniqueValues(e,t));else{const r=this.addManagedListener(s.aA.EVENT_ROW_COUNT_READY,(()=>{null==r||r(),i(this.extractUniqueValues(e,t))}))}}))}extractUniqueValues(e,t){const i=new Map,r=this.extractExistingFormattedKeys(t),a=new Set,o=this.treeData&&!!this.getDataPath,n=this.columnModel.getRowGroupColumns(),l=(e,o)=>{const n=this.caseFormat(e);if(!a.has(n)){a.add(n);let l=e,d=s.ch.makeNull(o);const h=null==r?void 0:r.get(n);null!=h&&(l=h,d=t.get(h)),i.set(l,d)}};return this.rowModel.forEachLeafNode((t=>{if(!t.data||!e(t))return;if(this.treeDataOrGrouping)return void this.addValueForTreeDataOrGrouping(t,o,n,l);let i=this.getValue(t);this.filterParams.convertValuesToStrings?this.addValueForConvertValuesToString(t,i,l):null!=i&&Array.isArray(i)?(i.forEach((e=>{l(this.createKey(e,t),e)})),0===i.length&&l(null,null)):l(this.createKey(i,t),i)})),i}addValueForConvertValuesToString(e,t,i){const r=this.createKey(t,e);null!=r&&Array.isArray(r)?(r.forEach((e=>{const t=s.ch.toStringOrNull(s.ch.makeNull(e));i(t,t)})),0===r.length&&i(null,null)):i(r,r)}addValueForTreeDataOrGrouping(e,t,i,r){var a;let o;if(t){if(null!=(a=e.childrenAfterGroup)&&a.length)return;o=this.getDataPath(e.data)}else o=i.map((t=>this.valueService.getKeyForNode(t,e))),o.push(this.getValue(e));o&&(o=o.map((e=>s.ch.toStringOrNull(s.ch.makeNull(e))))),!t&&this.groupAllowUnbalanced&&null!=o&&o.some((e=>null==e))&&(o=o.filter((e=>null!=e))),r(this.createKey(o),o)}getValue(e){return this.filterParams.getValue(e)}extractExistingFormattedKeys(e){if(!e)return null;const t=new Map;return e.forEach(((e,i)=>{t.set(this.caseFormat(i),i)})),t}},Gc=class{};Gc.SELECT_ALL="__AG_SELECT_ALL__",Gc.ADD_SELECTION_TO_FILTER="__AG_ADD_SELECTION_TO_FILTER__";var Vc=class{constructor(e,t,i,s){this.valueFormatterService=e,this.valueFormatter=t,this.formatter=i,this.column=s,this.displayedKeys=[]}updateDisplayedValuesToAllAvailable(e,t,i){this.displayedKeys=Array.from(i)}updateDisplayedValuesToMatchMiniFilter(e,t,i,s,r){this.displayedKeys=[];for(let a of i)if(null==a)r&&this.displayedKeys.push(a);else{const t=e(a),i=this.valueFormatterService.formatValue(this.column,null,t,this.valueFormatter,!1);s(this.formatter(i))&&this.displayedKeys.push(a)}}getDisplayedValueCount(){return this.displayedKeys.length}getDisplayedItem(e){return this.displayedKeys[e]}getSelectAllItem(){return Gc.SELECT_ALL}getAddSelectionToFilterItem(){return Gc.ADD_SELECTION_TO_FILTER}getDisplayedKeys(){return this.displayedKeys}forEachDisplayedKey(e){this.displayedKeys.forEach(e)}someDisplayedKey(e){return this.displayedKeys.some(e)}hasGroups(){return!1}refresh(){}},Bc=class e{constructor(e,t,i,s){this.formatter=e,this.treeListPathGetter=t,this.treeListFormatter=i,this.treeDataOrGrouping=s,this.allDisplayedItemsTree=[],this.activeDisplayedItemsFlat=[],this.selectAllItem={depth:0,filterPasses:!0,available:!0,treeKey:Gc.SELECT_ALL,children:this.allDisplayedItemsTree,expanded:!0,key:Gc.SELECT_ALL,parentTreeKeys:[]},this.addSelectionToFilterItem={depth:0,filterPasses:!0,available:!0,treeKey:Gc.ADD_SELECTION_TO_FILTER,expanded:!0,key:Gc.ADD_SELECTION_TO_FILTER,parentTreeKeys:[]}}updateDisplayedValuesToAllAvailable(e,t,i,s){"reload"===s?this.generateItemTree(e,t,i):"otherFilter"===s?(this.updateAvailable(i),this.updateExpandAll()):"miniFilter"===s&&(this.resetFilter(),this.updateExpandAll()),this.flattenItems()}updateDisplayedValuesToMatchMiniFilter(e,t,i,s,r,a){"reload"===a?this.generateItemTree(e,t,i):"otherFilter"===a&&this.updateAvailable(i),this.updateFilter(s,r),this.updateExpandAll(),this.flattenItems()}generateItemTree(e,t,i){var s;this.allDisplayedItemsTree=[],this.groupsExist=!1;const r=this.getTreeListPathGetter(e,i);for(let a of t){const t=null!=(s=r(e(a)))?s:[null];t.length>1&&(this.groupsExist=!0);const o=i.has(a);let n,l=this.allDisplayedItemsTree,d=[];t.forEach(((e,i)=>{l||(l=[],n.children=l),n=l.find((t=>{var i;return(null==(i=t.treeKey)?void 0:i.toUpperCase())===(null==e?void 0:e.toUpperCase())})),n||(n={treeKey:e,depth:i,filterPasses:!0,expanded:!1,available:o,parentTreeKeys:d},i===t.length-1&&(n.key=a),l.push(n)),l=n.children,d=[...d,e]}))}this.updateAvailable(i),this.selectAllItem.children=this.allDisplayedItemsTree,this.selectAllItem.expanded=!1}getTreeListPathGetter(t,i){if(this.treeListPathGetter)return this.treeListPathGetter;if(this.treeDataOrGrouping)return e=>e;let r=!1;for(const e of i){const i=t(e);if(i instanceof Date){r=!0;break}if(null!=i)break}return r?e.DATE_TREE_LIST_PATH_GETTER:(s.ch.warnOnce("property treeList=true for Set Filter params, but you did not provide a treeListPathGetter or values of type Date."),e=>[String(e)])}flattenItems(){this.activeDisplayedItemsFlat=[];const e=t=>{t.forEach((t=>{!t.filterPasses||!t.available||(this.activeDisplayedItemsFlat.push(t),t.children&&t.expanded&&e(t.children))}))};e(this.allDisplayedItemsTree)}resetFilter(){const e=t=>{t.children&&t.children.forEach((t=>{e(t)})),t.filterPasses=!0};this.allDisplayedItemsTree.forEach((t=>e(t)))}updateFilter(e,t){const i=i=>!!i.available&&(null==i.treeKey?t:e(this.formatter(this.treeListFormatter?this.treeListFormatter(i.treeKey,i.depth,i.parentTreeKeys):i.treeKey)));this.allDisplayedItemsTree.forEach((e=>this.recursiveItemCheck(e,!1,i,"filterPasses")))}getDisplayedValueCount(){return this.activeDisplayedItemsFlat.length}getDisplayedItem(e){return this.activeDisplayedItemsFlat[e]}getSelectAllItem(){return this.selectAllItem}getAddSelectionToFilterItem(){return this.addSelectionToFilterItem}getDisplayedKeys(){const e=[];return this.forEachDisplayedKey((t=>e.push(t))),e}forEachDisplayedKey(e){const t=(i,s)=>{i.children?(!i.expanded||!s)&&i.children.forEach((e=>{e.filterPasses&&t(e,!1)})):e(i.key)};this.activeDisplayedItemsFlat.forEach((e=>t(e,!0)))}someDisplayedKey(e){const t=(i,s)=>i.children?(!i.expanded||!s)&&i.children.some((e=>!!e.filterPasses&&t(e,!1))):e(i.key);return this.activeDisplayedItemsFlat.some((e=>t(e,!0)))}hasGroups(){return this.groupsExist}refresh(){this.updateExpandAll(),this.flattenItems()}updateExpandAll(){const e=(t,i,s)=>{for(const r of t){if(!r.filterPasses||!r.available||!r.children)continue;if(i=i||!!r.expanded,s=s||!r.expanded,i&&s)return;const t=e(r.children,i,s);if(void 0===t)return;t?i=!0:s=!0}return i&&s?void 0:i},t=this.getSelectAllItem();t.expanded=e(t.children,!1,!1)}recursiveItemCheck(e,t,i,s){let r=!1;e.children&&e.children.forEach((a=>{const o=this.recursiveItemCheck(a,t||i(e),i,s);r=r||o}));const a=t||r||i(e);return e[s]=a,a}updateAvailable(e){const t=t=>e.has(t.key);this.allDisplayedItemsTree.forEach((e=>this.recursiveItemCheck(e,!1,t,"available")))}};Bc.DATE_TREE_LIST_PATH_GETTER=e=>e?[String(e.getFullYear()),String(e.getMonth()+1),String(e.getDate())]:null;var _c=Bc,Uc=class{constructor(e){let{caseFormat:t}=e;this.filteringKeys=null,this.filteringKeysCaseFormatted=null,this.hasNoAppliedFilteringKeys=!1,this.caseFormat=t}allFilteringKeys(){return this.filteringKeys}allFilteringKeysCaseFormatted(){return this.filteringKeysCaseFormatted}noAppliedFilteringKeys(){return this.hasNoAppliedFilteringKeys}setFilteringKeys(e){this.filteringKeys=new Set(e),this.hasNoAppliedFilteringKeys=!this.filteringKeys||0===this.filteringKeys.size,this.filteringKeysCaseFormatted=new Set,this.filteringKeys.forEach((e=>this.filteringKeysCaseFormatted.add(this.caseFormat(e))))}addFilteringKey(e){null==this.filteringKeys&&(this.filteringKeys=new Set,this.filteringKeysCaseFormatted=new Set),this.filteringKeys.add(e),this.filteringKeysCaseFormatted.add(this.caseFormat(e)),this.hasNoAppliedFilteringKeys&&(this.hasNoAppliedFilteringKeys=!1)}hasCaseFormattedFilteringKey(e){return this.filteringKeysCaseFormatted.has(this.caseFormat(e))}hasFilteringKey(e){return this.filteringKeys.has(e)}reset(){this.filteringKeys=null,this.filteringKeysCaseFormatted=null,this.hasNoAppliedFilteringKeys=!1}},Hc=class e{constructor(e){this.localEventService=new s.az,this.miniFilterText=null,this.addCurrentSelectionToFilter=!1,this.providedValues=null,this.allValues=new Map,this.availableKeys=new Set,this.selectedKeys=new Set,this.initialised=!1;const{usingComplexObjects:t,columnModel:i,valueService:r,treeDataTreeList:a,groupingTreeList:o,filterParams:n,gridOptionsService:l,valueFormatterService:d,valueFormatter:h,addManagedListener:c}=e,{column:u,colDef:p,textFormatter:g,doesRowPassOtherFilter:m,suppressSorting:v,comparator:C,rowModel:f,values:y,caseSensitive:S,convertValuesToStrings:E,treeList:b,treeListPathGetter:w,treeListFormatter:A}=n;this.filterParams=n,this.gridOptionsService=l,this.setIsLoading=e.setIsLoading,this.translate=e.translate,this.caseFormat=e.caseFormat,this.createKey=e.createKey,this.usingComplexObjects=!!e.usingComplexObjects,this.formatter=g||s.c1.DEFAULT_FORMATTER,this.doesRowPassOtherFilters=m,this.suppressSorting=v||!1,this.convertValuesToStrings=!!E,this.filteringKeys=new Uc({caseFormat:this.caseFormat});const x=C??p.comparator,T=!!a||!!o;this.compareByValue=!!(t&&x||T||b&&!w),this.entryComparator=T&&!x?this.createTreeDataOrGroupingComparator():!b||w||x?(e,t)=>{let[i,s]=e,[r,a]=t;return x(s,a)}:(e,t)=>{let[i,r]=e,[a,o]=t;return s.ch.defaultComparator(r,o)},this.keyComparator=x??s.ch.defaultComparator,this.caseSensitive=!!S;const M=l.get("getDataPath"),P=l.get("groupAllowUnbalanced");"clientSide"===f.getType()&&(this.clientSideValuesExtractor=new kc(f,this.filterParams,this.createKey,this.caseFormat,i,r,T,!!a,M,P,c)),null==y?this.valuesType=2:(this.valuesType=Array.isArray(y)?0:1,this.providedValues=y),this.displayValueModel=b?new _c(this.formatter,w,A,a||o):new Vc(d,h,this.formatter,u),this.updateAllValues().then((e=>this.resetSelectionState(e||[])))}addEventListener(e,t,i){this.localEventService.addEventListener(e,t,i)}removeEventListener(e,t,i){this.localEventService.removeEventListener(e,t,i)}updateOnParamsChange(e){return new s.D((t=>{const{values:i,textFormatter:r,suppressSorting:a}=e,o=this.providedValues,n=this.suppressSorting;if(this.filterParams=e,this.formatter=r||s.c1.DEFAULT_FORMATTER,this.suppressSorting=a||!1,this.providedValues=i??null,this.providedValues!==o||this.suppressSorting!==n){if(i&&0!==i.length){const e=Array.isArray(i)&&i.length>0&&"function"==typeof i[0];this.valuesType=e?1:0}else this.valuesType=2,this.providedValues=null;const e=this.getModel();this.updateAllValues().then((i=>{this.setModel(e).then((()=>t()))}))}else t()}))}refreshValues(){return new s.D((e=>{this.allValuesPromise.then((()=>{const t=this.getModel();this.updateAllValues(),this.setModel(t).then((()=>e()))}))}))}overrideValues(e){return new s.D((t=>{this.allValuesPromise.then((()=>{this.valuesType=0,this.providedValues=e,this.refreshValues().then((()=>t()))}))}))}refreshAfterAnyFilterChanged(){return this.showAvailableOnly()?this.allValuesPromise.then((e=>(this.updateAvailableKeys(e??[],"otherFilter"),!0))):s.D.resolve(!1)}isInitialised(){return this.initialised}updateAllValues(){return this.allValuesPromise=new s.D((e=>{switch(this.valuesType){case 2:this.getValuesFromRowsAsync(!1).then((t=>e(this.processAllValues(t))));break;case 0:e(this.processAllValues(this.uniqueValues(this.validateProvidedValues(this.providedValues))));break;case 1:{this.setIsLoading(!0);const t=this.providedValues,{column:i,colDef:s}=this.filterParams,r=this.gridOptionsService.addGridCommonParams({success:t=>{this.setIsLoading(!1),e(this.processAllValues(this.uniqueValues(this.validateProvidedValues(t))))},colDef:s,column:i});window.setTimeout((()=>t(r)),0);break}default:throw new Error("Unrecognised valuesType")}})),this.allValuesPromise.then((e=>this.updateAvailableKeys(e||[],"reload"))).then((()=>this.initialised=!0)),this.allValuesPromise}processAllValues(e){const t=this.sortKeys(e);return this.allValues=e??new Map,t}validateProvidedValues(e){if(this.usingComplexObjects&&null!=e&&e.length){const t=e[0];t&&"object"!=typeof t&&"function"!=typeof t&&(null==this.createKey(t)?s.ch.warnOnce("Set Filter Key Creator is returning null for provided values and provided values are primitives. Please provide complex objects or set convertValuesToStrings=true in the filterParams. See https://www.ag-grid.com/javascript-data-grid/filter-set-filter-list/#filter-value-types"):s.ch.warnOnce("Set Filter has a Key Creator, but provided values are primitives. Did you mean to provide complex objects or enable convertValuesToStrings?"))}return e}setValuesType(e){this.valuesType=e}getValuesType(){return this.valuesType}isKeyAvailable(e){return this.availableKeys.has(e)}showAvailableOnly(){return 2===this.valuesType}updateAvailableKeys(t,i){const s=this.showAvailableOnly()?this.sortKeys(this.getValuesFromRows(!0)):t;this.availableKeys=new Set(s),this.localEventService.dispatchEvent({type:e.EVENT_AVAILABLE_VALUES_CHANGED}),this.updateDisplayedValues(i,t)}sortKeys(e){const t=e??new Map;if(this.suppressSorting)return Array.from(t.keys());let i;return i=this.compareByValue?Array.from(t.entries()).sort(this.entryComparator).map((e=>{let[t]=e;return t})):Array.from(t.keys()).sort(this.keyComparator),this.filterParams.excelMode&&t.has(null)&&(i=i.filter((e=>null!=e)),i.push(null)),i}getParamsForValuesFromRows(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.clientSideValuesExtractor)return s.ch.doOnce((()=>{console.error("AG Grid: Set Filter cannot initialise because you are using a row model that does not contain all rows in the browser. Either use a different filter type, or configure Set Filter such that you provide it with values")}),"setFilterValueNotCSRM"),null;return{predicate:t=>!e||this.doesRowPassOtherFilters(t),existingValues:e&&!this.caseSensitive?this.allValues:void 0}}getValuesFromRows(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.getParamsForValuesFromRows(e);return t?this.clientSideValuesExtractor.extractUniqueValues(t.predicate,t.existingValues):null}getValuesFromRowsAsync(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.getParamsForValuesFromRows(e);return t?this.clientSideValuesExtractor.extractUniqueValuesAsync(t.predicate,t.existingValues):s.D.resolve(null)}setMiniFilter(e){return e=s.ch.makeNull(e),this.miniFilterText!==e&&(null===e&&this.setAddCurrentSelectionToFilter(!1),this.miniFilterText=e,this.updateDisplayedValues("miniFilter"),!0)}getMiniFilter(){return this.miniFilterText}updateDisplayedValues(e,t){if("expansion"===e)return void this.displayValueModel.refresh();if(null==this.miniFilterText)return void this.displayValueModel.updateDisplayedValuesToAllAvailable((e=>this.getValue(e)),t,this.availableKeys,e);const i=this.caseFormat(this.formatter(this.miniFilterText)||""),s=e=>null!=e&&this.caseFormat(e).indexOf(i)>=0,r=!!this.filterParams.excelMode&&s(this.translate("blanks"));this.displayValueModel.updateDisplayedValuesToMatchMiniFilter((e=>this.getValue(e)),t,this.availableKeys,s,r,e)}getDisplayedValueCount(){return this.displayValueModel.getDisplayedValueCount()}getDisplayedItem(e){return this.displayValueModel.getDisplayedItem(e)}getSelectAllItem(){return this.displayValueModel.getSelectAllItem()}getAddSelectionToFilterItem(){return this.displayValueModel.getAddSelectionToFilterItem()}hasSelections(){return this.filterParams.defaultToNothingSelected?this.selectedKeys.size>0:this.allValues.size!==this.selectedKeys.size}getKeys(){return Array.from(this.allValues.keys())}getValues(){return Array.from(this.allValues.values())}getValue(e){return this.allValues.get(e)}setAddCurrentSelectionToFilter(e){this.addCurrentSelectionToFilter=e}isInWindowsExcelMode(){return"windows"===this.filterParams.excelMode}isAddCurrentSelectionToFilterChecked(){return this.isInWindowsExcelMode()&&this.addCurrentSelectionToFilter}showAddCurrentSelectionToFilter(){return this.isInWindowsExcelMode()&&s.ch.exists(this.miniFilterText)&&this.miniFilterText.length>0}selectAllMatchingMiniFilter(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null==this.miniFilterText?this.selectedKeys=new Set(this.allValues.keys()):(e&&this.selectedKeys.clear(),this.displayValueModel.forEachDisplayedKey((e=>this.selectedKeys.add(e))))}deselectAllMatchingMiniFilter(){null==this.miniFilterText?this.selectedKeys.clear():this.displayValueModel.forEachDisplayedKey((e=>this.selectedKeys.delete(e)))}selectKey(e){this.selectedKeys.add(e)}deselectKey(e){this.filterParams.excelMode&&this.isEverythingVisibleSelected()&&this.resetSelectionState(this.displayValueModel.getDisplayedKeys()),this.selectedKeys.delete(e)}isKeySelected(e){return this.selectedKeys.has(e)}isEverythingVisibleSelected(){return!this.displayValueModel.someDisplayedKey((e=>!this.isKeySelected(e)))}isNothingVisibleSelected(){return!this.displayValueModel.someDisplayedKey((e=>this.isKeySelected(e)))}getModel(){if(!this.hasSelections())return null;const e=this.isAddCurrentSelectionToFilterChecked()?this.filteringKeys.allFilteringKeys():null;if(e&&e.size>0){if(this.selectedKeys){const t=new Set([...Array.from(e),...Array.from(this.selectedKeys).filter((t=>!e.has(t)))]);return Array.from(t)}return Array.from(e)}return Array.from(this.selectedKeys)}setModel(e){return this.allValuesPromise.then((t=>{if(null==e)this.resetSelectionState(t??[]);else{this.selectedKeys.clear();const t=new Map;this.allValues.forEach(((e,i)=>{t.set(this.caseFormat(i),i)})),e.forEach((e=>{const i=this.caseFormat(s.ch.makeNull(e)),r=t.get(i);void 0!==r&&this.selectKey(r)}))}}))}uniqueValues(e){const t=new Map,i=new Set;return(e??[]).forEach((e=>{const r=s.ch.makeNull(e),a=this.convertAndGetKey(r),o=this.caseFormat(a);i.has(o)||(i.add(o),t.set(a,r))})),t}convertAndGetKey(e){return this.convertValuesToStrings?e:this.createKey(e)}resetSelectionState(e){this.filterParams.defaultToNothingSelected?this.selectedKeys.clear():this.selectedKeys=new Set(e)}hasGroups(){return this.displayValueModel.hasGroups()}createTreeDataOrGroupingComparator(){return(e,t)=>{let[i,r]=e,[a,o]=t;if(null==r)return null==o?0:-1;if(null==o)return 1;for(let n=0;n<r.length;n++){if(n>=o.length)return 1;const e=s.ch.defaultComparator(r[n],o[n]);if(0!==e)return e}return 0}}setAppliedModelKeys(e){this.filteringKeys.setFilteringKeys(e)}addToAppliedModelKeys(e){this.filteringKeys.addFilteringKey(e)}getAppliedModelKeys(){return this.filteringKeys.allFilteringKeys()}getCaseFormattedAppliedModelKeys(){return this.filteringKeys.allFilteringKeysCaseFormatted()}hasAppliedModelKey(e){return this.filteringKeys.hasCaseFormattedFilteringKey(e)}hasAnyAppliedModelKey(){return!this.filteringKeys.noAppliedFilteringKeys()}};Hc.EVENT_AVAILABLE_VALUES_CHANGED="availableValuesChanged";var Wc=Hc,Kc=class e extends s.ak{constructor(t){var i;super(t.isGroup?e.GROUP_TEMPLATE:e.TEMPLATE),this.focusWrapper=t.focusWrapper,this.value=t.value,this.params=t.params,this.translate=t.translate,this.valueFormatter=t.valueFormatter,this.item=t.item,this.isSelected=t.isSelected,this.isTree=t.isTree,this.depth=null!=(i=t.depth)?i:0,this.isGroup=t.isGroup,this.groupsExist=t.groupsExist,this.isExpanded=t.isExpanded,this.hasIndeterminateExpandState=t.hasIndeterminateExpandState}init(){this.addDestroyFunc((()=>{var e;return null==(e=this.destroyCellRendererComponent)?void 0:e.call(this)})),this.render(),this.eCheckbox.setLabelEllipsis(!0).setValue(this.isSelected,!0).setDisabled(!!this.params.readOnly).getInputElement().setAttribute("tabindex","-1"),this.refreshVariableAriaLabels(),this.isTree&&(this.depth>0&&this.addCssClass("ag-set-filter-indent-"+this.depth),this.isGroup?this.setupExpansion():this.groupsExist&&this.addCssClass("ag-set-filter-add-group-indent"),s.ch.setAriaLevel(this.getAriaElement(),this.depth+1)),this.refreshAriaChecked(),!this.params.readOnly&&this.eCheckbox.onValueChange((e=>this.onCheckboxChanged(!!e)))}getFocusableElement(){return this.focusWrapper}setupExpansion(){this.eGroupClosedIcon.appendChild(s.ch.createIcon("setFilterGroupClosed",this.gridOptionsService,null)),this.eGroupOpenedIcon.appendChild(s.ch.createIcon("setFilterGroupOpen",this.gridOptionsService,null)),this.addManagedListener(this.eGroupClosedIcon,"click",this.onExpandOrContractClicked.bind(this)),this.addManagedListener(this.eGroupOpenedIcon,"click",this.onExpandOrContractClicked.bind(this)),this.hasIndeterminateExpandState&&(this.eGroupIndeterminateIcon.appendChild(s.ch.createIcon("setFilterGroupIndeterminate",this.gridOptionsService,null)),this.addManagedListener(this.eGroupIndeterminateIcon,"click",this.onExpandOrContractClicked.bind(this))),this.setExpandedIcons(),this.refreshAriaExpanded()}onExpandOrContractClicked(){this.setExpanded(!this.isExpanded)}setExpanded(t,i){if(this.isGroup&&t!==this.isExpanded){this.isExpanded=t;const s={type:e.EVENT_EXPANDED_CHANGED,isExpanded:!!t,item:this.item};i||this.dispatchEvent(s),this.setExpandedIcons(),this.refreshAriaExpanded()}}setExpandedIcons(){s.ch.setDisplayed(this.eGroupClosedIcon,this.hasIndeterminateExpandState?!1===this.isExpanded:!this.isExpanded),s.ch.setDisplayed(this.eGroupOpenedIcon,!0===this.isExpanded),this.hasIndeterminateExpandState&&s.ch.setDisplayed(this.eGroupIndeterminateIcon,void 0===this.isExpanded)}onCheckboxChanged(t){this.isSelected=t;const i={type:e.EVENT_SELECTION_CHANGED,isSelected:t,item:this.item};this.dispatchEvent(i),this.refreshVariableAriaLabels(),this.refreshAriaChecked()}toggleSelected(){this.params.readOnly||this.setSelected(!this.isSelected)}setSelected(e,t){this.isSelected=e,this.eCheckbox.setValue(e,t),this.refreshAriaChecked()}refreshVariableAriaLabels(){if(!this.isTree)return;const e=this.localeService.getLocaleTextFunc(),t=this.eCheckbox.getValue(),i=void 0===t?e("ariaIndeterminate","indeterminate"):t?e("ariaVisible","visible"):e("ariaHidden","hidden"),r=e("ariaToggleVisibility","Press SPACE to toggle visibility");s.ch.setAriaLabelledBy(this.eCheckbox.getInputElement(),void 0),this.eCheckbox.setInputAriaLabel(`${r} (${i})`)}setupFixedAriaLabels(e){if(!this.isTree)return;const t=this.localeService.getLocaleTextFunc()("ariaFilterValue","Filter Value"),i=this.getAriaElement();s.ch.setAriaLabel(i,`${e} ${t}`),s.ch.setAriaDescribedBy(i,this.eCheckbox.getInputElement().id)}refreshAriaChecked(){const e=this.getAriaElement();s.ch.setAriaChecked(e,this.eCheckbox.getValue())}refreshAriaExpanded(){s.ch.setAriaExpanded(this.getAriaElement(),!!this.isExpanded)}refresh(e,t,i){var s,r;if(this.item=e,t!==this.isSelected&&this.setSelected(t,!0),this.setExpanded(i,!0),this.valueFunction){const e=this.valueFunction();this.setTooltipAndCellRendererParams(e,e),this.cellRendererComponent||this.renderCellWithoutCellRenderer()}if(this.cellRendererComponent&&!(null==(r=(s=this.cellRendererComponent).refresh)?void 0:r.call(s,this.cellRendererParams))){const e=this.cellRendererComponent;this.renderCell(),this.destroyBean(e)}}render(){const{params:{column:e}}=this;let{value:t}=this,i=null;"function"==typeof t?(this.valueFunction=t,i=this.valueFunction(),t=i):i=this.isTree?s.ch.toStringOrNull(t):this.getFormattedValue(e,t),this.setTooltipAndCellRendererParams(t,i),this.renderCell()}setTooltipAndCellRendererParams(e,t){const i="whenTruncated"===this.gridOptionsService.get("tooltipShowMode");if(this.params.showTooltips&&(!i||!this.params.cellRenderer)){const r=t??s.ch.toStringOrNull(e);let a;i&&(a=()=>{const e=this.eCheckbox.getGui().querySelector(".ag-label");return!e||e.scrollWidth>e.clientWidth}),this.setTooltip({newTooltipText:r,location:"setFilterValue",shouldDisplayTooltip:a})}this.cellRendererParams=this.gridOptionsService.addGridCommonParams({value:e,valueFormatted:t,colDef:this.params.colDef,column:this.params.column,setTooltip:(e,t)=>{this.setTooltip({newTooltipText:e,location:"setFilterValue",shouldDisplayTooltip:t})}})}getTooltipParams(){const e=super.getTooltipParams();return e.location="setFilterValue",e.colDef=this.getComponentHolder(),this.isTree&&(e.level=this.depth),e}getFormattedValue(e,t){return this.valueFormatterService.formatValue(e,null,t,this.valueFormatter,!1)}renderCell(){const e=this.userComponentFactory.getSetFilterCellRendererDetails(this.params,this.cellRendererParams),t=e?e.newAgStackInstance():void 0;null!=t?t.then((e=>{e&&(this.cellRendererComponent=e,this.eCheckbox.setLabel(e.getGui()),this.destroyCellRendererComponent=()=>this.destroyBean(e))})):this.renderCellWithoutCellRenderer()}renderCellWithoutCellRenderer(){var e;let t=null!=(e=null==this.cellRendererParams.valueFormatted?this.cellRendererParams.value:this.cellRendererParams.valueFormatted)?e:this.translate("blanks");"string"!=typeof t&&(s.ch.warnOnce(`Set Filter Value Formatter must return string values. Please ensure the Set Filter Value Formatter returns string values for complex objects, or set convertValuesToStrings=true in the filterParams. See ${this.getFrameworkOverrides().getDocLink("filter-set-filter-list/#filter-value-types")}`),t=""),this.eCheckbox.setLabel(t),this.setupFixedAriaLabels(t)}getComponentHolder(){return this.params.column.getColDef()}};Kc.EVENT_SELECTION_CHANGED="selectionChanged",Kc.EVENT_EXPANDED_CHANGED="expandedChanged",Kc.GROUP_TEMPLATE='\n        <div class="ag-set-filter-item" aria-hidden="true">\n            <span class="ag-set-filter-group-icons">\n                <span class="ag-set-filter-group-closed-icon" ref="eGroupClosedIcon"></span>\n                <span class="ag-set-filter-group-opened-icon" ref="eGroupOpenedIcon"></span>\n                <span class="ag-set-filter-group-indeterminate-icon" ref="eGroupIndeterminateIcon"></span>\n            </span>\n            <ag-checkbox ref="eCheckbox" class="ag-set-filter-item-checkbox"></ag-checkbox>\n        </div>',Kc.TEMPLATE='\n        <div class="ag-set-filter-item">\n            <ag-checkbox ref="eCheckbox" class="ag-set-filter-item-checkbox"></ag-checkbox>\n        </div>',Nc([(0,s.A)("valueFormatterService")],Kc.prototype,"valueFormatterService",2),Nc([(0,s.A)("userComponentFactory")],Kc.prototype,"userComponentFactory",2),Nc([(0,s.R)("eCheckbox")],Kc.prototype,"eCheckbox",2),Nc([(0,s.R)("eGroupOpenedIcon")],Kc.prototype,"eGroupOpenedIcon",2),Nc([(0,s.R)("eGroupClosedIcon")],Kc.prototype,"eGroupClosedIcon",2),Nc([(0,s.R)("eGroupIndeterminateIcon")],Kc.prototype,"eGroupIndeterminateIcon",2),Nc([s.a],Kc.prototype,"init",1);var zc=Kc,$c={loadingOoo:"Loading...",blanks:"(Blanks)",searchOoo:"Search...",selectAll:"(Select All)",selectAllSearchResults:"(Select All Search Results)",addCurrentSelectionToFilter:"Add current selection to filter",noMatches:"No matches."},jc=class{getModelAsString(e,t){const{values:i}=e||t.getModel()||{},s=t.getValueModel();if(null==i||null==s)return"";const r=i.filter((e=>s.isKeyAvailable(e))),a=r.length;return`(${a}) ${r.slice(0,10).map((e=>t.getFormattedValue(e))).join(",")}${a>10?",...":""}`}},Yc=class extends s.bu{constructor(){super("setFilter"),this.valueModel=null,this.setFilterParams=null,this.virtualList=null,this.caseSensitive=!1,this.convertValuesToStrings=!1,this.treeDataTreeList=!1,this.groupingTreeList=!1,this.hardRefreshVirtualList=!1,this.noValueFormatterSupplied=!1,this.filterModelFormatter=new jc,this.updateSetFilterOnParamsChange=e=>{var t;this.setFilterParams=e,this.convertValuesToStrings=!!e.convertValuesToStrings,this.caseSensitive=!!e.caseSensitive;const i=null!=(t=e.keyCreator)?t:e.colDef.keyCreator;this.setValueFormatter(e.valueFormatter,i,this.convertValuesToStrings,!!e.treeList,!!e.colDef.refData);const r=e.column.getId().startsWith(s.aG);this.treeDataTreeList=this.gridOptionsService.get("treeData")&&!!e.treeList&&r,this.getDataPath=this.gridOptionsService.get("getDataPath"),this.groupingTreeList=!!this.columnModel.getRowGroupColumns().length&&!!e.treeList&&r,this.createKey=this.generateCreateKey(i,this.convertValuesToStrings,this.treeDataTreeList||this.groupingTreeList)}}postConstruct(){super.postConstruct()}updateUiVisibility(){}createBodyTemplate(){return`\n            <div class="ag-set-filter">\n                <div ref="eFilterLoading" class="ag-filter-loading ag-hidden">${this.translateForSetFilter("loadingOoo")}</div>\n                <ag-input-text-field class="ag-mini-filter" ref="eMiniFilter"></ag-input-text-field>\n                <div ref="eFilterNoMatches" class="ag-filter-no-matches ag-hidden">${this.translateForSetFilter("noMatches")}</div>\n                <div ref="eSetFilterList" class="ag-set-filter-list" role="presentation"></div>\n            </div>`}handleKeyDown(e){if(super.handleKeyDown(e),!e.defaultPrevented)switch(e.key){case s.b6.SPACE:this.handleKeySpace(e);break;case s.b6.ENTER:this.handleKeyEnter(e);break;case s.b6.LEFT:this.handleKeyLeft(e);break;case s.b6.RIGHT:this.handleKeyRight(e)}}handleKeySpace(e){var t;null==(t=this.getComponentForKeyEvent(e))||t.toggleSelected()}handleKeyEnter(e){if(!this.setFilterParams)return;const{excelMode:t,readOnly:i}=this.setFilterParams||{};!t||i||(e.preventDefault(),this.onBtApply(!1,!1,e),"mac"===this.setFilterParams.excelMode&&this.eMiniFilter.getInputElement().select())}handleKeyLeft(e){var t;null==(t=this.getComponentForKeyEvent(e))||t.setExpanded(!1)}handleKeyRight(e){var t;null==(t=this.getComponentForKeyEvent(e))||t.setExpanded(!0)}getComponentForKeyEvent(e){var t;const i=this.gridOptionsService.getDocument();if(!this.eSetFilterList.contains(i.activeElement)||!this.virtualList)return;const s=this.virtualList.getLastFocusedRow();if(null==s)return;const r=this.virtualList.getComponentAt(s);if(null==r)return;e.preventDefault();const{readOnly:a}=null!=(t=this.setFilterParams)?t:{};return a?void 0:r}getCssIdentifier(){return"set-filter"}setModel(e){var t;return null==e&&null==(null==(t=this.valueModel)?void 0:t.getModel())?(this.setMiniFilter(null),s.D.resolve()):super.setModel(e)}refresh(e){var t,i,s;return!(!super.refresh(e)||["treeList","treeListFormatter","treeListPathGetter","keyCreator","convertValuesToStrings","caseSensitive","comparator","suppressSelectAll","excelMode"].some((t=>{var i;return e[t]!==(null==(i=this.setFilterParams)?void 0:i[t])}))||this.haveColDefParamsChanged(e.colDef))&&(super.updateParams(e),this.updateSetFilterOnParamsChange(e),this.updateMiniFilter(),(e.cellRenderer!==(null==(t=this.setFilterParams)?void 0:t.cellRenderer)||e.valueFormatter!==(null==(i=this.setFilterParams)?void 0:i.valueFormatter))&&this.checkAndRefreshVirtualList(),null==(s=this.valueModel)||s.updateOnParamsChange(e).then((()=>{var e;null!=(e=this.valueModel)&&e.hasSelections()&&this.refreshFilterValues()})),!0)}haveColDefParamsChanged(e){var t;const i=null==(t=this.setFilterParams)?void 0:t.colDef;return["keyCreator","filterValueGetter"].some((t=>e[t]!==(null==i?void 0:i[t])))}setModelAndRefresh(e){return this.valueModel?this.valueModel.setModel(e).then((()=>this.checkAndRefreshVirtualList())):s.D.resolve()}resetUiToDefaults(){return this.setMiniFilter(null),this.setModelAndRefresh(null)}setModelIntoUi(e){this.setMiniFilter(null);const t=null==e?null:e.values;return this.setModelAndRefresh(t)}getModelFromUi(){if(!this.valueModel)throw new Error("Value model has not been created.");const e=this.valueModel.getModel();return e?{values:e,filterType:this.getFilterType()}:null}getFilterType(){return"set"}getValueModel(){return this.valueModel}areModelsEqual(e,t){return null==e&&null==t||null!=e&&null!=t&&s.ch.areEqual(e.values,t.values)}setParams(e){var t;this.applyExcelModeOptions(e),super.setParams(e),this.updateSetFilterOnParamsChange(e);const i=null!=(t=e.keyCreator)?t:e.colDef.keyCreator;this.valueModel=new Wc({filterParams:e,setIsLoading:e=>this.setIsLoading(e),valueFormatterService:this.valueFormatterService,translate:e=>this.translateForSetFilter(e),caseFormat:e=>this.caseFormat(e),createKey:this.createKey,valueFormatter:this.valueFormatter,usingComplexObjects:!!i,gridOptionsService:this.gridOptionsService,columnModel:this.columnModel,valueService:this.valueService,treeDataTreeList:this.treeDataTreeList,groupingTreeList:this.groupingTreeList,addManagedListener:(e,t)=>this.addManagedListener(this.eventService,e,t)}),this.initialiseFilterBodyUi(),this.addEventListenersForDataChanges()}onAddCurrentSelectionToFilterChange(e){if(!this.valueModel)throw new Error("Value model has not been created.");this.valueModel.setAddCurrentSelectionToFilter(e)}setValueFormatter(e,t,i,r,a){let o=e;if(!o){if(t&&!i&&!r)throw new Error("AG Grid: Must supply a Value Formatter in Set Filter params when using a Key Creator unless convertValuesToStrings is enabled");this.noValueFormatterSupplied=!0,a||(o=e=>s.ch.toStringOrNull(e.value))}this.valueFormatter=o}generateCreateKey(e,t,i){var r=this;if(i&&!e)throw new Error("AG Grid: Must supply a Key Creator in Set Filter params when `treeList = true` on a group column, and Tree Data or Row Grouping is enabled.");return e?function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const a=r.getKeyCreatorParams(t,i);return s.ch.makeNull(e(a))}:t?e=>Array.isArray(e)?e:s.ch.makeNull(s.ch.toStringOrNull(e)):e=>s.ch.makeNull(s.ch.toStringOrNull(e))}getFormattedValue(e){var t;let i=this.valueModel.getValue(e);this.noValueFormatterSupplied&&(this.treeDataTreeList||this.groupingTreeList)&&Array.isArray(i)&&(i=s.ch.last(i));return null!=(t=this.valueFormatterService.formatValue(this.setFilterParams.column,null,i,this.valueFormatter,!1)??s.ch.toStringOrNull(i))?t:this.translateForSetFilter("blanks")}applyExcelModeOptions(e){"windows"===e.excelMode?(e.buttons||(e.buttons=["apply","cancel"]),null==e.closeOnApply&&(e.closeOnApply=!0)):"mac"===e.excelMode&&(e.buttons||(e.buttons=["reset"]),null==e.applyMiniFilterWhileTyping&&(e.applyMiniFilterWhileTyping=!0),null==e.debounceMs&&(e.debounceMs=500)),e.excelMode&&e.defaultToNothingSelected&&(e.defaultToNothingSelected=!1,s.ch.warnOnce('The Set Filter Parameter "defaultToNothingSelected" value was ignored because it does not work when "excelMode" is used.'))}addEventListenersForDataChanges(){this.isValuesTakenFromGrid()&&(this.addManagedListener(this.eventService,s.aA.EVENT_CELL_VALUE_CHANGED,(e=>{this.setFilterParams&&e.column===this.setFilterParams.column&&this.syncAfterDataChange()})),this.addManagedPropertyListeners(["treeData","getDataPath","groupAllowUnbalanced"],(()=>{this.syncAfterDataChange()})))}syncAfterDataChange(){if(!this.valueModel)throw new Error("Value model has not been created.");return this.valueModel.refreshValues().then((()=>{this.checkAndRefreshVirtualList(),this.onBtApply(!1,!0)}))}setIsLoading(e){s.ch.setDisplayed(this.eFilterLoading,e),e||(this.hardRefreshVirtualList=!0)}initialiseFilterBodyUi(){this.initVirtualList(),this.initMiniFilter()}initVirtualList(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");const e=this.localeService.getLocaleTextFunc()("ariaFilterList","Filter List"),t=!!this.setFilterParams.treeList,i=this.virtualList=this.createBean(new s.cf({cssIdentifier:"filter",ariaRole:t?"tree":"listbox",listName:e})),r=this.getRefElement("eSetFilterList");t&&r.classList.add("ag-set-filter-tree-list"),r&&r.appendChild(i.getGui());const{cellHeight:a}=this.setFilterParams;null!=a&&i.setRowHeight(a);i.setComponentCreator(((e,i)=>this.createSetListItem(e,t,i)));let o;i.setComponentUpdater(((e,t)=>this.updateSetListItem(e,t))),o=this.setFilterParams.suppressSelectAll?new qc(this.valueModel):new Xc(this.valueModel,(()=>this.isSelectAllSelected())),t&&(o=new Zc(o)),i.setModel(o)}getSelectAllLabel(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");const e=null!=this.valueModel.getMiniFilter()&&this.setFilterParams.excelMode?"selectAllSearchResults":"selectAll";return this.translateForSetFilter(e)}getAddSelectionToFilterLabel(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");return this.translateForSetFilter("addCurrentSelectionToFilter")}createSetListItem(e,t,i){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");const s=this.valueModel.hasGroups(),{isSelected:r,isExpanded:a}=this.isSelectedExpanded(e),{value:o,depth:n,isGroup:l,hasIndeterminateExpandState:d,selectedListener:h,expandedListener:c}=this.newSetListItemAttributes(e,t),u={focusWrapper:i,value:o,params:this.setFilterParams,translate:e=>this.translateForSetFilter(e),valueFormatter:this.valueFormatter,item:e,isSelected:r,isTree:t,depth:n,groupsExist:s,isGroup:l,isExpanded:a,hasIndeterminateExpandState:d},p=this.createBean(new zc(u));return p.addEventListener(zc.EVENT_SELECTION_CHANGED,h),c&&p.addEventListener(zc.EVENT_EXPANDED_CHANGED,c),p}newSetTreeItemAttributes(e,t){var i,s,r,a,o,n;if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");const l=this.valueModel.hasGroups();return e.key===Gc.SELECT_ALL?{value:()=>this.getSelectAllLabel(),isGroup:l,depth:e.depth,hasIndeterminateExpandState:!0,selectedListener:e=>this.onSelectAll(e.isSelected),expandedListener:e=>this.onExpandAll(e.item,e.isExpanded)}:e.key===Gc.ADD_SELECTION_TO_FILTER?{value:()=>this.getAddSelectionToFilterLabel(),depth:e.depth,isGroup:!1,hasIndeterminateExpandState:!1,selectedListener:e=>{this.onAddCurrentSelectionToFilterChange(e.isSelected)}}:e.children?{value:null!=(r=null==(s=(i=this.setFilterParams).treeListFormatter)?void 0:s.call(i,e.treeKey,e.depth,e.parentTreeKeys))?r:e.treeKey,depth:e.depth,isGroup:!0,selectedListener:e=>this.onGroupItemSelected(e.item,e.isSelected),expandedListener:e=>this.onExpandedChanged(e.item,e.isExpanded)}:{value:null!=(n=null==(o=(a=this.setFilterParams).treeListFormatter)?void 0:o.call(a,e.treeKey,e.depth,e.parentTreeKeys))?n:e.treeKey,depth:e.depth,selectedListener:e=>this.onItemSelected(e.item.key,e.isSelected)}}newSetListItemAttributes(e,t){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");return this.isSetFilterModelTreeItem(e)?this.newSetTreeItemAttributes(e,t):e===Gc.SELECT_ALL?{value:()=>this.getSelectAllLabel(),selectedListener:e=>this.onSelectAll(e.isSelected)}:e===Gc.ADD_SELECTION_TO_FILTER?{value:()=>this.getAddSelectionToFilterLabel(),selectedListener:e=>{this.onAddCurrentSelectionToFilterChange(e.isSelected)}}:{value:this.valueModel.getValue(e),selectedListener:e=>this.onItemSelected(e.item,e.isSelected)}}updateSetListItem(e,t){const{isSelected:i,isExpanded:s}=this.isSelectedExpanded(e);t.refresh(e,i,s)}isSelectedExpanded(e){let t,i;return this.isSetFilterModelTreeItem(e)?(i=e.expanded,t=e.key===Gc.SELECT_ALL?this.isSelectAllSelected():e.key===Gc.ADD_SELECTION_TO_FILTER?this.valueModel.isAddCurrentSelectionToFilterChecked():e.children?this.areAllChildrenSelected(e):this.valueModel.isKeySelected(e.key)):t=e===Gc.SELECT_ALL?this.isSelectAllSelected():e===Gc.ADD_SELECTION_TO_FILTER?this.valueModel.isAddCurrentSelectionToFilterChecked():this.valueModel.isKeySelected(e),{isSelected:t,isExpanded:i}}isSetFilterModelTreeItem(e){return void 0!==(null==e?void 0:e.treeKey)}initMiniFilter(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");const{eMiniFilter:e,localeService:t}=this,i=t.getLocaleTextFunc();e.setDisplayed(!this.setFilterParams.suppressMiniFilter),e.setValue(this.valueModel.getMiniFilter()),e.onValueChange((()=>this.onMiniFilterInput())),e.setInputAriaLabel(i("ariaSearchFilterValues","Search filter values")),this.addManagedListener(e.getInputElement(),"keydown",(e=>this.onMiniFilterKeyDown(e)))}updateMiniFilter(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");const{eMiniFilter:e}=this;e.isDisplayed()!==!this.setFilterParams.suppressMiniFilter&&e.setDisplayed(!this.setFilterParams.suppressMiniFilter);const t=this.valueModel.getMiniFilter();e.getValue()!==t&&e.setValue(t)}afterGuiAttached(e){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");super.afterGuiAttached(e),this.resetExpansion(),this.refreshVirtualList();const{eMiniFilter:t}=this;t.setInputPlaceholder(this.translateForSetFilter("searchOoo")),(!e||!e.suppressFocus)&&t.getFocusableElement().focus()}afterGuiDetached(){var e,t;super.afterGuiDetached(),null!=(e=this.setFilterParams)&&e.excelMode&&this.resetMiniFilter();const i=this.getModel();(null!=(t=this.setFilterParams)&&t.excelMode||!this.areModelsEqual(i,this.getModelFromUi()))&&(this.resetUiToActiveModel(i),this.showOrHideResults())}applyModel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"api";if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");this.setFilterParams.excelMode&&"rowDataUpdated"!==e&&this.valueModel.isEverythingVisibleSelected()&&this.valueModel.selectAllMatchingMiniFilter();const t=this.valueModel.showAddCurrentSelectionToFilter()&&this.valueModel.isAddCurrentSelectionToFilterChecked();if(t&&!this.getModel())return!1;const i=super.applyModel(e),s=this.getModel();return s?(t||this.valueModel.setAppliedModelKeys(new Set),s.values.forEach((e=>{this.valueModel.addToAppliedModelKeys(e)}))):t||this.valueModel.setAppliedModelKeys(null),i}isModelValid(e){return!this.setFilterParams||!this.setFilterParams.excelMode||(null==e||e.values.length>0)}doesFilterPass(e){if(!this.setFilterParams||!this.valueModel||!this.valueModel.getCaseFormattedAppliedModelKeys())return!0;if(!this.valueModel.hasAnyAppliedModelKey())return!1;const{node:t,data:i}=e;if(this.treeDataTreeList)return this.doesFilterPassForTreeData(t,i);if(this.groupingTreeList)return this.doesFilterPassForGrouping(t);let s=this.getValueFromNode(t);return this.convertValuesToStrings?this.doesFilterPassForConvertValuesToString(t,s):null!=s&&Array.isArray(s)?0===s.length?this.valueModel.hasAppliedModelKey(null):s.some((e=>this.isInAppliedModel(this.createKey(e,t)))):this.isInAppliedModel(this.createKey(s,t))}doesFilterPassForConvertValuesToString(e,t){const i=this.createKey(t,e);return null!=i&&Array.isArray(i)?0===i.length?this.valueModel.hasAppliedModelKey(null):i.some((e=>this.isInAppliedModel(e))):this.isInAppliedModel(i)}doesFilterPassForTreeData(e,t){var i;return(null==(i=e.childrenAfterGroup)||!i.length)&&this.isInAppliedModel(this.createKey(this.checkMakeNullDataPath(this.getDataPath(t))))}doesFilterPassForGrouping(e){const t=this.columnModel.getRowGroupColumns().map((t=>this.valueService.getKeyForNode(t,e)));return t.push(this.getValueFromNode(e)),this.isInAppliedModel(this.createKey(this.checkMakeNullDataPath(t)))}checkMakeNullDataPath(e){return e&&(e=e.map((e=>s.ch.toStringOrNull(s.ch.makeNull(e))))),null!=e&&e.some((e=>null==e))?null:e}isInAppliedModel(e){return this.valueModel.hasAppliedModelKey(e)}getValueFromNode(e){return this.setFilterParams.getValue(e)}getKeyCreatorParams(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{value:e,colDef:this.setFilterParams.colDef,column:this.setFilterParams.column,node:t,data:null==t?void 0:t.data,api:this.setFilterParams.api,columnApi:this.setFilterParams.columnApi,context:this.setFilterParams.context}}onNewRowsLoaded(){this.isValuesTakenFromGrid()&&this.syncAfterDataChange()}isValuesTakenFromGrid(){return!!this.valueModel&&2===this.valueModel.getValuesType()}setFilterValues(e){if(!this.valueModel)throw new Error("Value model has not been created.");this.valueModel.overrideValues(e).then((()=>{this.checkAndRefreshVirtualList(),this.onUiChanged()}))}resetFilterValues(){if(!this.valueModel)throw new Error("Value model has not been created.");this.valueModel.setValuesType(2),this.syncAfterDataChange()}refreshFilterValues(){if(!this.valueModel)throw new Error("Value model has not been created.");this.valueModel.isInitialised()&&this.valueModel.refreshValues().then((()=>{this.checkAndRefreshVirtualList(),this.onUiChanged()}))}onAnyFilterChanged(){setTimeout((()=>{if(this.isAlive()){if(!this.valueModel)throw new Error("Value model has not been created.");this.valueModel.refreshAfterAnyFilterChanged().then((e=>{e&&(this.checkAndRefreshVirtualList(),this.showOrHideResults())}))}}),0)}onMiniFilterInput(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");if(!this.valueModel.setMiniFilter(this.eMiniFilter.getValue()))return;const{applyMiniFilterWhileTyping:e,readOnly:t}=this.setFilterParams||{};!t&&e?this.filterOnAllVisibleValues(!1):this.updateUiAfterMiniFilterChange()}updateUiAfterMiniFilterChange(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");const{excelMode:e,readOnly:t}=this.setFilterParams||{};null==e||t?this.checkAndRefreshVirtualList():null==this.valueModel.getMiniFilter()?this.resetUiToActiveModel(this.getModel()):(this.valueModel.selectAllMatchingMiniFilter(!0),this.checkAndRefreshVirtualList(),this.onUiChanged()),this.showOrHideResults()}showOrHideResults(){if(!this.valueModel)throw new Error("Value model has not been created.");const e=null!=this.valueModel.getMiniFilter()&&this.valueModel.getDisplayedValueCount()<1;s.ch.setDisplayed(this.eNoMatches,e),s.ch.setDisplayed(this.eSetFilterList,!e)}resetMiniFilter(){var e;this.eMiniFilter.setValue(null,!0),null==(e=this.valueModel)||e.setMiniFilter(null)}resetUiToActiveModel(e,t){this.setModelAndRefresh(null==e?null:e.values).then((()=>{this.onUiChanged(!1,"prevent"),null==t||t()}))}handleCancelEnd(e){this.setMiniFilter(null),super.handleCancelEnd(e)}onMiniFilterKeyDown(e){const{excelMode:t,readOnly:i}=this.setFilterParams||{};e.key===s.b6.ENTER&&!t&&!i&&this.filterOnAllVisibleValues()}filterOnAllVisibleValues(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const{readOnly:t}=this.setFilterParams||{};if(!this.valueModel)throw new Error("Value model has not been created.");if(t)throw new Error("Unable to filter in readOnly mode.");this.valueModel.selectAllMatchingMiniFilter(!0),this.checkAndRefreshVirtualList(),this.onUiChanged(!1,e?"immediately":"debounce"),this.showOrHideResults()}focusRowIfAlive(e){null!=e&&window.setTimeout((()=>{if(!this.virtualList)throw new Error("Virtual list has not been created.");this.isAlive()&&this.virtualList.focusRow(e)}),0)}onSelectAll(e){if(!this.valueModel)throw new Error("Value model has not been created.");if(!this.virtualList)throw new Error("Virtual list has not been created.");e?this.valueModel.selectAllMatchingMiniFilter():this.valueModel.deselectAllMatchingMiniFilter(),this.refreshAfterSelection()}onGroupItemSelected(e,t){const i=e=>{e.children?e.children.forEach((e=>i(e))):this.selectItem(e.key,t)};i(e),this.refreshAfterSelection()}onItemSelected(e,t){if(!this.valueModel)throw new Error("Value model has not been created.");if(!this.virtualList)throw new Error("Virtual list has not been created.");this.selectItem(e,t),this.refreshAfterSelection()}selectItem(e,t){t?this.valueModel.selectKey(e):this.valueModel.deselectKey(e)}onExpandAll(e,t){const i=e=>{e.filterPasses&&e.available&&e.children&&(e.children.forEach((e=>i(e))),e.expanded=t)};i(e),this.refreshAfterExpansion()}onExpandedChanged(e,t){e.expanded=t,this.refreshAfterExpansion()}refreshAfterExpansion(){const e=this.virtualList.getLastFocusedRow();this.valueModel.updateDisplayedValues("expansion"),this.checkAndRefreshVirtualList(),this.focusRowIfAlive(e)}refreshAfterSelection(){const e=this.virtualList.getLastFocusedRow();this.checkAndRefreshVirtualList(),this.onUiChanged(),this.focusRowIfAlive(e)}setMiniFilter(e){this.eMiniFilter.setValue(e),this.onMiniFilterInput()}getMiniFilter(){return this.valueModel?this.valueModel.getMiniFilter():null}checkAndRefreshVirtualList(){if(!this.virtualList)throw new Error("Virtual list has not been created.");this.virtualList.refresh(!this.hardRefreshVirtualList),this.hardRefreshVirtualList&&(this.hardRefreshVirtualList=!1)}getFilterKeys(){return this.valueModel?this.valueModel.getKeys():[]}getFilterValues(){return this.valueModel?this.valueModel.getValues():[]}getValues(){return this.getFilterKeys()}refreshVirtualList(){this.setFilterParams&&this.setFilterParams.refreshValuesOnOpen?this.refreshFilterValues():this.checkAndRefreshVirtualList()}translateForSetFilter(e){return this.localeService.getLocaleTextFunc()(e,$c[e])}isSelectAllSelected(){if(!this.setFilterParams||!this.valueModel)return!1;if(this.setFilterParams.defaultToNothingSelected){if(this.valueModel.hasSelections()&&this.valueModel.isEverythingVisibleSelected())return!0;if(this.valueModel.isNothingVisibleSelected())return!1}else{if(this.valueModel.hasSelections()&&this.valueModel.isNothingVisibleSelected())return!1;if(this.valueModel.isEverythingVisibleSelected())return!0}}areAllChildrenSelected(e){const t=e=>{if(e.children){let i=!1,s=!1;return e.children.some((e=>{if(!e.filterPasses||!e.available)return!1;const r=t(e);return void 0===r||(r?i=!0:s=!0,i&&s)}))?void 0:i}return this.valueModel.isKeySelected(e.key)};return this.setFilterParams.defaultToNothingSelected?this.valueModel.hasSelections()&&t(e):t(e)}destroy(){null!=this.virtualList&&(this.virtualList.destroy(),this.virtualList=null),super.destroy()}caseFormat(e){return null==e||"string"!=typeof e||this.caseSensitive?e:e.toUpperCase()}resetExpansion(){var e,t;if(null==(e=this.setFilterParams)||!e.treeList)return;const i=null==(t=this.valueModel)?void 0:t.getSelectAllItem();if(this.isSetFilterModelTreeItem(i)){const e=t=>{t.children&&(t.children.forEach((t=>e(t))),t.expanded=!1)};e(i),this.valueModel.updateDisplayedValues("expansion")}}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e,this)}getPositionableElement(){return this.eSetFilterList}};Nc([(0,s.R)("eMiniFilter")],Yc.prototype,"eMiniFilter",2),Nc([(0,s.R)("eFilterLoading")],Yc.prototype,"eFilterLoading",2),Nc([(0,s.R)("eSetFilterList")],Yc.prototype,"eSetFilterList",2),Nc([(0,s.R)("eFilterNoMatches")],Yc.prototype,"eNoMatches",2),Nc([(0,s.A)("valueFormatterService")],Yc.prototype,"valueFormatterService",2),Nc([(0,s.A)("columnModel")],Yc.prototype,"columnModel",2),Nc([(0,s.A)("valueService")],Yc.prototype,"valueService",2);var qc=class{constructor(e){this.model=e}getRowCount(){return this.model.getDisplayedValueCount()}getRow(e){return this.model.getDisplayedItem(e)}areRowsEqual(e,t){return e===t}},Xc=class{constructor(e,t){this.model=e,this.isSelectAllSelected=t}getRowCount(){const e=this.model.showAddCurrentSelectionToFilter()?2:1;return this.model.getDisplayedValueCount()+e}getRow(e){if(0===e)return this.model.getSelectAllItem();const t=this.model.showAddCurrentSelectionToFilter(),i=t?2:1;return 1===e&&t?this.model.getAddSelectionToFilterItem():this.model.getDisplayedItem(e-i)}areRowsEqual(e,t){return e===t}},Zc=class{constructor(e){this.model=e}getRowCount(){return this.model.getRowCount()}getRow(e){return this.model.getRow(e)}areRowsEqual(e,t){return null==e&&null==t||null!=e&&null!=t&&e.treeKey===t.treeKey&&e.depth===t.depth}},Jc=class extends s.ak{constructor(){super('\n            <div class="ag-floating-filter-input ag-set-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eFloatingFilterText"></ag-input-text-field>\n            </div>'),this.availableValuesListenerAdded=!1,this.filterModelFormatter=new jc}destroy(){super.destroy()}init(e){this.params=e,this.eFloatingFilterText.setDisabled(!0).addGuiEventListener("click",(()=>this.params.showParentFilter())),this.setParams(e)}setParams(e){const t=this.columnModel.getDisplayNameForColumn(e.column,"header",!0),i=this.localeService.getLocaleTextFunc();this.eFloatingFilterText.setInputAriaLabel(`${t} ${i("ariaFilterInput","Filter Input")}`)}onParamsUpdated(e){this.refresh(e)}refresh(e){this.params=e,this.setParams(e)}onParentModelChanged(e){this.updateFloatingFilterText(e)}parentSetFilterInstance(e){this.params.parentFilterInstance((t=>{if(!(t instanceof Yc))throw new Error("AG Grid - SetFloatingFilter expects SetFilter as its parent");e(t)}))}addAvailableValuesListener(){this.parentSetFilterInstance((e=>{const t=e.getValueModel();t&&this.addManagedListener(t,Wc.EVENT_AVAILABLE_VALUES_CHANGED,(()=>this.updateFloatingFilterText()))})),this.availableValuesListenerAdded=!0}updateFloatingFilterText(e){this.availableValuesListenerAdded||this.addAvailableValuesListener(),this.parentSetFilterInstance((t=>{this.eFloatingFilterText.setValue(this.filterModelFormatter.getModelAsString(e,t))}))}};Nc([(0,s.R)("eFloatingFilterText")],Jc.prototype,"eFloatingFilterText",2),Nc([(0,s.A)("columnModel")],Jc.prototype,"columnModel",2);var Qc={version:"31.2.1",moduleName:s.M.SetFilterModule,beans:[],userComponents:[{componentName:"agSetColumnFilter",componentClass:Yc},{componentName:"agSetColumnFloatingFilter",componentClass:Jc}],dependantModules:[E]},eu=Object.defineProperty,tu=Object.getOwnPropertyDescriptor,iu=Object.getOwnPropertySymbols,su=Object.prototype.hasOwnProperty,ru=Object.prototype.propertyIsEnumerable,au=(e,t,i)=>t in e?eu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,ou=(e,t,i,s)=>{for(var r,a=s>1?void 0:s?tu(t,i):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s?r(t,i,a):r(a))||a);return s&&a&&eu(t,i,a),a},{extent:nu,isNumber:lu,isString:du,isStringObject:hu,isDate:cu,createId:uu,Padding:pu}=r.s,{LinearScale:gu,BandScale:mu,TimeScale:vu}=r.d,Cu=class{constructor(){this.type="category",this.stroke="rgb(204, 214, 235)",this.strokeWidth=1}},fu=class e{constructor(){this.id=uu(this),this.seriesRect={x:0,y:0,width:0,height:0},this._context=void 0,this._container=void 0,this._data=void 0,this.padding=new pu(3),this.xKey="x",this.yKey="y",this.dataType=void 0,this.xData=[],this.yData=[],this.min=void 0,this.max=void 0,this.yScale=new gu,this.axis=new Cu,this.highlightStyle={size:6,fill:"yellow",stroke:"silver",strokeWidth:1},this._width=100,this._height=100,this.smallestInterval=void 0,this.layoutId=0,this.defaultDateFormatter=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),this._onMouseMove=this.onMouseMove.bind(this),this._onMouseOut=this.onMouseOut.bind(this);const t=new r.i.Group;this.rootGroup=t;const i=document.createElement("div");i.setAttribute("class","ag-sparkline-wrapper");const s=new r.i.Scene({});this.scene=s,this.canvasElement=s.canvas.element,s.setRoot(t),s.setContainer(i),this.resizeAndSetDimensions(this.width,this.height),e.tooltipDocuments.includes(document)||this.initialiseTooltipStyles(),this.setupDomEventListeners(this.canvasElement)}set context(e){this._context!==e&&(this._context=e)}get context(){return this._context}set container(e){if(this._container!==e){const{parentNode:t}=this.canvasElement;null!=t&&t.removeChild(this.canvasElement),e&&e.appendChild(this.canvasElement),this._container=e}}get container(){return this._container}set data(e){this._data!==e&&(this._data=e,this.processData(),this.mouseMoveEvent&&this.highlightedDatum&&this.updateHitPoint(this.mouseMoveEvent))}get data(){return this._data}resizeAndSetDimensions(e,t){this.scene.resize(e,t),this.seriesRect.width=e,this.seriesRect.height=t}initialiseTooltipStyles(){const t=document.createElement("style");t.innerHTML="\n.ag-sparkline-tooltip-wrapper {\n    position: absolute;\n    user-select: none;\n    pointer-events: none;\n}\n\n.ag-sparkline-tooltip {\n    position: relative;\n    font: 12px arial,sans-serif;\n    border-radius: 2px;\n    box-shadow: 0 1px 3px rgb(0 0 0 / 20%), 0 1px 1px rgb(0 0 0 / 14%);\n    line-height: 1.7em;\n    overflow: hidden;\n    white-space: nowrap;\n    z-index: 99999;\n    background-color: rgb(255, 255, 255);\n    color: rgba(0,0,0, 0.67);\n}\n\n.ag-sparkline-tooltip-content {\n    padding: 0 7px;\n    opacity: 1;\n}\n\n.ag-sparkline-tooltip-title {\n    padding-left: 7px;\n    opacity: 1;\n}\n\n.ag-sparkline-tooltip-wrapper-hidden {\n    top: -10000px !important;\n}\n\n.ag-sparkline-wrapper {\n    box-sizing: border-box;\n    overflow: hidden;\n}\n",document.head.insertBefore(t,document.head.querySelector("style")),e.tooltipDocuments.push(document)}set width(e){this._width!==e&&(this._width=e,this.scene.resize(e,this.height),this.scheduleLayout())}get width(){return this._width}set height(e){this._height!==e&&(this._height=e,this.scene.resize(this.width,e),this.scheduleLayout())}get height(){return this._height}update(){}updateYScale(){this.updateYScaleRange(),this.updateYScaleDomain()}updateYScaleDomain(){}updateYScaleRange(){const{yScale:e,seriesRect:t}=this;e.range=[t.height,0]}updateXScale(){const{type:e}=this.axis;this.xScale=this.getXScale(e),this.updateXScaleRange(),this.updateXScaleDomain()}updateXScaleRange(){this.xScale.range=[0,this.seriesRect.width]}updateXScaleDomain(){const{xData:e,xScale:t}=this;let i;(t instanceof gu||t instanceof vu)&&(i=nu(e)),this.xScale.domain=i?i.slice():e}getXScale(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"category"){case"number":return new gu;case"time":return new vu;default:return new mu}}updateAxisLine(){}updateAxes(){this.updateYScale(),this.updateXScale(),this.updateAxisLine()}updateCrosshairs(){this.updateXCrosshairLine(),this.updateYCrosshairLine()}generateNodeData(){return[]}getNodeData(){return[]}updateNodes(){}updateXCrosshairLine(){}updateYCrosshairLine(){}highlightDatum(e){this.updateNodes()}dehighlightDatum(){this.highlightedDatum=void 0,this.updateNodes(),this.updateCrosshairs()}onMouseMove(e){this.mouseMoveEvent=e,this.updateHitPoint(e)}updateHitPoint(e){var t,i,s;const r=this.pickClosestSeriesNodeDatum(e.offsetX,e.offsetY);if(!r)return;const a=this.highlightedDatum;this.highlightedDatum=r,(this.highlightedDatum&&!a||this.highlightedDatum&&a&&this.highlightedDatum!==a)&&(this.highlightDatum(r),this.updateCrosshairs(),this.scene.render().catch((e=>console.error("AG Grid - chart rendering failed",e)))),(null==(s=null==(i=null==(t=this.processedOptions)?void 0:t.tooltip)?void 0:i.enabled)||s)&&this.handleTooltip(e,r)}onMouseOut(e){this.dehighlightDatum(),this.tooltip.toggle(!1),this.scene.render().catch((e=>console.error("AG Grid - chart rendering failed",e)))}processData(){const{data:e,yData:t,xData:i}=this;if(!e||this.invalidData(this.data))return;t.length=0,i.length=0;const s=e.length,r=this.getDataType(e);this.dataType=r;const{type:a}=this.axis,o="number"!==a&&"time"!==a?"category":a,n="number"===o||"time"===o,l=(e,t)=>{null==this.smallestInterval&&(this.smallestInterval={x:1/0,y:1/0});const{x:i}=this.smallestInterval,s=Math.abs(e-t);s>0&&s<i&&(this.smallestInterval.x=s)};let d;if("number"===r)for(let h=0;h<s;h++){const s=h,r=e[h],a=this.getDatum(s,o),c=this.getDatum(r,"number");n&&l(a,d),i.push(a),t.push(c),d=a}else if("array"===r)for(let h=0;h<s;h++){const s=e[h];if(Array.isArray(s)){const e=s[0],r=s[1],a=this.getDatum(e,o),h=this.getDatum(r,"number");if(null==a)continue;n&&l(a,d),i.push(a),t.push(h),d=a}}else if("object"===r){const{yKey:r,xKey:a}=this;for(let h=0;h<s;h++){const s=e[h];if("object"==typeof s&&!Array.isArray(s)){const e=s[a],h=s[r],c=this.getDatum(e,o),u=this.getDatum(h,"number");if(null==c)continue;n&&l(c,d),i.push(c),t.push(u),d=c}}}this.updateAxes(),this.immediateLayout()}getDataType(e){for(const t of e)if(null!=t){if(lu(t))return"number";if(Array.isArray(t))return"array";if("object"==typeof t)return"object"}}getDatum(e,t){if("number"===t&&lu(e)||"time"===t&&(lu(e)||cu(e)))return e;if("category"===t){if(du(e)||cu(e)||lu(e))return{toString:()=>String(e)};if(hu(e))return e}}get layoutScheduled(){return!!this.layoutId}scheduleLayout(){this.layoutId&&cancelAnimationFrame(this.layoutId),this.layoutId=requestAnimationFrame((()=>{this.immediateLayout(),this.layoutId=0}))}immediateLayout(){this.setSparklineDimensions(),!this.invalidData(this.data)&&(this.updateXScaleRange(),this.updateYScaleRange(),this.updateAxisLine(),this.update(),this.scene.render().catch((e=>console.error("AG Grid - chart rendering failed",e))))}setSparklineDimensions(){const{width:e,height:t,padding:i,seriesRect:s,rootGroup:r}=this,a=e-i.left-i.right,o=t-i.top-i.bottom;s.width=a,s.height=o,s.x=i.left,s.y=i.top,r.translationX=s.x,r.translationY=s.y}pickClosestSeriesNodeDatum(e,t){let i,s=1/0;const r=this.rootGroup.transformPoint(e,t),a=this.getNodeData();for(let o=0;o<a.length;o++){const e=a[o];if(!e.point)return;const t=this.getDistance(r,e.point);t<=s&&(s=t,i=e)}return i}getDistance(e,t){return Math.abs(e.x-t.x)}handleTooltip(e,t){var i,s;const{seriesDatum:r}=t,{canvasElement:a}=this,{clientX:o,clientY:n}=e,l=null==(i=this.processedOptions)?void 0:i.tooltip,d={pageX:o,pageY:n,position:{xOffset:null==l?void 0:l.xOffset,yOffset:null==l?void 0:l.yOffset},container:null==l?void 0:l.container};null==d.container&&(d.container=a);const h=r.y,c=r.x;let u=null==(s=null==l?void 0:l.enabled)||s;const p=null==l?void 0:l.renderer;if(p){const e=p({context:this.context,datum:r,yValue:h,xValue:c});u="string"!=typeof e&&void 0!==e.enabled?e.enabled:u}const g=u&&void 0!==r.y&&this.getTooltipHtml(t);g&&this.tooltip.show(d,g)}formatNumericDatum(e){return String(Math.round(10*e)/10)}formatDatum(e){const t=this.axis.type||"category";return"number"===t&&"number"==typeof e?this.formatNumericDatum(e):"time"===t&&(e instanceof Date||lu(e))?this.defaultDateFormatter.format(e):String(e)}setupDomEventListeners(e){e.addEventListener("mousemove",this._onMouseMove),e.addEventListener("mouseout",this._onMouseOut)}cleanupDomEventListeners(e){e.removeEventListener("mousemove",this._onMouseMove),e.removeEventListener("mouseout",this._onMouseOut)}invalidData(e){return!e||!Array.isArray(e)}destroy(){this.cleanupDomEventListeners(this.canvasElement),this.scene.destroy(),this.container=void 0}};fu.tooltipDocuments=[];var yu=fu;function Su(e,t){var i,s,r;if("string"==typeof e)return e;t=t??{};const{content:a=(null!=(i=t.content)?i:""),title:o=(null!=(s=t.title)?s:void 0),color:n=t.color,backgroundColor:l=t.backgroundColor,opacity:d=(null!=(r=t.opacity)?r:1)}=e;let h,c;n?(h=o?`<span class="${bu.class}-title"; style="color: ${n}">${o}</span>`:"",c=`<span class="${bu.class}-content" style="color: ${n}">${a}</span>`):(h=o?`<span class="${bu.class}-title">${o}</span>`:"",c=`<span class="${bu.class}-content">${a}</span>`);let u=`opacity: ${d}`;return l&&(u+=`; background-color: ${l.toLowerCase()}`),`<div class="${bu.class}" style="${u}">\n                ${h}\n                ${c}\n            </div>`}var Eu=class e{constructor(){this.element=document.createElement("div"),document.body.appendChild(this.element)}isVisible(){const{element:t}=this;if(t.classList)return!t.classList.contains(`${e.class}-wrapper-hidden`);const i=t.getAttribute("class");return!!i&&i.split(" ").indexOf(`${e.class}-wrapper-hidden`)<0}updateClass(t){const i=[`${e.class}-wrapper`];!0!==t&&i.push(`${e.class}-wrapper-hidden`),this.element.setAttribute("class",i.join(" "))}show(e,t){var i,s,r,a;this.toggle(!1);const{element:o}=this;if(void 0!==t)o.innerHTML=t;else if(!o.innerHTML)return;const n=null!=(s=null==(i=e.position)?void 0:i.xOffset)?s:10,l=null!=(a=null==(r=e.position)?void 0:r.yOffset)?a:0;let d=e.pageX+n,h=e.pageY+l;const c=o.getBoundingClientRect();let u=window.innerWidth-c.width;if(e.container){const t=e.container.getBoundingClientRect();u=t.left+(t.width-c.width)}d>u&&(d=e.pageX-o.clientWidth-n),typeof scrollX<"u"&&(d+=scrollX),typeof scrollY<"u"&&(h+=scrollY),o.style.left=`${Math.round(d)}px`,o.style.top=`${Math.round(h)}px`,this.toggle(!0)}toggle(e){this.updateClass(e)}destroy(){const{parentNode:e}=this.element;e&&e.removeChild(this.element)}};Eu.class="ag-sparkline-tooltip";var bu=Eu;function wu(e){switch(e){case"circle":default:return r.i.Circle;case"square":return r.i.Square;case"diamond":return r.i.Diamond}}function Au(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"solid";const i={solid:[],dash:[4,3],dot:[1,3],dashDot:[4,3,1,3],dashDotDot:[4,3,1,3,1,3],shortDot:[1,1],shortDash:[3,1],shortDashDot:[3,1,1,1],shortDashDotDot:[3,1,1,1,1,1],longDash:[8,3],longDashDot:[8,3,1,3],longDashDotDot:[8,3,1,3,1,3]},s={solid:[],dash:[3,3],dot:[0,3],dashDot:[3,3,0,3],dashDotDot:[3,3,0,3,0,3],shortDot:[0,2],shortDash:[2,2],shortDashDot:[2,2,0,2],shortDashDotDot:[2,2,0,2,0,2],longDash:[7,3],longDashDot:[7,3,0,3],longDashDotDot:[7,3,0,3,0,3]};return"round"===e||"square"===e?null==s[t]?(console.warn(`'${t}' is not a valid 'lineDash' option.`),s.solid):s[t]:null==i[t]?(console.warn(`'${t}' is not a valid 'lineDash' option.`),i.solid):i[t]}var{extent:xu}=r.s,{BandScale:Tu}=r.d,Mu=class{constructor(){this.enabled=!0,this.shape="circle",this.size=0,this.fill="rgb(124, 181, 236)",this.stroke="rgb(124, 181, 236)",this.strokeWidth=1,this.formatter=void 0}},Pu=class{constructor(){this.stroke="rgb(124, 181, 236)",this.strokeWidth=1}},Fu=class{constructor(){this.xLine={enabled:!0,stroke:"rgba(0,0,0, 0.54)",strokeWidth:1,lineDash:"solid",lineCap:void 0},this.yLine={enabled:!1,stroke:"rgba(0,0,0, 0.54)",strokeWidth:1,lineDash:"solid",lineCap:void 0}}},Du=class extends yu{constructor(){super(),this.fill="rgba(124, 181, 236, 0.25)",this.strokePath=new r.i.Path,this.fillPath=new r.i.Path,this.xCrosshairLine=new r.i.Line,this.yCrosshairLine=new r.i.Line,this.areaSparklineGroup=new r.i.Group,this.xAxisLine=new r.i.Line,this.markers=new r.i.Group,this.markerSelection=r.i.Selection.select(this.markers,(()=>this.markerFactory())),this.markerSelectionData=[],this.marker=new Mu,this.line=new Pu,this.crosshairs=new Fu,this.rootGroup.append(this.areaSparklineGroup),this.xAxisLine.zIndex=500,this.fillPath.zIndex=50,this.strokePath.zIndex=1e3,this.xCrosshairLine.zIndex=2e3,this.yCrosshairLine.zIndex=2e3,this.markers.zIndex=2500,this.areaSparklineGroup.append([this.fillPath,this.xAxisLine,this.strokePath,this.xCrosshairLine,this.yCrosshairLine,this.markers])}markerFactory(){const{shape:e}=this.marker;return new(wu(e))}getNodeData(){return this.markerSelectionData}update(){const e=this.generateNodeData();if(!e)return;const{nodeData:t,fillData:i,strokeData:s}=e;this.markerSelectionData=t,this.updateSelection(t),this.updateNodes(),this.updateStroke(s),this.updateFill(i)}updateYScaleDomain(){const{yData:e,yScale:t}=this,i=xu(e);let s=0,r=1;void 0!==i&&(s=this.min=i[0],r=this.max=i[1]),s=s<0?s:0,r=r<0?0:r,t.domain=[s,r]}generateNodeData(){const{data:e,yData:t,xData:i,xScale:s,yScale:r}=this;if(!e)return;const a=!(s instanceof Tu),o=a?0:s.bandwidth/2,n=t.length,l=[],d=[],h=[];let c,u,p,g;const m=r.convert(0);for(let v=0;v<n;v++){const e=t[v],C=i[v],f=s.convert(a?s.toDomain(C):C)+o,y=void 0===e?NaN:r.convert(e);v+1<n&&(g=s.convert(a?s.toDomain(i[v+1]):i[v+1])+o),h.push({seriesDatum:{x:C,y:e},point:{x:f,y:y}}),void 0===e&&void 0!==p?(d.push({seriesDatum:void 0,point:{x:p,y:m}}),void 0!==g&&d.push({seriesDatum:void 0,point:{x:g,y:m}})):void 0!==e&&(d.push({seriesDatum:{x:C,y:e},point:{x:f,y:y}}),l.push({seriesDatum:{x:C,y:e},point:{x:f,y:y}}),c=void 0!==c?c:f,u=f),p=f}return d.push({seriesDatum:void 0,point:{x:u,y:m}},{seriesDatum:void 0,point:{x:c,y:m}}),{nodeData:l,fillData:d,strokeData:h}}updateAxisLine(){const{xScale:e,yScale:t,axis:i,xAxisLine:s}=this;s.x1=e.range[0],s.x2=e.range[1],s.y1=s.y2=0,s.stroke=i.stroke,s.strokeWidth=i.strokeWidth;const r=t.convert(0);s.translationY=r}updateSelection(e){this.markerSelection.update(e)}updateNodes(){const{highlightedDatum:e,highlightStyle:t,marker:i}=this,{size:s,fill:r,stroke:a,strokeWidth:o}=t,n=i.formatter;this.markerSelection.each(((t,l,d)=>{const{point:h,seriesDatum:c}=l;if(!h)return;const u=l===e,p=u&&void 0!==r?r:i.fill,g=u&&void 0!==a?a:i.stroke,m=u&&void 0!==o?o:i.strokeWidth,v=u&&void 0!==s?s:i.size;let C;if(n){const e=0===d,t=d===this.markerSelectionData.length-1,i=c.y===this.min,s=c.y===this.max;C=n({datum:l,xValue:c.x,yValue:c.y,min:i,max:s,first:e,last:t,fill:p,stroke:g,strokeWidth:m,size:v,highlighted:u})}t.size=C&&null!=C.size?C.size:v,t.fill=C&&null!=C.fill?C.fill:p,t.stroke=C&&null!=C.stroke?C.stroke:g,t.strokeWidth=C&&null!=C.strokeWidth?C.strokeWidth:m,t.translationX=h.x,t.translationY=h.y,t.visible=C&&null!=C.enabled?C.enabled:i.enabled&&t.size>0}))}updateStroke(e){const{strokePath:t,yData:i,line:s}=this,r=t.path;if(r.clear(),i.length<2)return;const a=e.length;let o=!0;for(let n=0;n<a;n++){const{point:t,seriesDatum:i}=e[n],s=t.x,a=t.y;null==i.y?o=!0:o?(r.moveTo(s,a),o=!1):r.lineTo(s,a)}t.lineJoin=t.lineCap="round",t.fill=void 0,t.stroke=s.stroke,t.strokeWidth=s.strokeWidth}updateFill(e){const{fillPath:t,yData:i,fill:s}=this,r=t.path,a=e.length;if(r.clear(),!(i.length<2)){for(let t=0;t<a;t++){const{point:i}=e[t],s=i.x,a=i.y;t>0?r.lineTo(s,a):r.moveTo(s,a)}r.closePath(),t.lineJoin="round",t.stroke=void 0,t.fill=s}}updateXCrosshairLine(){var e;const{yScale:t,xCrosshairLine:i,highlightedDatum:s,crosshairs:{xLine:r}}=this;if(!r.enabled||null==s)return void(i.strokeWidth=0);i.y1=t.range[0],i.y2=t.range[1],i.x1=i.x2=0,i.stroke=r.stroke,i.strokeWidth=null!=(e=r.strokeWidth)?e:1,i.lineCap="round"===r.lineCap||"square"===r.lineCap?r.lineCap:void 0;const{lineDash:a}=r;i.lineDash=Array.isArray(a)?a:Au(i.lineCap,r.lineDash),i.translationX=s.point.x}updateYCrosshairLine(){var e;const{xScale:t,yCrosshairLine:i,highlightedDatum:s,crosshairs:{yLine:r}}=this;if(!r.enabled||null==s)return void(i.strokeWidth=0);i.x1=t.range[0],i.x2=t.range[1],i.y1=i.y2=0,i.stroke=r.stroke,i.strokeWidth=null!=(e=r.strokeWidth)?e:1,i.lineCap="round"===r.lineCap||"square"===r.lineCap?r.lineCap:void 0;const{lineDash:a}=r;i.lineDash=Array.isArray(a)?a:Au(i.lineCap,r.lineDash),i.translationY=s.point.y}getTooltipHtml(e){var t,i;const{dataType:s}=this,{seriesDatum:r}=e,a=r.y,o=r.x,n={content:this.formatNumericDatum(a),title:"array"===s||"object"===s?this.formatDatum(o):void 0},l=null==(i=null==(t=this.processedOptions)?void 0:t.tooltip)?void 0:i.renderer;return l?Su(l({context:this.context,datum:r,yValue:a,xValue:o}),n):Su(n)}};Du.className="AreaSparkline";var{extent:Ru}=r.s,{BandScale:Lu}=r.d,Iu=class{constructor(){this.enabled=!0,this.shape="circle",this.size=0,this.fill="rgb(124, 181, 236)",this.stroke="rgb(124, 181, 236)",this.strokeWidth=1,this.formatter=void 0}},Ou=class{constructor(){this.stroke="rgb(124, 181, 236)",this.strokeWidth=1}},Nu=class{constructor(){this.xLine={enabled:!0,stroke:"rgba(0,0,0, 0.54)",strokeWidth:1,lineDash:"solid",lineCap:void 0},this.yLine={enabled:!1,stroke:"rgba(0,0,0, 0.54)",strokeWidth:1,lineDash:"solid",lineCap:void 0}}},ku=class extends yu{constructor(){super(),this.linePath=new r.i.Path,this.xCrosshairLine=new r.i.Line,this.yCrosshairLine=new r.i.Line,this.lineSparklineGroup=new r.i.Group,this.markers=new r.i.Group,this.markerSelection=r.i.Selection.select(this.markers,(()=>this.markerFactory())),this.markerSelectionData=[],this.marker=new Iu,this.line=new Ou,this.crosshairs=new Nu,this.rootGroup.append(this.lineSparklineGroup),this.linePath.zIndex=1e3,this.xCrosshairLine.zIndex=2e3,this.yCrosshairLine.zIndex=2e3,this.markers.zIndex=2500,this.lineSparklineGroup.append([this.linePath,this.xCrosshairLine,this.yCrosshairLine,this.markers])}getNodeData(){return this.markerSelectionData}markerFactory(){const{shape:e}=this.marker;return new(wu(e))}onMarkerShapeChange(){this.markerSelection=this.markerSelection.clear(),this.scheduleLayout()}update(){const e=this.generateNodeData();e&&(this.markerSelectionData=e,this.updateSelection(e),this.updateNodes(),this.updateLine())}updateYScaleDomain(){const{yData:e,yScale:t}=this,i=Ru(e);let s=0,r=1;if(void 0!==i&&(s=this.min=i[0],r=this.max=i[1]),s===r){const e=Math.abs(.01*s);s-=e,r+=e}t.domain=[s,r]}generateNodeData(){const{data:e,yData:t,xData:i,xScale:s,yScale:r}=this;if(!e)return;const a=!(s instanceof Lu),o=a?0:s.bandwidth/2,n=[];for(let l=0;l<t.length;l++){const e=t[l],d=i[l];if(null==e)continue;const h=s.convert(a?s.toDomain(d):d)+o,c=void 0===e?NaN:r.convert(e);n.push({seriesDatum:{x:d,y:e},point:{x:h,y:c}})}return n}updateSelection(e){this.markerSelection.update(e)}updateNodes(){const{highlightedDatum:e,highlightStyle:t,marker:i}=this,{size:s,fill:r,stroke:a,strokeWidth:o}=t,n=i.formatter;this.markerSelection.each(((t,l,d)=>{const h=l===e,c=h&&void 0!==r?r:i.fill,u=h&&void 0!==a?a:i.stroke,p=h&&void 0!==o?o:i.strokeWidth,g=h&&void 0!==s?s:i.size;let m;const{seriesDatum:v,point:C}=l;if(n){const e=0===d,t=d===this.markerSelectionData.length-1,i=v.y===this.min,s=v.y===this.max;m=n({datum:l,xValue:v.x,yValue:v.y,min:i,max:s,first:e,last:t,fill:c,stroke:u,strokeWidth:p,size:g,highlighted:h})}t.size=m&&null!=m.size?m.size:g,t.fill=m&&null!=m.fill?m.fill:c,t.stroke=m&&null!=m.stroke?m.stroke:u,t.strokeWidth=m&&null!=m.strokeWidth?m.strokeWidth:p,t.translationX=C.x,t.translationY=C.y,t.visible=m&&null!=m.enabled?m.enabled:i.enabled&&t.size>0}))}updateLine(){const{linePath:e,yData:t,xData:i,xScale:s,yScale:r,line:a}=this,o=e.path;if(o.clear(),t.length<2)return;const n=!(s instanceof Lu),l=t.length,d=n?0:s.bandwidth/2;let h=!0;for(let c=0;c<l;c++){const e=i[c],a=t[c],l=s.convert(n?s.toDomain(e):e)+d,u=void 0===a?NaN:r.convert(a);null==a?h=!0:h?(o.moveTo(l,u),h=!1):o.lineTo(l,u)}e.fill=void 0,e.stroke=a.stroke,e.strokeWidth=a.strokeWidth}updateXCrosshairLine(){var e;const{yScale:t,xCrosshairLine:i,highlightedDatum:s,crosshairs:{xLine:r}}=this;if(!r.enabled||null==s)return void(i.strokeWidth=0);i.y1=t.range[0],i.y2=t.range[1],i.x1=i.x2=0,i.stroke=r.stroke,i.strokeWidth=null!=(e=r.strokeWidth)?e:1,i.lineCap="round"===r.lineCap||"square"===r.lineCap?r.lineCap:void 0;const{lineDash:a}=r;i.lineDash=Array.isArray(a)?a:Au(i.lineCap,r.lineDash),i.translationX=s.point.x}updateYCrosshairLine(){var e;const{xScale:t,yCrosshairLine:i,highlightedDatum:s,crosshairs:{yLine:r}}=this;if(!r.enabled||null==s)return void(i.strokeWidth=0);i.x1=t.range[0],i.x2=t.range[1],i.y1=i.y2=0,i.stroke=r.stroke,i.strokeWidth=null!=(e=r.strokeWidth)?e:1,i.lineCap="round"===r.lineCap||"square"===r.lineCap?r.lineCap:void 0;const{lineDash:a}=r;i.lineDash=Array.isArray(a)?a:Au(i.lineCap,r.lineDash),i.translationY=s.point.y}getTooltipHtml(e){var t,i;const{dataType:s}=this,{seriesDatum:r}=e,a=r.y,o=r.x,n={content:this.formatNumericDatum(a),title:"array"===s||"object"===s?this.formatDatum(o):void 0},l=null==(i=null==(t=this.processedOptions)?void 0:t.tooltip)?void 0:i.renderer;return l?Su(l({context:this.context,datum:r,yValue:a,xValue:o}),n):Su(n)}};ku.className="LineSparkline";var Gu=class{constructor(){this.enabled=!0,this.fontSize=8,this.fontFamily="Verdana, sans-serif",this.fontStyle=void 0,this.fontWeight=void 0,this.color="rgba(70, 70, 70, 1)"}},{extent:Vu}=r.s,Bu=class extends Gu{constructor(){super(...arguments),this.formatter=void 0,this.placement="insideEnd"}},_u=class extends yu{constructor(){super(),this.fill="rgb(124, 181, 236)",this.stroke="silver",this.strokeWidth=0,this.paddingInner=.1,this.paddingOuter=.2,this.valueAxisDomain=void 0,this.formatter=void 0,this.axisLine=new r.i.Line,this.bandWidth=0,this.sparklineGroup=new r.i.Group,this.rectGroup=new r.i.Group,this.labelGroup=new r.i.Group,this.rectSelection=r.i.Selection.select(this.rectGroup,r.i.Rect),this.labelSelection=r.i.Selection.select(this.labelGroup,r.i.Text),this.nodeSelectionData=[],this.label=new Bu,this.rootGroup.append(this.sparklineGroup),this.rectGroup.zIndex=50,this.axisLine.zIndex=500,this.labelGroup.zIndex=1500,this.sparklineGroup.append([this.rectGroup,this.axisLine,this.labelGroup]),this.axisLine.lineCap="round",this.label.enabled=!1}getNodeData(){return this.nodeSelectionData}update(){this.updateSelections(),this.updateNodes()}updateSelections(){const e=this.generateNodeData();e&&(this.nodeSelectionData=e,this.updateRectSelection(e),this.updateLabelSelection(e))}updateNodes(){this.updateRectNodes(),this.updateLabelNodes()}calculateStep(e){var t;const{xScale:i,paddingInner:s,paddingOuter:r,smallestInterval:a}=this;let o=(i.domain[1]-i.domain[0])/(null!=(t=null==a?void 0:a.x)?t:1)+1;const n=Math.min(o,50),l=n-1;return e/Math.max(1,2*r+l*s+n)}updateYScaleDomain(){const{yScale:e,yData:t,valueAxisDomain:i}=this,s=Vu(t);let r=0,a=1;void 0!==s&&(r=this.min=s[0],a=this.max=s[1]),r=r<0?r:0,a=a<0?0:a,i&&(i[1]<a&&(i[1]=a),i[0]>r&&(i[0]=r)),e.domain=i||[r,a]}updateRectSelection(e){this.rectSelection.update(e)}updateRectNodes(){const{highlightedDatum:e,formatter:t,fill:i,stroke:s,strokeWidth:r}=this,{fill:a,stroke:o,strokeWidth:n}=this.highlightStyle;this.rectSelection.each(((l,d,h)=>{const c=d===e,u=c&&void 0!==a?a:i,p=c&&void 0!==o?o:s,g=c&&void 0!==n?n:r;let m;const{x:v,y:C,width:f,height:y,seriesDatum:S}=d;if(t){const e=0===h,i=h===this.nodeSelectionData.length-1,s=S.y===this.min,r=S.y===this.max;m=t({datum:d,xValue:S.x,yValue:S.y,width:f,height:y,min:s,max:r,first:e,last:i,fill:u,stroke:p,strokeWidth:g,highlighted:c})}l.fill=m&&m.fill||u,l.stroke=m&&m.stroke||p,l.strokeWidth=m&&m.strokeWidth||g,l.x=l.y=0,l.width=f,l.height=y,l.visible=l.height>0,l.translationX=v,l.translationY=C}))}updateLabelSelection(e){this.labelSelection.update(e,(e=>{e.tag=1,e.pointerEvents=r.i.PointerEvents.None}))}updateLabelNodes(){const{label:{enabled:e,fontStyle:t,fontWeight:i,fontSize:s,fontFamily:r,color:a}}=this;this.labelSelection.each(((o,n)=>{const l=n.label;l&&e?(o.fontStyle=t,o.fontWeight=i,o.fontSize=s,o.fontFamily=r,o.textAlign=l.textAlign,o.textBaseline=l.textBaseline,o.text=l.text,o.x=l.x,o.y=l.y,o.fill=a,o.visible=!0):o.visible=!1}))}getTooltipHtml(e){var t,i;const{dataType:s}=this,{seriesDatum:r}=e,a=r.y,o=r.x,n={content:this.formatNumericDatum(a),title:"array"===s||"object"===s?this.formatDatum(o):void 0},l=null==(i=null==(t=this.processedOptions)?void 0:t.tooltip)?void 0:i.renderer;return l?Su(l({context:this.context,datum:r,yValue:a,xValue:o}),n):Su(n)}formatLabelValue(e){return e%1!==0?e.toFixed(1):e.toFixed(0)}},{isNumber:Uu}=r.s,{BandScale:Hu}=r.d,Wu=class extends _u{updateYScaleRange(){const{seriesRect:e,yScale:t}=this;t.range=[0,e.width]}updateXScaleRange(){const{xScale:e,seriesRect:t,paddingOuter:i,paddingInner:s}=this;if(e instanceof Hu)e.range=[0,t.height],e.paddingInner=s,e.paddingOuter=i;else{const r=this.calculateStep(t.height),a=r*i;this.bandWidth=r*(1-s),e.range=[a,t.height-a-this.bandWidth]}}updateAxisLine(){const{yScale:e,axis:t,axisLine:i,seriesRect:s}=this,{strokeWidth:r}=t;i.x1=0,i.x2=0,i.y1=0,i.y2=s.height,i.stroke=t.stroke,i.strokeWidth=r+(r%2===1?1:0);const a=e.convert(0);i.translationX=a}generateNodeData(){const{data:e,yData:t,xData:i,xScale:s,yScale:a,fill:o,stroke:n,strokeWidth:l,label:d}=this;if(!e)return;const{fontStyle:h,fontWeight:c,fontSize:u,fontFamily:p,color:g,formatter:m,placement:v}=d,C=[],f=a.convert(0),y=!(s instanceof Hu);for(let S=0,E=t.length;S<E;S++){let e=t[S];const d=i[S],E=void 0===e;E&&(e=0);const b=s.convert(y?s.toDomain(d):d),w=Math.min(void 0===e?NaN:a.convert(e),f),A=Math.max(void 0===e?NaN:a.convert(e),f),x=y?this.bandWidth:s.bandwidth,T=A-w,M={x:f,y:b};let P;P=m?m({value:e}):void 0!==e&&Uu(e)?this.formatLabelValue(e):"";const F=b+x/2;let D;const R="middle";let L;const I=void 0!==e&&e>=0,O=4;if("center"===v)D=w+T/2,L="center";else if("outsideEnd"===v)D=w+(I?T+O:-O),L=I?"start":"end";else if("insideEnd"===v){D=w+(I?T-O:O),L=I?"end":"start";const e=r.i.Text.getTextSize(P,p).width||20;(I&&D<f+e||!I&&D>f-e)&&(D=f+O*(I?1:-1),L=I?"start":"end")}else D=f+O*(I?1:-1),L=I?"start":"end";C.push({x:w,y:b,width:T,height:x,fill:o,stroke:n,strokeWidth:l,seriesDatum:{x:d,y:E?void 0:e},point:M,label:{x:D,y:F,text:P,fontStyle:h,fontWeight:c,fontSize:u,fontFamily:p,textAlign:L,textBaseline:R,fill:g}})}return C}getDistance(e,t){return Math.abs(e.y-t.y)}};Wu.className="BarSparkline";var{isNumber:Ku}=r.s,{BandScale:zu}=r.d,$u=class extends _u{updateYScaleRange(){const{seriesRect:e,yScale:t}=this;t.range=[e.height,0]}updateXScaleRange(){const{xScale:e,seriesRect:t,paddingOuter:i,paddingInner:s}=this;if(e instanceof zu)e.range=[0,t.width],e.paddingInner=s,e.paddingOuter=i;else{const r=this.calculateStep(t.width),a=r*i;this.bandWidth=r*(1-s),e.range=[a,t.width-a-this.bandWidth]}}updateAxisLine(){const{yScale:e,axis:t,axisLine:i,seriesRect:s}=this,{strokeWidth:r}=t;i.x1=0,i.x2=s.width,i.y1=0,i.y2=0,i.stroke=t.stroke,i.strokeWidth=r+(r%2===1?1:0);const a=e.convert(0);i.translationY=a}generateNodeData(){const{data:e,yData:t,xData:i,xScale:s,yScale:a,fill:o,stroke:n,strokeWidth:l,label:d}=this;if(!e)return;const{fontStyle:h,fontWeight:c,fontSize:u,fontFamily:p,color:g,formatter:m,placement:v}=d,C=[],f=a.convert(0),y=!(s instanceof zu);for(let S=0,E=t.length;S<E;S++){let e=t[S];const d=i[S],E=void 0===e;E&&(e=0);const b=Math.min(void 0===e?NaN:a.convert(e),f),w=s.convert(y?s.toDomain(d):d),A=Math.max(void 0===e?NaN:a.convert(e),f),x=y?this.bandWidth:s.bandwidth,T=A-b,M={x:w+x/2,y:f};let P;P=m?m({value:e}):void 0!==e&&Ku(e)?this.formatLabelValue(e):"";const F=w+x/2;let D;const R="center";let L;const I=void 0!==e&&e>=0,O=2;if("center"===v)D=b+T/2,L="middle";else if("outsideEnd"===v)D=b+(I?-O:T+O),L=I?"bottom":"top";else if("insideEnd"===v){D=b+(I?O:T-O),L=I?"top":"bottom";const e=r.i.Text.getTextSize(P,p).height||10;(I&&D>f-e||!I&&D<f+e)&&(D=f+O*(I?-1:1),L=I?"bottom":"top")}else D=f+O*(I?-1:1),L=I?"bottom":"top";C.push({x:w,y:b,width:x,height:T,fill:o,stroke:n,strokeWidth:l,seriesDatum:{x:d,y:E?void 0:e},point:M,label:{x:F,y:D,text:P,fontStyle:h,fontWeight:c,fontSize:u,fontFamily:p,textAlign:R,textBaseline:L,fill:g}})}return C}};$u.className="ColumnSparkline";var{isNumber:ju}=r.s,Yu=class{static create(e,t){const i=function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"line"){case"column":return new $u;case"bar":return new Wu;case"area":return new Du;default:return new ku}}((e=r.s.deepClone(e)).type);return t&&(i.tooltip=t),function(e,t){sp(e,"context",t.context,t),sp(e,"width",t.width,t),sp(e,"height",t.height,t),sp(e,"container",t.container,t),sp(e,"xKey",t.xKey,t),sp(e,"yKey",t.yKey,t),t.padding&&function(e,t){sp(e,"top",t.top,t),sp(e,"right",t.right,t),sp(e,"bottom",t.bottom,t),sp(e,"left",t.left,t)}(e.padding,t.padding),t.axis&&function(e,t){sp(e,"type",t.type,t),sp(e,"stroke",t.stroke,t),sp(e,"strokeWidth",t.strokeWidth,t)}(e.axis,t.axis),t.highlightStyle&&function(e,t){sp(e,"fill",t.fill,t),sp(e,"size",t.size,t),sp(e,"stroke",t.stroke,t),sp(e,"strokeWidth",t.strokeWidth,t)}(e.highlightStyle,t.highlightStyle)}(i,e),function(e,t){switch(t.type){case"bar":case"column":qu(e,t);break;case"area":!function(e,t){sp(e,"fill",t.fill,t),t.marker&&Xu(e.marker,t.marker),t.line&&Zu(e.line,t.line),t.crosshairs&&Ju(e.crosshairs,t.crosshairs)}(e,t);break;default:!function(e,t){t.marker&&Xu(e.marker,t.marker),t.line&&Zu(e.line,t.line),t.crosshairs&&Ju(e.crosshairs,t.crosshairs)}(e,t)}}(i,e),e.data&&(i.data=e.data),i.processedOptions=e,i}};function qu(e,t){sp(e,"valueAxisDomain",t.valueAxisDomain,t),sp(e,"fill",t.fill,t),sp(e,"stroke",t.stroke,t),sp(e,"strokeWidth",t.strokeWidth,t),sp(e,"paddingInner",t.paddingInner,t),sp(e,"paddingOuter",t.paddingOuter,t),sp(e,"formatter",t.formatter,t),t.label&&function(e,t){sp(e,"enabled",t.enabled,t),sp(e,"fontStyle",t.fontStyle,t),sp(e,"fontWeight",t.fontWeight,t),sp(e,"fontSize",t.fontSize,t),sp(e,"fontFamily",t.fontFamily,t),sp(e,"textAlign",t.textAlign,t),sp(e,"textBaseline",t.textBaseline,t),sp(e,"color",t.color,t),sp(e,"formatter",t.formatter,t),sp(e,"placement",t.placement,t)}(e.label,t.label)}function Xu(e,t){sp(e,"enabled",t.enabled,t),sp(e,"size",t.size,t),sp(e,"shape",t.shape,t),sp(e,"fill",t.fill,t),sp(e,"stroke",t.stroke,t),sp(e,"strokeWidth",t.strokeWidth,t),sp(e,"formatter",t.formatter,t)}function Zu(e,t){sp(e,"stroke",t.stroke,t),sp(e,"strokeWidth",t.strokeWidth,t)}function Ju(e,t){e.xLine&&t.xLine&&Qu(e.xLine,t.xLine),e.yLine&&t.yLine&&Qu(e.yLine,t.yLine)}function Qu(e,t){sp(e,"enabled",t.enabled,t),sp(e,"stroke",t.stroke,t),sp(e,"strokeWidth",t.strokeWidth,t),sp(e,"lineDash",t.lineDash,t),sp(e,"lineCap",t.lineCap,t)}var ep={};var tp=(e,t,i)=>{if(ju(t))return!0;const s=`AG Charts: ${e} must be a number, the value you provided is not a valid number. Using the default of ${i}px.`;return function(e,t){ep[t]||(e(),ep[t]=!0)}((()=>console.warn(s)),`${e} not a number`),!1},ip={xOffset:tp,yOffset:tp};function sp(e,t,i,s){if(t in s)if(t in e){const s=ip[t];(!s||s(t,i,e[t]))&&e[t]!==i&&(e[t]=i)}else console.warn(`Property ${t} does not exist on the target object.`)}var rp=class e extends s.ak{constructor(){super(e.TEMPLATE)}init(e){let t=!0;const i=this.resizeObserverService.observeResize(this.getGui(),(()=>{const{clientWidth:i,clientHeight:s}=this.getGui();if(0!==i&&0!==s)if(t){const r=((e,t)=>{for(var i in t||(t={}))su.call(t,i)&&au(e,i,t[i]);if(iu)for(var i of iu(t))ru.call(t,i)&&au(e,i,t[i]);return e})({data:e.value,width:i,height:s,context:{data:e.data}},e.sparklineOptions);this.sparkline=Yu.create(r,this.sparklineTooltipSingleton.getSparklineTooltip()),this.eSparkline.appendChild(this.sparkline.canvasElement),t=!1}else this.sparkline.width=i,this.sparkline.height=s}));this.addDestroyFunc((()=>i()))}refresh(e){return!!this.sparkline&&(this.sparkline.data=e.value,!0)}destroy(){this.sparkline&&this.sparkline.destroy(),super.destroy()}};rp.TEMPLATE='<div class="ag-sparkline-wrapper">\n            <span ref="eSparkline"></span>\n        </div>',ou([(0,s.R)("eSparkline")],rp.prototype,"eSparkline",2),ou([(0,s.A)("resizeObserverService")],rp.prototype,"resizeObserverService",2),ou([(0,s.A)("sparklineTooltipSingleton")],rp.prototype,"sparklineTooltipSingleton",2);var ap=rp,op=class extends s.B{postConstruct(){this.tooltip=new bu}getSparklineTooltip(){return this.tooltip}destroyTooltip(){this.tooltip&&this.tooltip.destroy()}};ou([s.a],op.prototype,"postConstruct",1),ou([s.b],op.prototype,"destroyTooltip",1),op=ou([(0,s._)("sparklineTooltipSingleton")],op);var np={version:"31.2.1",moduleName:s.M.SparklinesModule,beans:[op],userComponents:[{componentName:"agSparklineCellRenderer",componentClass:ap}],dependantModules:[E]},lp=class extends s.B{constructor(){super(),this.allComponents=new Map}registerStatusPanel(e,t){this.allComponents.set(e,t)}unregisterStatusPanel(e){this.allComponents.delete(e)}unregisterAllComponents(){this.allComponents.clear()}getStatusPanel(e){return this.allComponents.get(e)}destroy(){this.unregisterAllComponents(),super.destroy()}};lp=u([(0,s._)("statusBarService")],lp);var dp=class e extends s.ak{constructor(){super(e.TEMPLATE),this.compDestroyFunctions={}}postConstruct(){this.processStatusPanels(new Map),this.addManagedPropertyListeners(["statusBar"],this.handleStatusBarChanged.bind(this))}processStatusPanels(e){var t;const i=null==(t=this.gridOptionsService.get("statusBar"))?void 0:t.statusPanels;if(i){const t=i.filter((e=>"left"===e.align));this.createAndRenderComponents(t,this.eStatusBarLeft,e);const s=i.filter((e=>"center"===e.align));this.createAndRenderComponents(s,this.eStatusBarCenter,e);const r=i.filter((e=>!e.align||"right"===e.align));this.createAndRenderComponents(r,this.eStatusBarRight,e)}else this.setDisplayed(!1)}handleStatusBarChanged(){var e;const t=null==(e=this.gridOptionsService.get("statusBar"))?void 0:e.statusPanels,i=Array.isArray(t)&&t.length>0;this.setDisplayed(i);const r=new Map;i&&t.forEach((e=>{var t,i;const a=null!=(t=e.key)?t:e.statusPanel,o=this.statusBarService.getStatusPanel(a);if(null!=o&&o.refresh){const t=this.gridOptionsService.addGridCommonParams(null!=(i=e.statusPanelParams)?i:{});o.refresh(t)&&(r.set(a,o),delete this.compDestroyFunctions[a],s.ch.removeFromParent(o.getGui()))}})),this.resetStatusBar(),i&&this.processStatusPanels(r)}resetStatusBar(){this.eStatusBarLeft.innerHTML="",this.eStatusBarCenter.innerHTML="",this.eStatusBarRight.innerHTML="",this.destroyComponents(),this.statusBarService.unregisterAllComponents()}destroyComponents(){Object.values(this.compDestroyFunctions).forEach((e=>e())),this.compDestroyFunctions={}}createAndRenderComponents(e,t,i){const r=[];e.forEach((e=>{const t=e.key||e.statusPanel,a=i.get(t);let o;if(a)o=s.D.resolve(a);else{const t={};if(o=this.userComponentFactory.getStatusPanelCompDetails(e,t).newAgStackInstance(),!o)return}r.push({key:t,promise:o})})),s.D.all(r.map((e=>e.promise))).then((()=>{r.forEach((e=>{e.promise.then((i=>{const s=()=>{this.getContext().destroyBean(i)};this.isAlive()?(this.statusBarService.registerStatusPanel(e.key,i),t.appendChild(i.getGui()),this.compDestroyFunctions[e.key]=s):s()}))}))}))}};dp.TEMPLATE='<div class="ag-status-bar">\n            <div ref="eStatusBarLeft" class="ag-status-bar-left" role="status"></div>\n            <div ref="eStatusBarCenter" class="ag-status-bar-center" role="status"></div>\n            <div ref="eStatusBarRight" class="ag-status-bar-right" role="status"></div>\n        </div>',u([(0,s.A)("userComponentFactory")],dp.prototype,"userComponentFactory",2),u([(0,s.A)("statusBarService")],dp.prototype,"statusBarService",2),u([(0,s.R)("eStatusBarLeft")],dp.prototype,"eStatusBarLeft",2),u([(0,s.R)("eStatusBarCenter")],dp.prototype,"eStatusBarCenter",2),u([(0,s.R)("eStatusBarRight")],dp.prototype,"eStatusBarRight",2),u([s.a],dp.prototype,"postConstruct",1),u([s.b],dp.prototype,"destroyComponents",1);var hp=dp,cp=class e extends s.ak{constructor(){super(e.TEMPLATE)}setLabel(e,t){this.setDisplayed(!1);const i=this.localeService.getLocaleTextFunc();this.eLabel.innerHTML=i(e,t)}setValue(e){this.eValue.innerHTML=e}};cp.TEMPLATE='<div class="ag-status-name-value">\n            <span ref="eLabel"></span>:&nbsp;\n            <span ref="eValue" class="ag-status-name-value-value"></span>\n        </div>',u([(0,s.R)("eLabel")],cp.prototype,"eLabel",2),u([(0,s.R)("eValue")],cp.prototype,"eValue",2);var up=cp,pp=class extends up{postConstruct(){"clientSide"===this.gridApi.__getModel().getType()?(this.setLabel("totalAndFilteredRows","Rows"),this.addCssClass("ag-status-panel"),this.addCssClass("ag-status-panel-total-and-filtered-row-count"),this.setDisplayed(!0),this.addManagedListener(this.eventService,s.aA.EVENT_MODEL_UPDATED,this.onDataChanged.bind(this)),this.onDataChanged()):console.warn("AG Grid: agTotalAndFilteredRowCountComponent should only be used with the client side row model.")}onDataChanged(){const e=this.localeService.getLocaleTextFunc(),t=e("thousandSeparator",","),i=e("decimalSeparator","."),r=s.ch.formatNumberCommas(this.getFilteredRowCountValue(),t,i),a=s.ch.formatNumberCommas(this.getTotalRowCount(),t,i);if(r===a)this.setValue(r);else{const e=this.localeService.getLocaleTextFunc();this.setValue(`${r} ${e("of","of")} ${a}`)}}getFilteredRowCountValue(){let e=0;return this.gridApi.forEachNodeAfterFilter((t=>{t.group||e++})),e}getTotalRowCount(){let e=0;return this.gridApi.forEachNode((t=>{t.group||e++})),e}init(){}refresh(){return!0}destroy(){super.destroy()}};u([(0,s.A)("gridApi")],pp.prototype,"gridApi",2),u([s.a],pp.prototype,"postConstruct",1);var gp=class extends up{postConstruct(){if(this.setLabel("filteredRows","Filtered"),"clientSide"!==this.gridApi.__getModel().getType())return void console.warn("AG Grid: agFilteredRowCountComponent should only be used with the client side row model.");this.addCssClass("ag-status-panel"),this.addCssClass("ag-status-panel-filtered-row-count"),this.setDisplayed(!0);const e=this.onDataChanged.bind(this);this.addManagedListener(this.eventService,s.aA.EVENT_MODEL_UPDATED,e),e()}onDataChanged(){const e=this.getTotalRowCountValue(),t=this.getFilteredRowCountValue(),i=this.localeService.getLocaleTextFunc(),r=i("thousandSeparator",","),a=i("decimalSeparator",".");this.setValue(s.ch.formatNumberCommas(t,r,a)),this.setDisplayed(e!==t)}getTotalRowCountValue(){let e=0;return this.gridApi.forEachNode((t=>e+=1)),e}getFilteredRowCountValue(){let e=0;return this.gridApi.forEachNodeAfterFilter((t=>{t.group||(e+=1)})),e}init(){}refresh(){return!0}destroy(){super.destroy()}};u([(0,s.A)("gridApi")],gp.prototype,"gridApi",2),u([s.a],gp.prototype,"postConstruct",1);var mp=class extends up{postConstruct(){this.setLabel("totalRows","Total Rows"),"clientSide"===this.gridApi.__getModel().getType()?(this.addCssClass("ag-status-panel"),this.addCssClass("ag-status-panel-total-row-count"),this.setDisplayed(!0),this.addManagedListener(this.eventService,s.aA.EVENT_MODEL_UPDATED,this.onDataChanged.bind(this)),this.onDataChanged()):console.warn("AG Grid: agTotalRowCountComponent should only be used with the client side row model.")}onDataChanged(){const e=this.localeService.getLocaleTextFunc(),t=e("thousandSeparator",","),i=e("decimalSeparator",".");this.setValue(s.ch.formatNumberCommas(this.getRowCountValue(),t,i))}getRowCountValue(){let e=0;return this.gridApi.forEachLeafNode((t=>e+=1)),e}init(){}refresh(){return!0}destroy(){super.destroy()}};u([(0,s.A)("gridApi")],mp.prototype,"gridApi",2),u([s.a],mp.prototype,"postConstruct",1);var vp=class extends up{postConstruct(){if(!this.isValidRowModel())return void console.warn("AG Grid: agSelectedRowCountComponent should only be used with the client and server side row model.");this.setLabel("selectedRows","Selected"),this.addCssClass("ag-status-panel"),this.addCssClass("ag-status-panel-selected-row-count"),this.onRowSelectionChanged();const e=this.onRowSelectionChanged.bind(this);this.addManagedListener(this.eventService,s.aA.EVENT_MODEL_UPDATED,e),this.addManagedListener(this.eventService,s.aA.EVENT_SELECTION_CHANGED,e)}isValidRowModel(){const e=this.gridApi.__getModel().getType();return"clientSide"===e||"serverSide"===e}onRowSelectionChanged(){const e=this.selectionService.getSelectionCount();if(e<0)return this.setValue("?"),void this.setDisplayed(!0);const t=this.localeService.getLocaleTextFunc(),i=t("thousandSeparator",","),r=t("decimalSeparator",".");this.setValue(s.ch.formatNumberCommas(e,i,r)),this.setDisplayed(e>0)}init(){}refresh(){return!0}destroy(){super.destroy()}};u([(0,s.A)("gridApi")],vp.prototype,"gridApi",2),u([(0,s.A)("selectionService")],vp.prototype,"selectionService",2),u([s.a],vp.prototype,"postConstruct",1);var Cp=class e extends s.ak{constructor(){super(e.TEMPLATE)}destroy(){super.destroy()}postConstruct(){this.isValidRowModel()?(this.avgAggregationComp.setLabel("avg","Average"),this.countAggregationComp.setLabel("count","Count"),this.minAggregationComp.setLabel("min","Min"),this.maxAggregationComp.setLabel("max","Max"),this.sumAggregationComp.setLabel("sum","Sum"),this.addManagedListener(this.eventService,s.aA.EVENT_RANGE_SELECTION_CHANGED,this.onRangeSelectionChanged.bind(this)),this.addManagedListener(this.eventService,s.aA.EVENT_MODEL_UPDATED,this.onRangeSelectionChanged.bind(this))):console.warn("AG Grid: agAggregationComponent should only be used with the client and server side row model.")}isValidRowModel(){const e=this.gridApi.__getModel().getType();return"clientSide"===e||"serverSide"===e}init(e){this.params=e}refresh(e){return this.params=e,this.onRangeSelectionChanged(),!0}setAggregationComponentValue(e,t,i){var r;const a=this.getAllowedAggregationValueComponent(e);if(s.ch.exists(a)&&a){const e=this.localeService.getLocaleTextFunc(),r=e("thousandSeparator",","),o=e("decimalSeparator",".");a.setValue(s.ch.formatNumberTwoDecimalPlacesAndCommas(t,r,o)),a.setDisplayed(i)}else null==(r=this.getAggregationValueComponent(e))||r.setDisplayed(!1)}getAllowedAggregationValueComponent(e){const{aggFuncs:t}=this.params;return!t||t.includes(e)?this.getAggregationValueComponent(e):null}getAggregationValueComponent(e){return this[`${e}AggregationComp`]}onRangeSelectionChanged(){const e=this.rangeService?this.rangeService.getCellRanges():void 0;let t=0,i=0,r=0,a=null,o=null;const n={};e&&!s.ch.missingOrEmpty(e)&&e.forEach((e=>{let l=this.rangeService.getRangeStartRow(e);const d=this.rangeService.getRangeEndRow(e);for(;!s.ch.missing(l)&&l&&!this.rowPositionUtils.before(d,l)&&l&&e.columns;)e.columns.forEach((e=>{if(null===l)return;const d=this.cellPositionUtils.createId({rowPinned:l.rowPinned,column:e,rowIndex:l.rowIndex});if(n[d])return;n[d]=!0;const h=this.rowRenderer.getRowNode(l);if(s.ch.missing(h))return;let c=this.valueService.getValue(e,h);s.ch.missing(c)||""===c||(i++,("object"!=typeof c||!("value"in c)||(c=c.value,""!==c))&&("string"==typeof c&&(c=Number(c)),"number"==typeof c&&!isNaN(c)&&(t+=c,(null===o||c>o)&&(o=c),(null===a||c<a)&&(a=c),r++)))})),l=this.cellNavigationService.getRowBelow(l)}));const l=i>1,d=r>1;this.setAggregationComponentValue("count",i,l),this.setAggregationComponentValue("sum",t,d),this.setAggregationComponentValue("min",a,d),this.setAggregationComponentValue("max",o,d),this.setAggregationComponentValue("avg",t/r,d)}};Cp.TEMPLATE='<div class="ag-status-panel ag-status-panel-aggregations">\n            <ag-name-value ref="avgAggregationComp"></ag-name-value>\n            <ag-name-value ref="countAggregationComp"></ag-name-value>\n            <ag-name-value ref="minAggregationComp"></ag-name-value>\n            <ag-name-value ref="maxAggregationComp"></ag-name-value>\n            <ag-name-value ref="sumAggregationComp"></ag-name-value>\n        </div>',u([(0,s.O)("rangeService")],Cp.prototype,"rangeService",2),u([(0,s.A)("valueService")],Cp.prototype,"valueService",2),u([(0,s.A)("cellNavigationService")],Cp.prototype,"cellNavigationService",2),u([(0,s.A)("rowRenderer")],Cp.prototype,"rowRenderer",2),u([(0,s.A)("gridApi")],Cp.prototype,"gridApi",2),u([(0,s.A)("cellPositionUtils")],Cp.prototype,"cellPositionUtils",2),u([(0,s.A)("rowPositionUtils")],Cp.prototype,"rowPositionUtils",2),u([(0,s.R)("sumAggregationComp")],Cp.prototype,"sumAggregationComp",2),u([(0,s.R)("countAggregationComp")],Cp.prototype,"countAggregationComp",2),u([(0,s.R)("minAggregationComp")],Cp.prototype,"minAggregationComp",2),u([(0,s.R)("maxAggregationComp")],Cp.prototype,"maxAggregationComp",2),u([(0,s.R)("avgAggregationComp")],Cp.prototype,"avgAggregationComp",2),u([s.a],Cp.prototype,"postConstruct",1);var fp=Cp,yp={version:"31.2.1",moduleName:s.M.StatusBarModule,beans:[lp],agStackComponents:[{componentName:"AgStatusBar",componentClass:hp},{componentName:"AgNameValue",componentClass:up}],userComponents:[{componentName:"agAggregationComponent",componentClass:fp},{componentName:"agSelectedRowCountComponent",componentClass:vp},{componentName:"agTotalRowCountComponent",componentClass:mp},{componentName:"agFilteredRowCountComponent",componentClass:gp},{componentName:"agTotalAndFilteredRowCountComponent",componentClass:pp}],dependantModules:[E]},Sp=Object.defineProperty,Ep=Object.getOwnPropertyDescriptor,bp=(e,t,i,s)=>{for(var r,a=s>1?void 0:s?Ep(t,i):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s?r(t,i,a):r(a))||a);return s&&a&&Sp(t,i,a),a},wp=class extends s.B{constructor(){super(...arguments),this.firstRow=-1,this.lastRow=-1,this.rowCount=-1,this.rowNodesByIndex={}}ensureRowHeightsValid(e,t,i,s){return!1}init(){this.rowHeight=this.gridOptionsService.getRowHeightAsNumber(),this.addManagedListener(this.eventService,s.aA.EVENT_VIEWPORT_CHANGED,this.onViewportChanged.bind(this)),this.addManagedPropertyListener("viewportDatasource",(()=>this.updateDatasource())),this.addManagedPropertyListener("rowHeight",(()=>{this.rowHeight=this.gridOptionsService.getRowHeightAsNumber(),this.updateRowHeights()}))}start(){this.updateDatasource()}isLastRowIndexKnown(){return!0}destroyDatasource(){this.viewportDatasource&&(this.viewportDatasource.destroy&&this.viewportDatasource.destroy(),this.rowRenderer.datasourceChanged(),this.firstRow=-1,this.lastRow=-1)}updateDatasource(){const e=this.gridOptionsService.get("viewportDatasource");e&&this.setViewportDatasource(e)}getViewportRowModelPageSize(){return this.gridOptionsService.get("viewportRowModelPageSize")}getViewportRowModelBufferSize(){return this.gridOptionsService.get("viewportRowModelBufferSize")}calculateFirstRow(e){const t=this.getViewportRowModelBufferSize(),i=this.getViewportRowModelPageSize(),s=e-t;return s<0?0:Math.floor(s/i)*i}calculateLastRow(e){if(-1===e)return e;const t=this.getViewportRowModelBufferSize(),i=this.getViewportRowModelPageSize(),s=e+t,r=Math.ceil(s/i)*i,a=this.rowCount-1;return Math.min(r,a)}onViewportChanged(e){const t=this.calculateFirstRow(e.firstRow),i=this.calculateLastRow(e.lastRow);(this.firstRow!==t||this.lastRow!==i)&&(this.firstRow=t,this.lastRow=i,this.purgeRowsNotInViewport(),this.viewportDatasource&&this.viewportDatasource.setViewportRange(this.firstRow,this.lastRow))}purgeRowsNotInViewport(){Object.keys(this.rowNodesByIndex).forEach((e=>{const t=parseInt(e,10);if(t<this.firstRow||t>this.lastRow){if(this.isRowFocused(t))return;delete this.rowNodesByIndex[t]}}))}isRowFocused(e){const t=this.focusService.getFocusCellToUseAfterRefresh();return!(!t||null!=t.rowPinned)&&t.rowIndex===e}setViewportDatasource(e){this.destroyDatasource(),this.viewportDatasource=e,this.rowCount=-1,e.init?e.init({setRowCount:this.setRowCount.bind(this),setRowData:this.setRowData.bind(this),getRow:this.getRow.bind(this)}):console.warn("AG Grid: viewport is missing init method.")}getType(){return"viewport"}getRow(e){return this.rowNodesByIndex[e]||(this.rowNodesByIndex[e]=this.createBlankRowNode(e)),this.rowNodesByIndex[e]}getRowNode(e){let t;return this.forEachNode((i=>{i.id===e&&(t=i)})),t}getRowCount(){return-1===this.rowCount?0:this.rowCount}getRowIndexAtPixel(e){return 0!==this.rowHeight?Math.floor(e/this.rowHeight):0}getRowBounds(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}}updateRowHeights(){this.forEachNode((e=>{e.setRowHeight(this.rowHeight),e.setRowTop(this.rowHeight*e.rowIndex)}));const e={type:s.aA.EVENT_MODEL_UPDATED,newData:!1,newPage:!1,keepRenderedRows:!0,animate:!1};this.eventService.dispatchEvent(e)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(e){return e}isEmpty(){return this.rowCount>0}isRowsToRender(){return this.rowCount>0}getNodesInRangeForSelection(e,t){const i=s.ch.missing(e)?0:e.rowIndex,r=t.rowIndex,a=i<this.firstRow||i>this.lastRow,o=r<this.firstRow||r>this.lastRow;if(a||o)return[];const n=[],l=i<=r?r:i;for(let s=i<=r?i:r;s<=l;s++)n.push(this.rowNodesByIndex[s]);return n}forEachNode(e){let t=0;Object.keys(this.rowNodesByIndex).forEach((i=>{const s=parseInt(i,10),r=this.rowNodesByIndex[s];e(r,t),t++}))}setRowData(e){s.ch.iterateObject(e,((e,t)=>{const i=parseInt(e,10);if(i>=this.firstRow&&i<=this.lastRow){let e=this.rowNodesByIndex[i];s.ch.missing(e)&&(e=this.createBlankRowNode(i),this.rowNodesByIndex[i]=e),e.setDataAndId(t,i.toString())}}))}createBlankRowNode(e){const t=new s.bF(this.beans);return t.setRowHeight(this.rowHeight),t.setRowTop(this.rowHeight*e),t.setRowIndex(e),t}setRowCount(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e===this.rowCount)return;this.rowCount=e,this.eventService.dispatchEventOnce({type:s.aA.EVENT_ROW_COUNT_READY});const i={type:s.aA.EVENT_MODEL_UPDATED,newData:!1,newPage:!1,keepRenderedRows:t,animate:!1};this.eventService.dispatchEvent(i)}isRowPresent(e){return!!this.getRowNode(e.id)}};bp([(0,s.A)("rowRenderer")],wp.prototype,"rowRenderer",2),bp([(0,s.A)("focusService")],wp.prototype,"focusService",2),bp([(0,s.A)("beans")],wp.prototype,"beans",2),bp([s.a],wp.prototype,"init",1),bp([s.b],wp.prototype,"destroyDatasource",1),wp=bp([(0,s._)("rowModel")],wp);var Ap={version:"31.2.1",moduleName:s.M.ViewportRowModelModule,rowModel:"viewport",beans:[wp],dependantModules:[E]};c(p,ve),s.e.__registerModules([s.f,s.I,s.C,me,Ha,Qa,On,Gd,th,uh,Vh,Qh,ke,tc,No,Lc,Qc,on,np,yp,Ap],!1,void 0)}}]);