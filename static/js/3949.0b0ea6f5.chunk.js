"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[3949],{3949:(e,t,i)=>{i.r(t),i.d(t,{AgChart:()=>o.AgChart,AgCharts:()=>o.AgCharts,AgErrorBarSupportedSeriesTypes:()=>o.AgErrorBarSupportedSeriesTypes,AgTooltipPositionType:()=>o.AgTooltipPositionType,Marker:()=>o.Marker,VERSION:()=>o.VERSION,_ModuleSupport:()=>o._ModuleSupport,_Scale:()=>o._Scale,_Scene:()=>o._Scene,_Theme:()=>o._Theme,_Util:()=>o._Util,__FORCE_MODULE_DETECTION:()=>o.__FORCE_MODULE_DETECTION,time:()=>o.time});var o=i(9985),a=Object.defineProperty,s=Object.defineProperties,n=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,h=Object.getPrototypeOf,d=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,u=Reflect.get,p=Math.pow,y=(e,t,i)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,g=(e,t)=>{for(var i in t||(t={}))d.call(t,i)&&y(e,i,t[i]);if(l)for(var i of l(t))c.call(t,i)&&y(e,i,t[i]);return e},m=(e,t)=>s(e,r(t)),x=(e,t)=>{var i={};for(var o in e)d.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&l)for(var o of l(e))t.indexOf(o)<0&&c.call(e,o)&&(i[o]=e[o]);return i},f=(e,t,i,o)=>{for(var s,r=o>1?void 0:o?n(t,i):t,l=e.length-1;l>=0;l--)(s=e[l])&&(r=(o?s(t,i,r):s(r))||r);return o&&r&&a(t,i,r),r},v=(e,t,i)=>u(h(e),i,t),S=(e,t,i)=>new Promise(((o,a)=>{var s=e=>{try{r(i.next(e))}catch(t){a(t)}},n=e=>{try{r(i.throw(e))}catch(t){a(t)}},r=e=>e.done?o(e.value):Promise.resolve(e.value).then(s,n);r((i=i.apply(e,t)).next())})),M={__extends__:o._Theme.EXTENDS_AXES_DEFAULTS,gridLine:{enabled:!1,__extends__:o._Theme.EXTENDS_AXES_GRID_LINE_DEFAULTS}};function D(e,t,i){const o=(t,i,o,a)=>{let s=e[0];for(let n=t;o>0?n<=i:n>i;n+=o){const t=e[n];if(a(s,t))return!0;s=t}return!1},a=Math.floor(e.length/2);return!!o(t,a,t,i)||o(e.length-t,a,-t,i)}var{ChartAxisDirection:b,Layers:N,ARRAY:I,BOOLEAN:k,COLOR_STRING:T,FONT_STYLE:A,FONT_WEIGHT:O,LINE_DASH:L,NUMBER:E,POSITIVE_NUMBER:_,RATIO:R,STRING:C,UNION:w,AND:P,Validate:z,MATCHING_CROSSLINE_TYPE:K}=o._ModuleSupport,{Group:V}=o._Scene,{createId:B}=o._Util,F=class{constructor(){this.enabled=void 0,this.text=void 0,this.fontStyle=void 0,this.fontWeight=void 0,this.fontSize=14,this.fontFamily="Verdana, sans-serif",this.padding=5,this.color="rgba(87, 87, 87, 1)",this.parallel=void 0}};f([z(k,{optional:!0})],F.prototype,"enabled",2),f([z(C,{optional:!0})],F.prototype,"text",2),f([z(A,{optional:!0})],F.prototype,"fontStyle",2),f([z(O,{optional:!0})],F.prototype,"fontWeight",2),f([z(_)],F.prototype,"fontSize",2),f([z(C)],F.prototype,"fontFamily",2),f([z(E)],F.prototype,"padding",2),f([z(T,{optional:!0})],F.prototype,"color",2),f([z(k,{optional:!0})],F.prototype,"parallel",2);var U=class e{constructor(){this.id=B(this),this.enabled=void 0,this.type=void 0,this.range=void 0,this.value=void 0,this.fill=void 0,this.fillOpacity=void 0,this.stroke=void 0,this.strokeWidth=void 0,this.strokeOpacity=void 0,this.lineDash=void 0,this.shape="polygon",this.label=new F,this.scale=void 0,this.clippedRange=[-1/0,1/0],this.gridLength=0,this.sideFlag=-1,this.parallelFlipRotation=0,this.regularFlipRotation=0,this.direction=b.X,this.axisInnerRadius=0,this.axisOuterRadius=0,this.group=new V({name:`${this.id}`,layer:!0,zIndex:e.LINE_LAYER_ZINDEX}),this.labelGroup=new V({name:`${this.id}`,layer:!0,zIndex:e.LABEL_LAYER_ZINDEX})}setSectorNodeProps(e){var t,i,o;e.fill=this.fill,e.fillOpacity=null!=(t=this.fillOpacity)?t:1,e.stroke=this.stroke,e.strokeOpacity=null!=(i=this.strokeOpacity)?i:1,e.strokeWidth=null!=(o=this.strokeWidth)?o:1,e.lineDash=this.lineDash}setLabelNodeProps(e,t,i,o,a){const{label:s}=this;e.x=t,e.y=i,e.text=s.text,e.textAlign="center",e.textBaseline=o,e.rotation=a,e.rotationCenterX=t,e.rotationCenterY=i,e.fill=s.color,e.fontFamily=s.fontFamily,e.fontSize=s.fontSize,e.fontStyle=s.fontStyle,e.visible=!0}calculateLayout(e){}};U.LINE_LAYER_ZINDEX=N.SERIES_CROSSLINE_LINE_ZINDEX,U.RANGE_LAYER_ZINDEX=N.SERIES_CROSSLINE_RANGE_ZINDEX,U.LABEL_LAYER_ZINDEX=N.SERIES_LABEL_ZINDEX,f([z(k,{optional:!0})],U.prototype,"enabled",2),f([z(w(["range","line"],"a crossLine type"),{optional:!0})],U.prototype,"type",2),f([z(P(K("range"),I.restrict({length:2})),{optional:!0})],U.prototype,"range",2),f([z(K("value"),{optional:!0})],U.prototype,"value",2),f([z(T,{optional:!0})],U.prototype,"fill",2),f([z(R,{optional:!0})],U.prototype,"fillOpacity",2),f([z(T,{optional:!0})],U.prototype,"stroke",2),f([z(E,{optional:!0})],U.prototype,"strokeWidth",2),f([z(R,{optional:!0})],U.prototype,"strokeOpacity",2),f([z(L,{optional:!0})],U.prototype,"lineDash",2);var j=U,{ChartAxisDirection:W,validateCrossLineValues:Y}=o._ModuleSupport,{Path:G,Sector:H,Text:X}=o._Scene,{normalizeAngle360:Q,isNumberEqual:$}=o._Util,Z=class e extends j{constructor(){super(),this.direction=W.X,this.polygonNode=new G,this.sectorNode=new H,this.lineNode=new G,this.labelNode=new X,this.group.append(this.polygonNode),this.group.append(this.sectorNode),this.group.append(this.lineNode),this.labelGroup.append(this.labelNode)}update(e){const{scale:t,shape:i,type:a,value:s,range:n}=this;if(!t||!a||!Y(a,s,n,t))return this.group.visible=!1,void(this.labelGroup.visible=!1);this.group.visible=e,this.labelGroup.visible=e,"line"===a&&"circle"===i&&t instanceof o._Scale.BandScale&&(this.type="range",this.range=[s,s]),this.updateLineNode(e),this.updatePolygonNode(e),this.updateSectorNode(e),this.updateLabelNode(e)}updateLineNode(t){var i,o;const{scale:a,type:s,value:n,lineNode:r}=this;let l;if(!t||"line"!==s||!a||isNaN(l=a.convert(n)))return void(r.visible=!1);const{axisInnerRadius:h,axisOuterRadius:d}=this;r.visible=!0,r.stroke=this.stroke,r.strokeOpacity=null!=(i=this.strokeOpacity)?i:1,r.strokeWidth=null!=(o=this.strokeWidth)?o:1,r.fill=void 0,r.lineDash=this.lineDash;const c=d*Math.cos(l),u=d*Math.sin(l),p=h*Math.cos(l),y=h*Math.sin(l);r.path.clear(!0),r.path.moveTo(p,y),r.path.lineTo(c,u),this.group.zIndex=e.LINE_LAYER_ZINDEX}updatePolygonNode(t){var i;const{polygonNode:o,range:a,scale:s,shape:n,type:r}=this;let l;if(!t||"range"!==r||"polygon"!==n||!s||!a||!(l=null==(i=s.ticks)?void 0:i.call(s)))return void(o.visible=!1);const{axisInnerRadius:h,axisOuterRadius:d}=this,c=l.indexOf(a[0]),u=l.indexOf(a[1]),p=(c<=u?l.slice(c,u+1):l.slice(c).concat(l.slice(0,u+1))).map((e=>s.convert(e)));o.visible=!0,this.setSectorNodeProps(o);const{path:y}=o;y.clear(!0),p.forEach(((e,t)=>{const i=d*Math.cos(e),o=d*Math.sin(e);0===t?y.moveTo(i,o):y.lineTo(i,o)})),0===h?y.lineTo(0,0):p.slice().reverse().forEach((e=>{const t=h*Math.cos(e),i=h*Math.sin(e);y.lineTo(t,i)})),o.path.closePath(),this.group.zIndex=e.RANGE_LAYER_ZINDEX}updateSectorNode(t){var i;const{sectorNode:a,range:s,scale:n,shape:r,type:l}=this;if(!t||"range"!==l||"circle"!==r||!n||!s)return void(a.visible=!1);const{axisInnerRadius:h,axisOuterRadius:d}=this,c=s.map((e=>n.convert(e))),u=null!=(i=n.step)?i:0,p=n instanceof o._Scale.BandScale?u/2:0;a.visible=!0,this.setSectorNodeProps(a),a.centerX=0,a.centerY=0,a.innerRadius=h,a.outerRadius=d,a.startAngle=c[0]-p,a.endAngle=c[1]+p,this.group.zIndex=e.RANGE_LAYER_ZINDEX}updateLabelNode(e){var t,i;const{label:o,labelNode:a,range:s,scale:n,type:r}=this;if(!e||!1===o.enabled||!o.text||!n||"range"===r&&!s)return void(a.visible=!0);const{axisInnerRadius:l,axisOuterRadius:h}=this;let d,c,u,p;if("line"===r){const e=Q(n.convert(this.value)),t=1.5*Math.PI,i=$(e,t)||e>t||e<Math.PI/2,a=(l+h)/2*Math.cos(e),s=(l+h)/2*Math.sin(e);d=a+o.padding*Math.cos(e+Math.PI/2),c=s+o.padding*Math.sin(e+Math.PI/2),p=i?"top":"bottom",u=i?e:e-Math.PI}else{const[e,a]=s.map((e=>Q(n.convert(e))));let r=(e+a)/2;e>a&&(r-=Math.PI),r=Q(r);const l=($(r,0)||r>0)&&r<Math.PI;let y;const g=null!=(i=null==(t=n.ticks)?void 0:t.call(n))?i:[];y="circle"===this.shape||g.length<3?h-o.padding:h*Math.cos(Math.PI/g.length)-o.padding,d=y*Math.cos(r),c=y*Math.sin(r),p=l?"bottom":"top",u=l?r-Math.PI/2:r+Math.PI/2}this.setLabelNodeProps(a,d,c,p,u)}};Z.className="AngleCrossLine";var q=Z,{AND:J,assignJsonApplyConstructedArray:ee,ChartAxisDirection:te,GREATER_THAN:ie,NUMBER:oe,UNION:ae,ProxyOnWrite:se,Validate:ne}=o._ModuleSupport,{Path:re,Text:le}=o._Scene,{angleBetween:he,isNumberEqual:de,toRadians:ce,normalizeAngle360:ue}=o._Util,pe=class extends o._ModuleSupport.AxisLabel{constructor(){super(...arguments),this.orientation="fixed"}};f([ne(ae(["fixed","parallel","perpendicular"],"a label orientation"))],pe.prototype,"orientation",2);var ye=class extends o._ModuleSupport.PolarAxis{constructor(e,t){super(e,t),this.startAngle=0,this.endAngle=void 0,this.labelData=[],this.tickData=[],this.radiusLine=this.axisGroup.appendChild(new re),this.computeRange=()=>{const e=ue(-Math.PI/2+ce(this.startAngle));let t=null==this.endAngle?e+2*Math.PI:-Math.PI/2+ce(this.endAngle);t<e&&(t+=2*Math.PI),this.range=[e,t]},this.includeInvisibleDomains=!0}get direction(){return te.X}assignCrossLineArrayConstructor(e){ee(e,q)}createLabel(){return new pe}update(){return this.updateScale(),this.updatePosition(),this.updateGridLines(),this.updateTickLines(),this.updateLabels(),this.updateRadiusLine(),this.updateCrossLines(),this.tickData.length}calculateAvailableRange(){const{range:e,gridLength:t}=this;return he(e[0],e[1])*t}updatePosition(){const{translation:e,axisGroup:t,gridGroup:i,crossLineGroup:o}=this,a=Math.floor(e.x),s=Math.floor(e.y);t.translationX=a,t.translationY=s,i.translationX=a,i.translationY=s,o.translationX=a,o.translationY=s}updateRadiusLine(){const e=this.radiusLine,{path:t}=e;t.clear(!0);const{points:i,closePath:o}=this.getAxisLinePoints();i.forEach((e=>{let{x:i,y:o,moveTo:a,arc:s,radius:n=0,startAngle:r=0,endAngle:l=0}=e;s?t.arc(i,o,n,r,l):a?t.moveTo(i,o):t.lineTo(i,o)})),o&&t.closePath(),e.visible=this.line.enabled,e.stroke=this.line.color,e.strokeWidth=this.line.width,e.fill=void 0}getAxisLinePoints(){var e,t;const{scale:i,shape:o,gridLength:a}=this,[s,n]=this.range,r=de(n-s,2*Math.PI),l=[];if("circle"===o)r?(l.push({x:a,y:0,moveTo:!0}),l.push({x:0,y:0,radius:a,startAngle:0,endAngle:2*Math.PI,arc:!0,moveTo:!1})):(l.push({x:a*Math.cos(s),y:a*Math.sin(s),moveTo:!0}),l.push({x:0,y:0,radius:a,startAngle:ue(s),endAngle:ue(n),arc:!0,moveTo:!1}));else if("polygon"===o){const o=(null!=(t=null==(e=i.ticks)?void 0:e.call(i))?t:[]).map((e=>i.convert(e)));o.length>2&&o.forEach(((e,t)=>{const i=a*Math.cos(e),o=a*Math.sin(e),s=0===t;l.push({x:i,y:o,moveTo:s})}))}return{points:l,closePath:r}}updateGridLines(){const{scale:e,gridLength:t,gridLine:{enabled:i,style:o,width:a},innerRadiusRatio:s}=this;if(!(o&&t>0))return;const n=this.tickData,r=t*s,l=o.length;this.gridLineGroupSelection.update(i?n:[],void 0,(e=>e.value)).each(((i,s,n)=>{const{value:h}=s,{stroke:d,lineDash:c}=o[n%l],u=e.convert(h);i.x1=r*Math.cos(u),i.y1=r*Math.sin(u),i.x2=t*Math.cos(u),i.y2=t*Math.sin(u),i.stroke=d,i.strokeWidth=a,i.lineDash=c,i.fill=void 0})),this.gridLineGroupSelection.cleanup()}updateLabels(){const{label:e,tickLabelGroupSelection:t}=this,i=this.tickData;t.update(e.enabled?i:[]).each(((t,i,o)=>{const a=this.labelData[o];a&&!a.hidden?(t.text=a.text,t.setFont(e),t.fill=e.color,t.x=a.x,t.y=a.y,t.textAlign=a.textAlign,t.textBaseline=a.textBaseline,t.visible=!0,a.rotation?(t.rotation=a.rotation,t.rotationCenterX=a.x,t.rotationCenterY=a.y):t.rotation=0):t.visible=!1}))}updateTickLines(){const{scale:e,gridLength:t,tick:i,tickLineGroupSelection:o}=this,a=this.tickData;o.update(i.enabled?a:[]).each(((o,a)=>{const{value:s}=a,n=e.convert(s),r=Math.cos(n),l=Math.sin(n);o.x1=t*r,o.y1=t*l,o.x2=(t+i.size)*r,o.y2=(t+i.size)*l,o.stroke=i.color,o.strokeWidth=i.width}))}createLabelNodeData(e,t,i){const{label:o,gridLength:a,scale:s,tick:n}=this;if(!o.enabled)return[];const r=new le,l=i.x-this.translation.x,h=i.x+i.width-this.translation.x,d=e.map(((i,d)=>{var c;const{value:u}=i,p=a+o.padding+n.size,y=s.convert(u),g=p*Math.cos(y),m=p*Math.sin(y),{textAlign:x,textBaseline:f}=this.getLabelAlign(y),v=d===e.length-1&&u!==e[0]&&de(ue(y),ue(s.convert(e[0]))),S=this.getLabelRotation(y);let M=String(u);if(o.formatter){const{callbackCache:e}=this.moduleCtx;M=null!=(c=e.call(o.formatter,{value:u,index:d}))?c:""}r.text=M,r.x=g,r.y=m,r.setFont(o),r.textAlign=x,r.textBaseline=f,r.rotation=S,S&&(r.rotationCenterX=g,r.rotationCenterY=m);let D=S?r.computeTransformedBBox():r.computeBBox();if(D&&t.hideWhenNecessary&&!S){const e=l-D.x,t=D.x+D.width-h,i=1;if(e>i||t>i){const i=D.width-Math.max(e,t);({text:M}=le.wrap(M,i,1/0,o,"never")),"\u2026"===M&&(M="",D=void 0),r.text=M,D=r.computeBBox()}}return{text:M,x:g,y:m,textAlign:x,textBaseline:f,hidden:""===M||i.hidden||v,rotation:S,box:D}}));return o.avoidCollisions&&this.avoidLabelCollisions(d),d}computeLabelsBBox(e,t){this.tickData=this.generateAngleTicks(),this.labelData=this.createLabelNodeData(this.tickData,e,t);const i=this.labelData.map((e=>{let{box:t}=e;return t})).filter((e=>null!=e));return this.label.enabled&&0!==i.length?o._Scene.BBox.merge(i):null}getLabelOrientation(){const{label:e}=this;return e instanceof pe?e.orientation:"fixed"}getLabelRotation(e){var t;let i=ce(null!=(t=this.label.rotation)?t:0);e=ue(e);const o=this.getLabelOrientation();return"parallel"===o?(i+=e,e>=0&&e<Math.PI?i-=Math.PI/2:i+=Math.PI/2):"perpendicular"===o&&(i+=e,e>=Math.PI/2&&e<1.5*Math.PI&&(i+=Math.PI)),i}getLabelAlign(e){const t=Math.cos(e),i=Math.sin(e);let o,a;const s=this.getLabelOrientation(),n=de(t,0),r=de(i,0),l=de(t,1),h=de(i,-1),d=t>0&&!n,c=i>0&&!r;return"parallel"===s?(o="center",a=l&&r||c?"top":"bottom"):"perpendicular"===s?(o=h||d?"left":"right",a="middle"):(o="right",n?o="center":d&&(o="left"),a="bottom",r?a="middle":c&&(a="top")),{textAlign:o,textBaseline:a}}updateCrossLines(){var e;null==(e=this.crossLines)||e.forEach((e=>{if(e instanceof q){const{shape:t,gridLength:i,innerRadiusRatio:o}=this;e.shape=t,e.axisOuterRadius=i,e.axisInnerRadius=i*o}})),super.updateCrossLines({rotation:0,parallelFlipRotation:0,regularFlipRotation:0})}};f([se("rotation"),ne(oe.restrict({min:0,max:360}))],ye.prototype,"startAngle",2),f([ne(J(oe.restrict({min:0,max:720}),ie("startAngle")),{optional:!0})],ye.prototype,"endAngle",2);var{RATIO:ge,OR:me,POSITIVE_NUMBER:xe,NAN:fe,Validate:ve}=o._ModuleSupport,{BandScale:Se}=o._Scale,{isNumberEqual:Me}=o._Util,De=class extends o._ModuleSupport.AxisTick{constructor(){super(...arguments),this.minSpacing=NaN}};f([ve(me(xe,fe))],De.prototype,"minSpacing",2);var be=class extends ye{constructor(e){super(e,new Se),this.groupPaddingInner=0,this.paddingInner=0}createTick(){return new De}generateAngleTicks(){var e,t;const{scale:i,tick:o,gridLength:a}=this,s=null!=(t=null!=(e=o.values)?e:i.ticks())?t:[];if(s.length<2||isNaN(o.minSpacing))return s.map((e=>({value:e,visible:!0})));const n=s[0],r=i.convert(n),l=a*Math.cos(r),h=a*Math.sin(r);for(let d=1;d<s.length-1;d++){const e=s[d],t=i.convert(e);if(t-r>Math.PI)break;const c=a*Math.cos(t),u=a*Math.sin(t);if(Math.sqrt(p(c-l,2)+p(u-h,2))>o.minSpacing){const e=new Set([n]);return D(s,d,((t,i)=>{e.add(i)})),s.map((t=>({value:t,visible:e.has(t)})))}}return[{value:n,visible:!0}]}avoidLabelCollisions(e){let{minSpacing:t}=this.label;if(Number.isFinite(t)||(t=0),e.length<3)return;const i=(e,i)=>{if(e.hidden||i.hidden)return!1;const o=e.box.clone().grow(t/2),a=i.box.clone().grow(t/2);return o.collidesBBox(a)},o=e[0],a=e.at(-1),s=new Set([o]),n=Me(o.x,a.x)&&Me(o.y,a.y),r=Math.floor(e.length/2);for(let l=1;l<=r;l++){const t=n?e.slice(0,-1):e;if(!D(t,l,i)){D(t,l,((e,t)=>{s.add(t)}));break}}e.forEach((e=>{s.has(e)||(e.hidden=!0,e.box=void 0)}))}};be.className="AngleCategoryAxis",be.type="angle-category",f([ve(ge)],be.prototype,"groupPaddingInner",2),f([ve(ge)],be.prototype,"paddingInner",2);var Ne={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"angle-category",instanceConstructor:be,themeTemplate:M},{LinearScale:Ie,Invalidating:ke}=o._Scale,{isNumberEqual:Te,range:Ae,isDenseInterval:Oe}=o._Util,Le=class extends Ie{constructor(){super(...arguments),this.arcLength=0,this.niceTickStep=0}ticks(){if(!this.domain||this.domain.length<2||this.domain.some((e=>!isFinite(e)))||this.arcLength<=0)return[];this.refresh();const[e,t]=this.getDomain(),{interval:i}=this;if(i){const o=Math.abs(i),a=this.getPixelRange();if(!Oe({start:e,stop:t,interval:o,availableRange:a}))return Ae(e,t,o)}const o=this.nice&&this.niceTickStep?this.niceTickStep:this.getTickStep(e,t);return Ae(e,t,o)}hasNiceRange(){const e=this.range.slice().sort(((e,t)=>e-t));return[Math.PI,2*Math.PI].some((t=>Te(t,e[1]-e[0])))}getNiceStepAndTickCount(){const[e,t]=this.niceDomain;let i=this.getTickStep(e,t);const o=isNaN(this.maxTickCount)?1/0:this.maxTickCount,a=Math.abs(t-e)/i;let s=Math.pow(2,Math.ceil(Math.log(a)/Math.log(2)));return s>o&&(s/=2,i*=2),{count:s,step:i}}updateNiceDomain(){if(super.updateNiceDomain(),!this.hasNiceRange())return;const e=this.niceDomain[0]>this.niceDomain[1],t=e?this.niceDomain[1]:this.niceDomain[0],{step:i,count:o}=this.getNiceStepAndTickCount(),a=1/i,s=i>=1?Math.ceil(t/i+o)*i:Math.ceil((t+o*i)*a)/a;this.niceDomain=e?[s,t]:[t,s],this.niceTickStep=i}getPixelRange(){return this.arcLength}};f([ke],Le.prototype,"arcLength",2);var{AND:Ee,Default:_e,GREATER_THAN:Re,LESS_THAN:Ce,OR:we,POSITIVE_NUMBER:Pe,NAN:ze,NUMBER_OR_NAN:Ke,MIN_SPACING:Ve,Validate:Be}=o._ModuleSupport,{angleBetween:Fe,isNumberEqual:Ue,normalisedExtentWithMetadata:je}=o._Util,We=class extends o._ModuleSupport.AxisTick{constructor(){super(...arguments),this.minSpacing=NaN,this.maxSpacing=NaN}};f([Be(we(Pe,ze))],We.prototype,"minSpacing",2),f([Be(Ve),_e(NaN)],We.prototype,"maxSpacing",2);var Ye=class extends ye{constructor(e){super(e,new Le),this.shape="circle",this.min=NaN,this.max=NaN}normaliseDataDomain(e){const{min:t,max:i}=this,{extent:o,clipped:a}=je(e,t,i);return{domain:o,clipped:a}}createTick(){return new We}getRangeArcLength(){const{range:e}=this,t=Math.min(...e),i=Math.max(...e);return(Fe(t,i)||2*Math.PI)*this.gridLength}generateAngleTicks(){var e;const t=this.getRangeArcLength(),{scale:i,tick:o,range:a}=this,{minSpacing:s=NaN,maxSpacing:n=NaN}=o,r=n?Math.floor(t/n):1,l=s?Math.floor(t/s):1/0,h=Math.floor(4/Math.PI*Math.abs(a[0]-a[1]));i.tickCount=Math.max(r,Math.min(l,h)),i.minTickCount=r,i.maxTickCount=l,i.arcLength=t;return(null!=(e=o.values)?e:i.ticks()).map((e=>({value:e,visible:!0})))}avoidLabelCollisions(e){let{minSpacing:t}=this.label;Number.isFinite(t)||(t=0);const i=(e,i)=>{if(e.hidden||i.hidden)return!1;const o=e.box.clone().grow(t/2),a=i.box.clone().grow(t/2);return o.collidesBBox(a)},o=e[0],a=e.at(-1);o!==a&&Ue(o.x,a.x)&&Ue(o.y,a.y)&&(a.hidden=!0);for(let s=1;s<e.length;s*=2){let t=!1;for(let o=s;o<e.length;o+=s){const a=e[o];if(i(e[o-s],a)){t=!0;break}}if(!t)return void e.forEach(((e,t)=>{t%s>0&&(e.hidden=!0,e.box=void 0)}))}e.forEach(((e,t)=>{t>0&&(e.hidden=!0,e.box=void 0)}))}};Ye.className="AngleNumberAxis",Ye.type="angle-number",f([Be(Ee(Ke,Ce("max"))),_e(NaN)],Ye.prototype,"min",2),f([Be(Ee(Ke,Re("min"))),_e(NaN)],Ye.prototype,"max",2);var Ge={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"angle-number",instanceConstructor:Ye,themeTemplate:M},{OrdinalTimeScale:He}=o._Scale,{dateToNumber:Xe,Validate:Qe,Default:$e,MAX_SPACING:Ze,MIN_SPACING:qe}=o._ModuleSupport,Je=class extends o._ModuleSupport.AxisTick{constructor(){super(...arguments),this.minSpacing=NaN,this.maxSpacing=NaN}};f([Qe(qe)],Je.prototype,"minSpacing",2),f([Qe(Ze),$e(NaN)],Je.prototype,"maxSpacing",2);var et=class extends o._ModuleSupport.CategoryAxis{constructor(e){super(e,new He)}createTick(){return new Je}normaliseDataDomain(e){const t=[],i=new Set;for(let o of e){"number"===typeof o&&(o=new Date(o));const e=Xe(o);i.has(e)||(i.add(e),t.push(o))}return t.sort(((e,t)=>Xe(e)-Xe(t))),{domain:t,clipped:!1}}onLabelFormatChange(e,t,i){i?super.onLabelFormatChange(e,t,i):this.labelFormatter=this.scale.tickFormat({ticks:e,domain:t})}};et.className="OrdinalTimeAxis",et.type="ordinal-time";var tt={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"ordinal-time",instanceConstructor:et,themeTemplate:{__extends__:o._Theme.EXTENDS_AXES_DEFAULTS,groupPaddingInner:0,label:{autoRotate:!1},gridLine:{__extends__:o._Theme.EXTENDS_AXES_GRID_LINE_DEFAULTS,enabled:!1},crosshair:{enabled:!0,snap:!0,stroke:o._Theme.DEFAULT_MUTED_LABEL_COLOUR,strokeWidth:1,strokeOpacity:1,lineDash:[5,6],lineDashOffset:0,label:{enabled:!0}}}},it={__extends__:o._Theme.EXTENDS_AXES_DEFAULTS,line:{enabled:!1,__extends__:o._Theme.EXTENDS_AXES_LINE_DEFAULTS},tick:{enabled:!1,__extends__:o._Theme.EXTENDS_AXES_TICK_DEFAULTS}},{ChartAxisDirection:ot,Validate:at,DEGREE:st,validateCrossLineValues:nt}=o._ModuleSupport,{Path:rt,Sector:lt,Text:ht}=o._Scene,{normalizeAngle360:dt,toRadians:ct,isNumberEqual:ut}=o._Util,pt=class extends F{constructor(){super(...arguments),this.positionAngle=void 0}};f([at(st,{optional:!0})],pt.prototype,"positionAngle",2);var yt=class e extends j{constructor(){super(),this.direction=ot.Y,this.label=new pt,this.polygonNode=new rt,this.sectorNode=new lt,this.labelNode=new ht,this.outerRadius=0,this.innerRadius=0,this.group.append(this.polygonNode),this.group.append(this.sectorNode),this.labelGroup.append(this.labelNode)}update(t){const{scale:i,type:a,value:s,range:n}=this;if(!i||!a||!nt(a,s,n,i))return this.group.visible=!1,void(this.labelGroup.visible=!1);"line"===a&&i instanceof o._Scale.BandScale&&(this.type="range",this.range=[s,s]),this.updateRadii();const{innerRadius:r,outerRadius:l}=this;t&&(t=r>=this.axisInnerRadius&&l<=this.axisOuterRadius),this.group.visible=t,this.labelGroup.visible=t,this.updatePolygonNode(t),this.updateSectorNode(t),this.updateLabelNode(t),this.group.zIndex="line"===this.type?e.LINE_LAYER_ZINDEX:e.RANGE_LAYER_ZINDEX}updateRadii(){var e;const{range:t,scale:i,type:o,axisInnerRadius:a,axisOuterRadius:s}=this;if(!i)return{innerRadius:0,outerRadius:0};const n=e=>s+a-e;let r=0,l=0;if("line"===o)r=n(i.convert(this.value)),l=r;else{const o=Math.abs(null!=(e=null==i?void 0:i.bandwidth)?e:0),a=t.map((e=>i.convert(e)));r=n(Math.max(...a)),l=n(Math.min(...a))+o}this.outerRadius=r,this.innerRadius=l}drawPolygon(e,t,i){t.forEach(((t,o)=>{const a=e*Math.cos(t),s=e*Math.sin(t);0===o?i.path.moveTo(a,s):i.path.lineTo(a,s)})),i.path.closePath()}updatePolygonNode(e){const{gridAngles:t,polygonNode:i,scale:o,shape:a,type:s,innerRadius:n,outerRadius:r}=this;if(!e||"polygon"!==a||!o||!t)return void(i.visible=!1);i.visible=!0;const l=this.getPadding();i.path.clear(!0),this.drawPolygon(r-l,t,i);const h=t.slice().reverse(),d="line"===s?r-l:n+l;this.drawPolygon(d,h,i),this.setSectorNodeProps(i)}updateSectorNode(e){const{axisInnerRadius:t,axisOuterRadius:i,scale:a,sectorNode:s,shape:n,innerRadius:r,outerRadius:l}=this;if(!e||"circle"!==n||!a)return void(s.visible=!1);s.visible=!0,s.startAngle=0,s.endAngle=2*Math.PI;const h=this.getPadding();s.innerRadius=o._Util.clamp(t,r+h,i),s.outerRadius=o._Util.clamp(t,l-h,i),this.setSectorNodeProps(s)}updateLabelNode(e){var t,i;const{innerRadius:o,label:a,labelNode:s,scale:n,shape:r,type:l}=this;if(!e||!1===a.enabled||!a.text||!n)return void(s.visible=!1);const h=dt(ct((null!=(t=a.positionAngle)?t:0)-90)),d=(ut(h,0)||h>0)&&h<Math.PI,c=d?h-Math.PI/2:h+Math.PI/2;let u=0;const p=null!=(i=this.gridAngles)?i:[];u="line"===l?o+a.padding:"circle"===r||p.length<3?o-a.padding:o*Math.cos(Math.PI/p.length)-a.padding;const y=u*Math.cos(h),g=u*Math.sin(h);let m;m="line"===l?d?"top":"bottom":d?"bottom":"top",this.setLabelNodeProps(s,y,g,m,c)}getPadding(){var e,t;const{scale:i}=this;if(!i)return 0;const a=Math.abs(null!=(e=i.bandwidth)?e:0),s=Math.abs(null!=(t=i.step)?t:0);return i instanceof o._Scale.BandScale?(s-a)/2:0}};yt.className="RadiusCrossLine";var gt=yt,{assignJsonApplyConstructedArray:mt,ChartAxisDirection:xt,Default:ft,Layers:vt,DEGREE:St,MIN_SPACING:Mt,MAX_SPACING:Dt,BOOLEAN:bt,Validate:Nt}=o._ModuleSupport,{Caption:It,Group:kt,Path:Tt,Selection:At}=o._Scene,{isNumberEqual:Ot,normalizeAngle360:Lt,toRadians:Et}=o._Util,_t=class extends o._ModuleSupport.AxisTick{constructor(){super(...arguments),this.minSpacing=NaN,this.maxSpacing=NaN}};f([Nt(Mt),ft(NaN)],_t.prototype,"minSpacing",2),f([Nt(Dt),ft(NaN)],_t.prototype,"maxSpacing",2);var Rt=class extends o._ModuleSupport.AxisLabel{constructor(){super(...arguments),this.autoRotateAngle=335}};f([Nt(bt,{optional:!0})],Rt.prototype,"autoRotate",2),f([Nt(St)],Rt.prototype,"autoRotateAngle",2);var Ct=class extends o._ModuleSupport.PolarAxis{constructor(e,t){super(e,t),this.positionAngle=0,this.gridPathGroup=this.gridGroup.appendChild(new kt({name:`${this.id}-gridPaths`,zIndex:vt.AXIS_GRID_ZINDEX})),this.gridPathSelection=At.select(this.gridPathGroup,Tt)}get direction(){return xt.Y}assignCrossLineArrayConstructor(e){mt(e,gt)}getAxisTransform(){const e=this.scale.range[0],{translation:t,positionAngle:i,innerRadiusRatio:o}=this,a=e*o,s=Et(i);return{translationX:t.x,translationY:t.y-e-a,rotation:s,rotationCenterX:0,rotationCenterY:e+a}}updateSelections(e,t,i){var o;super.updateSelections(e,t,i);const{gridLine:{enabled:a,style:s,width:n},shape:r}=this;if(!s)return;const l=this.prepareTickData(t),h=s.length,[d,c]=null!=(o=this.gridRange)?o:[0,2*Math.PI],u=Ot(c-d,2*Math.PI),p=(e,t)=>{const{path:i}=e;i.clear(!0);const o=this.getTickRadius(t);u?(i.moveTo(o,0),i.arc(0,0,o,0,2*Math.PI)):(i.moveTo(o*Math.cos(d),o*Math.sin(d)),i.arc(0,0,o,Lt(d),Lt(c))),u&&i.closePath()},y=(e,t)=>{const{path:i}=e,o=this.gridAngles;if(i.clear(!0),!o||o.length<3)return;const a=this.getTickRadius(t);o.forEach(((e,t)=>{const s=a*Math.cos(e),n=a*Math.sin(e);0===t?i.moveTo(s,n):i.lineTo(s,n),o.forEach(((e,t)=>{const o=a*Math.cos(e),s=a*Math.sin(e);0===t?i.moveTo(o,s):i.lineTo(o,s)})),i.closePath()})),i.closePath()};this.gridPathSelection.update(a?l:[]).each(((e,t,i)=>{((e,t)=>{const{stroke:i,lineDash:o}=s[t%h];e.stroke=i,e.strokeWidth=n,e.lineDash=o,e.fill=void 0})(e,i),"circle"===r?p(e,t):y(e,t)}))}updateTitle(){var e;const t=e=>e.defaultValue,{title:i,_titleCaption:o,range:a,moduleCtx:{callbackCache:s}}=this,{formatter:n=t}=null!=(e=this.title)?e:{};if(!i)return void(o.enabled=!1);o.enabled=i.enabled,o.fontFamily=i.fontFamily,o.fontSize=i.fontSize,o.fontStyle=i.fontStyle,o.fontWeight=i.fontWeight,o.color=i.color,o.wrapping=i.wrapping;let r=!1;const l=o.node;i.enabled&&(r=!0,l.rotation=Math.PI/2,l.x=Math.floor((a[0]+a[1])/2),l.y=-It.SMALL_PADDING,l.textAlign="center",l.textBaseline="bottom",l.text=s.call(n,this.getTitleFormatterParams())),l.visible=r}createTick(){return new _t}updateCrossLines(){var e;null==(e=this.crossLines)||e.forEach((e=>{if(e instanceof gt){const{shape:t,gridAngles:i,range:o,innerRadiusRatio:a}=this,s=o[0];e.shape=t,e.gridAngles=i,e.axisOuterRadius=s,e.axisInnerRadius=s*a}})),super.updateCrossLines({rotation:0,parallelFlipRotation:0,regularFlipRotation:0})}createLabel(){return new Rt}};f([Nt(St),ft(0)],Ct.prototype,"positionAngle",2);var{RATIO:wt,ProxyPropertyOnWrite:Pt,Validate:zt}=o._ModuleSupport,{BandScale:Kt}=o._Scale,Vt=class extends Ct{constructor(e){super(e,new Kt),this.shape="circle",this.groupPaddingInner=0,this.paddingInner=0,this.paddingOuter=0}prepareTickData(e){return e.slice().reverse()}getTickRadius(e){const{scale:t}=this,i=t.range[0],o=i*this.innerRadiusRatio,a=(i-o)/t.domain.length;return i-e.translationY+o-a/2}};Vt.className="RadiusCategoryAxis",Vt.type="radius-category",f([zt(wt)],Vt.prototype,"groupPaddingInner",2),f([Pt("scale","paddingInner"),zt(wt)],Vt.prototype,"paddingInner",2),f([Pt("scale","paddingOuter"),zt(wt)],Vt.prototype,"paddingOuter",2);var Bt={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radius-category",instanceConstructor:Vt,themeTemplate:it},{AND:Ft,Default:Ut,GREATER_THAN:jt,LESS_THAN:Wt,NUMBER_OR_NAN:Yt,Validate:Gt}=o._ModuleSupport,{LinearScale:Ht}=o._Scale,{normalisedExtentWithMetadata:Xt}=o._Util,Qt=class extends Ct{constructor(e){super(e,new Ht),this.shape="polygon",this.min=NaN,this.max=NaN}prepareTickData(e){var t;const{scale:i}=this,o=null==(t=i.getDomain)?void 0:t.call(i)[1];return e.filter((e=>{let{tick:t}=e;return t!==o})).sort(((e,t)=>t.tick-e.tick))}getTickRadius(e){const{scale:t}=this,i=t.range[0],o=i*this.innerRadiusRatio;return i-e.translationY+o}normaliseDataDomain(e){const{min:t,max:i}=this,{extent:o,clipped:a}=Xt(e,t,i);return{domain:o,clipped:a}}};Qt.className="RadiusNumberAxis",Qt.type="radius-number",f([Gt(Ft(Yt,Wt("max"))),Ut(NaN)],Qt.prototype,"min",2),f([Gt(Ft(Yt,jt("min"))),Ut(NaN)],Qt.prototype,"max",2);var $t={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radius-number",instanceConstructor:Qt,themeTemplate:it},{BOOLEAN:Zt,POSITIVE_NUMBER:qt,ObserveChanges:Jt,Validate:ei}=o._ModuleSupport,ti=class extends o._ModuleSupport.BaseModuleInstance{constructor(e){super(),this.ctx=e,this.enabled=!0,e.animationManager.skip(!1)}};f([Jt(((e,t)=>{e.ctx.animationManager.skip(!t)})),ei(Zt)],ti.prototype,"enabled",2),f([Jt(((e,t)=>{e.ctx.animationManager.defaultDuration=t})),ei(qt,{optional:!0})],ti.prototype,"duration",2);var ii={type:"root",optionsKey:"animation",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology"],instanceConstructor:ti,themeTemplate:{animation:{enabled:!0}}},{BOOLEAN:oi,COLOR_STRING:ai,DATE:si,LINE_DASH:ni,NUMBER:ri,RATIO:li,STRING:hi,OBJECT:di,OR:ci,UNION:ui,BaseProperties:pi,Validate:yi}=o._ModuleSupport,gi=class extends pi{};f([yi(ai,{optional:!0})],gi.prototype,"stroke",2),f([yi(li,{optional:!0})],gi.prototype,"strokeOpacity",2),f([yi(ri,{optional:!0})],gi.prototype,"strokeWidth",2),f([yi(ni,{optional:!0})],gi.prototype,"lineDash",2),f([yi(ri,{optional:!0})],gi.prototype,"lineDashOffset",2);var mi=class extends gi{constructor(){super(...arguments),this.middle=new gi,this.background=new Mi}};f([yi(di,{optional:!0})],mi.prototype,"middle",2),f([yi(di,{optional:!0})],mi.prototype,"background",2);var xi=class extends gi{constructor(){super(...arguments),this.type="line",this.handle=new vi,this.start=new Si,this.end=new Si,this.top=new fi,this.bottom=new fi,this.middle=new gi,this.background=new Mi}};f([yi(ui(["line","parallel-channel"]))],xi.prototype,"type",2),f([yi(oi,{optional:!0})],xi.prototype,"locked",2),f([yi(oi,{optional:!0})],xi.prototype,"visible",2),f([yi(di,{optional:!0})],xi.prototype,"handle",2),f([yi(di,{optional:!0})],xi.prototype,"start",2),f([yi(di,{optional:!0})],xi.prototype,"end",2),f([yi(di,{optional:!0})],xi.prototype,"top",2),f([yi(di,{optional:!0})],xi.prototype,"bottom",2),f([yi(di,{optional:!0})],xi.prototype,"middle",2),f([yi(di,{optional:!0})],xi.prototype,"background",2);var fi=class extends pi{constructor(){super(...arguments),this.start=new Si,this.end=new Si}};f([yi(di,{optional:!0})],fi.prototype,"start",2),f([yi(di,{optional:!0})],fi.prototype,"end",2);var vi=class extends pi{};f([yi(ai,{optional:!0})],vi.prototype,"fill",2),f([yi(ai,{optional:!0})],vi.prototype,"stroke",2),f([yi(li,{optional:!0})],vi.prototype,"strokeOpacity",2),f([yi(ni,{optional:!0})],vi.prototype,"lineDash",2),f([yi(ri,{optional:!0})],vi.prototype,"lineDashOffset",2);var Si=class extends pi{};f([yi(ci(hi,ri,si))],Si.prototype,"x",2),f([yi(ci(hi,ri,si))],Si.prototype,"y",2);var Mi=class extends pi{};f([yi(ai,{optional:!0})],Mi.prototype,"fill",2),f([yi(li,{optional:!0})],Mi.prototype,"fillOpacity",2);var Di=(e=>(e.Line="line",e.ParallelChannel="parallel-channel",e))(Di||{}),bi=class extends o._Scene.Group{constructor(){super(...arguments),this.locked=!1}},Ni=class extends o._Scene.Group{constructor(){super(...arguments),this.visible=!1}drag(e){return{point:e,offset:{x:e.x-this.handle.x,y:e.y-this.handle.y}}}toggleActive(e){this.handle.strokeWidth=e?1.5:1,this.handle.dirtyPath=!0}toggleHovered(e){this.glow.visible=e,this.glow.dirtyPath=!0}toggleDragging(e){this.handle.visible=!e,this.glow.visible=this.glow.visible&&!e,this.handle.dirtyPath=!0,this.glow.dirtyPath=!0}getCursor(){return"default"}containsPoint(e,t){return this.handle.containsPoint(e,t)}},Ii=class extends Ni{constructor(){super(),this.handle=new o._Scene.Rect,this.glow=new o._Scene.Rect,this.gradient="horizontal",this.append([this.glow,this.handle]),this.handle.cornerRadius=4,this.handle.width=12,this.handle.height=12,this.handle.strokeWidth=1,this.handle.zIndex=2,this.glow.cornerRadius=4,this.glow.width=16,this.glow.height=16,this.glow.strokeWidth=0,this.glow.fillOpacity=.2,this.glow.zIndex=1,this.glow.visible=!1}update(e){var t,i,o;this.handle.setProperties(e),this.glow.setProperties(m(g({},e),{x:(null!=(t=e.x)?t:this.glow.x)-2,y:(null!=(i=e.y)?i:this.glow.y)-2,fill:null!=(o=e.stroke)?o:e.fill}))}drag(e){return"vertical"===this.gradient?{point:{x:e.x,y:this.handle.y},offset:{x:e.x-this.handle.x,y:0}}:{point:{x:this.handle.x,y:e.y},offset:{x:0,y:e.y-this.handle.y}}}getCursor(){return"vertical"===this.gradient?"col-resize":"row-resize"}},ki=class extends Ni{constructor(){super(),this.handle=new o._Scene.Circle,this.glow=new o._Scene.Circle,this.append([this.glow,this.handle]),this.handle.size=11,this.handle.strokeWidth=1,this.handle.zIndex=2,this.glow.size=17,this.glow.strokeWidth=0,this.glow.fillOpacity=.2,this.glow.zIndex=1,this.glow.visible=!1}update(e){this.handle.setProperties(e),this.glow.setProperties(m(g({},e),{fill:e.stroke}))}},Ti=(e,t)=>Math.sqrt(Math.pow(e,2)+Math.pow(t,2)),Ai=class extends o._Scene.Line{constructor(){super(...arguments),this.growCollisionBox=2}updateCollisionBBox(){const e=this.x1,t=this.strokeWidth+this.growCollisionBox,i=this.y1-Math.floor(t/2),a=Ti(this.x2-e,this.y2-i);this.collisionBBox=new o._Scene.BBox(e,i,a,t)}isPointInPath(e,t){var i,o;const{collisionBBox:a,x1:s,y1:n,x2:r,y2:l}=this;if(!a)return!1;e-=s,t-=n;const h=r-s,d=l-n,c=Math.atan2(t,e)-Math.atan2(d,h),u=Ti(e,t),p=s+u*Math.cos(c),y=n+u*Math.sin(c);return null!=(o=null==(i=this.collisionBBox)?void 0:i.containsPoint(p,y))&&o}},Oi=class extends bi{constructor(){super(),this.type="channel",this.topLine=new Ai,this.middleLine=new o._Scene.Line,this.bottomLine=new Ai,this.background=new o._Scene.Path,this.handles={topLeft:new ki,topMiddle:new Ii,topRight:new ki,bottomLeft:new ki,bottomMiddle:new Ii,bottomRight:new ki},this.append([this.background,this.topLine,this.middleLine,this.bottomLine,...Object.values(this.handles)])}update(e,t,i,o){const{locked:a,visible:s}=e;this.locked=null!=a&&a,this.seriesRect=t,null!=i&&null!=o?(this.visible=null==s||s,this.updateLines(e,i,o),this.updateHandles(e,i,o),this.updateBackground(e,i,o)):this.visible=!1}toggleHandles(e){var t;"boolean"===typeof e&&(e={topLeft:e,topMiddle:e,topRight:e,bottomLeft:e,bottomMiddle:e,bottomRight:e});for(const[i,o]of Object.entries(this.handles))o.visible=null==(t=e[i])||t,o.toggleHovered(this.activeHandle===i)}toggleActive(e){this.toggleHandles(e);for(const t of Object.values(this.handles))t.toggleActive(e)}dragHandle(e,t,i){const{activeHandle:o,handles:a}=this;if(null==o)return;const{offset:s}=a[o].drag(t);a[o].toggleDragging(!0);let n=[];switch(o){case"topLeft":case"bottomLeft":n=["topLeft","bottomLeft"];break;case"topMiddle":n=["topLeft","topRight"],s.y-=6;break;case"topRight":case"bottomRight":n=["topRight","bottomRight"];break;case"bottomMiddle":n=["bottomLeft","bottomRight"],s.y-=6}const r=n.map((e=>i({x:a[e].handle.x+s.x,y:a[e].handle.y+s.y})));if(!r.some((e=>void 0===e)))for(const[l,h]of r.entries()){const t=this.getHandleDatumPoint(n[l],e);t.x=h.x,t.y=h.y}}stopDragging(){const{activeHandle:e,handles:t}=this;null!=e&&t[e].toggleDragging(!1)}getCursor(){return null==this.activeHandle?"pointer":this.handles[this.activeHandle].getCursor()}containsPoint(e,t){var i,o;const{handles:a,seriesRect:s,topLine:n,bottomLine:r}=this;this.activeHandle=void 0;for(const[l,h]of Object.entries(a))if(h.containsPoint(e,t))return this.activeHandle=l,!0;return e-=null!=(i=null==s?void 0:s.x)?i:0,t-=null!=(o=null==s?void 0:s.y)?o:0,n.containsPoint(e,t)||r.containsPoint(e,t)}updateLines(e,t,i){var o,a,s,n,r;const{topLine:l,middleLine:h,bottomLine:d}=this,{lineDash:c,lineDashOffset:u,stroke:p,strokeOpacity:y,strokeWidth:m}=e,x={lineDash:c,lineDashOffset:u,stroke:p,strokeOpacity:y,strokeWidth:m};l.setProperties(g({x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2},x)),d.setProperties(g({x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},x)),l.updateCollisionBBox(),d.updateCollisionBBox(),"parallel-channel"===e.type?h.setProperties({x1:t.x1,y1:i.y1+(t.y1-i.y1)/2,x2:t.x2,y2:i.y2+(t.y2-i.y2)/2,lineDash:null!=(o=e.middle.lineDash)?o:c,lineDashOffset:null!=(a=e.middle.lineDashOffset)?a:u,stroke:null!=(s=e.middle.stroke)?s:p,strokeOpacity:null!=(n=e.middle.strokeOpacity)?n:y,strokeWidth:null!=(r=e.middle.strokeWidth)?r:m}):h.visible=!1}updateHandles(e,t,i){var o,a;const{handles:{topLeft:s,topMiddle:n,topRight:r,bottomLeft:l,bottomMiddle:h,bottomRight:d}}=this,c={fill:e.handle.fill,stroke:null!=(o=e.handle.stroke)?o:e.stroke,strokeOpacity:null!=(a=e.handle.strokeOpacity)?a:e.strokeOpacity};s.update(m(g({},c),{x:t.x1,y:t.y1})),r.update(m(g({},c),{x:t.x2,y:t.y2})),l.update(m(g({},c),{x:i.x1,y:i.y1})),d.update(m(g({},c),{x:i.x2,y:i.y2})),n.update(m(g({},c),{x:t.x1+(t.x2-t.x1)/2-n.handle.width/2,y:t.y1+(t.y2-t.y1)/2-n.handle.height/2})),h.update(m(g({},c),{x:i.x1+(i.x2-i.x1)/2-h.handle.width/2,y:i.y1+(i.y2-i.y1)/2-h.handle.height/2}))}updateBackground(e,t,i){const{background:o}=this;o.path.clear(),o.path.moveTo(t.x1,t.y1),o.path.lineTo(t.x2,t.y2),o.path.lineTo(i.x2,i.y2),o.path.lineTo(i.x1,i.y1),o.path.closePath(),o.checkPathDirty(),o.setProperties({fill:e.background.fill,fillOpacity:e.background.fillOpacity})}getHandleDatumPoint(e,t){switch(e){case"topLeft":return t.top.start;case"topRight":return t.top.end;case"bottomLeft":return t.bottom.start;default:return t.bottom.end}}},Li=class extends bi{constructor(){super(),this.type="line",this.line=new Ai,this.start=new ki,this.end=new ki,this.append([this.line,this.start,this.end])}update(e,t,i){var o,a;const{line:s,start:n,end:r}=this,{locked:l,visible:h,lineDash:d,lineDashOffset:c,stroke:u,strokeWidth:p,strokeOpacity:y}=e;if(this.locked=null!=l&&l,this.seriesRect=t,null==i)return void(this.visible=!1);this.visible=null==h||h;const{x1:x,y1:f,x2:v,y2:S}=i;s.setProperties({x1:x,y1:f,x2:v,y2:S,lineDash:d,lineDashOffset:c,stroke:u,strokeWidth:p,strokeOpacity:y,fillOpacity:0}),s.updateCollisionBBox();const M={fill:e.handle.fill,stroke:null!=(o=e.handle.stroke)?o:u,strokeOpacity:null!=(a=e.handle.strokeOpacity)?a:y};n.update(m(g({},M),{x:x,y:f})),r.update(m(g({},M),{x:v,y:S}))}toggleHandles(e){var t,i;"boolean"===typeof e&&(e={start:e,end:e}),this.start.visible=null==(t=e.start)||t,this.end.visible=null==(i=e.end)||i,this.start.toggleHovered("start"===this.activeHandle),this.end.toggleHovered("end"===this.activeHandle)}toggleActive(e){this.toggleHandles(e),this.start.toggleActive(e),this.end.toggleActive(e)}dragHandle(e,t,i){const{activeHandle:o}=this;if(!o||null==e.start||null==e.end)return;this[o].toggleDragging(!0);const a=i(this[o].drag(t).point);a&&(e[o].x=a.x,e[o].y=a.y)}stopDragging(){this.start.toggleDragging(!1),this.end.toggleDragging(!1)}getCursor(){return null==this.activeHandle?"pointer":"default"}containsPoint(e,t){var i,o;const{start:a,end:s,seriesRect:n,line:r}=this;return this.activeHandle=void 0,a.containsPoint(e,t)?(this.activeHandle="start",!0):s.containsPoint(e,t)?(this.activeHandle="end",!0):(e-=null!=(i=null==n?void 0:n.x)?i:0,t-=null!=(o=null==n?void 0:n.y)?o:0,r.isPointInPath(e,t))}},{BOOLEAN:Ei,OBJECT_ARRAY:_i,InteractionState:Ri,PropertiesArray:Ci,Validate:wi}=o._ModuleSupport,Pi=class extends o._ModuleSupport.BaseModuleInstance{constructor(e){super(),this.ctx=e,this.enabled=!0,this.initial=new Ci(xi),this.container=new o._Scene.Group({name:"static-annotations"}),this.annotations=new o._Scene.Selection(this.container,this.createAnnotation.bind(this)),this.hoverAddingFns={line:{end:(e,t,i)=>{e.set({end:i}),t.toggleHandles({end:!1})}},"parallel-channel":{end:(e,t,i)=>{e.set({top:{end:i},bottom:{end:i}}),t.toggleHandles(!1)},height:(e,t,i,o)=>{const a=this.convertPoint(e.bottom.start),s=this.convertPoint(e.bottom.end);if(!a||!s)return;const n=o.y-s.y,r=this.invertY(a.y+n),l=i.y;this.validateDatumPoint({x:a.x,y:r})&&this.validateDatumPoint({x:s.x,y:l})&&(t.toggleHandles({topMiddle:!1,bottomMiddle:!1}),e.set({bottom:{start:{y:r},end:{y:l}}}))}}},this.clickAddingFns={line:{start:(e,t)=>{var i;const o=this.createDatum("line",t);null==(i=this.annotationData)||i.push(o),this.addingStep="end"},end:(e,t)=>{var i,o;null==(o=null==(i=this.annotationData)?void 0:i.at(-1))||o.set({end:t}),null==e||e.toggleHandles(!0),this.addingStep=void 0,this.ctx.cursorManager.updateCursor("annotations"),this.ctx.interactionManager.popState(Ri.Annotations)}},"parallel-channel":{start:(e,t)=>{var i;const o=this.createDatum("parallel-channel",t);null==(i=this.annotationData)||i.push(o),this.addingStep="end"},end:(e,t)=>{var i,o;null==(o=null==(i=this.annotationData)?void 0:i.at(-1))||o.set({top:{end:t},bottom:{end:t}}),null==e||e.toggleHandles({topMiddle:!1,bottomMiddle:!1}),this.addingStep="height"},height:(e,t,i)=>{var o;const a=null==(o=this.annotationData)?void 0:o.at(-1),s=this.convertPoint(a.bottom.start),n=this.convertPoint(a.bottom.end);if(!s||!n)return;const r=i.y-n.y,l=this.invertY(s.y+r),h=t.y;a&&this.validateDatumPoint({x:s.x,y:l})&&this.validateDatumPoint({x:n.x,y:h})&&a.set({bottom:{start:{y:l},end:{y:h}}}),null==e||e.toggleHandles(!0),this.addingStep=void 0,this.ctx.cursorManager.updateCursor("annotations"),this.ctx.interactionManager.popState(Ri.Annotations)}}};const{All:t,Default:i,Annotations:a,ZoomDrag:s}=Ri,n=e.regionManager.getRegion("series");this.destroyFns.push(e.annotationManager.attachNode(this.container),n.addListener("hover",this.onHover.bind(this),t),n.addListener("click",this.onClick.bind(this),t),n.addListener("drag",this.onDrag.bind(this),i|s|a),n.addListener("drag-end",this.onDragEnd.bind(this),t),e.toolbarManager.addListener("button-pressed",(e=>this.onToolbarButtonPress(e))),e.layoutService.addListener("layout-complete",this.onLayoutComplete.bind(this)))}onToolbarButtonPress(e){null!=this.active&&(this.annotations.nodes()[this.active].toggleActive(!1),this.active=void 0),"annotations"===e.group&&Object.values(Di).includes(e.value)&&(this.ctx.interactionManager.pushState(Ri.Annotations),this.addingStep="start",this.addingType=e.value)}createAnnotation(e){return"parallel-channel"===e.type?new Oi:new Li}createDatum(e,t){const i=new xi;switch(i.set(o._ModuleSupport.mergeDefaults({type:e},this.ctx.annotationManager.getAnnotationTypeStyles(e))),e){case"line":i.set({start:t,end:t});break;case"parallel-channel":i.set({top:{start:t,end:t},bottom:{start:t,end:t}})}return i}onLayoutComplete(e){var t;const{annotationData:i,annotations:a}=this;this.seriesRect=e.series.rect;for(const s of null!=(t=e.axes)?t:[])s.direction===o._ModuleSupport.ChartAxisDirection.X?(null!=this.scaleX||(this.scaleX=s.scale),null!=this.domainX||(this.domainX=s.domain)):(null!=this.scaleY||(this.scaleY=s.scale),null!=this.domainY||(this.domainY=s.domain));a.update(null!=i?i:[]).each(((t,i)=>{if(this.validateDatum(i))switch(i.type){case"line":t.update(i,e.series.rect,this.convertLine(i));break;case"parallel-channel":t.update(i,e.series.rect,this.convertLine(i.top),this.convertLine(i.bottom))}}))}validateDatum(e){let t=!0;switch(e.type){case"line":t=this.validateDatumLine(e,`Annotation [${e.type}]`);break;case"parallel-channel":t=this.validateDatumLine(e.top,`Annotation [${e.type}] [top]`),t&&(t=this.validateDatumLine(e.bottom,`Annotation [${e.type}] [bottom]`))}return t}validateDatumLine(e,t){let i=!0;return null==e.start||null==e.end?(o._Util.Logger.warnOnce(`${t} requires both a [start] and [end] property, ignoring.`),i=!1):(i&&(i=this.validateDatumPoint(e.start,`${t} [start]`)),i&&(i=this.validateDatumPoint(e.end,`${t} [end]`))),i}validateDatumPoint(e,t){const{domainX:i,domainY:a,scaleX:s,scaleY:n}=this;if(null==e.x||null==e.y)return t&&o._Util.Logger.warnOnce(`${t} requires both an [x] and [y] property, ignoring.`),!1;if(!i||!a||!s||!n)return!0;const r=this.validateDatumPointDirection(i,s,e.x),l=this.validateDatumPointDirection(a,n,e.y);if(!r||!l){let i="x & y domains";return r&&(i="y domain"),l&&(i="x domain"),t&&o._Util.Logger.warnOnce(`${t} is outside the ${i}, ignoring. - x: [${e.x}], y: ${e.y}]`),!1}return!0}validateDatumPointDirection(e,t,i){return!o._Scene.ContinuousScale.is(t)||i>=e[0]&&i<=e[1]}onHover(e){const{addingStep:t}=this;null==t?this.onHoverSelecting(e):this.onHoverEditing(e)}onHoverSelecting(e){const{active:t,annotations:i,ctx:{cursorManager:o}}=this;this.hovered=void 0,i.each(((i,o,a)=>{if(i.locked)return;const s=i.containsPoint(e.offsetX,e.offsetY);s&&(null!=this.hovered||(this.hovered=a)),i.toggleHandles(s||t===a)})),o.updateCursor("annotations",null==this.hovered?void 0:i.nodes()[this.hovered].getCursor())}onHoverEditing(e){var t,i,o,a,s;const{annotationData:n,annotations:r,addingStep:l,addingType:h,ctx:{cursorManager:d,updateService:c}}=this;if(!n||!h||!l)return;const u={x:e.offsetX-(null!=(i=null==(t=this.seriesRect)?void 0:t.x)?i:0),y:e.offsetY-(null!=(a=null==(o=this.seriesRect)?void 0:o.y)?a:0)},p=this.invertPoint(u),y=this.validateDatumPoint(p);if(d.updateCursor("annotations",y?void 0:"not-allowed"),!y||"start"===l)return;const g=n.at(-1);this.active=n.length-1;const m=r.nodes()[this.active];if(!g||!m)return;m.toggleActive(!0);const x=null==(s=this.hoverAddingFns[h])?void 0:s[l];x&&x(g,m,p,u),c.update()}onClick(e){null==this.addingStep?this.onClickSelecting():this.onClickAdding(e)}onClickSelecting(){null!=this.active&&this.annotations.nodes()[this.active].toggleActive(!1),this.active=this.hovered,null!=this.active&&this.annotations.nodes()[this.active].toggleActive(!0)}onClickAdding(e){var t,i,a,s,n;const{active:r,annotationData:l,annotations:h,addingStep:d,addingType:c,ctx:{updateService:u}}=this;if(!l||!d||!c)return;const p={x:e.offsetX-(null!=(i=null==(t=this.seriesRect)?void 0:t.x)?i:0),y:e.offsetY-(null!=(s=null==(a=this.seriesRect)?void 0:a.y)?s:0)},y=this.invertPoint(p),g=r?h.nodes()[r]:void 0;if(!this.validateDatumPoint(y))return;const m=null==(n=this.clickAddingFns[c])?void 0:n[d];m&&m(g,y,p),u.update(o._ModuleSupport.ChartUpdateType.PERFORM_LAYOUT,{skipAnimations:!0})}onDrag(e){var t,i;const{active:a,annotationData:s,annotations:n,addingStep:r,seriesRect:l,ctx:{cursorManager:h,interactionManager:d,updateService:c}}=this;if(null==a||null==s||null!=r)return;d.pushState(Ri.Annotations);const{offsetX:u,offsetY:p}=e,y=s[a],g=n.nodes()[a],m={x:u-(null!=(t=null==l?void 0:l.x)?t:0),y:p-(null!=(i=null==l?void 0:l.y)?i:0)};h.updateCursor("annotations"),g.dragHandle(y,m,this.onDragNodeHandle.bind(this)),c.update(o._ModuleSupport.ChartUpdateType.PERFORM_LAYOUT,{skipAnimations:!0})}onDragNodeHandle(e){const t=this.invertPoint(e);if(this.validateDatumPoint(t))return t;this.ctx.cursorManager.updateCursor("annotations","not-allowed")}onDragEnd(e){const{active:t,annotations:i,addingStep:a,ctx:{cursorManager:s,interactionManager:n,updateService:r}}=this;null==a&&(n.popState(Ri.Annotations),s.updateCursor("annotations"),null!=t&&(i.nodes()[t].stopDragging(),r.update(o._ModuleSupport.ChartUpdateType.PERFORM_LAYOUT,{skipAnimations:!0})))}convertLine(e){if(null==e.start||null==e.end)return;const t=this.convertPoint(e.start),i=this.convertPoint(e.end);return null!=t&&null!=i?{x1:t.x,y1:t.y,x2:i.x,y2:i.y}:void 0}convertPoint(e){const{scaleX:t,scaleY:i}=this;let o=0,a=0;return t&&i&&null!=e.x&&null!=e.y?(o=t.convert(e.x),a=i.convert(e.y),{x:o,y:a}):{x:o,y:a}}invertPoint(e){return{x:this.invertX(e.x),y:this.invertY(e.y)}}invertX(e){const{scaleX:t}=this;return o._Scene.ContinuousScale.is(t)?e=t.invert(e):o._Scene.BandScale.is(t)&&(e=t.invertNearest(e)),e}invertY(e){const{scaleY:t}=this;return o._Scene.ContinuousScale.is(t)?e=t.invert(e):o._Scene.BandScale.is(t)&&(e=t.invertNearest(e)),e}};f([o._ModuleSupport.ObserveChanges(((e,t)=>{e.ctx.toolbarManager.toggleGroup("annotations",Boolean(t))})),wi(Ei)],Pi.prototype,"enabled",2),f([o._ModuleSupport.ObserveChanges(((e,t)=>{null!=e.annotationData||(e.annotationData=t)})),wi(_i,{optional:!0})],Pi.prototype,"initial",2);var zi={type:"root",optionsKey:"annotations",packageType:"enterprise",chartTypes:["cartesian"],dependencies:["toolbar"],instanceConstructor:Pi,themeTemplate:{annotations:{line:{stroke:o._Theme.DEFAULT_ANNOTATION_STROKE,strokeWidth:2,strokeOpacity:1,handle:{fill:o._Theme.DEFAULT_ANNOTATION_HANDLE_FILL}},"parallel-channel":{stroke:o._Theme.DEFAULT_ANNOTATION_STROKE,strokeWidth:2,strokeOpacity:1,middle:{lineDash:[6,5],strokeWidth:1},background:{fill:o._Theme.DEFAULT_ANNOTATION_BACKGROUND_FILL,fillOpacity:.2},handle:{fill:o._Theme.DEFAULT_ANNOTATION_HANDLE_FILL}}}}},{Image:Ki}=o._Scene,{BaseProperties:Vi,ObserveChanges:Bi,ProxyProperty:Fi,Validate:Ui,NUMBER:ji,POSITIVE_NUMBER:Wi,RATIO:Yi,createElement:Gi,calculatePlacement:Hi}=o._ModuleSupport,Xi=class extends Vi{constructor(){super(),this.opacity=1,this.loadedSynchronously=!0,this.containerWidth=0,this.containerHeight=0,this.onLoad=void 0,this.onImageLoad=()=>{var e;this.loadedSynchronously||(this.node.visible=!1,this.performLayout(this.containerWidth,this.containerHeight),null==(e=this.onLoad)||e.call(this))},this.imageElement=Gi("img"),this.imageElement.onload=this.onImageLoad,this.node=new Ki(this.imageElement)}get complete(){return this.imageElement.width>0&&this.imageElement.height>0}performLayout(e,t){this.containerWidth=e,this.containerHeight=t,this.node.setProperties(this.complete?g({visible:!0,opacity:this.opacity},Hi(this.imageElement.width,this.imageElement.height,this.containerWidth,this.containerHeight,this)):{visible:!1})}};f([Ui(ji,{optional:!0})],Xi.prototype,"top",2),f([Ui(ji,{optional:!0})],Xi.prototype,"right",2),f([Ui(ji,{optional:!0})],Xi.prototype,"bottom",2),f([Ui(ji,{optional:!0})],Xi.prototype,"left",2),f([Ui(Wi,{optional:!0})],Xi.prototype,"width",2),f([Ui(Wi,{optional:!0})],Xi.prototype,"height",2),f([Ui(Yi)],Xi.prototype,"opacity",2),f([Fi("imageElement.src"),Bi((e=>e.loadedSynchronously=e.complete))],Xi.prototype,"url",2);var{ActionOnSet:Qi,OBJECT:$i,Validate:Zi}=o._ModuleSupport,qi=class extends o._ModuleSupport.Background{constructor(e){super(e),this.ctx=e,this.image=new Xi}onLayoutComplete(e){if(super.onLayoutComplete(e),this.image){const{width:t,height:i}=e.chart;this.image.performLayout(t,i)}}onImageLoad(){this.ctx.updateService.update(o._ModuleSupport.ChartUpdateType.SCENE_RENDER)}};f([Zi($i,{optional:!0}),Qi({newValue(e){this.node.appendChild(e.node),e.onLoad=()=>this.onImageLoad()},oldValue(e){this.node.removeChild(e.node),e.onLoad=void 0}})],qi.prototype,"image",2);var Ji={type:"root",optionsKey:"background",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology"],instanceConstructor:qi},eo="ag-chart-context-menu",to="ag-charts-dark-context-menu",io=`\n.${eo} {\n    background: rgb(248, 248, 248);\n    border: 1px solid #babfc7;\n    border-radius: 5px;\n    box-shadow: 0 1px 4px 1px rgba(186, 191, 199, 0.4);\n    color: rgb(24, 29, 31);\n    font: 13px Verdana, sans-serif;\n    position: fixed;\n    transition: transform 0.1s ease;\n    white-space: nowrap;\n    z-index: 99999;\n}\n\n.${eo}.${to} {\n    color: white;\n    background: #15181c;\n}\n\n.${eo}__cover {\n    position: fixed;\n    left: 0px;\n    top: 0px;\n}\n\n.${eo}__menu {\n    display: flex;\n    flex-direction: column;\n    padding: 0.5em 0;\n}\n\n.${eo}__item {\n    background: none;\n    border: none;\n    box-sizing: border-box;\n    font: inherit;\n    padding: 0.5em 1em;\n    text-align: left;\n    -webkit-appearance: none;\n    -moz-appearance: none;\n}\n\n.${eo}__item.${to} {\n    color: white;\n}\n\n.${eo}__item:hover {\n    background: rgb(33, 150, 243, 0.1);\n}\n\n.${eo}__item:hover.${to} {\n    background: rgb(33, 150, 243, 0.1);\n}\n\n.${eo}__item:active {\n    background: rgb(33, 150, 243, 0.2);\n}\n\n.${eo}__item:active.${to} {\n    background: rgb(33, 150, 243, 0.1);\n}\n\n.${eo}__item[disabled] {\n    border: none;\n    opacity: 0.5;\n    text-align: left;\n}\n\n.${eo}__item[disabled]:hover {\n    background: inherit;\n    cursor: inherit;\n}\n\n.${eo}__divider {\n    margin: 5px 0;\n    background: #babfc7;\n    height: 1px;\n}\n\n.${eo}__divider.${to} {\n    background: rgb(33, 150, 243, 0.1);\n}\n`,{BOOLEAN:oo,Validate:ao,createElement:so,getDocument:no,getWindow:ro,injectStyle:lo}=o._ModuleSupport,ho=class extends o._ModuleSupport.BaseModuleInstance{constructor(e){super(),this.ctx=e,this.enabled=!0,this.darkTheme=!1,this.extraActions=[],this.extraNodeActions=[],this.x=0,this.y=0,this.highlightManager=e.highlightManager,this.interactionManager=e.interactionManager,this.registry=e.contextMenuRegistry,this.scene=e.scene;const{Default:t,ContextMenu:i,All:a}=o._ModuleSupport.InteractionState,s=t|i;if(this.destroyFns.push(e.interactionManager.addListener("contextmenu",(e=>this.onContextMenu(e)),s),e.interactionManager.addListener("click",(()=>this.onClick()),a)),this.groups={default:[],node:[],extra:[],extraNode:[]},this.canvasElement=e.scene.canvas.element,this.container=no("body"),this.element=this.container.appendChild(so("div")),this.element.classList.add(eo),this.element.addEventListener("contextmenu",(e=>e.preventDefault())),this.destroyFns.push((()=>{var e;return null==(e=this.element.parentNode)?void 0:e.removeChild(this.element)})),this.hide(),"undefined"!==typeof IntersectionObserver){const e=new IntersectionObserver((e=>{for(const t of e)t.target===this.canvasElement&&0===t.intersectionRatio&&this.hide()}),{root:this.container});e.observe(this.canvasElement),this.intersectionObserver=e}if("undefined"!==typeof MutationObserver){const e=new MutationObserver((()=>{this.menuElement&&this.element.contains(this.menuElement)&&this.reposition()}));e.observe(this.element,{childList:!0}),this.mutationObserver=e}lo(io,"contextMenu"),this.registry.registerDefaultAction({id:"download",label:"Download",action:()=>{const t=e.chartService.title;let i="image";(null==t?void 0:t.enabled)&&void 0!==(null==t?void 0:t.text)&&(i=t.text),this.scene.download(i)}})}isShown(){return void 0!==this.menuElement}onClick(){this.isShown()&&this.hide()}onContextMenu(e){if(!this.enabled)return;this.showEvent=e.sourceEvent,this.x=e.pageX,this.y=e.pageY,this.groups.default=this.registry.copyDefaultActions(),this.pickedNode=this.highlightManager.getActivePicked(),this.extraActions.length>0&&(this.groups.extra=[...this.extraActions]),this.extraNodeActions.length>0&&this.pickedNode&&(this.groups.extraNode=[...this.extraNodeActions]);const{default:t,node:i,extra:o,extraNode:a}=this.groups;0!==t.length+i.length+o.length+a.length&&(e.consume(),e.sourceEvent.preventDefault(),this.show())}show(){this.interactionManager.pushState(o._ModuleSupport.InteractionState.ContextMenu),this.element.classList.toggle(to,this.darkTheme);const e=this.renderMenu();this.menuElement?this.element.replaceChild(e,this.menuElement):this.element.appendChild(e),this.menuElement=e,this.element.style.display="block"}hide(){this.interactionManager.popState(o._ModuleSupport.InteractionState.ContextMenu),this.menuElement&&(this.element.removeChild(this.menuElement),this.menuElement=void 0),this.element.style.display="none"}renderMenu(){const e=so("div");return e.classList.add(`${eo}__menu`),e.classList.toggle(to,this.darkTheme),this.appendMenuGroup(e,this.groups.default,!1),this.pickedNode&&this.appendMenuGroup(e,this.groups.node),this.appendMenuGroup(e,this.groups.extra),this.pickedNode&&this.appendMenuGroup(e,this.groups.extraNode),e}appendMenuGroup(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];0!==t.length&&(i&&e.appendChild(this.createDividerElement()),t.forEach((t=>{const i=this.renderItem(t);i&&e.appendChild(i)})))}renderItem(e){if(e&&"object"===typeof e&&e.constructor===Object)return this.createActionElement(e)}createDividerElement(){const e=so("div");return e.classList.add(`${eo}__divider`),e.classList.toggle(to,this.darkTheme),e}createActionElement(e){let{id:t,label:i,action:o}=e;return t&&this.registry.isDisabled(t)?this.createDisabledElement(i):this.createButtonElement(i,o)}createButtonElement(e,t){const i=so("button");return i.classList.add(`${eo}__item`),i.classList.toggle(to,this.darkTheme),i.innerHTML=e,i.onclick=()=>{var e;const i=null==(e=this.pickedNode)?void 0:e.series.createNodeContextMenuActionEvent(this.showEvent,this.pickedNode);i?(Object.defineProperty(i,"itemId",{enumerable:!1,get:()=>{var e;return o._Util.Logger.warnOnce("Property [AgNodeContextMenuActionEvent.itemId] is deprecated. Use [yKey], [angleKey] and others instead."),null==(e=this.pickedNode)?void 0:e.itemId}}),t(i)):t({event:this.showEvent}),this.hide()},i}createDisabledElement(e){const t=so("button");return t.classList.add(`${eo}__item`),t.classList.toggle(to,this.darkTheme),t.disabled=!0,t.innerHTML=e,t}reposition(){const{x:e,y:t}=this;this.element.style.top="unset",this.element.style.bottom="unset",this.element.style.left="unset",this.element.style.right="unset",e+this.element.offsetWidth>ro("innerWidth")?this.element.style.right=`calc(100% - ${e-1}px)`:this.element.style.left=`${e+1}px`,t+this.element.offsetHeight>ro("innerHeight")?this.element.style.bottom=`calc(100% - ${t}px - 0.5em)`:this.element.style.top=`calc(${t}px - 0.5em)`}destroy(){var e,t;super.destroy(),null==(e=this.intersectionObserver)||e.unobserve(this.canvasElement),null==(t=this.mutationObserver)||t.disconnect()}};f([ao(oo)],ho.prototype,"enabled",2),f([ao(oo)],ho.prototype,"darkTheme",2);var co={type:"root",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology"],optionsKey:"contextMenu",instanceConstructor:ho,themeTemplate:{contextMenu:{enabled:!0,darkTheme:o._Theme.IS_DARK_THEME}}},{ActionOnSet:uo,BaseProperties:po,BOOLEAN:yo,FUNCTION:go,NUMBER:mo,STRING:xo,Validate:fo,createElement:vo,injectStyle:So}=o._ModuleSupport,{setAttribute:Mo}=o._Util,{BBox:Do}=o._Scene,bo="ag-crosshair-label",No=`\n.${bo} {\n    position: absolute;\n    left: 0px;\n    top: 0px;\n    user-select: none;\n    pointer-events: none;\n    font: 12px Verdana, sans-serif;\n    overflow: hidden;\n    white-space: nowrap;\n    z-index: 99999;\n    box-sizing: border-box;\n}\n\n.${bo}-content {\n    padding: 0 7px;\n    border-radius: 2px;\n    line-height: 1.7em;\n    background-color: rgb(71,71,71);\n    color: rgb(255, 255, 255);\n}\n\n.${bo}-hidden {\n    top: -10000px !important;\n}\n`,Io=class extends o._Scene.ChangeDetectableProperties{constructor(){super(...arguments),this.enabled=!0,this.xOffset=0,this.yOffset=0,this.format=void 0,this.renderer=void 0}};f([fo(yo)],Io.prototype,"enabled",2),f([fo(xo,{optional:!0})],Io.prototype,"className",2),f([fo(mo)],Io.prototype,"xOffset",2),f([fo(mo)],Io.prototype,"yOffset",2),f([fo(xo,{optional:!0})],Io.prototype,"format",2),f([fo(go,{optional:!0})],Io.prototype,"renderer",2);var ko=class extends po{constructor(e){super(),this.labelRoot=e,this.enabled=!0,this.xOffset=0,this.yOffset=0,this.renderer=void 0,this.element=vo("div"),this.element.classList.add(bo),Mo(this.element,"aria-hidden",!0),e.appendChild(this.element),So(No,"crosshairLabel")}show(e){const{element:t}=this;let i=e.x+this.xOffset,o=e.y+this.yOffset;const a=(e,t,i)=>Math.max(Math.min(t,i),e),s=this.getContainerBoundingBox(),n=s.x+s.width-t.clientWidth-1,r=s.y+s.height-t.clientHeight;i=a(s.x+1,i,n),o=a(s.y,o,r),t.style.top=`${Math.round(o)}px`,t.style.left=`${Math.round(i)}px`,this.toggle(!0)}setLabelHtml(e){void 0!==e&&(this.element.innerHTML=e)}computeBBox(){const{element:e}=this;return new o._Scene.BBox(e.clientLeft,e.clientTop,e.clientWidth,e.clientHeight)}getContainerBoundingBox(){const{width:e,height:t}=this.labelRoot.getBoundingClientRect();return new Do(0,0,e,t)}toggle(e){this.element.classList.toggle(`${bo}-hidden`,!e)}destroy(){const{parentNode:e}=this.element;e&&e.removeChild(this.element)}toLabelHtml(e,t){var i,o;if("string"===typeof e)return e;t=null!=t?t:{};const{text:a=(null!=(i=t.text)?i:""),color:s=t.color,backgroundColor:n=t.backgroundColor,opacity:r=(null!=(o=t.opacity)?o:1)}=e,l=`opacity: ${r}; background-color: ${null==n?void 0:n.toLowerCase()}; color: ${s}`;return`<div class="${bo}-content" style="${l}">\n                    <span>${a}</span>\n                </div>`}};f([fo(yo)],ko.prototype,"enabled",2),f([fo(xo,{optional:!0}),uo({changeValue(e,t){e!==t&&(t&&this.element.classList.remove(t),e&&this.element.classList.add(e))}})],ko.prototype,"className",2),f([fo(mo)],ko.prototype,"xOffset",2),f([fo(mo)],ko.prototype,"yOffset",2),f([fo(xo,{optional:!0})],ko.prototype,"format",2),f([fo(go,{optional:!0})],ko.prototype,"renderer",2);var{Group:To,Line:Ao,BBox:Oo}=o._Scene,{createId:Lo}=o._Util,{POSITIVE_NUMBER:Eo,RATIO:_o,BOOLEAN:Ro,COLOR_STRING:Co,LINE_DASH:wo,OBJECT:Po,Validate:zo,Layers:Ko,getDocument:Vo}=o._ModuleSupport,Bo=class extends o._ModuleSupport.BaseModuleInstance{constructor(e){super(),this.ctx=e,this.id=Lo(this),this.enabled=!1,this.stroke="rgb(195, 195, 195)",this.lineDash=[6,3],this.lineDashOffset=0,this.strokeWidth=1,this.strokeOpacity=1,this.snap=!0,this.label=new Io,this.seriesRect=new Oo(0,0,0,0),this.hoverRect=new Oo(0,0,0,0),this.bounds=new Oo(0,0,0,0),this.visible=!1,this.crosshairGroup=new To({layer:!0,zIndex:Ko.SERIES_CROSSHAIR_ZINDEX}),this.lineGroup=this.crosshairGroup.appendChild(new To({name:`${this.id}-crosshair-lines`,zIndex:Ko.SERIES_CROSSHAIR_ZINDEX})),this.lineGroupSelection=o._Scene.Selection.select(this.lineGroup,Ao,!1),this.activeHighlight=void 0,this.axisCtx=e.parent,this.crosshairGroup.visible=!1,this.labels={};const t=e.regionManager.getRegion("series");this.destroyFns.push(e.scene.attachNode(this.crosshairGroup),t.addListener("hover",(e=>this.onMouseMove(e))),t.addListener("leave",(()=>this.onMouseOut())),e.highlightManager.addListener("highlight-change",(e=>this.onHighlightChange(e))),e.layoutService.addListener("layout-complete",(e=>this.layout(e))),(()=>Object.entries(this.labels).forEach((e=>{let[t,i]=e;return i.destroy()}))))}layout(e){let{series:{rect:t,paddedRect:i,visible:o},axes:a}=e;if(this.hideCrosshairs(),!(o&&a&&this.enabled))return void(this.visible=!1);this.visible=!0,this.seriesRect=t,this.hoverRect=i;const{position:s="left",axisId:n}=this.axisCtx,r=a.find((e=>e.id===n));if(!r)return;this.axisLayout=r;const l=r.gridPadding+r.seriesAreaPadding;this.bounds=this.buildBounds(t,s,l);const{crosshairGroup:h,bounds:d}=this;h.translationX=Math.round(d.x),h.translationY=Math.round(d.y);const c=["pointer",...this.axisCtx.seriesKeyProperties()];this.updateSelections(c),this.updateLines(),this.updateLabels(c)}buildBounds(e,t,i){const o=e.clone();return o.x+="left"===t?-i:0,o.y+="top"===t?-i:0,o.width+="left"===t||"right"===t?i:0,o.height+="top"===t||"bottom"===t?i:0,o}updateSelections(e){this.lineGroupSelection.update(e,(e=>e.append(new Ao)),(e=>e))}updateLabels(e){var t;const{labels:i,ctx:o,axisLayout:a}=this;e.forEach((e=>{var t;null!=i[e]||(i[e]=new ko(null!=(t=o.scene.canvas.container)?t:Vo("body"))),this.updateLabel(i[e])}));const s=null!=(t=this.label.format)?t:null==a?void 0:a.label.format;this.labelFormatter=s?this.axisCtx.scaleValueFormatter(s):void 0}updateLabel(e){const{enabled:t,className:i,xOffset:o,yOffset:a,format:s,renderer:n}=this.label;e.enabled=t,e.className=i,e.xOffset=o,e.yOffset=a,e.format=s,e.renderer=n}updateLines(){const{lineGroupSelection:e,bounds:t,stroke:i,strokeWidth:o,strokeOpacity:a,lineDash:s,lineDashOffset:n,axisLayout:r}=this;if(!r)return;const l=this.isVertical();e.each((e=>{e.stroke=i,e.strokeWidth=o,e.strokeOpacity=a,e.lineDash=s,e.lineDashOffset=n,e.y1=0,e.y2=l?t.height:0,e.x1=0,e.x2=l?0:t.width}))}isVertical(){return"x"===this.axisCtx.direction}formatValue(e){var t;const{labelFormatter:i,axisLayout:o,ctx:{callbackCache:a}}=this;if(i){const t=a.call(i,e);if(void 0!==t)return t}const s=e%1===0,n=(null!=(t=null==o?void 0:o.label.fractionDigits)?t:0)+(s?0:1);return"number"===typeof e?e.toFixed(n):String(e)}onMouseMove(e){if(!this.enabled||this.snap)return;const{crosshairGroup:t,hoverRect:i}=this,{offsetX:o,offsetY:a}=e;if(this.visible&&i.containsPoint(o,a)){t.visible=!0;const i=this.getData(e);this.updatePositions(i)}else this.hideCrosshairs()}onMouseOut(){this.hideCrosshairs()}onHighlightChange(e){var t,i,o;if(!this.enabled)return;const{crosshairGroup:a,axisCtx:s}=this,{datum:n,series:r}=null!=(t=e.currentHighlight)?t:{},l=n&&((null==(i=null==r?void 0:r.axes.x)?void 0:i.id)===s.axisId||(null==(o=null==r?void 0:r.axes.y)?void 0:o.id)===s.axisId);if(this.activeHighlight=l?e.currentHighlight:void 0,this.snap){if(!this.visible||!this.activeHighlight)return void this.hideCrosshairs();const e=this.getActiveHighlightData(this.activeHighlight);this.updatePositions(e),a.visible=!0}}updatePositions(e){const{seriesRect:t,lineGroupSelection:i}=this;i.each(((i,o)=>{const a=e[o];if(!a)return void(i.visible=!1);i.visible=!0;const{value:s,position:n}=a;let r=0,l=0;this.isVertical()?(r=n,i.translationX=Math.round(r)):(l=n,i.translationY=Math.round(l)),this.label.enabled?this.showLabel(r+t.x,l+t.y,s,o):this.hideLabel(o)}))}getData(e){var t,i;const{seriesRect:o,axisCtx:a}=this,s="pointer",{datum:n,xKey:r="",yKey:l=""}=null!=(t=this.activeHighlight)?t:{},{offsetX:h,offsetY:d}=e,c=h-o.x,u=d-o.y,p=this.isVertical();return{[s]:{position:p?c:u,value:a.continuous?a.scaleInvert(p?c:u):null!=(i=null==n?void 0:n[p?r:l])?i:""}}}getActiveHighlightData(e){var t,i;const{axisCtx:o}=this,{datum:a,series:s,xKey:n="",aggregatedValue:r,cumulativeValue:l,midPoint:h}=e,d=s.getKeyProperties(o.direction),c=o.scaleBandwidth()/2,u=(null==(t=s.axes[o.direction])?void 0:t.id)===o.axisId,p=d.indexOf("yKey")>-1&&u,y=d.indexOf("xKey")>-1&&u;if(p&&void 0!==r)return{yKey:{value:r,position:o.scaleConvert(r)+c}};if(p&&void 0!==l)return{yKey:{value:l,position:o.scaleConvert(l)+c}};if(y){const e=null!=(i=this.isVertical()?null==h?void 0:h.x:null==h?void 0:h.y)?i:0;return{xKey:{value:o.continuous?o.scaleInvert(e):a[n],position:e}}}const g={};return d.forEach((e=>{const t=s.properties[e],i=a[t],n=o.scaleConvert(i)+c;g[e]={value:i,position:n}})),g}getLabelHtml(e,t){const{label:{renderer:i},axisLayout:{label:{fractionDigits:o=0}={}}={}}=this,a={text:this.formatValue(e)};if(i){const s={value:e,fractionDigits:o};return t.toLabelHtml(i(s),a)}return t.toLabelHtml(a)}showLabel(e,t,i,o){const{axisCtx:a,bounds:s,axisLayout:n}=this;if(!n)return;const{label:{padding:r},tickSize:l}=n,h=r+l,d=this.labels[o],c=this.getLabelHtml(i,d);d.setLabelHtml(c);const u=d.computeBBox();let p;if(this.isVertical()){const t=-u.width/2,i="bottom"===a.position?0:-u.height;p={x:e+t,y:("bottom"===a.position?s.y+s.height+h:s.y-h)+i}}else{const e=-u.height/2,i="right"===a.position?0:-u.width;p={x:("right"===a.position?s.x+s.width+h:s.x-h)+i,y:t+e}}d.show(p)}hideCrosshairs(){this.crosshairGroup.visible=!1;for(const e in this.labels)this.hideLabel(e)}hideLabel(e){this.labels[e].toggle(!1)}};f([zo(Ro)],Bo.prototype,"enabled",2),f([zo(Co,{optional:!0})],Bo.prototype,"stroke",2),f([zo(wo,{optional:!0})],Bo.prototype,"lineDash",2),f([zo(Eo)],Bo.prototype,"lineDashOffset",2),f([zo(Eo)],Bo.prototype,"strokeWidth",2),f([zo(_o)],Bo.prototype,"strokeOpacity",2),f([zo(Ro)],Bo.prototype,"snap",2),f([zo(Po)],Bo.prototype,"label",2);var Fo={type:"axis-option",optionsKey:"crosshair",packageType:"enterprise",chartTypes:["cartesian"],axisTypes:["category","ordinal-time","number","log","time"],instanceConstructor:Bo,themeTemplate:{crosshair:{enabled:!0,snap:!0,stroke:o._Theme.DEFAULT_MUTED_LABEL_COLOUR,strokeWidth:1,strokeOpacity:1,lineDash:[5,6],lineDashOffset:0,label:{enabled:!0}},category:{crosshair:{enabled:!1,snap:!0,stroke:o._Theme.DEFAULT_MUTED_LABEL_COLOUR,strokeWidth:1,strokeOpacity:1,lineDash:[5,6],lineDashOffset:0,label:{enabled:!0}}}}},{BOOLEAN:Uo,FUNCTION:jo,ActionOnSet:Wo,Validate:Yo}=o._ModuleSupport,Go=class extends o._ModuleSupport.BaseModuleInstance{constructor(e){super(),this.enabled=!1,this.getData=()=>Promise.resolve(),this.dataService=e.dataService}updateCallback(e,t){this.dataService&&(e&&null!=t?this.dataService.updateCallback(t):this.dataService.clearCallback())}};f([Wo({newValue(e){this.updateCallback(e,this.getData)}}),Yo(Uo)],Go.prototype,"enabled",2),f([Wo({newValue(e){this.updateCallback(this.enabled,e)}}),Yo(jo)],Go.prototype,"getData",2),f([Wo({newValue(e){this.dataService.requestThrottle=e}})],Go.prototype,"requestThrottle",2),f([Wo({newValue(e){this.dataService.dispatchThrottle=e}})],Go.prototype,"updateThrottle",2),f([Wo({newValue(e){this.dataService.dispatchOnlyLatest=!e}})],Go.prototype,"updateDuringInteraction",2);var Ho={type:"root",optionsKey:"dataSource",packageType:"enterprise",chartTypes:["cartesian","hierarchy","polar","topology"],instanceConstructor:Go,themeTemplate:{dataSource:{enabled:!1}}},{partialAssign:Xo,mergeDefaults:Qo}=o._ModuleSupport,{BBox:$o}=o._Scene,Zo=class{constructor(e){this.components=e,this.union=$o.merge(e)}containsPoint(e,t){if(!this.union.containsPoint(e,t))return!1;for(const i of this.components)if(i.containsPoint(e,t))return!0;return!1}},qo=class extends o._Scene.Group{constructor(){super(),this.capLength=NaN,this._datum=void 0,this.whiskerPath=new o._Scene.Path,this.capsPath=new o._Scene.Path,this.bboxes=new Zo([]),this.append([this.whiskerPath,this.capsPath])}get datum(){return this._datum}set datum(e){this._datum=e}calculateCapLength(e,t){const{lengthRatio:i=1,length:o}=e,{lengthRatioMultiplier:a,lengthMax:s}=t,n=null!=o?o:i*a;return Math.min(n,s)}getFormatterParams(e,t){const{datum:i}=this;if(void 0===i||void 0===e.formatter&&void 0===e.cap.formatter)return;const{xLowerKey:o,xLowerName:a,xUpperKey:s,xUpperName:n,yLowerKey:r,yLowerName:l,yUpperKey:h,yUpperName:d}=e;return{datum:i.datum,seriesId:i.datum.seriesId,xKey:i.xKey,yKey:i.yKey,xLowerKey:o,xLowerName:a,xUpperKey:s,xUpperName:n,yLowerKey:r,yLowerName:l,yUpperKey:h,yUpperName:d,highlighted:t}}formatStyles(e,t,i){let o=e,{cap:a}=o,s=x(o,["cap"]);const n=this.getFormatterParams(t,i);if(void 0!==n){if(void 0!==t.formatter){const e=t.formatter(n);s=Qo(e,s),a=Qo(e,a),a=Qo(null==e?void 0:e.cap,a)}if(void 0!==t.cap.formatter){const e=t.cap.formatter(n);a=Qo(e,a)}}return{whiskerStyle:s,capsStyle:a}}applyStyling(e,t){Xo(["visible","stroke","strokeWidth","strokeOpacity","lineDash","lineDashOffset"],e,t)}update(e,t,i){if(void 0===this.datum)return;const{whiskerStyle:o,capsStyle:a}=this.formatStyles(e,t,i),{xBar:s,yBar:n,capDefaults:r}=this.datum,l=this.whiskerPath;this.applyStyling(l,o),l.path.clear(),void 0!==n&&(l.path.moveTo(n.lowerPoint.x,n.lowerPoint.y),l.path.lineTo(n.upperPoint.x,n.upperPoint.y)),void 0!==s&&(l.path.moveTo(s.lowerPoint.x,s.lowerPoint.y),l.path.lineTo(s.upperPoint.x,s.upperPoint.y)),l.path.closePath(),l.markDirtyTransform(),this.capLength=this.calculateCapLength(null!=a?a:{},r);const h=this.capLength/2,d=this.capsPath;this.applyStyling(d,a),d.path.clear(),void 0!==n&&(d.path.moveTo(n.lowerPoint.x-h,n.lowerPoint.y),d.path.lineTo(n.lowerPoint.x+h,n.lowerPoint.y),d.path.moveTo(n.upperPoint.x-h,n.upperPoint.y),d.path.lineTo(n.upperPoint.x+h,n.upperPoint.y)),void 0!==s&&(d.path.moveTo(s.lowerPoint.x,s.lowerPoint.y-h),d.path.lineTo(s.lowerPoint.x,s.lowerPoint.y+h),d.path.moveTo(s.upperPoint.x,s.upperPoint.y-h),d.path.lineTo(s.upperPoint.x,s.upperPoint.y+h)),d.path.closePath(),d.markDirtyTransform()}updateBBoxes(){var e;const{capLength:t,whiskerPath:i,capsPath:o}=this,{yBar:a,xBar:s}=null!=(e=this.datum)?e:{},n=t/2,r=[];if(void 0!==a){const e=a.lowerPoint.y-a.upperPoint.y;r.push(new $o(a.lowerPoint.x,a.upperPoint.y,i.strokeWidth,e),new $o(a.lowerPoint.x-n,a.lowerPoint.y,t,o.strokeWidth),new $o(a.upperPoint.x-n,a.upperPoint.y,t,o.strokeWidth))}if(void 0!==s){const e=s.upperPoint.x-s.lowerPoint.x;r.push(new $o(s.lowerPoint.x,s.upperPoint.y,e,i.strokeWidth),new $o(s.lowerPoint.x,s.lowerPoint.y-n,o.strokeWidth,t),new $o(s.upperPoint.x,s.upperPoint.y-n,o.strokeWidth,t))}this.bboxes.components=r,this.bboxes.union=$o.merge(r)}containsPoint(e,t){return this.bboxes.containsPoint(e,t)}pickNode(e,t){return this.containsPoint(e,t)?this:void 0}nearestSquared(e,t,i){const{bboxes:o}=this;if(o.union.distanceSquared(e,t)>i)return{nearest:void 0,distanceSquared:1/0};const{distanceSquared:a}=$o.nearestBox(e,t,o.components);return{nearest:this,distanceSquared:a}}},Jo=class extends o._Scene.Group{get children(){return super.children}nearestSquared(e,t){const{nearest:i,distanceSquared:a}=o._Scene.nearestSquaredInContainer(e,t,this);if(void 0!==i&&!isNaN(a))return{datum:i.datum,distanceSquared:a}}},{BaseProperties:ea,Validate:ta,BOOLEAN:ia,COLOR_STRING:oa,FUNCTION:aa,LINE_DASH:sa,NUMBER:na,OBJECT:ra,POSITIVE_NUMBER:la,RATIO:ha,STRING:da}=o._ModuleSupport,ca=class extends ea{};f([ta(ia,{optional:!0})],ca.prototype,"visible",2),f([ta(oa,{optional:!0})],ca.prototype,"stroke",2),f([ta(la,{optional:!0})],ca.prototype,"strokeWidth",2),f([ta(ha,{optional:!0})],ca.prototype,"strokeOpacity",2),f([ta(sa,{optional:!0})],ca.prototype,"lineDash",2),f([ta(la,{optional:!0})],ca.prototype,"lineDashOffset",2),f([ta(na,{optional:!0})],ca.prototype,"length",2),f([ta(ha,{optional:!0})],ca.prototype,"lengthRatio",2),f([ta(aa,{optional:!0})],ca.prototype,"formatter",2);var ua=class extends ea{constructor(){super(...arguments),this.visible=!0,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.cap=new ca}};f([ta(da,{optional:!0})],ua.prototype,"yLowerKey",2),f([ta(da,{optional:!0})],ua.prototype,"yLowerName",2),f([ta(da,{optional:!0})],ua.prototype,"yUpperKey",2),f([ta(da,{optional:!0})],ua.prototype,"yUpperName",2),f([ta(da,{optional:!0})],ua.prototype,"xLowerKey",2),f([ta(da,{optional:!0})],ua.prototype,"xLowerName",2),f([ta(da,{optional:!0})],ua.prototype,"xUpperKey",2),f([ta(da,{optional:!0})],ua.prototype,"xUpperName",2),f([ta(ia,{optional:!0})],ua.prototype,"visible",2),f([ta(oa,{optional:!0})],ua.prototype,"stroke",2),f([ta(la,{optional:!0})],ua.prototype,"strokeWidth",2),f([ta(ha,{optional:!0})],ua.prototype,"strokeOpacity",2),f([ta(sa,{optional:!0})],ua.prototype,"lineDash",2),f([ta(la,{optional:!0})],ua.prototype,"lineDashOffset",2),f([ta(aa,{optional:!0})],ua.prototype,"formatter",2),f([ta(ra)],ua.prototype,"cap",2);var{fixNumericExtent:pa,groupAccumulativeValueProperty:ya,isDefined:ga,mergeDefaults:ma,valueProperty:xa,ChartAxisDirection:fa}=o._ModuleSupport;var va=class e extends o._ModuleSupport.BaseModuleInstance{constructor(e){super(),this.properties=new ua;const t=function(e){for(const t of o.AgErrorBarSupportedSeriesTypes)if(t===e.series.type)return e.series;throw new Error(`AG Charts - unsupported series type '${e.series.type}', error bars supported series types: ${o.AgErrorBarSupportedSeriesTypes.join(", ")}`)}(e),{annotationGroup:i,annotationSelections:a}=t;this.cartesianSeries=t,this.groupNode=new Jo({name:`${i.id}-errorBars`,zIndex:o._ModuleSupport.Layers.SERIES_LAYER_ZINDEX,zIndexSubOrder:t.getGroupZIndexSubOrder("annotation")}),i.appendChild(this.groupNode),this.selection=o._Scene.Selection.select(this.groupNode,(()=>this.errorBarFactory())),a.add(this.selection),this.destroyFns.push(t.addListener("data-processed",(e=>this.onDataProcessed(e))),t.addListener("data-update",(e=>this.onDataUpdate(e))),t.addListener("visibility-changed",(e=>this.onToggleSeriesItem(e))),e.highlightManager.addListener("highlight-change",(e=>this.onHighlightChange(e))),(()=>i.removeChild(this.groupNode)),(()=>a.delete(this.selection)))}hasErrorBars(){const{xLowerKey:e,xUpperKey:t,yLowerKey:i,yUpperKey:o}=this.properties;return ga(e)&&ga(t)||ga(i)&&ga(o)}isStacked(){var e;const t=null==(e=this.cartesianSeries.seriesGrouping)?void 0:e.stackCount;return null!=t&&t>0}getUnstackPropertyDefinition(e){const t=[],{xLowerKey:i,xUpperKey:o,yLowerKey:a,yUpperKey:s,xErrorsID:n,yErrorsID:r}=this.getMaybeFlippedKeys(),{xScaleType:l,yScaleType:h}=e;return null!=a&&null!=s&&t.push(xa(a,h,{id:`${r}-lower`}),xa(s,h,{id:`${r}-upper`})),null!=i&&null!=o&&t.push(xa(i,l,{id:`${n}-lower`}),xa(o,l,{id:`${n}-upper`})),t}getStackPropertyDefinition(e){var t,i;const o=[],{cartesianSeries:a}=this,{xLowerKey:s,xUpperKey:n,yLowerKey:r,yUpperKey:l,xErrorsID:h,yErrorsID:d}=this.getMaybeFlippedKeys(),{xScaleType:c,yScaleType:u}=e,p=null!=(i=null==(t=a.seriesGrouping)?void 0:t.groupIndex)?i:a.id,y=g({invalidValue:null,missingValue:0,separateNegative:!0},a.visible?{}:{forceValue:0}),m=(e,t,i,o)=>ya(e,"normal","current",g({id:`${t}-${i}`,groupId:`errorGroup-${p}-${i}`},y),o),x=(e,t,i,a)=>{o.push(...m(e,i,"lower",a),...m(t,i,"upper",a))};return null!=r&&null!=l&&x(r,l,d,u),null!=s&&null!=n&&x(s,n,h,c),o}getPropertyDefinitions(e){return this.isStacked()?this.getStackPropertyDefinition(e):this.getUnstackPropertyDefinition(e)}onDataProcessed(e){this.dataModel=e.dataModel,this.processedData=e.processedData}getDomain(e){const{xLowerKey:t,xUpperKey:i,xErrorsID:o,yLowerKey:a,yUpperKey:s,yErrorsID:n}=this.getMaybeFlippedKeys();if(e===fa.X?ga(t)&&ga(i):ga(a)&&ga(s)){const{dataModel:t,processedData:i,cartesianSeries:a}=this;if(null!=t&&null!=i){const s=a.axes[e],r={x:o,y:n}[e],l=t.getDomain(a,`${r}-lower`,"value",i),h=t.getDomain(a,`${r}-upper`,"value",i),d=[Math.min(...l,...h),Math.max(...l,...h)];return pa(d,s)}}return[]}onDataUpdate(e){this.dataModel=e.dataModel,this.processedData=e.processedData,ga(e.dataModel)&&ga(e.processedData)&&(this.createNodeData(),this.update())}getNodeData(){var e;return null==(e=this.cartesianSeries.contextNodeData)?void 0:e.nodeData}createNodeData(){var e,t;const i=this.getNodeData(),o=null==(e=this.cartesianSeries.axes[fa.X])?void 0:e.scale,a=null==(t=this.cartesianSeries.axes[fa.Y])?void 0:t.scale;if(this.hasErrorBars()&&o&&a&&i)for(let s=0;s<i.length;s++){const{midPoint:e,xLower:t,xUpper:n,yLower:r,yUpper:l}=this.getDatum(i,s);if(null!=e){let h,d;ga(t)&&ga(n)&&(h={lowerPoint:{x:this.convert(o,t),y:e.y},upperPoint:{x:this.convert(o,n),y:e.y}}),ga(r)&&ga(l)&&(d={lowerPoint:{x:e.x,y:this.convert(a,r)},upperPoint:{x:e.x,y:this.convert(a,l)}}),i[s].xBar=h,i[s].yBar=d}}}getMaybeFlippedKeys(){let{xLowerKey:e,xUpperKey:t,yLowerKey:i,yUpperKey:o}=this.properties,[a,s]=["xValue-errors","yValue-errors"];return this.cartesianSeries.shouldFlipXY()&&([e,i]=[i,e],[t,o]=[o,t],[a,s]=[s,a]),{xLowerKey:e,xUpperKey:t,xErrorsID:a,yLowerKey:i,yUpperKey:o,yErrorsID:s}}static getDatumKey(e,t,i){if(null==t)return;const a=e.datum[t];if(null!=a){if("number"===typeof a)return a+i;o._Util.Logger.warnOnce(`Found [${t}] error value of type ${typeof a}. Expected number type`)}}getDatum(t,i){const{xLowerKey:o,xUpperKey:a,yLowerKey:s,yUpperKey:n}=this.getMaybeFlippedKeys(),r=t[i],l=null!=r.cumulativeValue&&this.isStacked()?r.cumulativeValue-r.yValue:0,[h,d]=this.cartesianSeries.shouldFlipXY()?[l,0]:[0,l];return{midPoint:r.midPoint,xLower:e.getDatumKey(r,o,h),xUpper:e.getDatumKey(r,a,h),yLower:e.getDatumKey(r,s,d),yUpper:e.getDatumKey(r,n,d)}}convert(e,t){var i;const o=(null!=(i=e.bandwidth)?i:0)/2;return e.convert(t)+o}update(){const e=this.getNodeData();null!=e&&(this.selection.update(e),this.selection.each(((e,t,i)=>this.updateNode(e,t,i))))}updateNode(e,t,i){e.datum=t,e.update(this.getDefaultStyle(),this.properties,!1),e.updateBBoxes()}pickNodeExact(e){const{x:t,y:i}=this.groupNode.transformPoint(e.x,e.y),o=this.groupNode.pickNode(t,i);if(null!=o)return{datum:o.datum,distanceSquared:0}}pickNodeNearest(e){return this.groupNode.nearestSquared(e.x,e.y)}pickNodeMainAxisFirst(e){return this.groupNode.nearestSquared(e.x,e.y)}getTooltipParams(){const{xLowerKey:e,xUpperKey:t,yLowerKey:i,yUpperKey:o,xLowerName:a=e,xUpperName:s=t,yLowerName:n=i,yUpperName:r=o}=this.properties;return{xLowerKey:e,xLowerName:a,xUpperKey:t,xUpperName:s,yLowerKey:i,yLowerName:n,yUpperKey:o,yUpperName:r}}onToggleSeriesItem(e){this.groupNode.visible=e.enabled}makeStyle(e){return{visible:e.visible,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,stroke:e.stroke,strokeWidth:e.strokeWidth,strokeOpacity:e.strokeOpacity,cap:ma(this.properties.cap,e)}}getDefaultStyle(){return this.makeStyle(this.getWhiskerProperties())}getHighlightStyle(){return this.makeStyle(this.getWhiskerProperties())}restyleHighlightChange(e,t,i){const o=this.getNodeData();if(null!=o)for(let a=0;a<o.length;a++)if(e===o[a]){this.selection.nodes()[a].update(t,this.properties,i);break}}onHighlightChange(e){const{previousHighlight:t,currentHighlight:i}=e;(null==i?void 0:i.series)===this.cartesianSeries&&this.restyleHighlightChange(i,this.getHighlightStyle(),!0),(null==t?void 0:t.series)===this.cartesianSeries&&this.restyleHighlightChange(t,this.getDefaultStyle(),!1),this.groupNode.opacity=this.cartesianSeries.getOpacity()}errorBarFactory(){return new qo}getWhiskerProperties(){const{stroke:e,strokeWidth:t,visible:i,strokeOpacity:o,lineDash:a,lineDashOffset:s}=this.properties;return{stroke:e,strokeWidth:t,visible:i,strokeOpacity:o,lineDash:a,lineDashOffset:s}}},Sa={series:{errorBar:{visible:!0,stroke:o._Theme.DEFAULT_LABEL_COLOUR,strokeWidth:1,strokeOpacity:1,cap:{length:void 0,lengthRatio:void 0}}}},Ma={type:"series-option",identifier:"error-bars",optionsKey:"errorBar",packageType:"enterprise",chartTypes:["cartesian"],seriesTypes:o.AgErrorBarSupportedSeriesTypes,instanceConstructor:va,themeTemplate:Sa},{Validate:Da,BOOLEAN:ba,POSITIVE_NUMBER:Na,Layers:Ia,ActionOnSet:ka,CategoryAxis:Ta,GroupedCategoryAxis:Aa}=o._ModuleSupport,{toRadians:Oa,Padding:La,Logger:Ea}=o._Util,{Text:_a,Group:Ra,BBox:Ca}=o._Scene,wa=class{constructor(){this.top=0,this.bottom=0}};f([Da(Na)],wa.prototype,"top",2),f([Da(Na)],wa.prototype,"bottom",2);var Pa=class extends o._ModuleSupport.BaseModuleInstance{constructor(e){super(),this.ctx=e,this.enabled=!1,this.padding=new wa,this.root=new Ra({name:"root"}),this.seriesRoot=this.root.appendChild(new Ra({name:"Series-root",layer:!0,zIndex:Ia.SERIES_LAYER_ZINDEX})),this.axisGridGroup=this.root.appendChild(new Ra({name:"Axes-Grids",layer:!0,zIndex:Ia.AXIS_GRID_ZINDEX})),this.axisGroup=this.root.appendChild(new Ra({name:"Axes-Grids",layer:!0,zIndex:Ia.AXIS_GRID_ZINDEX})),this.data=[],this._destroyed=!1,this.miniChartAnimationPhase="initial",this.axes=[],this.series=[]}destroy(){this._destroyed||(this.destroySeries(this.series),this.axes.forEach((e=>e.destroy())),this.axes=[],this._destroyed=!0)}onSeriesChange(e,t){var i;const o=null!=(i=null==t?void 0:t.filter((t=>!e.includes(t))))?i:[];this.destroySeries(o);for(const a of e){if(null==t?void 0:t.includes(a))continue;null==a.rootGroup.parent&&this.seriesRoot.appendChild(a.rootGroup);const e=this;a.chart={get mode(){return"standalone"},get isMiniChart(){return!0},get seriesRect(){return e.seriesRect},placeLabels:()=>new Map},a.resetAnimation("initial"===this.miniChartAnimationPhase?"initial":"disabled")}}destroySeries(e){null==e||e.forEach((e=>{e.destroy(),null!=e.rootGroup&&this.seriesRoot.removeChild(e.rootGroup),e.chart=void 0}))}assignSeriesToAxes(){this.axes.forEach((e=>{e.boundSeries=this.series.filter((t=>t.axes[e.direction]===e))}))}assignAxesToSeries(){const e={};this.axes.forEach((t=>{var i;const o=t.direction;(null!=(i=e[o])?i:e[o]=[]).push(t)})),this.series.forEach((t=>{t.directions.forEach((i=>{const o=e[i];if(!o)return void Ea.warnOnce(`no available axis for direction [${i}]; check series and axes configuration.`);const a=t.getKeys(i),s=this.findMatchingAxis(o,a);s?t.axes[i]=s:Ea.warnOnce(`no matching axis for direction [${i}] and keys [${a}]; check series and axes configuration.`)}))}))}findMatchingAxis(e,t){for(const i of e){if(!i.keys.length)return i;if(t)for(const e of t)if(i.keys.includes(e))return i}}updateData(e){return S(this,null,(function*(){this.series.forEach((t=>t.setChartData(e.data))),"initial"===this.miniChartAnimationPhase&&this.ctx.animationManager.onBatchStop((()=>{this.miniChartAnimationPhase="ready",this.series.forEach((e=>e.resetAnimation("disabled")))}))}))}processData(e){return S(this,null,(function*(){this.series.some((e=>e.canHaveAxes))&&(this.assignAxesToSeries(),this.assignSeriesToAxes());const t=this.series.map((t=>t.processData(e.dataController)));yield Promise.all(t)}))}computeAxisPadding(){const e=new La;return this.enabled?(this.axes.forEach((t=>{var i;const{position:o,thickness:a=0,line:s,label:n}=t;if(null==o)return;let r;r=a>0?a:(s.enabled?s.width:0)+(n.enabled?(null!=(i=n.fontSize)?i:0)*_a.defaultLineHeightRatio+n.padding:0),e[o]=Math.ceil(r)})),e):e}layout(e,t){return S(this,null,(function*(){const{padding:i}=this,o=null!=this.seriesRect,a=new Ca(0,0,e,t-(i.top+i.bottom));this.seriesRect=a,this.seriesRoot.translationY=i.top,this.seriesRoot.setClipRectInGroupCoordinateSpace(this.seriesRoot.inverseTransformBBox(new Ca(0,-i.top,e,t)));this.axes.forEach((i=>{const{position:s="left"}=i;switch(s){case"top":case"bottom":i.range=[0,a.width],i.gridLength=a.height;break;case"right":case"left":i.range=(e=>e instanceof Ta||e instanceof Aa?[0,a.height]:[a.height,0])(i),i.gridLength=a.width}switch(s){case"top":case"left":i.translation.x=0,i.translation.y=0;break;case"bottom":i.translation.x=0,i.translation.y=t;break;case"right":i.translation.x=e,i.translation.y=0}i.gridPadding=0,i.calculateLayout(),i.updatePosition({rotation:Oa(i.rotation),sideFlag:i.label.getSideFlag()}),i.update(void 0,o)})),yield Promise.all(this.series.map((e=>e.update({seriesRect:a}))))}))}};f([Da(ba)],Pa.prototype,"enabled",2),f([ka({changeValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];for(const i of t)e.includes(i)||(i.detachAxis(this.axisGroup,this.axisGridGroup),i.destroy());for(const i of e)(null==t?void 0:t.includes(i))||i.attachAxis(this.axisGroup,this.axisGridGroup)}})],Pa.prototype,"axes",2),f([ka({changeValue(e,t){this.onSeriesChange(e,t)}})],Pa.prototype,"series",2);var{ObserveChanges:za}=o._ModuleSupport,Ka=class e extends o._ModuleSupport.Navigator{constructor(e){super(e),this.miniChart=new Pa(e)}updateData(e){return S(this,null,(function*(){yield this.miniChart.updateData(e)}))}processData(e){return S(this,null,(function*(){yield this.miniChart.processData(e)}))}performLayout(t){return S(this,null,(function*(){const{shrinkRect:i}=yield v(e.prototype,this,"performLayout").call(this,t);if(this.enabled){const{top:e,bottom:t}=this.miniChart.computeAxisPadding();i.shrink(e+t,"bottom"),this.y-=t}return{shrinkRect:i}}))}performCartesianLayout(t){return S(this,null,(function*(){yield v(e.prototype,this,"performCartesianLayout").call(this,t),yield this.miniChart.layout(this.width,this.height)}))}};f([za(((e,t,i)=>{e.updateBackground(null==i?void 0:i.root,null==t?void 0:t.root)}))],Ka.prototype,"miniChart",2);var Va,Ba={type:"root",optionsKey:"navigator",packageType:"enterprise",chartTypes:["cartesian"],instanceConstructor:Ka,themeTemplate:m(g({},o._ModuleSupport.NavigatorModule.themeTemplate),{navigator:m(g({},null==(Va=o._ModuleSupport.NavigatorModule.themeTemplate)?void 0:Va.navigator),{miniChart:{enabled:!1,label:{color:o._Theme.DEFAULT_LABEL_COLOUR,fontStyle:void 0,fontWeight:void 0,fontSize:10,fontFamily:o._Theme.DEFAULT_FONT_FAMILY,formatter:void 0,padding:0},padding:{top:0,bottom:0}}})})},{BOOLEAN:Fa,STRING:Ua,UNION:ja,BaseProperties:Wa,CartesianAxis:Ya,ChartUpdateType:Ga,arraysEqual:Ha,isDate:Xa,isDefined:Qa,isFiniteNumber:$a,ObserveChanges:Za,TooltipManager:qa,Validate:Ja}=o._ModuleSupport,{Logger:es}=o._Util,ts=class extends Wa{constructor(e){super(),this.moduleContext=e,this.enabled=!1,this.axes="x",this.nodeInteraction=!0,this.zoom=!0}updateChart(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ga.UPDATE_DATA;e.ctx.updateService.update(t,{skipSync:!0})}updateSiblings(e){const{syncManager:t}=this.moduleContext;(()=>S(this,null,(function*(){for(const i of t.getGroupSiblings(e))yield i.waitForDataProcess(120),this.updateChart(i)})))().catch((e=>{es.warnOnce("Error updating sibling chart",e)}))}enabledZoomSync(){const{syncManager:e,zoomManager:t}=this.moduleContext;this.disableZoomSync=t.addListener("zoom-change",(()=>{var t;for(const i of e.getGroupSiblings(this.groupId))(null==(t=i.modulesManager.getModule("sync"))?void 0:t.zoom)&&i.ctx.zoomManager.updateZoom("sync",this.mergeZoom(i))}))}enabledNodeInteractionSync(){const{highlightManager:e,syncManager:t}=this.moduleContext;this.disableNodeInteractionSync=e.addListener("highlight-change",(e=>{var i,o,a,s,n,r,l,h,d,c,u,p;for(const y of t.getGroupSiblings(this.groupId))if(null==(i=y.modulesManager.getModule("sync"))?void 0:i.nodeInteraction)if(null==(o=e.currentHighlight)?void 0:o.datum)for(const t of y.axes){const i="xy"===this.axes?"x":this.axes;if(!Ya.is(t)||t.direction!==i)continue;const o=y.series.map((i=>{const o=i.getKeys(t.direction);if(t.keys.length&&!t.keys.some((e=>o.includes(e))))return;const{nodeData:a}=i.contextNodeData;if(!(null==a?void 0:a.length))return;const s=a[0][`${t.direction}Key`];let n=e.currentHighlight.datum[s];const r=Xa(n);r&&(n=n.getTime());const l=a.find((e=>{const t=e.datum[s];return r?t.getTime()===n:t===n}));return l?{series:i,nodeDatum:l}:null})).filter(Qa);if(o.length<2&&(null==(a=o[0])?void 0:a.nodeDatum)!==y.ctx.highlightManager.getActiveHighlight()){const{series:e,nodeDatum:t}=null!=(s=o[0])?s:{};if(y.ctx.highlightManager.updateHighlight(y.id,t),t){const i=null!=(h=null!=(l=null==(n=t.midPoint)?void 0:n.x)?l:null==(r=t.point)?void 0:r.x)?h:0,o=null!=(p=null!=(u=null==(d=t.midPoint)?void 0:d.y)?u:null==(c=t.point)?void 0:c.y)?p:0,a=qa.makeTooltipMeta({type:"hover",offsetX:i,offsetY:o},t);delete a.lastPointerEvent,y.ctx.tooltipManager.updateTooltip(y.id,a,e.getTooltipHtml(t))}else y.ctx.tooltipManager.removeTooltip(y.id);this.updateChart(y,Ga.SERIES_UPDATE)}}else y.ctx.highlightManager.updateHighlight(y.id),y.ctx.tooltipManager.removeTooltip(y.id)}))}syncAxes(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{syncManager:t}=this.moduleContext,i=t.getChart(),o=t.getGroup(this.groupId),a=o.flatMap((e=>e.series)),s=o[0].axes;let n=!1;i.axes.forEach((e=>{if(!Ya.is(e)||"xy"!==this.axes&&this.axes!==e.direction)return void(e.boundSeries=i.series.filter((t=>t.axes[e.direction]===e)));const{direction:t,min:o,max:r,nice:l,reverse:h}=e;for(const a of s)if(t===a.direction&&(l!==a.nice||h!==a.reverse||o!==a.min&&($a(o)||$a(a.min))||r!==a.max&&($a(r)||$a(a.max))))return es.warnOnce("To allow synchronization, ensure that all charts have matching min, max, nice, and reverse properties on the synchronized axes."),e.boundSeries=i.series.filter((t=>t.axes[e.direction]===e)),void(this.enabled=!1);const d=a.filter((t=>{if(t.visible){const i=t.getKeys(e.direction);return!e.keys.length||e.keys.some((e=>i.includes(e)))}}));Ha(e.boundSeries,d)||(e.boundSeries=d,n=!0)})),n&&!e&&this.updateSiblings(this.groupId)}mergeZoom(e){var t,i;const{zoomManager:o}=this.moduleContext;if("xy"===this.axes)return o.getZoom();const a=null!=(t=e.zoomManager.getZoom())?t:{};return a[this.axes]=null==(i=o.getZoom())?void 0:i[this.axes],a}onEnabledChange(){const{syncManager:e}=this.moduleContext;this.enabled?e.subscribe(this.groupId):e.unsubscribe(this.groupId),this.updateSiblings(this.groupId),this.onNodeInteractionChange(),this.onZoomChange()}onGroupIdChange(e,t){if(!this.enabled||e===t)return;const{syncManager:i}=this.moduleContext;i.unsubscribe(t),i.subscribe(e),this.updateSiblings(t),this.updateSiblings(e)}onAxesChange(){if(!this.enabled)return;const{syncManager:e}=this.moduleContext;this.updateChart(e.getChart())}onNodeInteractionChange(){var e;this.enabled&&this.nodeInteraction?this.enabledNodeInteractionSync():null==(e=this.disableNodeInteractionSync)||e.call(this)}onZoomChange(){var e;this.enabled&&this.zoom?this.enabledZoomSync():null==(e=this.disableZoomSync)||e.call(this)}destroy(){var e;const{syncManager:t}=this.moduleContext;t.unsubscribe(this.groupId),this.updateSiblings(this.groupId),null==(e=this.disableZoomSync)||e.call(this)}};ts.className="Sync",f([Ja(Fa),Za((e=>e.onEnabledChange()))],ts.prototype,"enabled",2),f([Ja(Ua,{optional:!0}),Za(((e,t,i)=>e.onGroupIdChange(t,i)))],ts.prototype,"groupId",2),f([Ja(ja(["x","y","xy"],"an axis")),Za((e=>e.onAxesChange()))],ts.prototype,"axes",2),f([Ja(Fa),Za((e=>e.onNodeInteractionChange()))],ts.prototype,"nodeInteraction",2),f([Ja(Fa),Za((e=>e.onZoomChange()))],ts.prototype,"zoom",2);var is={type:"root",optionsKey:"sync",packageType:"enterprise",chartTypes:["cartesian"],instanceConstructor:ts,themeTemplate:{sync:{enabled:!1}}},{COLOR_STRING:os,RATIO:as,Validate:ss}=o._ModuleSupport,ns=class extends o._Scene.Rect{constructor(){super(...arguments),this.fill="rgb(33, 150, 243)",this.fillOpacity=.2}};ns.className="ZoomRect",f([ss(os)],ns.prototype,"fill",2),f([ss(as)],ns.prototype,"fillOpacity",2);var{clamp:rs,isEqual:ls,round:hs}=o._ModuleSupport,ds={min:0,max:1},cs="middle",us=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ds.min,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ds.max;return rs(t,e,i)};function ps(){return{x:g({},ds),y:g({},ds)}}function ys(e){return e.x.max-e.x.min}function gs(e){return e.y.max-e.y.min}function ms(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-10;return ls(e.x.min,t.x.min,i)&&ls(e.x.max,t.x.max,i)&&ls(e.y.min,t.y.min,i)&&ls(e.y.max,t.y.max,i)}function xs(e,t,i){const o=hs(ys(e),10)<=t,a=hs(gs(e),10)<=i;return o||a}function fs(e){var t,i,o,a,s,n,r,l;return{x:{min:null!=(i=null==(t=null==e?void 0:e.x)?void 0:t.min)?i:ds.min,max:null!=(a=null==(o=null==e?void 0:e.x)?void 0:o.max)?a:ds.max},y:{min:null!=(n=null==(s=null==e?void 0:e.y)?void 0:s.min)?n:ds.min,max:null!=(l=null==(r=null==e?void 0:e.y)?void 0:r.max)?l:ds.max}}}function vs(e,t,i){if(!e)return{x:0,y:0};const o=us(t-e.x,0,e.x+e.width),a=us(i-e.y,0,e.y+e.height),s=1/e.width*o,n=1-1/e.height*a;return{x:us(s),y:us(n)}}function Ss(e,t,i){return{x:{min:e.x.min+t,max:e.x.max+t},y:{min:e.y.min+i,max:e.y.max+i}}}function Ms(e,t,i){return{x:{min:e.x.min,max:e.x.min+ys(e)*t},y:{min:e.y.min,max:e.y.min+gs(e)*i}}}function Ds(e,t,i){const o=ys(e),a=gs(e),s=e.x.min+o/2,n=e.y.min+a/2;return{x:{min:s-o*t/2,max:s+o*t/2},y:{min:n-a*i/2,max:n+a*i/2}}}function bs(e,t,i,o){const{min:a,max:s}=t,n=a+(s-a)/2,r=e.max-e.min;switch(i){case"start":return{min:a,max:t.min+r};case"end":return{min:t.max-r,max:s};case"middle":return{min:n-r/2,max:n+r/2};case"pointer":return Ns(e,t,null!=o?o:n);default:return{min:a,max:s}}}function Ns(e,t,i){const o=i-i*(1-(t.max-t.min-(e.max-e.min)));return{min:e.min+o,max:e.max+o}}function Is(e){const t=ps();return t.x=ks(e.x),t.y=ks(e.y),t}function ks(e){const t=e.max-e.min;let i=e.max>ds.max?ds.max-t:e.min,o=e.min<ds.min?t:e.max;return i=Math.max(ds.min,i),o=Math.min(ds.max,o),{min:i,max:o}}function Ts(e,t,i){let{min:o,max:a}=e;if(a===t.max)o=a-i;else if(o===t.min)a=o+i;else{const e=t.min+(t.max-t.min)/2;o=e-i/2,a=e+i/2}return{min:o,max:a}}var As=class{update(e,t,i,a,s,n){return null!=this.oldZoom||(this.oldZoom=fs(t===o._ModuleSupport.ChartAxisDirection.X?m(g({},s),{x:n}):m(g({},s),{y:n}))),this.updateCoords(e.offsetX,e.offsetY),this.updateZoom(t,i,a)}stop(){this.coords=void 0,this.oldZoom=void 0}updateCoords(e,t){this.coords?(this.coords.x2=e,this.coords.y2=t):this.coords={x1:e,y1:t,x2:e,y2:t}}updateZoom(e,t,i){const{coords:a,oldZoom:s}=this;let n=fs(s);if(!a||!s)return e===o._ModuleSupport.ChartAxisDirection.X?n.x:n.y;const r=vs(i,a.x1,a.y1),l=vs(i,a.x2,a.y2);if(e===o._ModuleSupport.ChartAxisDirection.X){const e=(l.x-r.x)*ys(s);return n.x.max+=e,n.x=bs(n.x,s.x,t,r.x),n=Is(n),n.x}const h=(l.y-r.y)*gs(s);return n.y.max-=h,n.y=bs(n.y,s.y,t,r.y),n=Is(n),n.y}},Os="zoom-action",Ls="pan-action",Es=class{constructor(e,t,i){this.contextMenuRegistry=e,this.zoomManager=t,this.updateZoom=i}registerActions(e,t,i){if(!e)return;const{contextMenuRegistry:o}=this;o.registerDefaultAction({id:Os,label:"Zoom to here",action:e=>this.onZoomToHere(e,i)}),o.registerDefaultAction({id:Ls,label:"Pan to here",action:e=>this.onPanToHere(e,i)}),this.toggleActions(t,i)}toggleActions(e,t){const{contextMenuRegistry:i}=this;xs(e,t.minRatioX,t.minRatioY)?i.disableAction(Os):i.enableAction(Os),ms(e,ps())?i.disableAction(Ls):i.enableAction(Ls)}onZoomToHere(e,t){let{event:i}=e;const{rect:o}=this,{enabled:a,isScalingX:s,isScalingY:n,minRatioX:r,minRatioY:l}=t;if(!a||!o||!i||!i.target)return;const h=fs(this.zoomManager.getZoom()),d=vs(o,i.clientX,i.clientY),c=d.x*ys(h),u=d.y*gs(h),p=ds.max-ds.min,y=p/2;let g={x:{min:d.x-y,max:d.x+y},y:{min:d.y-y,max:d.y+y}};g=Ds(g,s?r:p,n?l:p),g=Ss(g,h.x.min-d.x+c,h.y.min-d.y+u),this.updateZoom(Is(g))}onPanToHere(e,t){let{event:i}=e;const{rect:o}=this,{enabled:a}=t;if(!a||!o||!i||!i.target)return;const s=fs(this.zoomManager.getZoom()),n=vs(o,i.clientX,i.clientY),r=ys(s),l=gs(s),h=n.x*r,d=n.y*l,c=(ds.max-ds.min)/2;let u={x:{min:n.x-c,max:n.x+c},y:{min:n.y-c,max:n.y+c}};u=Ds(u,r,l),u=Ss(u,s.x.min-n.x+h,s.y.min-n.y+d),this.updateZoom(Is(u))}},_s=class{constructor(){this.deceleration=1,this.zoomCoordsHistoryIndex=0,this.coordsHistory=[]}addListener(e,t){return this.onUpdate=t,()=>{this.onUpdate=void 0}}stopInteractions(){null!=this.inertiaHandle&&(cancelAnimationFrame(this.inertiaHandle),this.inertiaHandle=void 0)}update(e){var t,i;this.updateCoords(e.offsetX,e.offsetY);const{x1:o=0,y1:a=0,x2:s=0,y2:n=0}=null!=(t=this.coords)?t:{};null==(i=this.onUpdate)||i.call(this,{type:"update",deltaX:o-s,deltaY:a-n})}start(){this.coordsMonitorTimeout=setInterval(this.recordCurrentZoomCoords.bind(this),16)}stop(){const{coordsHistory:e}=this;let t=0,i=0,o=0;if(e.length>0){const a=this.zoomCoordsHistoryIndex%16;let s=a-1;s<0&&(s=e.length-1);let n=a;n>=e.length&&(n=0);const r=e[s],l=e[n];t=r.x-l.x,i=r.y-l.y,o=r.t-l.t}if(this.coords=void 0,clearInterval(this.coordsMonitorTimeout),this.coordsMonitorTimeout=void 0,this.zoomCoordsHistoryIndex=0,this.coordsHistory.length=0,o>0&&this.deceleration<1){const e=t/o,a=i/o,s=Math.hypot(e,a),n=Math.atan2(a,e),r=performance.now();this.inertiaHandle=requestAnimationFrame((e=>{this.animateInertia(e,e,r,s,n)}))}}recordCurrentZoomCoords(){const{coords:e,coordsHistory:t,zoomCoordsHistoryIndex:i}=this;if(!e)return;const{x2:o,y2:a}=e,s=Date.now();t[i%16]={x:o,y:a,t:s},this.zoomCoordsHistoryIndex+=1}animateInertia(e,t,i,o,a){var s;const n=1-this.deceleration,r=-o/Math.log(n),l=o*(p(n,t-i)-1)/Math.log(n),h=o*(p(n,e-i)-1)/Math.log(n);null==(s=this.onUpdate)||s.call(this,{type:"update",deltaX:-Math.cos(a)*(h-l),deltaY:-Math.sin(a)*(h-l)}),h>=r-1||(this.inertiaHandle=requestAnimationFrame((t=>{this.animateInertia(t,e,i,o,a)})))}updateCoords(e,t){this.coords?this.coords={x1:this.coords.x2,y1:this.coords.y2,x2:e,y2:t}:this.coords={x1:e,y1:t,x2:e,y2:t}}translateZooms(e,t,i,a){const s=vs(e,e.x+Math.abs(i),e.y+e.height-Math.abs(a)),n=Math.sign(i)*s.x,r=-Math.sign(a)*s.y,l={};for(const[h,{direction:d,zoom:c}]of Object.entries(t)){let e;e=d===o._ModuleSupport.ChartAxisDirection.X?fs({x:c}):fs({y:c}),e=Is(Ss(e,n*ys(e),r*gs(e))),d===o._ModuleSupport.ChartAxisDirection.X?l[h]={direction:d,zoom:e.x}:l[h]={direction:d,zoom:e.y}}return l}},{AND:Rs,DATE:Cs,NUMBER:ws,OR:Ps,ActionOnSet:zs,isFiniteNumber:Ks,isValidDate:Vs,Validate:Bs}=o._ModuleSupport,Fs=class{constructor(e){this.onChange=e}getRange(){return this.getRangeWithValues(this.start,this.end)}getInitialRange(){return this.getRangeWithValues(this.initialStart,this.initialEnd)}extendToEnd(e){return this.extendWith((t=>Number(t)-e))}extendWith(e){var t;if(!this.domain)return;const[,i]=this.domain;if(null==i)return;const o=e(i),a=this.start!==o||this.end!==i;this.end=i,this.start=o,a||null==(t=this.onChange)||t.call(this,this.getRange())}updateWith(e){var t;if(!this.domain)return;let[i,o]=this.domain;[i,o]=e(i,o);const a=this.start!==i||this.end!==o;this.end=o,this.start=i,a||null==(t=this.onChange)||t.call(this,this.getRange())}extendAll(){var e;if(!this.domain)return;const[t,i]=this.domain,o=this.start!==t||this.end!==i;this.start=t,this.end=i,o||null==(e=this.onChange)||e.call(this,this.getRange())}updateAxis(e){const t=e.find((e=>{let{domain:t}=e;const i=!Ks(t[0])||!Ks(t.at(-1)),o=!Vs(t[0])||!Vs(t.at(-1));return i||o}));if(!t)return null!=this.domain;let i=t.domain;null!=i&&(i=[i[0],i.at(-1)],i[0]instanceof Date&&i[1]instanceof Date&&(i=[i[0].getTime(),i[1].getTime()]));const a=null==this.domain||!o._Util.areArrayItemsStrictlyEqual(this.domain,i);return a&&(this.domain=i),a}getRangeWithValues(e,t){var i;let[o,a]=null!=(i=this.domain)?i:[];if(null==e&&null==t||null==o||null==a)return;o=Number(o),a=Number(a);let s=0,n=1;return null!=e&&(s=(Number(e)-o)/(a-o)),null!=t&&(n=(Number(t)-o)/(a-o)),{min:s,max:n}}};f([zs({changeValue(e){var t;null!=this.initialStart||(this.initialStart=e),null==(t=this.onChange)||t.call(this,this.getRangeWithValues(e,this.end))}}),Bs(Rs(Ps(Cs,ws)),{optional:!0})],Fs.prototype,"start",2),f([zs({changeValue(e){var t;null!=this.initialEnd||(this.initialEnd=e),null==(t=this.onChange)||t.call(this,this.getRangeWithValues(this.start,e))}}),Bs(Rs(Ps(Cs,ws)),{optional:!0})],Fs.prototype,"end",2);var{AND:Us,GREATER_THAN:js,LESS_THAN:Ws,RATIO:Ys,ActionOnSet:Gs,Validate:Hs}=o._ModuleSupport,Xs=class{constructor(e){this.onChange=e}getRatio(){return this.getRatioWithValues(this.start,this.end)}getInitialRatio(){return this.getRatioWithValues(this.initialStart,this.initialEnd)}getRatioWithValues(e,t){if(null!=e||null!=t)return{min:null!=e?e:ds.min,max:null!=t?t:ds.max}}};f([Gs({changeValue(e){var t;null!=this.initialStart||(this.initialStart=e),null==(t=this.onChange)||t.call(this,this.getRatioWithValues(e,this.end))}}),Hs(Us(Ys,Ws("end")),{optional:!0})],Xs.prototype,"start",2),f([Gs({changeValue(e){var t;null!=this.initialEnd||(this.initialEnd=e),null==(t=this.onChange)||t.call(this,this.getRatioWithValues(this.start,e))}}),Hs(Us(Ys,js("start")),{optional:!0})],Xs.prototype,"end",2);var Qs=class{update(e,t,i,o){const a=e.deltaX*t*200;return this.translateZooms(i,o,a)}translateZooms(e,t,i){const a={},s=vs(e,e.x+Math.abs(i),0),n=i<0?-s.x:s.x;for(const[r,{direction:l,zoom:h}]of Object.entries(t)){if(l!==o._ModuleSupport.ChartAxisDirection.X)continue;let e=fs({x:h});e=Is(Ss(e,n*ys(e),0)),a[r]={direction:l,zoom:e.x}}return a}},$s=class{update(e,t,i,o){const a=e.sourceEvent,{anchorPointX:s,anchorPointY:n,isScalingX:r,isScalingY:l,scrollingStep:h}=t,d=e.deltaY;let c=fs(o);return c.x.max+=r?h*d*ys(o):0,c.y.max+=l?h*d*gs(o):0,"pointer"===s&&r||"pointer"===n&&l?c=this.scaleZoomToPointer(a,r,l,i,o,c):(r&&(c.x=bs(c.x,o.x,s)),l&&(c.y=bs(c.y,o.y,n))),c=Is(c),c}scaleZoomToPointer(e,t,i,o,a,s){var n,r;const l=vs(o,null!=(n=e.offsetX)?n:e.clientX,null!=(r=e.offsetY)?r:e.clientY);return s.x=t?Ns(s.x,a.x,l.x):s.x,s.y=i?Ns(s.y,a.y,l.y):s.y,s}},Zs=class{constructor(e){this.rect=e,this.rect.visible=!1}update(e,t,i,o){this.rect.visible=!0,this.updateCoords(e.offsetX,e.offsetY,t,i,o),this.updateRect(i)}stop(e,t,i){let o=fs();if(!e||!t)return o;this.coords&&(o=this.createZoomFromCoords(t,i));return o=Is(function(e,t,i){return{x:{min:e.x.min*t,max:e.x.max*t},y:{min:e.y.min*i,max:e.y.max*i}}}(o,t.width/e.width,t.height/e.height)),this.reset(),o}reset(){this.coords=void 0,this.rect.visible=!1}didUpdate(){return this.rect.visible}updateCoords(e,t,i,o,a){if(!this.coords)return void(this.coords={x1:e,y1:t,x2:e,y2:t});if(this.coords.x2=e,this.coords.y2=t,!o)return;const{isScalingX:s,isScalingY:n,minRatioX:r,minRatioY:l}=i,h=fs(a),d=this.getNormalisedDimensions(),c=o.width/o.height,u=r/(h.x.max-h.x.min),p=l/(h.y.max-h.y.min);d.width/o.width<u&&(this.coords.x2<this.coords.x1?this.coords.x2=this.coords.x1-o.width*u:this.coords.x2=this.coords.x1+o.width*u),n&&!s?d.height/o.height<p&&(this.coords.y2<this.coords.y1?this.coords.y2=this.coords.y1-o.width*u:this.coords.y2=this.coords.y1+o.height*p):this.coords.y2<this.coords.y1?this.coords.y2=Math.min(this.coords.y1-d.width/c,this.coords.y1-o.height*p):this.coords.y2=Math.max(this.coords.y1+d.width/c,this.coords.y1+o.height*p),s||(this.coords.x1=o.x,this.coords.x2=o.x+o.width),n||(this.coords.y1=o.y,this.coords.y2=o.y+o.height)}updateRect(e){if(!e)return;const{rect:t}=this,i=this.getNormalisedDimensions(),{width:o,height:a}=i;let{x:s,y:n}=i;s=Math.max(s,e.x),s-=Math.max(0,s+o-(e.x+e.width)),n=Math.max(n,e.y),n-=Math.max(0,n+a-(e.y+e.height)),t.x=s,t.y=n,t.width=o,t.height=a}createZoomFromCoords(e,t){const i=fs(t),o=this.getNormalisedDimensions(),a=vs(e,o.x,o.y+o.height);let s=Ms(i,o.width/e.width,o.height/e.height);return s=Ss(s,a.x*(i.x.max-i.x.min),a.y*(i.y.max-i.y.min)),s=Is(s),s}getNormalisedDimensions(){var e;const{x1:t=0,y1:i=0,x2:o=0,y2:a=0}=null!=(e=this.coords)?e:{};return{x:t<=o?t:o,y:i<=a?i:a,width:t<=o?o-t:t-o,height:i<=a?a-i:i-a}}},{ToolbarManager:qs}=o._ModuleSupport,Js=class{constructor(e,t,i,o){this.toolbarManager=e,this.zoomManager=t,this.getResetZoom=i,this.updateZoom=o}toggle(e,t,i){this.toggleGroups(e),e&&this.toggleButtons(t,i)}toggleButtons(e,t){const{toolbarManager:i}=this,o=ms(e,ps()),a=xs(e,t.minRatioX,t.minRatioY),s=ms(e,this.getResetZoom());i.toggleButton("zoom","pan-start",e.x.min>ds.min),i.toggleButton("zoom","pan-end",e.x.max<ds.max),i.toggleButton("zoom","pan-left",e.x.min>ds.min),i.toggleButton("zoom","pan-right",e.x.max<ds.max),i.toggleButton("zoom","zoom-out",!o),i.toggleButton("zoom","zoom-in",!a),i.toggleButton("zoom","reset",!s)}onButtonPress(e,t){this.onButtonPressRanges(e,t),this.onButtonPressZoom(e,t)}toggleGroups(e){var t,i;null==(t=this.toolbarManager)||t.toggleGroup("ranges",Boolean(e)),null==(i=this.toolbarManager)||i.toggleGroup("zoom",Boolean(e))}onButtonPressRanges(e,t){if(!qs.isGroup("ranges",e))return;const{rangeX:i}=t,o=e.value;"number"===typeof o?i.extendToEnd(o):Array.isArray(o)?i.updateWith((()=>o)):"function"===typeof o&&i.updateWith(o)}onButtonPressZoom(e,t){if(!qs.isGroup("zoom",e))return;const{anchorPointX:i,anchorPointY:o,isScalingX:a,isScalingY:s,scrollingStep:n}=t,r=fs(this.zoomManager.getZoom());let l=fs(r);switch(e.value){case"reset":l=this.getResetZoom();break;case"pan-start":l.x.max=ys(l),l.x.min=0;break;case"pan-end":l.x.min=ds.max-ys(l),l.x.max=ds.max;break;case"pan-left":case"pan-right":l=Ss(l,"pan-left"===e.value?-ys(l):ys(l),0);break;case"zoom-in":case"zoom-out":const t="zoom-in"===e.value?1-n:1+n,h="pointer"===i?"end":i,d="pointer"===o?cs:o;l=Ms(l,a?t:1,s?t:1),l.x=bs(l.x,r.x,h),l.y=bs(l.y,r.y,d)}this.updateZoom(Is(l))}},{ARRAY:en,BOOLEAN:tn,NUMBER:on,RATIO:an,STRING:sn,UNION:nn,ActionOnSet:rn,ChartAxisDirection:ln,ChartUpdateType:hn,Validate:dn,ProxyProperty:cn,round:un}=o._ModuleSupport,pn=e=>un(e,10),yn=nn(["pointer","start","middle","end"],"an anchor cord"),gn="zoom-cursor",mn="zoom-tooltip",xn=class extends o._ModuleSupport.BaseProperties{constructor(e){super(),this.onChange=e,this.enabled=!1,this.position="floating-bottom",this.align="center"}};f([o._ModuleSupport.ObserveChanges((e=>{e.onChange()})),dn(tn)],xn.prototype,"enabled",2),f([o._ModuleSupport.ObserveChanges((e=>{e.onChange()})),dn(en,{optional:!0})],xn.prototype,"buttons",2),f([dn(sn)],xn.prototype,"position",2),f([dn(sn)],xn.prototype,"align",2);var fn=class extends o._ModuleSupport.BaseModuleInstance{constructor(e){super(),this.ctx=e,this.enabled=!1,this.enableAxisDragging=!0,this.buttons=new xn((()=>this.onZoomButtonsChange(this.enabled))),this.enableDoubleClickToReset=!0,this.enablePanning=!0,this.enableScrolling=!0,this.enableSelecting=!1,this.panKey="alt",this.axes="x",this.scrollingStep=(ds.max-ds.min)/10,this.minVisibleItemsX=2,this.minVisibleItemsY=2,this.anchorPointX="end",this.anchorPointY=cs,this.rangeX=new Fs(this.onRangeChange.bind(this,ln.X)),this.rangeY=new Fs(this.onRangeChange.bind(this,ln.Y)),this.ratioX=new Xs(this.onRatioChange.bind(this,ln.X)),this.ratioY=new Xs(this.onRatioChange.bind(this,ln.Y)),this.axisDragger=new As,this.contextMenu=new Es(this.ctx.contextMenuRegistry,this.ctx.zoomManager,this.updateZoom.bind(this)),this.panner=new _s,this.scroller=new $s,this.scrollPanner=new Qs,this.toolbar=new Js(this.ctx.toolbarManager,this.ctx.zoomManager,this.getResetZoom.bind(this),this.updateZoom.bind(this)),this.deceleration=1,this.dragState=0,this.minRatioX=0,this.minRatioY=0;const t=new ns;this.selector=new Zs(t);const{Default:i,ZoomDrag:a,Animation:s}=o._ModuleSupport.InteractionState,n=i|s|a,r=i|s,l=e.regionManager.getRegion("series");this.destroyFns.push(e.scene.attachNode(t),l.addListener("dblclick",(e=>this.onDoubleClick(e)),r),l.addListener("drag",(e=>this.onDrag(e)),n),l.addListener("drag-start",(e=>this.onDragStart(e)),n),l.addListener("drag-end",(()=>this.onDragEnd()),n),l.addListener("wheel",(e=>this.onWheel(e)),r),l.addListener("hover",(()=>this.onAxisLeave()),r),l.addListener("leave",(()=>this.onAxisLeave()),r),e.chartEventManager.addListener("axis-hover",(e=>this.onAxisHover(e))),e.gestureDetector.addListener("pinch-move",(e=>this.onPinchMove(e))),e.toolbarManager.addListener("button-pressed",(e=>this.toolbar.onButtonPress(e,this.getModuleProperties()))),e.layoutService.addListener("layout-complete",(e=>this.onLayoutComplete(e))),e.updateService.addListener("update-complete",(e=>this.onUpdateComplete(e))),e.zoomManager.addListener("zoom-change",(e=>this.onZoomChange(e))),e.zoomManager.addListener("zoom-pan-start",(e=>this.onZoomPanStart(e))),this.panner.addListener("update",(e=>this.onPanUpdate(e))))}onEnabledChange(e){if(!this.contextMenu||!this.toolbar)return;const t=this.getZoom(),i=this.getModuleProperties({enabled:e});this.contextMenu.registerActions(e,t,i),this.onZoomButtonsChange(e),this.toolbar.toggle(e,t,i)}onZoomButtonsChange(e){if(!this.buttons)return;const t=this.buttons.toJson();t.enabled&&(t.enabled=e),this.ctx.toolbarManager.proxyGroupOptions("zoom",t)}onRangeChange(e,t){if(!t)return;const i=this.getZoom();i[e]=t,this.updateZoom(Is(i))}onRatioChange(e,t){if(!t)return;let i=this.ratioX.getRatio(),o=this.ratioY.getRatio();e===ln.X?i=t:o=t;const a=Is(fs({x:i,y:o}));this.updateZoom(a)}onDoubleClick(e){const{enabled:t,enableDoubleClickToReset:i,hoveredAxis:o,paddedRect:a,ctx:{highlightManager:s}}=this;if(!t||!i)return;const{x:n,y:r}=this.getResetZoom();if(o){const{direction:e}=o,t=e===ln.X?n:r;this.updateAxisZoom(e,t)}else(null==a?void 0:a.containsPoint(e.offsetX,e.offsetY))&&null==s.getActivePicked()&&this.updateZoom({x:n,y:r})}onDragStart(e){const{enabled:t,enableAxisDragging:i,enablePanning:o,enableSelecting:a,hoveredAxis:s,paddedRect:n,ctx:{cursorManager:r,zoomManager:l}}=this;if(!t||!n)return;this.panner.stopInteractions();let h=0;if(i&&s)h=1;else if(n.containsPoint(e.offsetX,e.offsetY)){const t=this.isPanningKeyPressed(e.sourceEvent);if(!o||a&&!t){if(a){this.isMinZoom(this.getZoom())||t||(h=3)}}else r.updateCursor(gn,"grabbing"),h=2,this.panner.start()}0!==(this.dragState=h)&&l.fireZoomPanStartEvent("zoom")}onDrag(e){const{anchorPointX:t,anchorPointY:i,axisDragger:a,dragState:s,enabled:n,paddedRect:r,panner:l,selector:h,seriesRect:d,hoveredAxis:c,ctx:{interactionManager:u,tooltipManager:p,updateService:y,zoomManager:g}}=this;if(!n||!r||!d)return;u.pushState(o._ModuleSupport.InteractionState.ZoomDrag);const m=this.getZoom();switch(s){case 1:if(!c)break;const{id:s,direction:n}=c,u=n===o._ModuleSupport.ChartAxisDirection.X?t:i,p=g.getAxisZoom(s),y=a.update(e,n,u,d,m,p);this.updateAxisZoom(n,y);break;case 2:l.update(e);break;case 3:h.update(e,this.getModuleProperties(),r,m);break;case 0:return}p.updateTooltip(mn),y.update(hn.PERFORM_LAYOUT,{skipAnimations:!0})}onDragEnd(){const{axisDragger:e,dragState:t,enabled:i,panner:a,selector:s,ctx:{cursorManager:n,interactionManager:r,tooltipManager:l}}=this;if(r.popState(o._ModuleSupport.InteractionState.ZoomDrag),i&&0!==t){switch(t){case 1:e.stop();break;case 2:a.stop();break;case 3:if(!s.didUpdate())break;const t=this.getZoom();if(this.isMinZoom(t))break;const i=s.stop(this.seriesRect,this.paddedRect,t);this.updateZoom(i)}this.dragState=0,n.updateCursor(gn),l.removeTooltip(mn)}}onWheel(e){const{enabled:t,enableAxisDragging:i,enablePanning:a,enableScrolling:s,hoveredAxis:n,paddedRect:r,scroller:l,scrollingStep:h,scrollPanner:d,seriesRect:c,ctx:{zoomManager:u}}=this;if(!t||!s||!r||!c)return;const p=r.containsPoint(e.offsetX,e.offsetY),y=i&&null!=n;let g=this.isScalingX(),m=this.isScalingY();y&&(g=n.direction===o._ModuleSupport.ChartAxisDirection.X,m=!g);const x=e.sourceEvent,{deltaX:f,deltaY:v}=x,S=null!=f&&null!=v&&Math.abs(f)>Math.abs(v);if(a&&S){e.consume(),e.sourceEvent.preventDefault();const t=d.update(e,h,c,u.getAxisZooms());for(const{direction:e,zoom:i}of Object.values(t))this.updateAxisZoom(e,i);return}if(!p&&!y)return;e.consume(),e.sourceEvent.preventDefault();const M=l.update(e,this.getModuleProperties({isScalingX:g,isScalingY:m}),c,this.getZoom());this.updateZoom(M)}onAxisLeave(){const{enabled:e,ctx:{cursorManager:t}}=this;e&&(this.hoveredAxis=void 0,t.updateCursor(gn))}onAxisHover(e){const{enabled:t,enableAxisDragging:i,ctx:{cursorManager:o}}=this;t&&(this.hoveredAxis={id:e.axisId,direction:e.direction},i&&o.updateCursor(gn,e.direction===ln.X?"ew-resize":"ns-resize"))}onPinchMove(e){const{enabled:t,enableScrolling:i,paddedRect:o,seriesRect:a}=this;if(!t||!i||!o||!a)return;const s=this.getZoom(),n=this.getZoom(),r=-.01*e.deltaDistance,l=vs(a,e.origin.x,e.origin.y);this.isScalingX()&&(n.x.max+=r*ys(s),n.x=Ns(n.x,s.x,l.x)),this.isScalingY()&&(n.y.max+=r*(s.y.max-s.y.min),n.y=Ns(n.y,s.y,l.y)),this.updateZoom(Is(n))}onLayoutComplete(e){const{enabled:t,rangeX:i,rangeY:a}=this;if(!t)return;const{series:{rect:s,paddedRect:n,shouldFlipXY:r},axes:l}=e;if(this.seriesRect=s,this.paddedRect=n,this.contextMenu.rect=n,this.shouldFlipXY=r,!l)return;const[h,d]=o._Util.bifurcate((e=>e.direction===ln.X),l),c=i.updateAxis(h),u=a.updateAxis(d);if(!c&&!u)return;const p={};p.x=i.getRange(),p.y=a.getRange(),null==p.x&&null==p.y||this.updateZoom(Is(fs(p)))}onUpdateComplete(e){let{minRect:t,minVisibleRect:i}=e;const{enabled:o,minVisibleItemsX:a,minVisibleItemsY:s,paddedRect:n,shouldFlipXY:r}=this;if(!o||!n||!t||!i)return;const l=this.getZoom(),h=r?s:a,d=r?a:s,c=i.width*h/n.width,u=i.height*d/n.height,p=pn(c*ys(l)),y=pn(u*gs(l));this.isScalingX()&&(this.minRatioX=Math.min(1,p)),this.isScalingY()&&(this.minRatioY=Math.min(1,y)),this.minRatioX||(this.minRatioX=this.minRatioY||0),this.minRatioY||(this.minRatioY=this.minRatioX||0)}onZoomChange(e){"zoom"!==e.callerId&&this.panner.stopInteractions();const t=this.getZoom(),i=this.getModuleProperties();this.contextMenu.toggleActions(t,i),this.toolbar.toggleButtons(t,i)}onZoomPanStart(e){"zoom"===e.callerId&&this.panner.stopInteractions()}onPanUpdate(e){const{panner:t,seriesRect:i,ctx:{tooltipManager:o,updateService:a,zoomManager:s}}=this;if(!i)return;const n=t.translateZooms(i,s.getAxisZooms(),e.deltaX,e.deltaY);for(const{direction:r,zoom:l}of Object.values(n))this.updateAxisZoom(r,l);o.updateTooltip(mn),a.update(hn.PERFORM_LAYOUT,{skipAnimations:!0})}isPanningKeyPressed(e){switch(this.panKey){case"alt":return e.altKey;case"ctrl":return e.ctrlKey;case"shift":return e.shiftKey;case"meta":return e.metaKey}}isScalingX(){return"xy"===this.axes||(this.shouldFlipXY?"y"===this.axes:"x"===this.axes)}isScalingY(){return"xy"===this.axes||(this.shouldFlipXY?"x"===this.axes:"y"===this.axes)}getAnchorPointX(){return this.shouldFlipXY?this.anchorPointY:this.anchorPointX}getAnchorPointY(){return this.shouldFlipXY?this.anchorPointX:this.anchorPointY}isMinZoom(e){return xs(e,this.minRatioX,this.minRatioY)}updateZoom(e){const{minRatioX:t,minRatioY:i,ctx:{zoomManager:o}}=this,a=ys(e),s=gs(e),n=this.getZoom(),r=a<=ys(n)&&a<t,l=s<=gs(n)&&s<i;r&&(e.x=Ts(e.x,n.x,t)),l&&(e.y=Ts(e.y,n.y,i)),o.updateZoom("zoom",e)}updateAxisZoom(e,t){if(!t)return;const i=this.getZoom();i[e]=t,this.updateZoom(i)}getZoom(){return fs(this.ctx.zoomManager.getZoom())}getResetZoom(){var e,t,i,o;return{x:null!=(t=null!=(e=this.rangeX.getInitialRange())?e:this.ratioX.getInitialRatio())?t:ds,y:null!=(o=null!=(i=this.rangeY.getInitialRange())?i:this.ratioY.getInitialRatio())?o:ds}}getModuleProperties(e){var t,i,o,a,s,n,r,l,h;return{anchorPointX:null!=(t=null==e?void 0:e.anchorPointX)?t:this.getAnchorPointX(),anchorPointY:null!=(i=null==e?void 0:e.anchorPointY)?i:this.getAnchorPointY(),enabled:null!=(o=null==e?void 0:e.enabled)?o:this.enabled,isScalingX:null!=(a=null==e?void 0:e.isScalingX)?a:this.isScalingX(),isScalingY:null!=(s=null==e?void 0:e.isScalingY)?s:this.isScalingY(),minRatioX:null!=(n=null==e?void 0:e.minRatioX)?n:this.minRatioX,minRatioY:null!=(r=null==e?void 0:e.minRatioY)?r:this.minRatioY,rangeX:null!=(l=null==e?void 0:e.rangeX)?l:this.rangeX,scrollingStep:null!=(h=null==e?void 0:e.scrollingStep)?h:this.scrollingStep}}};f([rn({newValue(e){this.onEnabledChange(e)}}),dn(tn)],fn.prototype,"enabled",2),f([dn(tn)],fn.prototype,"enableAxisDragging",2),f([dn(tn)],fn.prototype,"enableDoubleClickToReset",2),f([dn(tn)],fn.prototype,"enablePanning",2),f([dn(tn)],fn.prototype,"enableScrolling",2),f([dn(tn)],fn.prototype,"enableSelecting",2),f([dn(nn(["alt","ctrl","meta","shift"],"a pan key"))],fn.prototype,"panKey",2),f([dn(nn(["x","y","xy"],"an axis"))],fn.prototype,"axes",2),f([dn(an)],fn.prototype,"scrollingStep",2),f([dn(on.restrict({min:1}))],fn.prototype,"minVisibleItemsX",2),f([dn(on.restrict({min:1}))],fn.prototype,"minVisibleItemsY",2),f([dn(yn)],fn.prototype,"anchorPointX",2),f([dn(yn)],fn.prototype,"anchorPointY",2),f([cn("panner.deceleration"),dn(on.restrict({min:1e-4,max:1}))],fn.prototype,"deceleration",2);var vn={type:"root",optionsKey:"zoom",packageType:"enterprise",chartTypes:["cartesian"],dependencies:["toolbar"],instanceConstructor:fn,themeTemplate:{zoom:{anchorPointX:"end",anchorPointY:"middle",axes:"x",buttons:{enabled:!0,buttons:[{icon:"zoom-out",tooltip:"Zoom out",value:"zoom-out"},{icon:"zoom-in",tooltip:"Zoom in",value:"zoom-in"},{icon:"pan-left",tooltip:"Pan left",value:"pan-left"},{icon:"pan-right",tooltip:"Pan right",value:"pan-right"},{icon:"reset",tooltip:"Reset the zoom",value:"reset"}]},enabled:!1,enableAxisDragging:!0,enableDoubleClickToReset:!0,enablePanning:!0,enableScrolling:!0,enableSelecting:!1,minVisibleItemsX:2,minVisibleItemsY:2,panKey:"alt",scrollingStep:.1}}},{BOOLEAN:Sn,Layers:Mn,POSITION:Dn,Validate:bn,Default:Nn,MIN_SPACING:In,MAX_SPACING:kn,POSITIVE_NUMBER:Tn,ProxyProperty:An,DeprecatedAndRenamedTo:On}=o._ModuleSupport,{BBox:Ln,Group:En,Rect:_n,LinearGradientFill:Rn,Triangle:Cn}=o._Scene,{createId:wn}=o._Util,Pn=class{constructor(){this.thickness=16,this.preferredLength=100}};f([bn(Tn)],Pn.prototype,"thickness",2),f([bn(Tn)],Pn.prototype,"preferredLength",2);var zn=class extends o._ModuleSupport.AxisTick{constructor(){super(...arguments),this.enabled=!1,this.size=0,this.minSpacing=NaN,this.maxSpacing=NaN}};f([bn(In),Nn(NaN)],zn.prototype,"minSpacing",2),f([bn(kn),Nn(NaN)],zn.prototype,"maxSpacing",2);var Kn=class extends o._ModuleSupport.CartesianAxis{constructor(e){super(e,new o._Scale.LinearScale,{respondsToZoom:!1}),this.colorDomain=[],this.nice=!1,this.line.enabled=!1}calculateDomain(){this.setDomain(this.colorDomain)}createTick(){return new zn}},Vn=class{constructor(e){this.label=e}};f([An("label.fontStyle")],Vn.prototype,"fontStyle",2),f([An("label.fontWeight")],Vn.prototype,"fontWeight",2),f([An("label.fontSize")],Vn.prototype,"fontSize",2),f([An("label.fontFamily")],Vn.prototype,"fontFamily",2),f([An("label.color")],Vn.prototype,"color",2),f([An("label.format")],Vn.prototype,"format",2),f([An("label.formatter")],Vn.prototype,"formatter",2);var Bn=class{constructor(e){this.tick=e}};f([An("tick.values")],Bn.prototype,"values",2),f([An("tick.minSpacing")],Bn.prototype,"minSpacing",2),f([An("tick.maxSpacing")],Bn.prototype,"maxSpacing",2),f([An("tick.interval")],Bn.prototype,"step",2);var Fn=class{constructor(e){this.axis=e,this.label=new Vn(e.label),this.interval=new Bn(e.tick)}};f([An("axis.seriesAreaPadding")],Fn.prototype,"padding",2);var Un=class{constructor(e){this.ctx=e,this.id=wn(this),this.group=new En({name:"legend",layer:!0,zIndex:Mn.LEGEND_ZINDEX}),this.gradient=new Pn,this.destroyFns=[],this.enabled=!1,this.position="bottom",this.reverseOrder=void 0,this.pagination=void 0,this.spacing=20,this.data=[],this.listeners={},this.latestGradientBox=void 0,this.layoutService=e.layoutService,this.destroyFns.push(this.layoutService.addListener("start-layout",(e=>this.update(e.shrinkRect)))),this.highlightManager=e.highlightManager,this.destroyFns.push(this.highlightManager.addListener("highlight-change",(()=>this.onChartHoverChange()))),this.gradientRect=new _n,this.gradientFill=new Rn,this.gradientFill.mask=this.gradientRect,this.group.append(this.gradientFill),this.arrow=new Cn,this.group.append(this.arrow),this.axisGridGroup=new En({name:"legend-axis-grid-group"}),this.group.append(this.axisGridGroup),this.axisGroup=new En({name:"legend-axis-group"}),this.group.append(this.axisGroup),this.axis=new Kn(e),this.axis.attachAxis(this.axisGroup,this.axisGridGroup),this.scale=new Fn(this.axis),this.stop=this.scale,this.destroyFns.push((()=>this.detachLegend()))}getOrientation(){switch(this.position){case"right":case"left":return"vertical";case"bottom":case"top":return"horizontal"}}destroy(){this.destroyFns.forEach((e=>e()))}attachLegend(e){e.appendChild(this.group)}detachLegend(){var e;null==(e=this.group.parent)||e.removeChild(this.group)}update(e){const t=this.data[0];if(!this.enabled||!t||!t.enabled)return this.group.visible=!1,{shrinkRect:e.clone()};const{colorRange:i}=this.normalizeColorArrays(t),o=this.updateGradientRect(e,i),a=this.updateAxis(t,o),{newShrinkRect:s,translateX:n,translateY:r}=this.getMeasurements(e,o,a);return this.updateArrow(o),this.group.visible=!0,this.group.translationX=n,this.group.translationY=r,this.latestGradientBox=o,{shrinkRect:s}}normalizeColorArrays(e){let t=e.colorDomain.slice();const i=e.colorRange.slice();if(t.length===i.length)return{colorDomain:t,colorRange:i};t.length>i.length&&i.splice(t.length);const o=i.length;return t=i.map(((e,i)=>{const[a,s]=t;return 0===i?a:i===o-1?s:a+(s-a)*i/(o-1)})),{colorDomain:t,colorRange:i}}updateGradientRect(e,t){const{preferredLength:i,thickness:o}=this.gradient,a=new Ln(0,0,0,0),s="vertical"===this.getOrientation();if(s){const t=e.height,s=i;a.x=0,a.y=0,a.width=o,a.height=Math.min(t,s)}else{const t=e.width,s=i;a.x=0,a.y=0,a.width=Math.min(t,s),a.height=o}return this.reverseOrder&&(t=t.slice().reverse()),this.gradientFill.stops=t,this.gradientFill.direction=s?"to-bottom":"to-right",this.gradientRect.x=a.x,this.gradientRect.y=a.y,this.gradientRect.width=a.width,this.gradientRect.height=a.height,a}updateAxis(e,t){const{reverseOrder:i,axis:o}=this,a="vertical"===this.getOrientation();o.position=a?"right":"bottom",o.colorDomain=i?e.colorDomain.slice().reverse():e.colorDomain,o.calculateDomain(),o.range=a?[0,t.height]:[0,t.width],o.gridLength=0,o.translation.x=t.x+(a?t.width:0),o.translation.y=t.y+(a?0:t.height);const s=o.calculateLayout().bbox;return o.update(),s}updateArrow(e){var t;const{arrow:i,axis:{label:o,scale:a}}=this,s=this.highlightManager.getActiveHighlight(),n=null==s?void 0:s.colorValue;if(null==s||null==n)return void(i.visible=!1);const r="vertical"===this.getOrientation(),l=null!=(t=o.fontSize)?t:0,h=a.convert(n);let d,c,u;r?(d=e.x-l/2,c=e.y+h,u=Math.PI/2):(d=e.x+h,c=e.y-l/2,u=Math.PI),i.fill=o.color,i.size=l,i.translationX=d,i.translationY=c,i.rotation=u,i.visible=!0}getMeasurements(e,t,i){let o,a;"vertical"===this.getOrientation()?(o=t.width+i.width,a=t.height):(o=t.width,a=t.height+i.height);const{spacing:s}=this,n=e.clone();let r,l;return"left"===this.position?(r=e.x,l=e.y+e.height/2-a/2,n.shrink(o+s,"left")):"right"===this.position?(r=e.x+e.width-o,l=e.y+e.height/2-a/2,n.shrink(o+s,"right")):"top"===this.position?(r=e.x+e.width/2-o/2,l=e.y,n.shrink(a+s,"top")):(r=e.x+e.width/2-o/2,l=e.y+e.height-a,n.shrink(a+s,"bottom")),{translateX:r,translateY:l,gradientBox:t,newShrinkRect:n}}computeBBox(){return this.group.computeBBox()}onChartHoverChange(){this.enabled&&null!=this.latestGradientBox&&this.updateArrow(this.latestGradientBox)}};Un.className="GradientLegend",f([bn(Sn)],Un.prototype,"enabled",2),f([bn(Dn)],Un.prototype,"position",2),f([bn(Sn,{optional:!0})],Un.prototype,"reverseOrder",2),f([bn(Tn)],Un.prototype,"spacing",2),f([On("scale")],Un.prototype,"stop",2);var jn={type:"legend",optionsKey:"gradientLegend",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology"],identifier:"gradient",instanceConstructor:Un,themeTemplate:{enabled:!1,position:"bottom",spacing:20,scale:{padding:8,label:{color:o._Theme.DEFAULT_LABEL_COLOUR,fontStyle:void 0,fontWeight:void 0,fontSize:12,fontFamily:o._Theme.DEFAULT_FONT_FAMILY,formatter:void 0},interval:{minSpacing:1}},gradient:{preferredLength:100,thickness:16},reverseOrder:!1}},Wn=class{constructor(){this.ieCompatibility=!1}init(){this.ieCompatibility="5d41402abc4b2a76b9719d911017c592"!=this.md5("hello")}md5cycle(e,t){let i=e[0],o=e[1],a=e[2],s=e[3];i=this.ff(i,o,a,s,t[0],7,-680876936),s=this.ff(s,i,o,a,t[1],12,-389564586),a=this.ff(a,s,i,o,t[2],17,606105819),o=this.ff(o,a,s,i,t[3],22,-1044525330),i=this.ff(i,o,a,s,t[4],7,-176418897),s=this.ff(s,i,o,a,t[5],12,1200080426),a=this.ff(a,s,i,o,t[6],17,-1473231341),o=this.ff(o,a,s,i,t[7],22,-45705983),i=this.ff(i,o,a,s,t[8],7,1770035416),s=this.ff(s,i,o,a,t[9],12,-1958414417),a=this.ff(a,s,i,o,t[10],17,-42063),o=this.ff(o,a,s,i,t[11],22,-1990404162),i=this.ff(i,o,a,s,t[12],7,1804603682),s=this.ff(s,i,o,a,t[13],12,-40341101),a=this.ff(a,s,i,o,t[14],17,-1502002290),o=this.ff(o,a,s,i,t[15],22,1236535329),i=this.gg(i,o,a,s,t[1],5,-165796510),s=this.gg(s,i,o,a,t[6],9,-1069501632),a=this.gg(a,s,i,o,t[11],14,643717713),o=this.gg(o,a,s,i,t[0],20,-373897302),i=this.gg(i,o,a,s,t[5],5,-701558691),s=this.gg(s,i,o,a,t[10],9,38016083),a=this.gg(a,s,i,o,t[15],14,-660478335),o=this.gg(o,a,s,i,t[4],20,-405537848),i=this.gg(i,o,a,s,t[9],5,568446438),s=this.gg(s,i,o,a,t[14],9,-1019803690),a=this.gg(a,s,i,o,t[3],14,-187363961),o=this.gg(o,a,s,i,t[8],20,1163531501),i=this.gg(i,o,a,s,t[13],5,-1444681467),s=this.gg(s,i,o,a,t[2],9,-51403784),a=this.gg(a,s,i,o,t[7],14,1735328473),o=this.gg(o,a,s,i,t[12],20,-1926607734),i=this.hh(i,o,a,s,t[5],4,-378558),s=this.hh(s,i,o,a,t[8],11,-2022574463),a=this.hh(a,s,i,o,t[11],16,1839030562),o=this.hh(o,a,s,i,t[14],23,-35309556),i=this.hh(i,o,a,s,t[1],4,-1530992060),s=this.hh(s,i,o,a,t[4],11,1272893353),a=this.hh(a,s,i,o,t[7],16,-155497632),o=this.hh(o,a,s,i,t[10],23,-1094730640),i=this.hh(i,o,a,s,t[13],4,681279174),s=this.hh(s,i,o,a,t[0],11,-358537222),a=this.hh(a,s,i,o,t[3],16,-722521979),o=this.hh(o,a,s,i,t[6],23,76029189),i=this.hh(i,o,a,s,t[9],4,-640364487),s=this.hh(s,i,o,a,t[12],11,-421815835),a=this.hh(a,s,i,o,t[15],16,530742520),o=this.hh(o,a,s,i,t[2],23,-995338651),i=this.ii(i,o,a,s,t[0],6,-198630844),s=this.ii(s,i,o,a,t[7],10,1126891415),a=this.ii(a,s,i,o,t[14],15,-1416354905),o=this.ii(o,a,s,i,t[5],21,-57434055),i=this.ii(i,o,a,s,t[12],6,1700485571),s=this.ii(s,i,o,a,t[3],10,-1894986606),a=this.ii(a,s,i,o,t[10],15,-1051523),o=this.ii(o,a,s,i,t[1],21,-2054922799),i=this.ii(i,o,a,s,t[8],6,1873313359),s=this.ii(s,i,o,a,t[15],10,-30611744),a=this.ii(a,s,i,o,t[6],15,-1560198380),o=this.ii(o,a,s,i,t[13],21,1309151649),i=this.ii(i,o,a,s,t[4],6,-145523070),s=this.ii(s,i,o,a,t[11],10,-1120210379),a=this.ii(a,s,i,o,t[2],15,718787259),o=this.ii(o,a,s,i,t[9],21,-343485551),e[0]=this.add32(i,e[0]),e[1]=this.add32(o,e[1]),e[2]=this.add32(a,e[2]),e[3]=this.add32(s,e[3])}cmn(e,t,i,o,a,s){return t=this.add32(this.add32(t,e),this.add32(o,s)),this.add32(t<<a|t>>>32-a,i)}ff(e,t,i,o,a,s,n){return this.cmn(t&i|~t&o,e,t,a,s,n)}gg(e,t,i,o,a,s,n){return this.cmn(t&o|i&~o,e,t,a,s,n)}hh(e,t,i,o,a,s,n){return this.cmn(t^i^o,e,t,a,s,n)}ii(e,t,i,o,a,s,n){return this.cmn(i^(t|~o),e,t,a,s,n)}md51(e){const t=e.length,i=[1732584193,-271733879,-1732584194,271733878];let o;for(o=64;o<=e.length;o+=64)this.md5cycle(i,this.md5blk(e.substring(o-64,o)));e=e.substring(o-64);const a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(o=0;o<e.length;o++)a[o>>2]|=e.charCodeAt(o)<<(o%4<<3);if(a[o>>2]|=128<<(o%4<<3),o>55)for(this.md5cycle(i,a),o=0;o<16;o++)a[o]=0;return a[14]=8*t,this.md5cycle(i,a),i}md5blk(e){const t=[];for(let i=0;i<64;i+=4)t[i>>2]=e.charCodeAt(i)+(e.charCodeAt(i+1)<<8)+(e.charCodeAt(i+2)<<16)+(e.charCodeAt(i+3)<<24);return t}rhex(e){const t="0123456789abcdef".split("");let i="",o=0;for(;o<4;o++)i+=t[e>>8*o+4&15]+t[e>>8*o&15];return i}hex(e){for(let t=0;t<e.length;t++)e[t]=this.rhex(e[t]);return e.join("")}md5(e){return this.hex(this.md51(e))}add32(e,t){return this.ieCompatibility?this.add32Compat(e,t):this.add32Std(e,t)}add32Std(e,t){return e+t&4294967295}add32Compat(e,t){const i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}};function Yn(e){return null==e||0===e.length}var Gn={"01":"GRID","02":"CHARTS","0102":"BOTH"},Hn=class e{constructor(e){this.gridContext=!1,this.watermarkMessage=void 0,this.totalMessageLength=124,this.document=e,this.md5=new Wn,this.md5.init()}validateLicense(){const t=this.getLicenseDetails(this.licenseKey,this.gridContext),i=`AG ${"BOTH"===t.currentLicenseType?"Grid and ":""}Charts Enterprise`,o=void 0===t.suppliedLicenseType?"":`AG ${"BOTH"===t.suppliedLicenseType?"Grid and AG Charts":"GRID"===t.suppliedLicenseType?"Grid":"Charts"} Enterprise`;if(t.missing)this.isWebsiteUrl()&&!this.isForceWatermark()||this.outputMissingLicenseKey(i);else if(t.expired){const i=e.getChartsReleaseDate(),a=e.formatDate(i);this.outputExpiredKey(t.expiry,a,o)}else t.valid?t.isTrial&&t.trialExpired&&this.outputExpiredTrialKey(t.expiry,i,o):this.outputInvalidLicenseKey(!!t.incorrectLicenseType,i,o)}static extractExpiry(t){const i=t.substring(t.lastIndexOf("_")+1,t.length);return new Date(parseInt(e.decode(i),10))}static extractLicenseComponents(t){let i=t.replace(/[\u200B-\u200D\uFEFF]/g,"");if(i=i.replace(/\r?\n|\r/g,""),t.length<=32)return{md5:null,license:t,version:null,isTrial:null};const o=i.length-32,a=i.substring(o),s=i.substring(0,o),[n,r,l]=e.extractBracketedInformation(i);return{md5:a,license:s,version:n,isTrial:r,type:l}}getLicenseDetails(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o="CHARTS";if(Yn(t))return{licenseKey:t,valid:!1,missing:!0,currentLicenseType:o};const a=e.getChartsReleaseDate(),{md5:s,license:n,version:r,isTrial:l,type:h}=e.extractLicenseComponents(t);let d,c,u,p=s===this.md5.md5(n)&&-1===t.indexOf("For_Trialing_ag-Grid_Only"),y=null,g=!1;if(p&&(y=e.extractExpiry(n),p=!isNaN(y.getTime()),p))switch(c=a>y,r){case"legacy":case"2":p=!1;break;case"3":Yn(h)?p=!1:(u=h,h!==Gn["02"]&&h!==Gn["0102"]?(p=!1,g=!0):l&&(d=y<new Date,c=void 0))}return p?{licenseKey:t,valid:p,expiry:e.formatDate(y),expired:c,version:r,isTrial:l,trialExpired:d,invalidLicenseTypeForCombo:i?"BOTH"!==u:void 0,incorrectLicenseType:g,currentLicenseType:o,suppliedLicenseType:u}:{licenseKey:t,valid:p,incorrectLicenseType:g,currentLicenseType:o,suppliedLicenseType:u}}isDisplayWatermark(){return this.isForceWatermark()||!this.isLocalhost()&&!this.isWebsiteUrl()&&!Yn(this.watermarkMessage)}getWatermarkMessage(){return this.watermarkMessage||""}getHostname(){if(!this.document)return"localhost";const e=this.document.defaultView||window;if(!e)return"localhost";const t=e.location,{hostname:i=""}=t;return i}isForceWatermark(){var e,t;if(!this.document)return!1;const i=(null!=(t=null==(e=this.document)?void 0:e.defaultView)?t:"undefined"!=typeof window)?window:void 0;if(!i)return!1;const{pathname:o}=i.location;return!!o&&-1!==o.indexOf("forceWatermark")}isWebsiteUrl(){return null!==this.getHostname().match(/^((?:[\w-]+\.)?ag-grid\.com)$/)}isLocalhost(){return null!==this.getHostname().match(/^(?:127\.0\.0\.1|localhost)$/)}static formatDate(e){const t=e.getDate(),i=e.getMonth(),o=e.getFullYear();return t+" "+["January","February","March","April","May","June","July","August","September","October","November","December"][i]+" "+o}static getChartsReleaseDate(){return new Date(parseInt(e.decode(e.RELEASE_INFORMATION),10))}static decode(t){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let o,a,s,n,r,l,h,d="",c=0;const u=t.replace(/[^A-Za-z0-9+/=]/g,"");for(;c<u.length;)n=i.indexOf(u.charAt(c++)),r=i.indexOf(u.charAt(c++)),l=i.indexOf(u.charAt(c++)),h=i.indexOf(u.charAt(c++)),o=n<<2|r>>4,a=(15&r)<<4|l>>2,s=(3&l)<<6|h,d+=String.fromCharCode(o),64!=l&&(d+=String.fromCharCode(a)),64!=h&&(d+=String.fromCharCode(s));return d=e.utf8_decode(d),d}static utf8_decode(e){e=e.replace(/rn/g,"n");let t="";for(let i=0;i<e.length;i++){const o=e.charCodeAt(i);o<128?t+=String.fromCharCode(o):o>127&&o<2048?(t+=String.fromCharCode(o>>6|192),t+=String.fromCharCode(63&o|128)):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128),t+=String.fromCharCode(63&o|128))}return t}setLicenseKey(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.gridContext=t,this.licenseKey=e}static extractBracketedInformation(e){if(!e.includes("["))return["legacy",!1,void 0];const t=e.match(/\[(.*?)\]/g).map((e=>e.replace("[","").replace("]","")));if(!t||0===t.length)return["legacy",!1,void 0];const i=1===t.filter((e=>"TRIAL"===e)).length,o=t.filter((e=>0===e.indexOf("v")))[0];return[o?o.replace("v",""):"legacy",i,Gn[t.filter((e=>Gn[e]))[0]]]}centerPadAndOutput(e){const t=this.totalMessageLength-e.length;console.error(e.padStart(t/2+e.length,"*").padEnd(this.totalMessageLength,"*"))}padAndOutput(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";console.error(e.padEnd(this.totalMessageLength-i.length,t)+i)}outputInvalidLicenseKey(e,t,i){this.gridContext||(e?(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${t} License `),this.centerPadAndOutput(" Incompatible License Key "),this.padAndOutput(`* Your license key is for ${i} only and does not cover you for ${t}.`," ","*"),this.padAndOutput("* Please contact info@ag-grid.com to obtain a combined license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")):(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${t} License `),this.centerPadAndOutput(" Invalid License Key "),this.padAndOutput("* Your license key is not valid - please contact info@ag-grid.com to obtain a valid license."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput(""))),this.watermarkMessage="Invalid License"}outputExpiredTrialKey(e,t,i){this.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${t} License `),this.centerPadAndOutput(" Trial Period Expired. "),this.padAndOutput(`* Your trial only license for ${i} expired on ${e}.`," ","*"),this.padAndOutput("* Please email info@ag-grid.com to purchase a license."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="Trial Period Expired"}outputMissingLicenseKey(e){this.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${e} License `),this.centerPadAndOutput(" License Key Not Found "),this.padAndOutput(`* All ${e} features are unlocked for trial.`," ","*"),this.padAndOutput("* If you want to hide the watermark please email info@ag-grid.com for a trial license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="For Trial Use Only"}outputExpiredKey(e,t,i){this.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Incompatible Software Version "),this.padAndOutput(`* Your license key works with versions of ${i} released before ${e}.`," ","*"),this.padAndOutput(`* The version you are trying to use was released on ${t}.`," ","*"),this.padAndOutput("* Please contact info@ag-grid.com to renew your license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="License Expired"}};Hn.RELEASE_INFORMATION="MTcyMTExNTk3ODAyNA==";var Xn=Hn,{createElement:Qn,injectStyle:$n}=o._ModuleSupport,Zn="\n.ag-watermark {\n    position: absolute;\n    bottom: 20px;\n    right: 25px;\n    font-weight: bold;\n    font-family: Impact, sans-serif;\n    font-size: 19px;\n    opacity: 0.7;\n    animation: 1s ease-out 3s ag-watermark-fadeout;\n    color: #9B9B9B;\n    pointer-events: none;\n\n    &::before {\n        content: '';\n        display: block;\n        height: 40px;\n        width: 170px;\n        background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjU4IiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMjU4IDQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMjUuNzc5IDI4LjY1N0gxMy4zNTlMMTEuMTczIDM0LjAxMkg1LjY3Mjk3TDE3LjE4MiA3LjA1OTk5SDIxLjk1M0wzMy40NjIgMzQuMDEySDI3Ljk2MkwyNS43NzYgMjguNjU3SDI1Ljc3OVpNMjQuMDY4IDI0LjM5N0wxOS41ODggMTMuNDM0TDE1LjEwNyAyNC4zOTdIMjQuMDY4Wk02Mi4wOTIgMTguODIzSDQ5LjgxN1YyMy4wODZINTYuNzc1QzU2LjU1NSAyNS4yMjIgNTUuNzU1IDI2LjkyNyA1NC4zNzIgMjguMjAyQzUyLjk4OSAyOS40NzYgNTEuMTY2IDMwLjExNSA0OC45MDkgMzAuMTE1QzQ3LjYyMiAzMC4xMTUgNDYuNDUgMjkuODg1IDQ1LjM5MyAyOS40MjNDNDQuMzU4MyAyOC45NzgxIDQzLjQzMjYgMjguMzEzOCA0Mi42OCAyNy40NzZDNDEuOTI3IDI2LjYzOSA0MS4zNDQgMjUuNjMxIDQwLjkzMSAyNC40NTNDNDAuNTE5IDIzLjI3NSA0MC4zMTEgMjEuOTcgNDAuMzExIDIwLjUzN0M0MC4zMTEgMTkuMTA1IDQwLjUxNiAxNy44IDQwLjkzMSAxNi42MjFDNDEuMzQ0IDE1LjQ0MyA0MS45MjcgMTQuNDM2IDQyLjY4IDEzLjU5OEM0My40Mzc2IDEyLjc1NzcgNDQuMzY5NiAxMi4wOTMyIDQ1LjQxMSAxMS42NTFDNDYuNDc4IDExLjE4OSA0Ny42NTYgMTAuOTYgNDguOTQ2IDEwLjk2QzUxLjYxMiAxMC45NiA1My42MzcgMTEuNjAyIDU1LjAyIDEyLjg4NUw1OC4zIDkuNjA0OTlDNTUuODE3IDcuNjY5OTkgNTIuNjc2IDYuNjk5OTkgNDguODcyIDYuNjk5OTlDNDYuNzYgNi42OTk5OSA0NC44NTMgNy4wMzQ5OSA0My4xNTQgNy43MDA5OUM0MS40NTUgOC4zNjc5OSAzOS45OTggOS4zMDM5OSAzOC43ODMgMTAuNTA0QzM3LjU2NyAxMS43MDcgMzYuNjM0IDEzLjE1OCAzNS45NzcgMTQuODU3QzM1LjMxOSAxNi41NTYgMzQuOTk0IDE4LjQ1MSAzNC45OTQgMjAuNTRDMzQuOTk0IDIyLjYzIDM1LjMyOSAyNC40OTQgMzUuOTk1IDI2LjIwNUMzNi42NjIgMjcuOTE2IDM3LjYwNSAyOS4zNzQgMzguODE3IDMwLjU3N0M0MC4wMzIgMzEuNzggNDEuNDg2IDMyLjcxMyA0My4xODggMzMuMzgzQzQ0Ljg4OCAzNC4wNDkgNDYuNzgyIDM0LjM4NCA0OC44NzIgMzQuMzg0QzUwLjk2MSAzNC4zODQgNTIuNzUgMzQuMDQ5IDU0LjM5IDMzLjM4M0M1Ni4wMzEgMzIuNzE2IDU3LjQyNiAzMS43OCA1OC41NzkgMzAuNTc3QzU5LjczMyAyOS4zNzQgNjAuNjE5IDI3LjkxNiA2MS4yMzkgMjYuMjA1QzYxLjg2IDI0LjQ5NCA2Mi4xNyAyMi42MDUgNjIuMTcgMjAuNTRDNjIuMTY5NiAxOS45Njg4IDYyLjE0NDUgMTkuMzk4IDYyLjA5NSAxOC44MjlMNjIuMDkyIDE4LjgyM1pNMTUxLjgxIDE2Ljk4MUMxNTMuNDEgMTQuNjA5IDE1Ny40MTkgMTQuMzU4IDE1OS4wMjIgMTQuMzU4VjE4LjkxQzE1Ni45NTcgMTguOTEgMTU0Ljk4NSAxOC45OTYgMTUzLjc1NyAxOS44OTJDMTUyLjUyOSAyMC43OTIgMTUxLjkxOSAyMS45ODIgMTUxLjkxOSAyMy40NjRWMzMuOTlIMTQ2Ljk2NFYxNC4zNThIMTUxLjczNkwxNTEuODEgMTYuOTgxWk0xNDMuMDExIDE0LjM2MVYzNC4wMzFIMTM4LjI0TDEzOC4xMzEgMzEuMDQ1QzEzNy40NjYgMzIuMDc2IDEzNi41NTEgMzIuOTIxOSAxMzUuNDcxIDMzLjUwNEMxMzQuMzc2IDM0LjA5OSAxMzMuMDY4IDM0LjM5NiAxMzEuNTM2IDM0LjM5NkMxMzAuMiAzNC4zOTYgMTI4Ljk2MyAzNC4xNTIgMTI3LjgyMiAzMy42NjhDMTI2LjcgMzMuMTk2NCAxMjUuNjg5IDMyLjQ5NSAxMjQuODU1IDMxLjYwOUMxMjQuMDE4IDMwLjcyMiAxMjMuMzU0IDI5LjY2MiAxMjIuODcxIDI4LjQyMkMxMjIuMzg0IDI3LjE4NSAxMjIuMTQyIDI1LjgxMSAxMjIuMTQyIDI0LjMwNEMxMjIuMTQyIDIyLjc5OCAxMjIuMzg0IDIxLjM3OCAxMjIuODcxIDIwLjExNkMxMjMuMzU3IDE4Ljg1NCAxMjQuMDE4IDE3Ljc3MiAxMjQuODU1IDE2Ljg3M0MxMjUuNjg4IDE1Ljk3NjQgMTI2LjY5OCAxNS4yNjM2IDEyNy44MjIgMTQuNzhDMTI4Ljk2MyAxNC4yODEgMTMwLjIwMyAxNC4wMzMgMTMxLjUzNiAxNC4wMzNDMTMzLjA0MyAxNC4wMzMgMTM0LjMzIDE0LjMxOCAxMzUuMzk3IDE0Ljg4OEMxMzYuNDYyIDE1LjQ1ODkgMTM3LjM3NSAxNi4yNzggMTM4LjA1NyAxNy4yNzZWMTQuMzYxSDE0My4wMTFaTTEzMi42MzEgMzAuMTMzQzEzNC4yNTYgMzAuMTMzIDEzNS41NjcgMjkuNTk0IDEzNi41NjUgMjguNTEyQzEzNy41NjEgMjcuNDMgMTM4LjA2IDI1Ljk5MSAxMzguMDYgMjQuMTk2QzEzOC4wNiAyMi40MDEgMTM3LjU2MSAyMC45OSAxMzYuNTY1IDE5Ljg5OUMxMzUuNTcgMTguODA3IDEzNC4yNTkgMTguMjU4IDEzMi42MzEgMTguMjU4QzEzMS4wMDMgMTguMjU4IDEyOS43MjkgMTguODA0IDEyOC43MzQgMTkuODk5QzEyNy43MzggMjAuOTkzIDEyNy4yMzkgMjIuNDM4IDEyNy4yMzkgMjQuMjMzQzEyNy4yMzkgMjYuMDI4IDEyNy43MzUgMjcuNDMzIDEyOC43MzQgMjguNTE1QzEyOS43MjkgMjkuNTk0IDEzMS4wMjggMzAuMTM2IDEzMi42MzEgMzAuMTM2VjMwLjEzM1pNOTMuNjk4IDI3Ljg3NkM5My41Nzk1IDI4LjAwMjUgOTMuNDU2NCAyOC4xMjQ2IDkzLjMyOSAyOC4yNDJDOTEuOTQ3IDI5LjUxNiA5MC4xMjMgMzAuMTU1IDg3Ljg2NiAzMC4xNTVDODYuNTggMzAuMTU1IDg1LjQwOCAyOS45MjYgODQuMzUgMjkuNDY0QzgzLjMxNTUgMjkuMDE4OSA4Mi4zODk4IDI4LjM1NDYgODEuNjM3IDI3LjUxN0M4MC44ODQgMjYuNjc5IDgwLjMwMSAyNS42NzIgNzkuODg5IDI0LjQ5NEM3OS40NzYgMjMuMzE1IDc5LjI2OSAyMi4wMSA3OS4yNjkgMjAuNTc4Qzc5LjI2OSAxOS4xNDUgNzkuNDczIDE3Ljg0IDc5Ljg4OSAxNi42NjJDODAuMzAxIDE1LjQ4NCA4MC44ODQgMTQuNDc2IDgxLjYzNyAxMy42MzlDODIuMzk0OSAxMi43OTg3IDgzLjMyNzMgMTIuMTM0MiA4NC4zNjkgMTEuNjkyQzg1LjQzNiAxMS4yMyA4Ni42MTQgMTEgODcuOTAzIDExQzkwLjU3IDExIDkyLjU5NSAxMS42NDIgOTMuOTc3IDEyLjkyNkw5Ny4yNTggOS42NDQ5OUM5NC43NzQgNy43MTA5OSA5MS42MzMgNi43Mzk5OSA4Ny44MjkgNi43Mzk5OUM4NS43MTggNi43Mzk5OSA4My44MTEgNy4wNzQ5OSA4Mi4xMTIgNy43NDE5OUM4MC40MTMgOC40MDc5OSA3OC45NTYgOS4zNDQ5OSA3Ny43NCAxMC41NDVDNzYuNTI1IDExLjc0NyA3NS41OTIgMTMuMTk5IDc0LjkzNCAxNC44OThDNzQuMjc3IDE2LjU5NyA3My45NTEgMTguNDkxIDczLjk1MSAyMC41ODFDNzMuOTUxIDIyLjY3IDc0LjI4NiAyNC41MzQgNzQuOTUzIDI2LjI0NUM3NS42MTkgMjcuOTU3IDc2LjU2MiAyOS40MTQgNzcuNzc0IDMwLjYxN0M3OC45OSAzMS44MiA4MC40NDQgMzIuNzUzIDgyLjE0NiAzMy40MjNDODMuODQ1IDM0LjA5IDg1LjczOSAzNC40MjQgODcuODI5IDM0LjQyNEM4OS45MTkgMzQuNDI0IDkxLjcwOCAzNC4wOSA5My4zNDggMzMuNDIzQzk0LjcxOCAzMi44NjUgOTUuOTE4IDMyLjEyMSA5Ni45NDggMzEuMTkxQzk3LjE0OSAzMS4wMDggOTcuMzQ4IDMwLjgxNSA5Ny41MzcgMzAuNjJMOTMuNzAxIDI3Ljg4NUw5My42OTggMjcuODc2Wk0xMTAuODAyIDE0LjAxNUMxMDkuMTk5IDE0LjAxNSAxMDYuODM2IDE0LjQ3MSAxMDUuNjExIDE2LjE1OEwxMDUuNTM3IDYuMDE1OTlIMTAwLjc2NVYzMy45MzlIMTA1LjcyVjIyLjY0MUMxMDUuNzcxIDIxLjQ2MDcgMTA2LjI4OCAyMC4zNDg4IDEwNy4xNTcgMTkuNTQ4OUMxMDguMDI3IDE4Ljc0OTEgMTA5LjE3OCAxOC4zMjY2IDExMC4zNTggMTguMzc0QzExMy4zOTcgMTguMzc0IDExNC4yNjggMjEuMTU5IDExNC4yNjggMjIuNjQxVjMzLjkzOUgxMTkuMjIzVjIxLjA1OUMxMTkuMjIzIDIxLjA1OSAxMTkuMTQyIDE0LjAxNSAxMTAuODAyIDE0LjAxNVpNMTczLjc2MyAxNC4zNThIMTY5Ljk5OVY4LjcxNDk5SDE2NS4wNDhWMTQuMzU4SDE2MS4yODRWMTguOTE2SDE2NS4wNDhWMzQuMDAzSDE2OS45OTlWMTguOTE2SDE3My43NjNWMTQuMzU4Wk0xOTAuNzg3IDI1LjI2MkMxOTAuMTI5IDI0LjUwMTQgMTg5LjMwNyAyMy44OTk0IDE4OC4zODQgMjMuNTAxQzE4Ny40ODggMjMuMTE3IDE4Ni4zMzEgMjIuNzMyIDE4NC45NDggMjIuMzY0QzE4NC4xNjUgMjIuMTQzOSAxODMuMzkgMjEuODk3OCAxODIuNjIzIDIxLjYyNkMxODIuMTYzIDIxLjQ2MjEgMTgxLjc0MSAyMS4yMDY2IDE4MS4zODMgMjAuODc1QzE4MS4yMzUgMjAuNzQyMSAxODEuMTE4IDIwLjU3ODkgMTgxLjAzOSAyMC4zOTY0QzE4MC45NjEgMjAuMjE0IDE4MC45MjIgMjAuMDE2NiAxODAuOTI3IDE5LjgxOEMxODAuOTI3IDE5LjI3MiAxODEuMTU2IDE4Ljg0NCAxODEuNjI1IDE4LjUxQzE4Mi4xMjEgMTguMTU2IDE4Mi44NjIgMTcuOTc2IDE4My44MjYgMTcuOTc2QzE4NC43OSAxNy45NzYgMTg1LjU4NyAxOC4yMDkgMTg2LjE0OCAxOC42NjhDMTg2LjcwNiAxOS4xMjQgMTg3LjAwNyAxOS43MjUgMTg3LjA3MiAyMC41TDE4Ny4wOTQgMjAuNzgySDE5MS42MzNMMTkxLjYxNyAyMC40NkMxOTEuNTIxIDE4LjQ4NSAxOTAuNzcxIDE2LjkgMTg5LjM4NSAxNS43NUMxODguMDEyIDE0LjYxMiAxODYuMTg1IDE0LjAzMyAxODMuOTYyIDE0LjAzM0MxODIuNDc3IDE0LjAzMyAxODEuMTQxIDE0LjI4NyAxNzkuOTk0IDE0Ljc4NkMxNzguODMxIDE1LjI5MSAxNzcuOTI2IDE1Ljk5NSAxNzcuMjk2IDE2Ljg4MkMxNzYuNjczIDE3Ljc0NTUgMTc2LjMzOCAxOC43ODQgMTc2LjM0MSAxOS44NDlDMTc2LjM0MSAyMS4xNjcgMTc2LjY5OCAyMi4yNDkgMTc3LjM5OSAyMy4wNjRDMTc4LjA2IDIzLjg0MzIgMTc4Ljg5OCAyNC40NTM0IDE3OS44NDIgMjQuODQ0QzE4MC43NDQgMjUuMjE2IDE4MS45MjggMjUuNjA3IDE4My4zNjEgMjZDMTg0LjgwNiAyNi40MSAxODUuODcyIDI2Ljc4NSAxODYuNTMgMjcuMTIzQzE4Ny4xIDI3LjQxNCAxODcuMzc5IDI3Ljg0NSAxODcuMzc5IDI4LjQ0NEMxODcuMzc5IDI5LjA0MiAxODcuMTIyIDI5LjQ2NyAxODYuNTk1IDI5LjgzOUMxODYuMDQzIDMwLjIyNiAxODUuMjM3IDMwLjQyNSAxODQuMjAxIDMwLjQyNUMxODMuMTY2IDMwLjQyNSAxODIuMzk0IDMwLjE3NCAxODEuNzQ5IDI5LjY3NEMxODEuMTEzIDI5LjE4MSAxODAuNzcyIDI4LjU4OSAxODAuNzEgMjcuODY0TDE4MC42ODUgMjcuNTgySDE3Ni4wMTNMMTc2LjAyNSAyNy45MDFDMTc2LjA2NyAyOS4wOTU1IDE3Ni40NzIgMzAuMjQ4NyAxNzcuMTg4IDMxLjIwNkMxNzcuOTA3IDMyLjE4IDE3OC44OTMgMzIuOTU4IDE4MC4xMTggMzMuNTE5QzE4MS4zMzYgMzQuMDc3IDE4Mi43MzIgMzQuMzYyIDE4NC4yNjYgMzQuMzYyQzE4NS44MDEgMzQuMzYyIDE4Ny4xMDkgMzQuMTA4IDE4OC4yMzggMzMuNjA5QzE4OS4zNzYgMzMuMTA0IDE5MC4yNzIgMzIuMzk0IDE5MC45MDEgMzEuNDk0QzE5MS41MzQgMzAuNTkyIDE5MS44NTMgMjkuNTU0IDE5MS44NTMgMjguNDAzQzE5MS44MjggMjcuMTEgMTkxLjQ2NiAyNi4wNTMgMTkwLjc3NyAyNS4yNjJIMTkwLjc4N1oiIGZpbGw9IiM5QjlCOUIiLz4KPHBhdGggZD0iTTI0MS45ODIgMjUuNjU4MlYxNy43MTE3SDIyOC40NDFMMjIwLjQ5NCAyNS42NTgySDI0MS45ODJaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNTcuMjM5IDUuOTUwODFIMjQwLjI2NUwyMzIuMjU1IDEzLjg5NzNIMjU3LjIzOVY1Ljk1MDgxWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjEyLjYxMSAzMy42MDQ4TDIxNi42OCAyOS41MzYxSDIzMC40MTJWMzcuNDgyN0gyMTIuNjExVjMzLjYwNDhaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yMTUuNTk5IDIxLjc4MDNIMjI0LjM3MkwyMzIuMzgyIDEzLjgzMzdIMjE1LjU5OVYyMS43ODAzWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjA2IDMzLjYwNDdIMjEyLjYxMUwyMjAuNDk0IDI1LjY1ODJIMjA2VjMzLjYwNDdaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNDAuMjY1IDUuOTUwODFMMjM2LjE5NyAxMC4wMTk0SDIxMC4yNTlWMi4wNzI4OEgyNDAuMjY1VjUuOTUwODFaIiBmaWxsPSIjOUI5QjlCIi8+Cjwvc3ZnPgo=);\n        background-repeat: no-repeat;\n        background-size: 170px 40px;\n    }\n\n    > span {\n        padding-left: 0.7rem;\n    }\n}\n\n@keyframes ag-watermark-fadeout {\n    from { opacity: 0.5; }\n    to { opacity: 0; }\n}\n";function qn(e,t){$n(Zn,"watermark");const i=Qn("div"),o=Qn("span");o.innerText=t,i.addEventListener("animationend",(()=>e.removeChild(i))),i.classList.add("ag-watermark"),i.appendChild(o),e.appendChild(i)}var{Group:Jn,Rect:er,Line:tr,BBox:ir,Selection:or}=o._Scene,{Logger:ar}=o._Util,sr=class extends Jn{constructor(){super(),this.append([new er({tag:0}),new er({tag:0}),new er({tag:2}),new er({tag:1}),new tr({tag:3}),new tr({tag:3}),new tr({tag:4}),new tr({tag:4})])}updateDatumStyles(e,t,i,o,a){const{bandwidth:s,scaledValues:{xValue:n,medianValue:r}}=e;let{minValue:l,q1Value:h,q3Value:d,maxValue:c}=e.scaledValues;(i&&!o||!i&&o)&&([c,d,h,l]=[l,h,d,c]);const u=(e,t,o,a)=>i?{y:e,x:t,width:a,height:o}:{x:e,y:t,width:o,height:a},p=(e,t,o)=>i?{y1:e,y2:t,x:o}:{x1:e,x2:t,y:o},y=(e,t,o)=>i?{x1:t,x2:o,y:e}:{x:e,y1:t,y2:o},g=(e,t,i,o)=>(({x:e,y:t,width:i,height:o}=u(e,t,i,o)),new ir(e,t,i,o)),{fill:m,fillOpacity:x,stroke:f,strokeWidth:v,strokeOpacity:S,lineDash:M,lineDashOffset:D,cap:b,whisker:N}=t,I=or.select(this,er),k=I.selectByTag(0),[T]=I.selectByTag(2),[A]=I.selectByTag(1),O=I.selectByTag(3),L=I.selectByTag(4);N.strokeWidth>s&&(N.strokeWidth=s);const E=u(h,n,d-h,s);T.setProperties(E),k[0].setProperties(E),k[0].setProperties({cornerRadius:a,clipBBox:g(h,n,Math.round(r-h+v/2),s)}),k[1].setProperties(E),k[1].setProperties({cornerRadius:a,clipBBox:g(Math.round(r-v/2),n,Math.floor(d-r+v/2),s)});const _=Math.max(Math.round(r-v/2),h+v),R=Math.min(Math.round(r+v/2),d-v);A.setProperties(E),A.setProperties({visible:_<R,cornerRadius:a,clipBBox:g(_,n+v,R-_,Math.max(0,s-2*v))});const C=Math.floor(n+s*(1-b.lengthRatio)/2),w=Math.ceil(n+s*(1+b.lengthRatio)/2);L[0].setProperties(y(l,C,w)),L[1].setProperties(y(c,C,w)),O[0].setProperties(p(Math.round(l+N.strokeWidth/2),h,Math.floor(n+s/2))),O[1].setProperties(p(d,Math.round(c-N.strokeWidth/2),Math.floor(n+s/2)));for(const P of k)P.setProperties({fill:m,fillOpacity:x,strokeWidth:2*v,strokeOpacity:0});A.setProperties({fill:f,fillOpacity:S,strokeWidth:0});for(const P of[...O,...L])P.setProperties(N);T.setProperties({stroke:f,strokeWidth:v,strokeOpacity:S,lineDash:M,lineDashOffset:D,cornerRadius:a,fillOpacity:0})}distanceSquared(e,t){const i=or.selectByClass(this,er,tr);return o._Scene.nearestSquared(e,t,i).distanceSquared}get midPoint(){const e=this.datum;return void 0===e.midPoint?(ar.error("BoxPlotGroup.datum.midPoint is undefined"),{x:NaN,y:NaN}):e.midPoint}},{BaseProperties:nr,AbstractBarSeriesProperties:rr,SeriesTooltip:lr,Validate:hr,COLOR_STRING:dr,FUNCTION:cr,LINE_DASH:ur,OBJECT:pr,POSITIVE_NUMBER:yr,RATIO:gr,STRING:mr,mergeDefaults:xr}=o._ModuleSupport,fr=class extends nr{constructor(){super(...arguments),this.lengthRatio=.5}};f([hr(gr)],fr.prototype,"lengthRatio",2);var vr=class extends nr{};f([hr(dr,{optional:!0})],vr.prototype,"stroke",2),f([hr(yr)],vr.prototype,"strokeWidth",2),f([hr(gr)],vr.prototype,"strokeOpacity",2),f([hr(ur,{optional:!0})],vr.prototype,"lineDash",2),f([hr(yr)],vr.prototype,"lineDashOffset",2);var Sr=class extends rr{constructor(){super(...arguments),this.fill="#c16068",this.fillOpacity=1,this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.cap=new fr,this.whisker=new vr,this.tooltip=new lr}toJson(){const{stroke:e,strokeWidth:t,strokeOpacity:i,lineDash:o,lineDashOffset:a}=this,s=super.toJson();return s.whisker=xr(s.whisker,{stroke:e,strokeWidth:t,strokeOpacity:i,lineDash:o,lineDashOffset:a}),s}};f([hr(mr)],Sr.prototype,"xKey",2),f([hr(mr)],Sr.prototype,"minKey",2),f([hr(mr)],Sr.prototype,"q1Key",2),f([hr(mr)],Sr.prototype,"medianKey",2),f([hr(mr)],Sr.prototype,"q3Key",2),f([hr(mr)],Sr.prototype,"maxKey",2),f([hr(mr,{optional:!0})],Sr.prototype,"xName",2),f([hr(mr,{optional:!0})],Sr.prototype,"yName",2),f([hr(mr,{optional:!0})],Sr.prototype,"minName",2),f([hr(mr,{optional:!0})],Sr.prototype,"q1Name",2),f([hr(mr,{optional:!0})],Sr.prototype,"medianName",2),f([hr(mr,{optional:!0})],Sr.prototype,"q3Name",2),f([hr(mr,{optional:!0})],Sr.prototype,"maxName",2),f([hr(dr,{optional:!0})],Sr.prototype,"fill",2),f([hr(gr)],Sr.prototype,"fillOpacity",2),f([hr(dr)],Sr.prototype,"stroke",2),f([hr(yr)],Sr.prototype,"strokeWidth",2),f([hr(gr)],Sr.prototype,"strokeOpacity",2),f([hr(ur)],Sr.prototype,"lineDash",2),f([hr(yr)],Sr.prototype,"lineDashOffset",2),f([hr(yr)],Sr.prototype,"cornerRadius",2),f([hr(cr,{optional:!0})],Sr.prototype,"formatter",2),f([hr(pr)],Sr.prototype,"cap",2),f([hr(pr)],Sr.prototype,"whisker",2),f([hr(pr)],Sr.prototype,"tooltip",2);var{extent:Mr,extractDecoratedProperties:Dr,fixNumericExtent:br,keyProperty:Nr,mergeDefaults:Ir,SeriesNodePickMode:kr,SMALLEST_KEY_INTERVAL:Tr,valueProperty:Ar,diff:Or,animationValidation:Lr,convertValuesToScaleByDefs:Er,isFiniteNumber:_r,computeBarFocusBounds:Rr}=o._ModuleSupport,{motion:Cr}=o._Scene,{ContinuousScale:wr}=o._Scale,Pr=class extends o._ModuleSupport.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.xKey=o.properties.xKey,this.minKey=o.properties.minKey,this.q1Key=o.properties.q1Key,this.medianKey=o.properties.medianKey,this.q3Key=o.properties.q3Key,this.maxKey=o.properties.maxKey}},zr=class extends o._ModuleSupport.AbstractBarSeries{constructor(e){super({moduleCtx:e,pickModes:[kr.EXACT_SHAPE_MATCH],directionKeys:{x:["xKey"],y:["medianKey","q1Key","q3Key","minKey","maxKey"]},directionNames:{x:["xName"],y:["medianName","q1Name","q3Name","minName","maxName"]},pathsPerSeries:1,hasHighlightedLabels:!0}),this.properties=new Sr,this.NodeEvent=Pr}processData(e){return S(this,null,(function*(){var t,i,o;if(!this.properties.isValid()||!this.visible)return;const{xKey:a,minKey:s,q1Key:n,medianKey:r,q3Key:l,maxKey:h}=this.properties,d=!this.ctx.animationManager.isSkipped(),c=null==(t=this.getCategoryAxis())?void 0:t.scale,u=null==(i=this.getValueAxis())?void 0:i.scale,{isContinuousX:p,xScaleType:y,yScaleType:g}=this.getScaleInformation({xScale:c,yScale:u}),m=[];d&&this.processedData&&m.push(Or(this.processedData)),d&&m.push(Lr());const{processedData:x}=yield this.requestDataModel(e,this.data,{props:[Nr(a,y,{id:"xValue"}),Ar(s,g,{id:"minValue"}),Ar(n,g,{id:"q1Value"}),Ar(r,g,{id:"medianValue"}),Ar(l,g,{id:"q3Value"}),Ar(h,g,{id:"maxValue"}),...p?[Tr]:[],...m]});this.smallestDataInterval=null==(o=x.reduced)?void 0:o.smallestKeyInterval,this.animationState.transition("updateData")}))}getSeriesDomain(e){var t;const{processedData:i,dataModel:o,smallestDataInterval:a}=this;if(!i||!o)return[];if(e===this.getBarDirection()){const e=o.getDomain(this,"minValue","value",i),t=o.getDomain(this,"maxValue","value",i);return br([Math.min(...e),Math.max(...t)],this.getValueAxis())}const{index:s,def:n}=o.resolveProcessedDataDefById(this,"xValue"),r=i.domain.keys[s];if("key"===n.type&&"category"===n.valueType)return r;const l=this.getCategoryAxis(),h=null!=(t=Mr(r))?t:[NaN,NaN],d=_r(a)?.5*a:0,c=h[0]+-d,u=h[1]+d;return br([c,u],l)}createNodeData(){return S(this,null,(function*(){const{visible:e,dataModel:t}=this,i=this.getCategoryAxis(),o=this.getValueAxis();if(!(t&&i&&o))return;const{xKey:a,fill:s,fillOpacity:n,stroke:r,strokeWidth:l,strokeOpacity:h,lineDash:d,lineDashOffset:c,cap:u,whisker:p}=this.properties,y=[],g=t.resolveProcessedDataDefsByIds(this,["xValue","minValue","q1Value","medianValue","q3Value","maxValue"]),{barWidth:m,groupIndex:x}=this.updateGroupScale(i),f=wr.is(i.scale)?-.5*m:0,{groupScale:v,processedData:S}=this,M=this.isVertical(),D={itemId:a,nodeData:y,labelData:[],scales:this.calculateScaling(),visible:this.visible};return e?(null==S||S.data.forEach((e=>{let{datum:S,keys:D,values:b}=e;const{xValue:N,minValue:I,q1Value:k,medianValue:T,q3Value:A,maxValue:O}=t.resolveProcessedDataDefsValues(g,{keys:D,values:b});if([I,k,T,A,O].some((e=>"number"!==typeof e))||I>k||k>T||T>A||A>O)return;const L=Er({defs:g,values:{xValue:N,minValue:I,q1Value:k,medianValue:T,q3Value:A,maxValue:O},xAxis:i,yAxis:o});L.xValue+=Math.round(v.convert(String(x)))+f;const E=Math.round(m),_=Math.abs(L.q3Value-L.q1Value),R=L.xValue+E/2,C=Math.min(L.q3Value,L.q1Value)+_/2,w={x:M?R:C,y:M?C:R},P=M?E:_,z=M?_:E;y.push({series:this,itemId:N,datum:S,xKey:a,bandwidth:E,scaledValues:L,cap:u,whisker:p,fill:s,fillOpacity:n,stroke:r,strokeWidth:l,strokeOpacity:h,lineDash:d,lineDashOffset:c,midPoint:w,focusRect:{x:w.x-P/2,y:w.y-z/2,width:P,height:z}})})),D):D}))}getLegendData(e){var t;const{id:i,data:o}=this,{xKey:a,yName:s,fill:n,fillOpacity:r,stroke:l,strokeWidth:h,strokeOpacity:d,showInLegend:c,legendItemName:u,visible:p}=this.properties;return c&&(null==o?void 0:o.length)&&a&&"category"===e?[{legendType:"category",id:i,itemId:i,seriesId:i,enabled:p,label:{text:null!=(t=null!=u?u:s)?t:i},marker:{fill:n,fillOpacity:r,stroke:l,strokeOpacity:d,strokeWidth:h},legendItemName:u}]:[]}getTooltipHtml(e){const{xKey:t,minKey:i,q1Key:a,medianKey:s,q3Key:n,maxKey:r,xName:l,yName:h,minName:d,q1Name:c,medianName:u,q3Name:p,maxName:y,tooltip:g,fill:m}=this.properties,{datum:x,itemId:f}=e,v=this.getCategoryAxis(),S=this.getValueAxis();if(!v||!S||!this.properties.isValid())return o._ModuleSupport.EMPTY_TOOLTIP_CONTENT;const M=o._Util.sanitizeHtml(h),D=[[t,l,v],[i,d,S],[a,c,S],[s,u,S],[n,p,S],[r,y,S]].map((e=>{let[t,i,a]=e;return o._Util.sanitizeHtml(`${null!=i?i:t}: ${a.formatDatum(x[t])}`)})).join(M?"<br/>":", "),{fill:b}=this.getFormattedStyles(e);return g.toTooltipHtml({title:M,content:D,backgroundColor:m},{seriesId:this.id,itemId:f,datum:x,fill:m,xKey:t,minKey:i,q1Key:a,medianKey:s,q3Key:n,maxKey:r,xName:l,minName:d,q1Name:c,medianName:u,q3Name:p,maxName:y,yName:h,title:M,color:null!=m?m:b})}animateEmptyUpdateReady(e){let{datumSelection:t}=e;const i=this.isVertical(),{from:o,to:a}=function(e){return{from:e?{scalingX:1,scalingY:0}:{scalingX:0,scalingY:1},to:{scalingX:1,scalingY:1}}}(i);Cr.resetMotion([t],function(e){return(t,i)=>e?{scalingCenterY:i.scaledValues.medianValue}:{scalingCenterX:i.scaledValues.medianValue}}(i)),Cr.staticFromToMotion(this.id,"datums",this.ctx.animationManager,[t],o,a,{phase:"initial"})}isLabelEnabled(){return!1}updateDatumSelection(e){return S(this,null,(function*(){var t;const i=null!=(t=e.nodeData)?t:[];return e.datumSelection.update(i)}))}updateDatumNodes(e){return S(this,arguments,(function(e){var t=this;let{datumSelection:i,isHighlight:o}=e;return function*(){var e;const a=t.isVertical(),s=null==(e=t.getValueAxis())?void 0:e.isReversed(),{cornerRadius:n}=t.properties;i.each(((e,i)=>{let r=t.getFormattedStyles(i,o);o&&(r=Ir(t.properties.highlightStyle.item,r));const{stroke:l,strokeWidth:h,strokeOpacity:d,lineDash:c,lineDashOffset:u}=r;r.whisker=Ir(r.whisker,{stroke:l,strokeWidth:h,strokeOpacity:d,lineDash:c,lineDashOffset:u}),e.updateDatumStyles(i,r,a,s,n)}))}()}))}updateLabelNodes(e){return S(this,null,(function*(){}))}updateLabelSelection(e){return S(this,null,(function*(){const{labelData:t,labelSelection:i}=e;return i.update(t)}))}nodeFactory(){return new sr}getFormattedStyles(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{id:i,ctx:{callbackCache:o}}=this,{xKey:a,minKey:s,q1Key:n,medianKey:r,q3Key:l,maxKey:h,formatter:d}=this.properties,{datum:c,fill:u,fillOpacity:p,stroke:y,strokeWidth:x,strokeOpacity:f,lineDash:v,lineDashOffset:S,cap:M,whisker:D}=e,b={fill:u,fillOpacity:p,stroke:y,strokeWidth:x,strokeOpacity:f,lineDash:v,lineDashOffset:S,cap:Dr(M),whisker:Dr(D)};if(d){const e=o.call(d,m(g({datum:c,seriesId:i,highlighted:t},b),{xKey:a,minKey:s,q1Key:n,medianKey:r,q3Key:l,maxKey:h}));if(e)return Ir(e,b)}return b}computeFocusBounds(e){let{datumIndex:t,seriesRect:i}=e;var o;return Rr(null==(o=this.contextNodeData)?void 0:o.nodeData[t].focusRect,this.contentGroup,i)}};zr.className="BoxPlotSeries",zr.type="box-plot";var Kr={series:{__extends__:o._Theme.EXTENDS_SERIES_DEFAULTS,direction:"vertical",strokeWidth:2},axes:{[o._Theme.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{snap:!1}},[o._Theme.CARTESIAN_AXIS_TYPE.CATEGORY]:{groupPaddingInner:.2,crosshair:{enabled:!1,snap:!1}}}},Vr={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"box-plot",instanceConstructor:zr,defaultAxes:[{type:o._Theme.CARTESIAN_AXIS_TYPE.NUMBER,position:o._Theme.POSITION.LEFT},{type:o._Theme.CARTESIAN_AXIS_TYPE.CATEGORY,position:o._Theme.POSITION.BOTTOM}],themeTemplate:Kr,groupable:!0,paletteFactory:e=>{let{takeColors:t,userPalette:i,themeTemplateParameters:a}=e;var s;const n=a.properties.get(o._Theme.DEFAULT_BACKGROUND_COLOUR),r=null!=(s=Array.isArray(n)?n[0]:n)?s:"white",{fills:[l],strokes:[h]}=t(1);return{fill:i?l:o._Util.Color.interpolate(l,r)(.7),stroke:h}},swapDefaultAxesCondition:e=>{let{direction:t}=e;return"horizontal"===t}},{AbstractBarSeriesProperties:Br,BaseProperties:Fr,PropertiesArray:Ur,SeriesTooltip:jr,Validate:Wr,ARRAY:Yr,COLOR_STRING:Gr,LINE_DASH:Hr,OBJECT:Xr,POSITIVE_NUMBER:Qr,RATIO:$r,STRING:Zr}=o._ModuleSupport,qr=class extends Fr{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.lengthRatio=.75}};f([Wr(Gr)],qr.prototype,"fill",2),f([Wr($r)],qr.prototype,"fillOpacity",2),f([Wr(Gr)],qr.prototype,"stroke",2),f([Wr(Qr)],qr.prototype,"strokeWidth",2),f([Wr($r)],qr.prototype,"strokeOpacity",2),f([Wr(Hr)],qr.prototype,"lineDash",2),f([Wr(Qr)],qr.prototype,"lineDashOffset",2),f([Wr($r)],qr.prototype,"lengthRatio",2);var Jr=class extends Fr{};f([Wr(Qr,{optional:!0})],Jr.prototype,"max",2);var el=class extends Fr{constructor(){super(...arguments),this.color="lightgrey"}};f([Wr(Gr)],el.prototype,"color",2),f([Wr(Qr,{optional:!0})],el.prototype,"stop",2);var tl=class extends Br{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.widthRatio=.5,this.colorRanges=new Ur(el),this.target=new qr,this.scale=new Jr,this.tooltip=new jr,this.backgroundFill="white"}};f([Wr(Zr)],tl.prototype,"valueKey",2),f([Wr(Zr,{optional:!0})],tl.prototype,"valueName",2),f([Wr(Zr,{optional:!0})],tl.prototype,"targetKey",2),f([Wr(Zr,{optional:!0})],tl.prototype,"targetName",2),f([Wr(Gr)],tl.prototype,"fill",2),f([Wr($r)],tl.prototype,"fillOpacity",2),f([Wr(Gr)],tl.prototype,"stroke",2),f([Wr(Qr)],tl.prototype,"strokeWidth",2),f([Wr($r)],tl.prototype,"strokeOpacity",2),f([Wr(Hr)],tl.prototype,"lineDash",2),f([Wr(Qr)],tl.prototype,"lineDashOffset",2),f([Wr($r)],tl.prototype,"widthRatio",2),f([Wr(Yr.restrict({minLength:0}))],tl.prototype,"colorRanges",2),f([Wr(Xr)],tl.prototype,"target",2),f([Wr(Xr)],tl.prototype,"scale",2),f([Wr(Xr)],tl.prototype,"tooltip",2),f([Wr(Gr)],tl.prototype,"backgroundFill",2);var{animationValidation:il,collapsedStartingBarPosition:ol,diff:al,keyProperty:sl,partialAssign:nl,prepareBarAnimationFunctions:rl,resetBarSelectionsFn:ll,seriesLabelFadeInAnimation:hl,valueProperty:dl,createDatumId:cl,computeBarFocusBounds:ul}=o._ModuleSupport,{fromToMotion:pl}=o._Scene.motion,{sanitizeHtml:yl}=o._Util,gl=["fill","fillOpacity","stroke","strokeWidth","strokeOpacity","lineDash","lineDashOffset"],ml=class e extends o._ModuleSupport.AbstractBarSeries{constructor(e){super({moduleCtx:e,directionKeys:{y:["targetKey","valueKey"]},directionNames:{y:["targetName","valueName"]},pickModes:[o._ModuleSupport.SeriesNodePickMode.EXACT_SHAPE_MATCH],hasHighlightedLabels:!0,animationResetFns:{datum:ll}}),this.properties=new tl,this.normalizedColorRanges=[],this.colorRangesGroup=new o._Scene.Group({name:`${this.id}-colorRanges`}),this.colorRangesSelection=o._Scene.Selection.select(this.colorRangesGroup,o._Scene.Rect,!1),this.rootGroup.append(this.colorRangesGroup),this.targetLinesSelection=o._Scene.Selection.select(this.annotationGroup,o._Scene.Line,!1)}destroy(){this.rootGroup.removeChild(this.colorRangesGroup),super.destroy()}processData(e){return S(this,null,(function*(){var t,i;if(!this.properties.isValid()||!this.data||!this.visible)return;const{valueKey:o,targetKey:a}=this.properties,s=null==(t=this.getCategoryAxis())?void 0:t.scale,n=null==(i=this.getValueAxis())?void 0:i.scale,{xScaleType:r,yScaleType:l}=this.getScaleInformation({xScale:s,yScale:n}),h=[];void 0!==a&&h.push(dl(a,l,{id:"target"})),this.ctx.animationManager.isSkipped()||(void 0!==this.processedData&&h.push(al(this.processedData)),h.push(il())),yield this.requestDataModel(e,this.data.slice(0,1),{props:[sl(o,r,{id:"xValue"}),dl(o,l,{id:"value"}),...h],groupByKeys:!0}),this.animationState.transition("updateData")}))}getBandScalePadding(){return{inner:0,outer:0}}getMaxValue(){var e,t;return Math.max(...null!=(t=null==(e=this.getValueAxis())?void 0:e.dataDomain.domain)?t:[0])}getSeriesDomain(e){var t,i;const{dataModel:o,processedData:a}=this;if(!o||!a)return[];const{valueKey:s,targetKey:n,valueName:r,scale:l}=this.properties;if(e===this.getCategoryDirection())return[null!=r?r:s];if(e==(null==(t=this.getValueAxis())?void 0:t.direction)){const e=o.getDomain(this,"value","value",a),t=void 0===n?[]:o.getDomain(this,"target","value",a);return[0,null!=(i=l.max)?i:Math.max(...e,...t)]}throw new Error(`unknown direction ${e}`)}getKeys(e){return e===this.getBarDirection()?[this.properties.valueKey]:super.getKeys(e)}createNodeData(){return S(this,null,(function*(){var e,t,i,a;const{dataModel:s,processedData:n}=this,{valueKey:r,targetKey:l,widthRatio:h,target:{lengthRatio:d}}=this.properties,c=null==(e=this.getCategoryAxis())?void 0:e.scale,u=null==(t=this.getValueAxis())?void 0:t.scale;if(!r||!s||!n||!c||!u)return;if(void 0===h||void 0===d)return;const p=null!=(i=c.bandwidth)?i:NaN,y=this.getMaxValue(),x=s.resolveProcessedDataIndexById(this,"value"),f=void 0===l?NaN:s.resolveProcessedDataIndexById(this,"target"),v={itemId:r,nodeData:[],labelData:[],scales:this.calculateScaling(),visible:this.visible};if(!this.visible)return v;for(const{datum:D,values:b}of n.data){if(!Array.isArray(D)||D.length<1)continue;b[0][x]<0&&o._Util.Logger.warnOnce("negative values are not supported, clipping to 0.");const e=null!=(a=this.properties.valueName)?a:this.properties.valueKey,t=Math.min(y,Math.max(0,b[0][x])),i=u.convert(t),s=h*p,n=u.convert(0),l=this.getBarDirection()===o._ModuleSupport.ChartAxisDirection.X,c={x:p*(1-h)/2,y:Math.min(i,n),width:s,height:Math.abs(n-i)};let S;if(l&&([c.x,c.y,c.width,c.height]=[c.y,c.x,c.height,c.width]),b[0][f]<0&&o._Util.Logger.warnOnce("negative targets are not supported, ignoring."),this.properties.targetKey&&b[0][f]>=0){const e=d*p,t=Math.min(y,b[0][f]);if(!isNaN(t)&&void 0!==t){const i=u.convert(t);let o=p*(1-d)/2,a=o+e,[s,n]=[i,i];l&&([o,a,s,n]=[s,n,o,a]),S={value:t,x1:o,x2:a,y1:s,y2:n}}}const M=m(g({series:this,datum:D[0],xKey:r,xValue:e,yKey:r,yValue:t,cumulativeValue:t,target:S},c),{midPoint:{x:c.x+c.width/2,y:c.y+c.height/2},opacity:1});v.nodeData.push(M)}const S=[...this.getColorRanges()].sort(((e,t)=>{var i,o;return(null!=(i=e.stop)?i:y)-(null!=(o=t.stop)?o:y)}));let M=0;return this.normalizedColorRanges=S.map((e=>{var t;const i=Math.min(y,null!=(t=e.stop)?t:1/0),o={color:e.color,start:M,stop:i};return M=i,o})),v}))}getColorRanges(){const{colorRanges:e,fill:t,backgroundFill:i}=this.properties;if(void 0!==e&&e.length>0)return e;const a=new el;return a.color=o._Util.Color.interpolate(t,i)(.7),[a]}getLegendData(e){return[]}getTooltipHtml(e){const{valueKey:t,valueName:i,targetKey:a,targetName:s}=this.properties,n=this.getValueAxis(),{yValue:r,target:{value:l}={value:void 0},datum:h,itemId:d}=e;if(void 0===t||void 0===r||void 0===n)return o._ModuleSupport.EMPTY_TOOLTIP_CONTENT;const c=(e,t,i)=>`<b>${yl(null!=t?t:e)}</b>: ${yl(n.formatDatum(i))}`,u=void 0,p=void 0===a||void 0===l?c(t,i,r):`${c(t,i,r)}<br/>${c(a,s,l)}`;return this.properties.tooltip.toTooltipHtml({title:u,content:p,backgroundColor:this.properties.fill},{datum:h,itemId:d,title:u,seriesId:this.id,valueKey:t,valueName:i,targetKey:a,targetName:s,color:void 0})}isLabelEnabled(){return!1}nodeFactory(){return new o._Scene.Rect}updateDatumSelection(e){return S(this,null,(function*(){return this.targetLinesSelection.update(e.nodeData,void 0,void 0),e.datumSelection.update(e.nodeData,void 0,void 0)}))}updateDatumNodes(e){return S(this,null,(function*(){for(const{node:t}of e.datumSelection){const e=this.properties;nl(gl,t,e)}for(const{node:e,datum:t}of this.targetLinesSelection)if(void 0===t.target)e.visible=!1;else{const i=this.properties.target;nl(["x1","x2","y1","y2"],e,t.target),nl(gl,e,i)}}))}updateColorRanges(){return S(this,null,(function*(){const e=this.getValueAxis(),t=this.getCategoryAxis();if(!e||!t)return;const[i,a]=[0,Math.max(...t.scale.range)],s=this.getBarDirection()===o._ModuleSupport.ChartAxisDirection.Y?(t,o)=>{t.x=i,t.y=e.scale.convert(o.stop),t.height=e.scale.convert(o.start)-t.y,t.width=a}:(t,o)=>{t.x=e.scale.convert(o.start),t.y=i,t.height=a,t.width=e.scale.convert(o.stop)-t.x};this.colorRangesSelection.update(this.normalizedColorRanges);for(const{node:o,datum:n}of this.colorRangesSelection)s(o,n),o.fill=n.color}))}updateNodes(t,i,o){return S(this,null,(function*(){yield v(e.prototype,this,"updateNodes").call(this,t,i,o),yield this.updateColorRanges()}))}updateLabelSelection(e){return S(this,null,(function*(){return e.labelSelection}))}updateLabelNodes(e){return S(this,null,(function*(){}))}animateEmptyUpdateReady(e){const{datumSelection:t,annotationSelections:i}=e,o=rl(ol(this.isVertical(),this.axes,"normal"));pl(this.id,"nodes",this.ctx.animationManager,[t],o),hl(this,"annotations",this.ctx.animationManager,...i)}animateWaitingUpdateReady(e){var t,i,o;const{datumSelection:a,annotationSelections:s}=e;this.ctx.animationManager.stopByAnimationGroupId(this.id);const n=null==(i=null==(t=this.processedData)?void 0:t.reduced)?void 0:i.diff,r=rl(ol(this.isVertical(),this.axes,"normal"));pl(this.id,"nodes",this.ctx.animationManager,[a],r,((e,t)=>cl(t.xValue)),n);(null==(o=null==n?void 0:n.changed)||o)&&hl(this,"annotations",this.ctx.animationManager,...s)}computeFocusBounds(e){let{datumIndex:t,seriesRect:i}=e;var o;return ul(null==(o=this.contextNodeData)?void 0:o.nodeData[t],this.contentGroup,i)}},xl={series:{direction:"vertical",strokeWidth:0,strokeOpacity:1,fillOpacity:1,widthRatio:.5,target:{strokeWidth:3,strokeOpacity:1,lengthRatio:.75}},axes:{[o._Theme.CARTESIAN_AXIS_TYPE.NUMBER]:{nice:!1,crosshair:{enabled:!1}}}},fl={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"bullet",solo:!0,instanceConstructor:ml,defaultAxes:[{type:o._Theme.CARTESIAN_AXIS_TYPE.NUMBER,position:o._Theme.POSITION.LEFT},{type:o._Theme.CARTESIAN_AXIS_TYPE.CATEGORY,position:o._Theme.POSITION.BOTTOM}],themeTemplate:xl,swapDefaultAxesCondition:e=>"horizontal"===(null==e?void 0:e.direction),paletteFactory:e=>{let{takeColors:t,colorsCount:i,themeTemplateParameters:a}=e;var s;const{properties:n}=a,{fills:[r],strokes:[l]}=t(i),h=a.properties.get(o._Theme.DEFAULT_BACKGROUND_COLOUR),d=null!=(s=Array.isArray(h)?h[0]:h)?s:"white";return{fill:r,stroke:l,target:{stroke:n.get(o._Theme.DEFAULT_CROSS_LINES_COLOUR)},backgroundFill:d}}},{SceneChangeDetection:vl,BBox:Sl,RedrawType:Ml}=o._Scene,Dl=class extends o._Scene.Group{constructor(){super(...arguments),this.x=0,this.y=0,this.yBottom=0,this.yHigh=0,this.yLow=0,this.width=0,this.height=0}distanceSquared(e,t){const i=o._Scene.Selection.selectByClass(this,o._Scene.Rect,o._Scene.Line);return o._Scene.nearestSquared(e,t,i).distanceSquared}get midPoint(){const e=this.datum;return void 0===e.midPoint?(o._Util.Logger.error("CandlestickBaseGroup.datum.midPoint is undefined"),{x:NaN,y:NaN}):e.midPoint}render(e){this.updateCoordinates(),super.render(e)}};f([vl({redraw:Ml.MAJOR})],Dl.prototype,"x",2),f([vl({redraw:Ml.MAJOR})],Dl.prototype,"y",2),f([vl({redraw:Ml.MAJOR})],Dl.prototype,"yBottom",2),f([vl({redraw:Ml.MAJOR})],Dl.prototype,"yHigh",2),f([vl({redraw:Ml.MAJOR})],Dl.prototype,"yLow",2),f([vl({redraw:Ml.MAJOR})],Dl.prototype,"width",2),f([vl({redraw:Ml.MAJOR})],Dl.prototype,"height",2);var bl=class extends Dl{constructor(){super(),this.append([new o._Scene.Rect({tag:0}),new o._Scene.Line({tag:1}),new o._Scene.Line({tag:2})])}updateCoordinates(){const{x:e,y:t,yBottom:i,yHigh:a,yLow:s,width:n,height:r}=this,l=o._Scene.Selection.select(this,o._Scene.Rect),[h]=l.selectByTag(0),[d]=l.selectByTag(1),[c]=l.selectByTag(2);if(0===n||0===r)return h.visible=!1,d.visible=!1,void(c.visible=!1);h.visible=!0,d.visible=!0,c.visible=!0,h.setProperties({x:e,y:t,width:n,height:r,crisp:!0,clipBBox:new Sl(e,t,n,r)});const u=n/2;d.setProperties({y1:Math.round(s+d.strokeWidth/2),y2:i,x:e+u}),c.setProperties({y1:Math.round(a+c.strokeWidth/2),y2:t,x:e+u})}updateDatumStyles(e,t){const{bandwidth:i}=e,{fill:a,fillOpacity:s,stroke:n,strokeWidth:r,strokeOpacity:l,lineDash:h,lineDashOffset:d,wick:c={},cornerRadius:u}=t;null!=c.strokeWidth||(c.strokeWidth=1);const p=o._Scene.Selection.select(this,o._Scene.Rect),[y]=p.selectByTag(0),[g]=p.selectByTag(1),[m]=p.selectByTag(2);c.strokeWidth>i&&(c.strokeWidth=i),y.setProperties({fill:a,fillOpacity:s,strokeWidth:r,strokeOpacity:l,stroke:n,lineDash:h,lineDashOffset:d,cornerRadius:u}),g.setProperties(c),m.setProperties(c)}},{computeBarFocusBounds:Nl,NODE_UPDATE_STATE_TO_PHASE_MAPPING:Il}=o._ModuleSupport;function kl(e,t){return Al(t)}function Tl(e){return{toFn:(e,t,i)=>{if("removed"===i){const{x:e,yLow:i,yHigh:o,width:a}=Al(t),s="up"===t.itemId?i:o;return{x:e,y:s,yBottom:s,yHigh:s,yLow:s,width:a,height:0}}return Al(t)},fromFn:(t,i,o)=>{const a=e?"initial":Il[o];if("unknown"===o||"added"===o&&null!=i){const{x:e,y:t,yLow:s,yHigh:n,width:r,height:l}=Al(i);let h="up"===i.itemId?s:n;return"unknown"===o&&(h=t+l/2),{x:e,y:h,yBottom:h,yHigh:h,yLow:h,width:r,height:0,phase:a}}return{x:t.x,y:t.y,yBottom:t.yBottom,yHigh:t.yHigh,yLow:t.yLow,width:t.width,height:t.height,phase:a}}}}function Al(e){const{bandwidth:t,scaledValues:{xValue:i,openValue:o,closeValue:a,highValue:s,lowValue:n}}=e,r=Math.min(o,a),l=isNaN(o)?a:Math.max(o,a);return{x:i,y:r,yBottom:l,yHigh:Math.min(s,n),yLow:Math.max(s,n),width:t,height:Math.max(l-r,.001)}}function Ol(e,t){var i;const o=null==(i=e.getNodeData())?void 0:i.at(t.datumIndex),a=o?{x:o.scaledValues.xValue,y:o.scaledValues.highValue,width:o.bandwidth,height:o.scaledValues.lowValue-o.scaledValues.highValue}:void 0;return Nl(a,e.contentGroup,t.seriesRect)}var{motion:Ll}=o._Scene,{extent:El,fixNumericExtent:_l,keyProperty:Rl,SeriesNodePickMode:Cl,SMALLEST_KEY_INTERVAL:wl,valueProperty:Pl,diff:zl,animationValidation:Kl,convertValuesToScaleByDefs:Vl,mergeDefaults:Bl,isFiniteNumber:Fl}=o._ModuleSupport,{sanitizeHtml:Ul,Logger:jl}=o._Util,{ContinuousScale:Wl}=o._Scale,Yl=class extends o._ModuleSupport.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.xKey=o.properties.xKey,this.openKey=o.properties.openKey,this.closeKey=o.properties.closeKey,this.highKey=o.properties.highKey,this.lowKey=o.properties.lowKey}},Gl=class extends o._ModuleSupport.AbstractBarSeries{constructor(e,t){super({moduleCtx:e,pickModes:[Cl.NEAREST_BY_MAIN_AXIS_FIRST,Cl.EXACT_SHAPE_MATCH],directionKeys:{x:["xKey"],y:["lowKey","highKey","openKey","closeKey"]},directionNames:{x:["xName"],y:["lowName","highName","openName","closeName"]},pathsPerSeries:1,datumSelectionGarbageCollection:!1,animationAlwaysUpdateSelections:!0,animationResetFns:{datum:t}}),this.NodeEvent=Yl}animateEmptyUpdateReady(e){let{datumSelection:t}=e;const i=Tl(!0);Ll.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],i)}animateWaitingUpdateReady(e){let{datumSelection:t}=e;var i;const{processedData:o}=this,a=null==(i=null==o?void 0:o.reduced)?void 0:i.diff,s=Tl(!1);Ll.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],s,((e,t)=>String(t.xValue)),a)}processData(e){return S(this,null,(function*(){var t,i,o;if(!this.properties.isValid()||!this.visible)return;const{xKey:a,openKey:s,closeKey:n,highKey:r,lowKey:l}=this.properties,h=!this.ctx.animationManager.isSkipped(),d=null==(t=this.getCategoryAxis())?void 0:t.scale,c=null==(i=this.getValueAxis())?void 0:i.scale,{isContinuousX:u,xScaleType:p,yScaleType:y}=this.getScaleInformation({xScale:d,yScale:c}),g=[];h&&(this.processedData&&g.push(zl(this.processedData)),g.push(Kl())),s&&g.push(Pl(s,y,{id:"openValue",invalidValue:void 0,missingValue:void 0}));const{processedData:m}=yield this.requestDataModel(e,this.data,{props:[Rl(a,p,{id:"xValue"}),Pl(n,y,{id:"closeValue"}),Pl(r,y,{id:"highValue"}),Pl(l,y,{id:"lowValue"}),...u?[wl]:[],...g]});this.smallestDataInterval=null==(o=m.reduced)?void 0:o.smallestKeyInterval,this.animationState.transition("updateData")}))}getSeriesDomain(e){var t;const{processedData:i,dataModel:o,smallestDataInterval:a}=this;if(!i||!o)return[];const{openKey:s}=this.properties;if(e===this.getBarDirection()){const e=o.getDomain(this,"lowValue","value",i),t=o.getDomain(this,"highValue","value",i),a=s?o.getDomain(this,"openValue","value",i):[],n=o.getDomain(this,"closeValue","value",i);return _l([Math.min(...e,...t,...a,...n),Math.max(...t,...e,...a,...n)],this.getValueAxis())}const{index:n,def:r}=o.resolveProcessedDataDefById(this,"xValue"),l=i.domain.keys[n];if("key"===r.type&&"category"===r.valueType)return l;const h=this.getCategoryAxis(),d=null!=(t=El(l))?t:[NaN,NaN],c=Fl(a)?a:0,u=d[0]+-c,p=d[1]+c;return _l([u,p],h)}createBaseNodeData(){const{visible:e,dataModel:t}=this,i=this.getCategoryAxis(),o=this.getValueAxis();if(!(t&&i&&o))return;const{xKey:a,openKey:s,closeKey:n,highKey:r,lowKey:l}=this.properties,h=[],d=["xValue","closeValue","highValue","lowValue"];s&&d.push("openValue");const c=t.resolveProcessedDataDefsByIds(this,d),{barWidth:u,groupIndex:p}=this.updateGroupScale(i),y=Wl.is(i.scale)?-.5*u:0,{groupScale:g,processedData:m}=this,x={itemId:a,nodeData:h,labelData:[],scales:this.calculateScaling(),visible:this.visible};return e?(null==m||m.data.forEach((e=>{let{datum:d,keys:m,values:x}=e;const{xValue:f,openValue:v,closeValue:S,highValue:M,lowValue:D}=t.resolveProcessedDataDefsValues(c,{keys:m,values:x}),b=void 0!==v,N=void 0!==M&&(!b||M>=v)&&M>=S;if(!(void 0!==D&&(!b||D<=v)&&D<=S))return void jl.warnOnce(`invalid low value for key [${l}] in data element, low value cannot be higher than datum open or close values`);if(!N)return void jl.warnOnce(`invalid high value for key [${r}] in data element, high value cannot be lower than datum open or close values.`);const I=Vl({defs:c,values:{xValue:f,openValue:v,closeValue:S,highValue:M,lowValue:D},xAxis:i,yAxis:o});I.xValue+=Math.round(g.convert(String(p)))+y;const k=!b||S>v,T=this.getSeriesItemType(k),[A,O]=b?[I.openValue,I.closeValue]:[I.lowValue,I.highValue],L=Math.min(A,O),E=Math.max(A,O)-L,_={x:I.xValue+Math.round(u)/2,y:L+E/2};h.push({series:this,itemId:T,datum:d,xKey:a,xValue:f,openKey:s,closeKey:n,highKey:r,lowKey:l,openValue:v,closeValue:S,highValue:M,lowValue:D,bandwidth:Math.round(u),scaledValues:I,midPoint:_,aggregatedValue:S})})),x):x}getSeriesItemType(e){return e?"up":"down"}getItemConfig(e){return this.properties.item[e]}getLegendData(e){return[]}getTooltipHtml(e){const{xKey:t,openKey:i,closeKey:a,highKey:s,lowKey:n,xName:r,yName:l,openName:h,closeName:d,highName:c,lowName:u,tooltip:p}=this.properties,{datum:y,itemId:x}=e,f=this.getCategoryAxis(),v=this.getValueAxis();if(!f||!v||!this.properties.isValid())return o._ModuleSupport.EMPTY_TOOLTIP_CONTENT;const S=Ul(l),M=[[t,r,f],[s,c,v],[n,u,v],[a,d,v]];i&&M.splice(1,0,[i,h,v]);const D=M.map((e=>{let[t,i,o]=e;return Ul(`${null!=i?i:(a=t,a.charAt(0).toUpperCase()+a.substring(1))}: ${o.formatDatum(y[t])}`);var a})).join("<br/>"),b=this.getFormattedStyles(e);return p.toTooltipHtml({title:S,content:D,backgroundColor:b.stroke},m(g({seriesId:this.id,datum:y},b),{xKey:t,openKey:null!=i?i:"",closeKey:a,highKey:s,lowKey:n,xName:r,yName:l,openName:h,closeName:d,highName:c,lowName:u,title:S,color:b.fill,fill:b.fill,itemId:x}))}isVertical(){return!0}isLabelEnabled(){return!1}updateDatumSelection(e){return S(this,null,(function*(){var t;const i=null!=(t=e.nodeData)?t:[];return e.datumSelection.update(i)}))}updateDatumNodes(e){return S(this,arguments,(function(e){var t=this;let{datumSelection:i,isHighlight:o}=e;return function*(){i.each(((e,i)=>{const a=t.getActiveStyles(i,o);e.updateDatumStyles(i,a)}))}()}))}updateLabelNodes(e){return S(this,null,(function*(){}))}updateLabelSelection(e){return S(this,null,(function*(){const{labelData:t,labelSelection:i}=e;return i.update(t)}))}getFormattedStyles(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{id:i,ctx:{callbackCache:o}}=this,{xKey:a,openKey:s="",closeKey:n,highKey:r,lowKey:l,formatter:h}=this.properties;if(h){const d=o.call(h,this.getFormatterParams(m(g({},e),{seriesId:i,highlighted:t,xKey:a,openKey:s,closeKey:n,highKey:r,lowKey:l})));if(d)return Bl(d,this.getSeriesStyles(e))}return this.getSeriesStyles(e)}},{BaseProperties:Hl,AbstractBarSeriesProperties:Xl,SeriesTooltip:Ql,Validate:$l,COLOR_STRING:Zl,FUNCTION:ql,LINE_DASH:Jl,OBJECT:eh,POSITIVE_NUMBER:th,RATIO:ih,STRING:oh}=o._ModuleSupport,ah=class extends Hl{};f([$l(Zl,{optional:!0})],ah.prototype,"stroke",2),f([$l(th)],ah.prototype,"strokeWidth",2),f([$l(ih)],ah.prototype,"strokeOpacity",2),f([$l(Jl,{optional:!0})],ah.prototype,"lineDash",2),f([$l(th)],ah.prototype,"lineDashOffset",2);var sh=class extends Hl{constructor(){super(...arguments),this.fill="#c16068",this.fillOpacity=1,this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.wick=new ah}};f([$l(Zl,{optional:!0})],sh.prototype,"fill",2),f([$l(ih)],sh.prototype,"fillOpacity",2),f([$l(Zl)],sh.prototype,"stroke",2),f([$l(th)],sh.prototype,"strokeWidth",2),f([$l(ih)],sh.prototype,"strokeOpacity",2),f([$l(Jl)],sh.prototype,"lineDash",2),f([$l(th)],sh.prototype,"lineDashOffset",2),f([$l(th)],sh.prototype,"cornerRadius",2),f([$l(ql,{optional:!0})],sh.prototype,"formatter",2),f([$l(eh)],sh.prototype,"wick",2);var nh=class extends Hl{constructor(){super(...arguments),this.up=new sh,this.down=new sh}};f([$l(eh)],nh.prototype,"up",2),f([$l(eh)],nh.prototype,"down",2);var rh=class extends Xl{constructor(e,t){super(),this.tooltip=new Ql,this.item=e,this.formatter=t}};f([$l(oh)],rh.prototype,"xKey",2),f([$l(oh)],rh.prototype,"openKey",2),f([$l(oh)],rh.prototype,"closeKey",2),f([$l(oh)],rh.prototype,"highKey",2),f([$l(oh)],rh.prototype,"lowKey",2),f([$l(oh,{optional:!0})],rh.prototype,"xName",2),f([$l(oh,{optional:!0})],rh.prototype,"yName",2),f([$l(oh,{optional:!0})],rh.prototype,"openName",2),f([$l(oh,{optional:!0})],rh.prototype,"closeName",2),f([$l(oh,{optional:!0})],rh.prototype,"highName",2),f([$l(oh,{optional:!0})],rh.prototype,"lowName",2),f([$l(eh)],rh.prototype,"tooltip",2),f([$l(eh)],rh.prototype,"item",2),f([$l(ql,{optional:!0})],rh.prototype,"formatter",2);var lh=class extends rh{constructor(){super(new nh)}};f([$l(oh)],lh.prototype,"openKey",2);var{extractDecoratedProperties:hh,mergeDefaults:dh}=o._ModuleSupport,ch=class extends Gl{constructor(e){super(e,kl),this.properties=new lh}createNodeData(){return S(this,null,(function*(){const e=this.createBaseNodeData();if(!e)return;const t=e.nodeData.map((e=>{const{fill:t,fillOpacity:i,stroke:o,strokeWidth:a,strokeOpacity:s,lineDash:n,lineDashOffset:r,wick:l,cornerRadius:h}=this.getItemConfig(e.itemId);return m(g({},e),{fill:t,fillOpacity:i,stroke:o,strokeWidth:a,strokeOpacity:s,lineDash:n,lineDashOffset:r,wick:l,cornerRadius:h})}));return m(g({},e),{nodeData:t})}))}nodeFactory(){return new bl}getSeriesStyles(e){const{fill:t,fillOpacity:i,stroke:o,strokeWidth:a,strokeOpacity:s,lineDash:n,lineDashOffset:r,wick:l,cornerRadius:h}=e;return{fill:t,fillOpacity:i,stroke:o,strokeWidth:a,strokeOpacity:s,lineDash:n,lineDashOffset:r,wick:hh(l),cornerRadius:h}}getActiveStyles(e,t){let i=this.getFormattedStyles(e,t);t&&(i=dh(this.properties.highlightStyle.item,i));const{stroke:o,strokeWidth:a,strokeOpacity:s,lineDash:n,lineDashOffset:r}=i;return i.wick=dh(i.wick,{stroke:o,strokeWidth:a,strokeOpacity:s,lineDash:n,lineDashOffset:r}),i}getFormatterParams(e){return e}computeFocusBounds(e){return Ol(this,e)}};ch.className="CandleStickSeries",ch.type="candlestick";var uh={series:{__extends__:o._Theme.EXTENDS_SERIES_DEFAULTS,highlightStyle:{item:{strokeWidth:3}},direction:"vertical"},animation:{enabled:!1},axes:{[o._Theme.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{snap:!1}},[o._Theme.CARTESIAN_AXIS_TYPE.ORDINAL_TIME]:{groupPaddingInner:0,crosshair:{enabled:!0}}}},ph={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"candlestick",instanceConstructor:ch,defaultAxes:[{type:o._Theme.CARTESIAN_AXIS_TYPE.NUMBER,position:o._Theme.POSITION.LEFT},{type:o._Theme.CARTESIAN_AXIS_TYPE.ORDINAL_TIME,position:o._Theme.POSITION.BOTTOM}],themeTemplate:uh,groupable:!1,paletteFactory:e=>{let{takeColors:t,colorsCount:i,userPalette:a,themeTemplateParameters:s}=e;const{properties:n}=s,{fills:r,strokes:l}=t(i),{fills:h,strokes:d}=n.get(o._Theme.DEFAULT_COLOURS);return{item:{up:{fill:a?"transparent":h.GREEN,stroke:a?l[0]:d.GREEN},down:{fill:a?r[0]:h.RED,stroke:a?l[0]:d.RED}}}}},{Validate:yh,NUMBER:gh,TEXT_WRAP:mh,OVERFLOW_STRATEGY:xh}=o._ModuleSupport,{Logger:fh}=o._Util,{Text:vh,Label:Sh}=o._Scene,Mh=class extends Sh{constructor(){super(...arguments),this.wrapping="on-space",this.overflowStrategy="ellipsis"}static lineHeight(e){return Math.ceil(e*vh.defaultLineHeightRatio)}};f([yh(mh)],Mh.prototype,"wrapping",2),f([yh(xh)],Mh.prototype,"overflowStrategy",2),f([yh(gh,{optional:!0})],Mh.prototype,"minimumFontSize",2);var Dh=class extends Mh{constructor(){super(...arguments),this.spacing=0}};f([yh(gh)],Dh.prototype,"spacing",2);var bh=class extends Mh{};function Nh(e,t,i){if(e>t)return;let o,a=e,s=t;for(;s>=a;){const e=(s+a)/2|0,t=i(e);null==t?s=e-1:(o=t,a=e+1)}return o}function Ih(e,t,i,o){let{padding:a}=i;var s;const n=2*a,r=Math.min(null!=(s=t.minimumFontSize)?s:t.fontSize,t.fontSize),l=new vh;l.setFont(t);const h={fontFamily:t.fontFamily,fontSize:t.fontSize,fontStyle:t.fontStyle,fontWeight:t.fontWeight};return Nh(r,t.fontSize,(i=>{const a=Dh.lineHeight(i),s=i===r,d=o(a+n,s),c=d.width-n,u=d.height-n;if(a>u)return;h.fontSize=i;const{lines:p}=vh.wrapLines(e,c,u,h,t.wrapping,s?t.overflowStrategy:"hide");if(null==p)return;const y=p.join("\n");l.text=y,l.fontSize=i,l.lineHeight=a;const g=l.computeBBox(),m=l.computeBBox().width,x=a*p.length;return g.width>c||x>u?void 0:[{text:y,fontSize:i,lineHeight:a,width:m,height:x},d.meta]}))}function kh(e){return null!=(null==e?void 0:e.minimumFontSize)&&(null==e?void 0:e.fontSize)&&(null==e?void 0:e.minimumFontSize)>(null==e?void 0:e.fontSize)}function Th(e,t,i,o,a,s){const n=t.enabled?e:void 0,r=o.enabled?i:void 0;let l,h,d;if((kh(t)||kh(o))&&fh.warnOnce("minimumFontSize should be set to a value less than or equal to the font size"),null!=n&&null!=r&&(l=function(e,t,i,o,a,s){let{padding:n}=a;var r,l;const{spacing:h}=t,d=2*n,c=2*n+h,u=(null!=(r=t.minimumFontSize)?r:t.fontSize)+(null!=(l=o.minimumFontSize)?l:o.fontSize);if(u>s(u+c,!1).height-c)return;const p=function(e,t){const{fontSize:i,minimumFontSize:o=i}=e,{fontSize:a,minimumFontSize:s=a}=t,n=i-o,r=a-s;let l=e.fontSize,h=t.fontSize;const d=[{labelFontSize:i,secondaryLabelFontSize:a}];for(;l>o||h>s;)(n>0?(l-o)/n:-1)>(r>0?(h-s)/r:-1)?l--:h--,d.push({labelFontSize:l,secondaryLabelFontSize:h});return d.reverse(),d}(t,o),y=new vh;y.setFont(t);const g={fontFamily:t.fontFamily,fontSize:t.fontSize,fontStyle:t.fontStyle,fontWeight:t.fontWeight},m=new vh;m.setFont(o);const x={fontFamily:o.fontFamily,fontSize:o.fontSize,fontStyle:o.fontStyle,fontWeight:o.fontWeight};let f,v;return Nh(0,p.length-1,(a=>{const{labelFontSize:n,secondaryLabelFontSize:r}=p[a],l=0===a,u=Dh.lineHeight(n),S=bh.lineHeight(r),M=s(u+S+c,l),D=M.width-d,b=M.height-c;if(u+S>b)return;if(null==f||f.fontSize!==n){g.fontSize=n;const{lines:i}=vh.wrapLines(e,D,b,g,t.wrapping,l?t.overflowStrategy:"hide");if(null==i)f=void 0;else{const e=i.join("\n");y.text=e,y.fontSize=n,y.lineHeight=n;const t=y.computeBBox().width,o=i.length*u;f={text:e,fontSize:n,lineHeight:u,width:t,height:o}}}if(null==f||f.width>D||f.height>b)return;if(null==v||v.fontSize!==r){x.fontSize=r;const{lines:e}=vh.wrapLines(i,D,b,x,o.wrapping,l?o.overflowStrategy:"hide");if(null==e)v=void 0;else{const t=e.join("\n");m.text=t,m.fontSize=r,m.lineHeight=S;const i=m.computeBBox().width,o=e.length*S;v={text:t,fontSize:r,lineHeight:S,width:i,height:o}}}if(null==v)return;const N=f.height+v.height;return v.width>D||N>b?void 0:{width:Math.max(f.width,v.width),height:N+h,meta:M.meta,label:f,secondaryLabel:v}}))}(n,t,r,o,a,s)),null==l&&null!=n&&(h=Ih(n,t,a,s)),null!=h){const[e,t]=h;l={width:e.width,height:e.height,meta:t,label:e,secondaryLabel:void 0}}if(null==l&&null==n&&null!=r&&(d=Ih(r,o,a,s)),null!=d){const[e,t]=d;l={width:e.width,height:e.height,meta:t,label:void 0,secondaryLabel:e}}return l}var{CartesianSeriesProperties:Ah,SeriesTooltip:Oh,Validate:Lh,AND:Eh,ARRAY:_h,COLOR_STRING:Rh,COLOR_STRING_ARRAY:Ch,FUNCTION:wh,OBJECT:Ph,POSITIVE_NUMBER:zh,RATIO:Kh,STRING:Vh,TEXT_ALIGN:Bh,VERTICAL_ALIGN:Fh}=o._ModuleSupport,Uh=class extends Ah{constructor(){super(...arguments),this.colorRange=["black","black"],this.stroke="black",this.strokeWidth=0,this.textAlign="center",this.verticalAlign="middle",this.itemPadding=0,this.label=new Dh,this.tooltip=new Oh}};f([Lh(Vh,{optional:!0})],Uh.prototype,"title",2),f([Lh(Vh)],Uh.prototype,"xKey",2),f([Lh(Vh)],Uh.prototype,"yKey",2),f([Lh(Vh,{optional:!0})],Uh.prototype,"colorKey",2),f([Lh(Vh,{optional:!0})],Uh.prototype,"xName",2),f([Lh(Vh,{optional:!0})],Uh.prototype,"yName",2),f([Lh(Vh,{optional:!0})],Uh.prototype,"colorName",2),f([Lh(Eh(Ch,_h.restrict({minLength:1})))],Uh.prototype,"colorRange",2),f([Lh(Rh,{optional:!0})],Uh.prototype,"stroke",2),f([Lh(Kh,{optional:!0})],Uh.prototype,"strokeOpacity",2),f([Lh(zh,{optional:!0})],Uh.prototype,"strokeWidth",2),f([Lh(Bh)],Uh.prototype,"textAlign",2),f([Lh(Fh)],Uh.prototype,"verticalAlign",2),f([Lh(zh)],Uh.prototype,"itemPadding",2),f([Lh(wh,{optional:!0})],Uh.prototype,"formatter",2),f([Lh(Ph)],Uh.prototype,"label",2),f([Lh(Ph)],Uh.prototype,"tooltip",2);var{SeriesNodePickMode:jh,computeBarFocusBounds:Wh,getMissCount:Yh,valueProperty:Gh,ChartAxisDirection:Hh,DEFAULT_CARTESIAN_DIRECTION_KEYS:Xh,DEFAULT_CARTESIAN_DIRECTION_NAMES:Qh}=o._ModuleSupport,{Rect:$h,PointerEvents:Zh}=o._Scene,{ColorScale:qh}=o._Scale,{sanitizeHtml:Jh,Color:ed,Logger:td}=o._Util,id=class extends o._ModuleSupport.CartesianSeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.colorKey=o.properties.colorKey}},od={left:-.5,center:0,right:-.5},ad={top:-.5,middle:0,bottom:-.5},sd=class extends o._ModuleSupport.CartesianSeries{constructor(e){super({moduleCtx:e,directionKeys:Xh,directionNames:Qh,pickModes:[jh.EXACT_SHAPE_MATCH],pathsPerSeries:0,hasMarkers:!1,hasHighlightedLabels:!0}),this.properties=new Uh,this.NodeEvent=id,this.colorScale=new qh,this.seriesItemEnabled=[]}processData(e){return S(this,null,(function*(){var t,i,o;const a=this.axes[Hh.X],s=this.axes[Hh.Y];if(!a||!s||!this.properties.isValid()||!(null==(t=this.data)?void 0:t.length))return;const{xKey:n,yKey:r,colorRange:l,colorKey:h}=this.properties,d=null==(i=this.axes[Hh.X])?void 0:i.scale,c=null==(o=this.axes[Hh.Y])?void 0:o.scale,{xScaleType:u,yScaleType:p}=this.getScaleInformation({xScale:d,yScale:c}),y=this.colorScale.type,{dataModel:g,processedData:m}=yield this.requestDataModel(e,this.data,{props:[Gh(n,u,{id:"xValue"}),Gh(r,p,{id:"yValue"}),...h?[Gh(h,y,{id:"colorValue"})]:[]]});if(this.isColorScaleValid()){const e=g.resolveProcessedDataIndexById(this,"colorValue");this.colorScale.domain=m.domain.values[e],this.colorScale.range=l,this.colorScale.update()}}))}isColorScaleValid(){const{colorKey:e}=this.properties;if(!e)return!1;const{dataModel:t,processedData:i}=this;if(!t||!i)return!1;const o=t.resolveProcessedDataIndexById(this,"colorValue"),a=i.data.length,s=Yh(this,i.defs.values[o].missing);return!(0===a||a===s)}getSeriesDomain(e){const{dataModel:t,processedData:i}=this;return t&&i?e===Hh.X?t.getDomain(this,"xValue","value",i):t.getDomain(this,"yValue","value",i):[]}createNodeData(){return S(this,null,(function*(){var e,t,i,o,a,s,n;const{data:r,visible:l,axes:h,dataModel:d}=this,c=h[Hh.X],u=h[Hh.Y];if(!(r&&d&&l&&c&&u))return;if("category"!==c.type||"category"!==u.type)return void td.warnOnce(`Heatmap series expected axes to have "category" type, but received "${c.type}" and "${u.type}" instead.`);const{xKey:p,xName:y,yKey:g,yName:m,colorKey:x,colorName:f,textAlign:v,verticalAlign:S,itemPadding:M,colorRange:D,label:b}=this.properties,N=d.resolveProcessedDataIndexById(this,"xValue"),I=d.resolveProcessedDataIndexById(this,"yValue"),k=x?d.resolveProcessedDataIndexById(this,"colorValue"):void 0,T=c.scale,A=u.scale,O=(null!=(e=T.bandwidth)?e:0)/2,L=(null!=(t=A.bandwidth)?t:0)/2,E=this.isColorScaleValid(),_=[],R=[],C=null!=(i=T.bandwidth)?i:10,w=null!=(o=A.bandwidth)?o:10,P=(C-2*M)*od[v],z=(w-2*M)*ad[S],K=()=>({width:C,height:w,meta:null}),{seriesItemEnabled:V}=this;V.length=0;for(const{values:B,datum:F}of null!=(s=null==(a=this.processedData)?void 0:a.data)?s:[]){const e=B[N],t=B[I],i=T.convert(e)+O,o=A.convert(t)+L,a=B[null!=k?k:-1],s=E&&null!=a?this.colorScale.convert(a):D[0];V.push(null!=a);const n=Th(null==a?void 0:this.getLabelText(b,{value:a,datum:F,colorKey:x,colorName:f,xKey:p,yKey:g,xName:y,yName:m}),this.properties.label,void 0,this.properties.label,{padding:M},K),r={x:i,y:o,size:0};if(_.push({series:this,itemId:g,yKey:g,xKey:p,xValue:e,yValue:t,colorValue:a,datum:F,point:r,width:C,height:w,fill:s,midPoint:{x:i,y:o}}),null!=(null==n?void 0:n.label)){const{text:e,fontSize:t,lineHeight:i,height:o}=n.label,{fontStyle:a,fontFamily:s,fontWeight:l,color:h}=this.properties.label,d=r.x+P*(C-2*M),c=r.y+z*(w-2*M)-.5*(n.height-o);R.push({series:this,itemId:g,datum:F,text:e,fontSize:t,lineHeight:i,fontStyle:a,fontFamily:s,fontWeight:l,color:h,textAlign:v,verticalAlign:S,x:d,y:c})}}return{itemId:null!=(n=this.properties.yKey)?n:this.id,nodeData:_,labelData:R,scales:this.calculateScaling(),visible:this.visible}}))}nodeFactory(){return new $h}updateDatumSelection(e){return S(this,null,(function*(){const{nodeData:t,datumSelection:i}=e,o=null!=t?t:[];return i.update(o)}))}updateDatumNodes(e){return S(this,null,(function*(){var t;const{isHighlight:i}=e,{id:o,ctx:{callbackCache:a}}=this,{xKey:s,yKey:n,colorKey:r,formatter:l,highlightStyle:{item:{fill:h,stroke:d,strokeWidth:c,strokeOpacity:u,fillOpacity:p}}}=this.properties,y=this.axes[Hh.X],[g,m]=null!=(t=null==y?void 0:y.visibleRange)?t:[],x=!(0!==g||1!==m);e.datumSelection.each(((e,t)=>{var y,g,m,f,v;const{point:S,width:M,height:D}=t,b=i&&void 0!==h?ed.interpolate(t.fill,h)(null!=p?p:1):t.fill,N=i&&void 0!==d?d:this.properties.stroke,I=i&&void 0!==u?u:this.properties.strokeOpacity,k=i&&void 0!==c?c:this.properties.strokeWidth;let T;l&&(T=a.call(l,{datum:t.datum,fill:b,stroke:N,strokeOpacity:I,strokeWidth:k,highlighted:i,xKey:s,yKey:n,colorKey:r,seriesId:o})),e.crisp=x,e.x=Math.floor(S.x-M/2),e.y=Math.floor(S.y-D/2),e.width=Math.ceil(M),e.height=Math.ceil(D),e.fill=null!=(y=null==T?void 0:T.fill)?y:b,e.stroke=null!=(g=null==T?void 0:T.stroke)?g:N,e.strokeOpacity=null!=(f=null!=(m=null==T?void 0:T.strokeOpacity)?m:I)?f:1,e.strokeWidth=null!=(v=null==T?void 0:T.strokeWidth)?v:k}))}))}updateLabelSelection(e){return S(this,null,(function*(){const{labelData:t,labelSelection:i}=e,{enabled:o}=this.properties.label,a=o?t:[];return i.update(a)}))}updateLabelNodes(e){return S(this,null,(function*(){e.labelSelection.each(((e,t)=>{e.text=t.text,e.fontSize=t.fontSize,e.lineHeight=t.lineHeight,e.fontStyle=t.fontStyle,e.fontFamily=t.fontFamily,e.fontWeight=t.fontWeight,e.fill=t.color,e.textAlign=t.textAlign,e.textBaseline=t.verticalAlign,e.x=t.x,e.y=t.y,e.pointerEvents=Zh.None}))}))}getTooltipHtml(e){var t,i,a;const s=this.axes[Hh.X],n=this.axes[Hh.Y];if(!this.properties.isValid()||!s||!n)return o._ModuleSupport.EMPTY_TOOLTIP_CONTENT;const{xKey:r,yKey:l,colorKey:h,xName:d,yName:c,colorName:u,stroke:p,strokeWidth:y,colorRange:g,formatter:m,tooltip:x}=this.properties,{colorScale:f,id:v,ctx:{callbackCache:S}}=this,{datum:M,xValue:D,yValue:b,colorValue:N,itemId:I}=e,k=this.isColorScaleValid()?f.convert(N):g[0];let T;m&&(T=S.call(m,{datum:e,xKey:r,yKey:l,colorKey:h,fill:k,stroke:p,strokeWidth:y,highlighted:!1,seriesId:v}));const A=null!=(i=null!=(t=null==T?void 0:T.fill)?t:k)?i:"gray",O=null!=(a=this.properties.title)?a:c,L=Jh(s.formatDatum(D)),E=Jh(n.formatDatum(b));let _=`<b>${Jh(null!=d?d:r)}</b>: ${L}<br><b>${Jh(null!=c?c:l)}</b>: ${E}`;return h&&(_=`<b>${Jh(null!=u?u:h)}</b>: ${Jh(N)}<br>`+_),x.toTooltipHtml({title:O,content:_,backgroundColor:A},{seriesId:v,datum:M,xKey:r,yKey:l,xName:d,yName:c,title:O,color:A,colorKey:h,colorName:u,itemId:I})}getLegendData(e){var t;return"gradient"===e&&(null==(t=this.data)?void 0:t.length)&&this.properties.isValid()&&this.isColorScaleValid()&&this.dataModel?[{legendType:"gradient",enabled:this.visible,seriesId:this.id,colorName:this.properties.colorName,colorDomain:this.processedData.domain.values[this.dataModel.resolveProcessedDataIndexById(this,"colorValue")],colorRange:this.properties.colorRange}]:[]}isLabelEnabled(){return this.properties.label.enabled&&Boolean(this.properties.colorKey)}getBandScalePadding(){return{inner:0,outer:0}}computeFocusBounds(e){let{datumIndex:t,seriesRect:i}=e;var o;const a=null==(o=this.contextNodeData)?void 0:o.nodeData[t];if(void 0===a)return;const{width:s,height:n,midPoint:r}=a,l={x:r.x-s/2,y:r.y-n/2,width:s,height:n};return Wh(l,this.contentGroup,i)}};sd.className="HeatmapSeries",sd.type="heatmap";var nd={series:{__extends__:o._Theme.EXTENDS_SERIES_DEFAULTS,label:{enabled:!1,color:o._Theme.DEFAULT_LABEL_COLOUR,fontSize:o._Theme.FONT_SIZE.SMALL,fontFamily:o._Theme.DEFAULT_FONT_FAMILY,wrapping:"on-space",overflowStrategy:"ellipsis"},itemPadding:3},gradientLegend:{enabled:!0}},rd={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"heatmap",instanceConstructor:sd,defaultAxes:[{type:o._Theme.CARTESIAN_AXIS_TYPE.CATEGORY,position:o._Theme.POSITION.LEFT},{type:o._Theme.CARTESIAN_AXIS_TYPE.CATEGORY,position:o._Theme.POSITION.BOTTOM}],themeTemplate:nd,paletteFactory:e=>{let{takeColors:t,colorsCount:i,userPalette:a,themeTemplateParameters:s}=e;var n;const{properties:r}=s,l=r.get(o._Theme.DEFAULT_DIVERGING_SERIES_COLOUR_RANGE),h=r.get(o._Theme.DEFAULT_BACKGROUND_COLOUR),d=null!=(n=Array.isArray(h)?h[0]:h)?n:"white",{fills:c,strokes:u}=t(i);return{stroke:a?u[0]:d,colorRange:a?[c[0],c[1]]:l}}},ld={legend:{enabled:!1},gradientLegend:{enabled:!1},tooltip:{range:"exact"}},hd=1e-9;function dd(e,t,i,o){const[a,s]=e,[n,r]=t,l=n-a,h=r-s,d=l*l+h*h;let c,u;if(Math.abs(d)<hd)c=a,u=s;else{let e=((i-a)*l+(o-s)*h)/d;e=Math.max(0,Math.min(1,e)),c=a+e*(n-a),u=s+e*(r-s)}const p=i-c,y=o-u;return p*p+y*y}function cd(e,t,i){let o=1/0,a=e[e.length-1];for(const s of e)o=Math.min(o,dd(a,s,t,i)),a=s;return Math.sqrt(o)}function ud(e){let[t,i]=e[0],o=0;for(let a=1;a<e.length;a+=1){const[s,n]=e[a];o+=Math.hypot(s-t,n-i),t=s,i=n}return o}function pd(e){if(0===e.length)return;const t=ud(e)/2;let[i,o]=e[0],a=0;for(let s=1;s<e.length;s+=1){const[n,r]=e[s],l=Math.hypot(n-i,r-o),h=a+l;if(h>t){const e=(t-a)/l;return{point:[i+(n-i)*e,o+(r-o)*e],angle:Math.atan2(r-o,n-i)}}a=h,i=n,o=r}}var{LonLatBBox:yd}=o._ModuleSupport;function gd(e,t,i,o,a){return null==e?e=new yd(t,i,o,a):(e.lon0=Math.min(e.lon0,t),e.lat0=Math.min(e.lat0,i),e.lon1=Math.max(e.lon1,o),e.lat1=Math.max(e.lat1,a)),e}var md=(e,t,i)=>{let o=e,a=o;for(const s of t)if(null==o||i(o.value,s)>0)o={value:s,next:o},a=o;else{for(;null!=a.next&&i(a.next.value,s)<=0;)a=a.next;a.next={value:s,next:a.next}}return o};function xd(e,t){return e.forEach((e=>{const[i,o]=e;t=gd(t,i,o,i,o)})),t}function fd(e,t,i){let o=!1,a=1/0;for(const s of e){let e=s[s.length-1],[n,r]=e;for(const l of s){const[s,h]=l;h>i!==r>i&&t<(n-s)*(i-h)/(r-h)+s&&(o=!o),a=Math.min(a,dd(e,l,t,i)),e=l,n=s,r=h}}return(o?-1:1)*Math.sqrt(a)}var{Path:vd,ExtendedPath2D:Sd,BBox:Md,ScenePathChangeDetection:Dd}=o._Scene,bd=class extends vd{constructor(){super(...arguments),this.projectedGeometry=void 0,this.renderMode=3,this.strokePath=new Sd}computeBBox(){var e;return(this.dirtyPath||this.isDirtyPath())&&(this.updatePath(),this.dirtyPath=!1),null==(e=this.bbox)?void 0:e.clone()}updatePath(){const{projectedGeometry:e}=this;this.strokePath.clear(),this.path.clear(),this.bbox=null!=e?this.drawGeometry(e,void 0):void 0}drawPath(e){super.drawPath(e),this.renderStroke(e,this.strokePath.getPath2D())}containsPoint(e,t){const{projectedGeometry:i}=this;return null!=i&&(({x:e,y:t}=this.transformPoint(e,t)),!!this.getCachedBBox().containsPoint(e,t)&&this.geometryDistance(i,e,t)<=0)}distanceToPoint(e,t){const{projectedGeometry:i}=this;return({x:e,y:t}=this.transformPoint(e,t)),null!=i?this.geometryDistance(i,e,t):1/0}geometryDistance(e,t,i){const{renderMode:o,strokeWidth:a}=this,s=0!==(1&o),n=0!==(2&o),r=Math.max(a/2,1)+1;switch(e.type){case"GeometryCollection":return e.geometries.reduce(((e,o)=>Math.min(e,this.geometryDistance(o,t,i))),1/0);case"MultiPolygon":return s?e.coordinates.reduce(((e,o)=>Math.min(e,Math.max(fd(o,t,i),0))),1/0):1/0;case"Polygon":return s?Math.max(fd(e.coordinates,t,i),0):1/0;case"MultiLineString":return n?e.coordinates.reduce(((e,o)=>Math.min(e,Math.max(cd(o,t,i)-r,0))),1/0):1/0;case"LineString":return n?Math.max(cd(e.coordinates,t,i)-r,0):1/0;default:return 1/0}}drawGeometry(e,t){const{renderMode:i,path:o,strokePath:a}=this,s=0!==(1&i),n=0!==(2&i);switch(e.type){case"GeometryCollection":e.geometries.forEach((e=>{t=this.drawGeometry(e,t)}));break;case"MultiPolygon":s&&e.coordinates.forEach((e=>{t=this.drawPolygon(o,e,t)}));break;case"Polygon":s&&(t=this.drawPolygon(o,e.coordinates,t));break;case"LineString":n&&(t=this.drawLineString(a,e.coordinates,t,!1));break;case"MultiLineString":n&&e.coordinates.forEach((e=>{t=this.drawLineString(a,e,t,!1)}))}return t}drawPolygon(e,t,i){if(t.length<1)return i;i=this.drawLineString(e,t[0],i,!0);for(let o=1;o<t.length;o+=1){const i=t[o];this.drawLineString(e,i,void 0,!0)}return i}drawLineString(e,t,i,o){if(t.length<2)return i;const a=o?t.length-1:t.length;for(let s=0;s<a;s+=1){const[o,a]=t[s];if(0===s?e.moveTo(o,a):e.lineTo(o,a),null==i)i=new Md(o,a,0,0);else{const{x:e,y:t}=i,s=e+i.width,n=t+i.height;i.x=Math.min(e,o),i.y=Math.min(t,a),i.width=Math.max(s,o)-i.x,i.height=Math.max(n,a)-i.y}}return o&&e.closePath(),i}};function Nd(e,t){if(null!=e.bbox){const[i,o,a,s]=e.bbox;return t=gd(t,i,o,a,s)}switch(e.type){case"GeometryCollection":e.geometries.forEach((e=>{t=Nd(e,t)}));break;case"MultiPolygon":e.coordinates.forEach((e=>{e.length>0&&(t=xd(e[0],t))}));break;case"Polygon":e.coordinates.length>0&&(t=xd(e.coordinates[0],t));break;case"MultiLineString":e.coordinates.forEach((e=>{t=xd(e,t)}));break;case"LineString":t=xd(e.coordinates,t);break;case"MultiPoint":e.coordinates.forEach((e=>{const[i,o]=e;t=gd(t,i,o,i,o)}));break;case"Point":{const[i,o]=e.coordinates;t=gd(t,i,o,i,o);break}}return t}function Id(e){switch(e.type){case"GeometryCollection":{let t,i;return e.geometries.map((e=>{const o=Id(e);if(null==o)return;const a=xd(o[0],void 0);if(null==a)return;const s=Math.abs(a.lat1-a.lat0)*Math.abs(a.lon1-a.lon0);(null==t||s>t)&&(t=s,i=o)})),i}case"MultiPolygon":{let t,i;return e.coordinates.forEach((e=>{const o=xd(e[0],void 0);if(null==o)return;const a=Math.abs(o.lat1-o.lat0)*Math.abs(o.lon1-o.lon0);(null==t||a>t)&&(t=a,i=e)})),i}case"Polygon":return e.coordinates;case"MultiLineString":case"LineString":case"MultiPoint":case"Point":return}}function kd(e){switch(e.type){case"GeometryCollection":{let t,i;return e.geometries.map((e=>{const o=kd(e);if(null==o)return;const a=ud(o);null!=a&&(null==t||a>t)&&(t=a,i=o)})),i}case"MultiLineString":{let t,i=0;return e.coordinates.forEach((e=>{const o=ud(e);o>i&&(i=o,t=e)})),t}case"LineString":return e.coordinates;case"MultiPolygon":case"Polygon":case"MultiPoint":case"Point":return}}function Td(e,t){if(null==e)return!1;switch(e.type){case"GeometryCollection":return e.geometries.some((e=>Td(e,t)));case"MultiPolygon":case"Polygon":return 0!==(1&t);case"MultiLineString":case"LineString":return 0!==(2&t);case"MultiPoint":case"Point":return 0!==(4&t)}}function Ad(e,t){switch(e.type){case"GeometryCollection":return{type:"GeometryCollection",geometries:e.geometries.map((e=>Ad(e,t)))};case"Polygon":return{type:"Polygon",coordinates:Ld(e.coordinates,t)};case"MultiPolygon":return{type:"MultiPolygon",coordinates:Od(e.coordinates,t)};case"MultiLineString":return{type:"MultiLineString",coordinates:Ld(e.coordinates,t)};case"LineString":return{type:"LineString",coordinates:Ed(e.coordinates,t)};case"MultiPoint":return{type:"MultiPoint",coordinates:Ed(e.coordinates,t)};case"Point":return{type:"Point",coordinates:t.convert(e.coordinates)}}}function Od(e,t){return e.map((e=>Ld(e,t)))}function Ld(e,t){return e.map((e=>Ed(e,t)))}function Ed(e,t){return e.map((e=>t.convert(e)))}function _d(e){return Array.isArray(e)&&e.length>=2&&e.every(o._ModuleSupport.isFiniteNumber)}function Rd(e){return Array.isArray(e)&&e.length>=2&&e.every(_d)}f([Dd()],bd.prototype,"projectedGeometry",2),f([Dd()],bd.prototype,"renderMode",2);var Cd=.001;function wd(e){return Math.abs(e[0][0]-e[e.length-1][0])<Cd&&Math.abs(e[0][1]-e[e.length-1][1])<Cd}function Pd(e){return Array.isArray(e)&&e.every(Rd)&&e.every(wd)}function zd(e){if(null===e)return!0;if("object"!==typeof e||null==e.type)return!1;const{type:t,coordinates:i}=e;switch(t){case"GeometryCollection":return Array.isArray(e.geometries)&&e.geometries.every(zd);case"MultiPolygon":return Array.isArray(i)&&i.every(Pd);case"Polygon":return Pd(i);case"MultiLineString":return Array.isArray(i)&&i.every(Rd);case"LineString":case"MultiPoint":return Rd(i);case"Point":return _d(i)}}function Kd(e){return null!==e&&"object"===typeof e&&"Feature"===e.type&&zd(e.geometry)}var Vd=o._ModuleSupport.predicateWithMessage((function(e){return null!==e&&"object"===typeof e&&"FeatureCollection"===e.type&&Array.isArray(e.features)&&e.features.every(Kd)}),"a GeoJSON object"),{COLOR_STRING:Bd,LINE_DASH:Fd,OBJECT:Ud,POSITIVE_NUMBER:jd,RATIO:Wd,Validate:Yd,SeriesProperties:Gd,SeriesTooltip:Hd}=o._ModuleSupport,Xd=class extends Gd{constructor(){super(...arguments),this.topology=void 0,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.tooltip=new Hd}};f([Yd(Vd,{optional:!0})],Xd.prototype,"topology",2),f([Yd(Bd)],Xd.prototype,"stroke",2),f([Yd(Wd)],Xd.prototype,"strokeOpacity",2),f([Yd(jd)],Xd.prototype,"strokeWidth",2),f([Yd(Fd)],Xd.prototype,"lineDash",2),f([Yd(jd)],Xd.prototype,"lineDashOffset",2),f([Yd(Ud)],Xd.prototype,"tooltip",2);var{createDatumId:Qd,DataModelSeries:$d,SeriesNodePickMode:Zd,Validate:qd}=o._ModuleSupport,{Group:Jd,Selection:ec,PointerEvents:tc}=o._Scene,{Logger:ic}=o._Util,oc=class extends $d{constructor(e){super({moduleCtx:e,contentGroupVirtual:!1,useLabelLayer:!0,pickModes:[Zd.EXACT_SHAPE_MATCH]}),this.properties=new Xd,this._chartTopology=void 0,this.itemGroup=this.contentGroup.appendChild(new Jd({name:"itemGroup"})),this.datumSelection=ec.select(this.itemGroup,(()=>this.nodeFactory()))}getNodeData(){var e;return null==(e=this.contextNodeData)?void 0:e.nodeData}get topology(){var e;return null!=(e=this.properties.topology)?e:this._chartTopology}setOptionsData(){}setChartData(){}get hasData(){return!1}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}nodeFactory(){const e=new bd;return e.renderMode=2,e.lineJoin="round",e.lineCap="round",e.pointerEvents=tc.None,e}processData(){return S(this,null,(function*(){const{topology:e}=this;this.topologyBounds=null==e?void 0:e.features.reduce(((e,t)=>{const i=t.geometry;return null==i?e:Nd(i,e)}),void 0),null==e&&ic.warnOnce("no topology was provided for [MapShapeBackgroundSeries]; nothing will be rendered.")}))}createNodeData(){return S(this,null,(function*(){const{id:e,topology:t,scale:i}=this;if(null==t)return;const o=[];return t.features.forEach(((e,t)=>{const{geometry:a}=e,s=null!=a&&null!=i?Ad(a,i):void 0;null!=s&&o.push({series:this,itemId:t,datum:e,index:t,projectedGeometry:s})})),{itemId:e,nodeData:o,labelData:[]}}))}updateSelections(){return S(this,null,(function*(){this.nodeDataRefresh&&(this.contextNodeData=yield this.createNodeData(),this.nodeDataRefresh=!1)}))}update(){return S(this,null,(function*(){var e;const{datumSelection:t}=this;yield this.updateSelections(),this.contentGroup.visible=this.visible;const{nodeData:i=[]}=null!=(e=this.contextNodeData)?e:{};this.datumSelection=yield this.updateDatumSelection({nodeData:i,datumSelection:t}),yield this.updateDatumNodes({datumSelection:t})}))}updateDatumSelection(e){return S(this,null,(function*(){return e.datumSelection.update(e.nodeData,void 0,(e=>Qd(e.index)))}))}updateDatumNodes(e){return S(this,null,(function*(){const{properties:t}=this,{datumSelection:i}=e,{stroke:o,strokeOpacity:a,lineDash:s,lineDashOffset:n}=t,r=this.getStrokeWidth(t.strokeWidth);i.each(((e,t)=>{const{projectedGeometry:i}=t;if(null==i)return e.visible=!1,void(e.projectedGeometry=void 0);e.visible=!0,e.projectedGeometry=i,e.stroke=o,e.strokeWidth=r,e.strokeOpacity=a,e.lineDash=s,e.lineDashOffset=n}))}))}resetAnimation(){}getLabelData(){return[]}getSeriesDomain(){return[NaN,NaN]}getLegendData(){return[]}getTooltipHtml(){return o._ModuleSupport.EMPTY_TOOLTIP_CONTENT}computeFocusBounds(e){}};oc.className="MapLineBackgroundSeries",oc.type="map-line-background",f([qd(Vd,{optional:!0,property:"topology"})],oc.prototype,"_chartTopology",2);var{EXTENDS_SERIES_DEFAULTS:ac,DEFAULT_HIERARCHY_STROKES:sc}=o._Theme,nc={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-line-background",instanceConstructor:oc,themeTemplate:m(g({},ld),{series:{__extends__:ac,strokeWidth:1,lineDash:[0],lineDashOffset:0}}),paletteFactory:e=>{let{themeTemplateParameters:t}=e;var i;const{properties:o}=t;return{stroke:null==(i=o.get(sc))?void 0:i[1]}}};function rc(e,t){var i;const o=null==(i=e.contextNodeData)?void 0:i.nodeData[t.datumIndex];if(void 0!==o)for(const a of e.datumSelection.nodes())if(a.datum===o)return a.computeTransformedBBox()}var{AND:lc,ARRAY:hc,COLOR_STRING:dc,COLOR_STRING_ARRAY:cc,FUNCTION:uc,LINE_DASH:pc,NUMBER_ARRAY:yc,OBJECT:gc,POSITIVE_NUMBER:mc,RATIO:xc,STRING:fc,Validate:vc,SeriesProperties:Sc,SeriesTooltip:Mc}=o._ModuleSupport,{Label:Dc}=o._Scene,bc=class extends Sc{constructor(){super(...arguments),this.topology=void 0,this.idKey="",this.topologyIdKey="name",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.maxStrokeWidth=void 0,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.label=new Dc,this.tooltip=new Mc}};f([vc(Vd,{optional:!0})],bc.prototype,"topology",2),f([vc(fc,{optional:!0})],bc.prototype,"title",2),f([vc(fc,{optional:!0})],bc.prototype,"legendItemName",2),f([vc(fc)],bc.prototype,"idKey",2),f([vc(fc)],bc.prototype,"topologyIdKey",2),f([vc(fc,{optional:!0})],bc.prototype,"idName",2),f([vc(fc,{optional:!0})],bc.prototype,"labelKey",2),f([vc(fc,{optional:!0})],bc.prototype,"labelName",2),f([vc(fc,{optional:!0})],bc.prototype,"sizeKey",2),f([vc(fc,{optional:!0})],bc.prototype,"sizeName",2),f([vc(fc,{optional:!0})],bc.prototype,"colorKey",2),f([vc(fc,{optional:!0})],bc.prototype,"colorName",2),f([vc(yc,{optional:!0})],bc.prototype,"sizeDomain",2),f([vc(lc(cc,hc.restrict({minLength:1})),{optional:!0})],bc.prototype,"colorRange",2),f([vc(mc,{optional:!0})],bc.prototype,"maxStrokeWidth",2),f([vc(dc)],bc.prototype,"stroke",2),f([vc(xc)],bc.prototype,"strokeOpacity",2),f([vc(mc)],bc.prototype,"strokeWidth",2),f([vc(pc)],bc.prototype,"lineDash",2),f([vc(mc)],bc.prototype,"lineDashOffset",2),f([vc(uc,{optional:!0})],bc.prototype,"formatter",2),f([vc(gc)],bc.prototype,"label",2),f([vc(gc)],bc.prototype,"tooltip",2);var{getMissCount:Nc,createDatumId:Ic,DataModelSeries:kc,SeriesNodePickMode:Tc,valueProperty:Ac,Validate:Oc}=o._ModuleSupport,{ColorScale:Lc,LinearScale:Ec}=o._Scale,{Selection:_c,Text:Rc}=o._Scene,{sanitizeHtml:Cc,Logger:wc}=o._Util,Pc=class extends kc{constructor(e){super({moduleCtx:e,contentGroupVirtual:!1,useLabelLayer:!0,pickModes:[Tc.EXACT_SHAPE_MATCH,Tc.NEAREST_NODE]}),this.properties=new bc,this._chartTopology=void 0,this.colorScale=new Lc,this.sizeScale=new Ec,this.datumSelection=_c.select(this.contentGroup,(()=>this.nodeFactory())),this.labelSelection=_c.select(this.labelGroup,Rc),this.highlightDatumSelection=_c.select(this.highlightNode,(()=>this.nodeFactory())),this._previousDatumMidPoint=void 0}getNodeData(){var e;return null==(e=this.contextNodeData)?void 0:e.nodeData}get topology(){var e;return null!=(e=this.properties.topology)?e:this._chartTopology}get hasData(){return super.hasData&&null!=this.topology}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager.addListener("legend-item-click",(e=>{this.onLegendItemClick(e)})),this.ctx.chartEventManager.addListener("legend-item-double-click",(e=>{this.onLegendItemDoubleClick(e)})))}isLabelEnabled(){return null!=this.properties.labelKey&&this.properties.label.enabled}nodeFactory(){const e=new bd;return e.renderMode=2,e.lineJoin="round",e.lineCap="round",e}processData(e){return S(this,null,(function*(){var t,i;if(null==this.data||!this.properties.isValid())return;const{data:o,topology:a,sizeScale:s,colorScale:n}=this,{topologyIdKey:r,idKey:l,sizeKey:h,colorKey:d,labelKey:c,sizeDomain:u,colorRange:p}=this.properties,y=new Map;null==a||a.features.forEach((e=>{var t;const i=null==(t=e.properties)?void 0:t[r];null!=i&&Td(e.geometry,2)&&y.set(i,e)}));const g=this.sizeScale.type,m=this.colorScale.type,x=null==(t=this.scale)?void 0:t.type,{dataModel:f,processedData:v}=yield this.requestDataModel(e,o,{props:[Ac(l,x,{id:"idValue",includeProperty:!1}),Ac(l,x,{id:"featureValue",includeProperty:!1,processor:()=>e=>y.get(e)}),...null!=c?[Ac(c,"band",{id:"labelValue"})]:[],...null!=h?[Ac(h,g,{id:"sizeValue"})]:[],...null!=d?[Ac(d,m,{id:"colorValue"})]:[]]}),S=f.resolveProcessedDataIndexById(this,"featureValue");if(this.topologyBounds=v.data.reduce(((e,t)=>{let{values:i}=t;const o=i[S],a=null==o?void 0:o.geometry;return null==a?e:Nd(a,e)}),void 0),null!=h){const e=f.resolveProcessedDataIndexById(this,"sizeValue"),t=null!=(i=v.domain.values[e])?i:[];s.domain=null!=u?u:t}if(null!=p&&this.isColorScaleValid()){const e=f.resolveProcessedDataIndexById(this,"colorValue");n.domain=v.domain.values[e],n.range=p,n.update()}null==a&&wc.warnOnce("no topology was provided for [MapLineSeries]; nothing will be rendered.")}))}isColorScaleValid(){const{colorKey:e}=this.properties;if(!e)return!1;const{dataModel:t,processedData:i}=this;if(!t||!i)return!1;const o=t.resolveProcessedDataIndexById(this,"colorValue"),a=i.data.length,s=Nc(this,i.defs.values[o].missing);return!(0===a||a===s)}getLabelDatum(e,t,i,o){if(null==t||null==i)return;const a=kd(i);if(null==a)return;const{idKey:s,idName:n,sizeKey:r,sizeName:l,colorKey:h,colorName:d,labelKey:c,labelName:u,label:p}=this.properties,y=this.getLabelText(p,{value:t,datum:e,idKey:s,idName:n,sizeKey:r,sizeName:l,colorKey:h,colorName:d,labelKey:c,labelName:u});if(null==y)return;const g=Rc.getTextSize(String(y),o),m=pd(a);if(null==m)return;const[x,f]=m.point,{width:v,height:S}=g;return{point:{x:x,y:f,size:0},label:{width:v,height:S,text:y},marker:void 0,placement:void 0}}createNodeData(){return S(this,null,(function*(){var e;const{id:t,dataModel:i,processedData:o,sizeScale:a,colorScale:s,properties:n,scale:r}=this,{idKey:l,sizeKey:h,colorKey:d,labelKey:c,label:u}=n;if(null==i||null==o)return;const p=this.isColorScaleValid(),y=i.resolveProcessedDataIndexById(this,"idValue"),g=i.resolveProcessedDataIndexById(this,"featureValue"),m=null!=c?i.resolveProcessedDataIndexById(this,"labelValue"):void 0,x=null!=h?i.resolveProcessedDataIndexById(this,"sizeValue"):void 0,f=null!=d?i.resolveProcessedDataIndexById(this,"colorValue"):void 0,v=null!=(e=n.maxStrokeWidth)?e:n.strokeWidth;a.range=[Math.min(n.strokeWidth,v),v];const S=u.getFont(),M=new Map;o.data.forEach((e=>{let{values:t}=e;var i;const o=t[y],a=null==(i=t[g])?void 0:i.geometry,s=null!=a&&null!=r?Ad(a,r):void 0;null!=o&&null!=s&&M.set(o,s)}));const D=[],b=[],N=[];o.data.forEach((e=>{let{datum:t,values:i}=e;const o=i[y],n=null!=f?i[f]:void 0,r=null!=x?i[x]:void 0,h=null!=m?i[m]:void 0,d=p&&null!=n?s.convert(n):void 0,c=null!=r?a.convert(r,{clampMode:"clamped"}):void 0,u=M.get(o);null==u&&N.push(o);const g=this.getLabelDatum(t,h,u,S);null!=g&&b.push(g),D.push({series:this,itemId:l,datum:t,stroke:d,strokeWidth:c,idValue:o,labelValue:h,colorValue:n,sizeValue:r,projectedGeometry:u})}));if(N.length>10){const e=N.length-10;N.length=10,N.push(`(+${e} more)`)}return N.length>0&&wc.warnOnce("some data items do not have matches in the provided topology",N),{itemId:t,nodeData:D,labelData:b}}))}updateSelections(){return S(this,null,(function*(){this.nodeDataRefresh&&(this.contextNodeData=yield this.createNodeData(),this.nodeDataRefresh=!1)}))}update(){return S(this,null,(function*(){var e,t,i;const{datumSelection:o,labelSelection:a,highlightDatumSelection:s}=this;yield this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let n=null==(e=this.ctx.highlightManager)?void 0:e.getActiveHighlight();null==n||n.series===this&&null!=n.datum||(n=void 0);const r=null!=(i=null==(t=this.contextNodeData)?void 0:t.nodeData)?i:[];this.datumSelection=yield this.updateDatumSelection({nodeData:r,datumSelection:o}),yield this.updateDatumNodes({datumSelection:o,isHighlight:!1}),this.labelSelection=yield this.updateLabelSelection({labelSelection:a}),yield this.updateLabelNodes({labelSelection:a}),this.highlightDatumSelection=yield this.updateDatumSelection({nodeData:null!=n?[n]:[],datumSelection:s}),yield this.updateDatumNodes({datumSelection:s,isHighlight:!0})}))}updateDatumSelection(e){return S(this,null,(function*(){return e.datumSelection.update(e.nodeData,void 0,(e=>Ic(e.idValue)))}))}updateDatumNodes(e){return S(this,null,(function*(){const{id:t,properties:i,ctx:{callbackCache:o}}=this,{datumSelection:a,isHighlight:s}=e,{idKey:n,labelKey:r,sizeKey:l,colorKey:h,stroke:d,strokeOpacity:c,lineDash:u,lineDashOffset:p,formatter:y}=i,g=s?i.highlightStyle.item:void 0,m=this.getStrokeWidth(i.strokeWidth);a.each(((e,i)=>{var a,x,f,v,S,M,D,b,N,I,k,T;const{projectedGeometry:A}=i;if(null==A)return e.visible=!1,void(e.projectedGeometry=void 0);let O;if(null!=y){const e={seriesId:t,datum:i.datum,itemId:i.itemId,idKey:n,labelKey:r,sizeKey:l,colorKey:h,strokeOpacity:c,stroke:d,strokeWidth:m,lineDash:u,lineDashOffset:p,highlighted:s};O=o.call(y,e)}e.visible=!0,e.projectedGeometry=A,e.stroke=null!=(f=null!=(x=null!=(a=null==g?void 0:g.stroke)?a:null==O?void 0:O.stroke)?x:i.stroke)?f:d,e.strokeWidth=Math.max(null!=(v=null==g?void 0:g.strokeWidth)?v:0,null!=(M=null!=(S=null==O?void 0:O.strokeWidth)?S:i.strokeWidth)?M:m),e.strokeOpacity=null!=(b=null!=(D=null==g?void 0:g.strokeOpacity)?D:null==O?void 0:O.strokeOpacity)?b:c,e.lineDash=null!=(I=null!=(N=null==g?void 0:g.lineDash)?N:null==O?void 0:O.lineDash)?I:u,e.lineDashOffset=null!=(T=null!=(k=null==g?void 0:g.lineDashOffset)?k:null==O?void 0:O.lineDashOffset)?T:p}))}))}updateLabelSelection(e){return S(this,null,(function*(){var t,i;const o=null!=(i=this.isLabelEnabled()?null==(t=this.chart)?void 0:t.placeLabels().get(this):void 0)?i:[];return e.labelSelection.update(o)}))}updateLabelNodes(e){return S(this,null,(function*(){const{labelSelection:t}=e,{color:i,fontStyle:o,fontWeight:a,fontSize:s,fontFamily:n}=this.properties.label;t.each(((e,t)=>{let{x:r,y:l,width:h,height:d,text:c}=t;e.visible=!0,e.x=r+h/2,e.y=l+d/2,e.text=c,e.fill=i,e.fontStyle=o,e.fontWeight=a,e.fontSize=s,e.fontFamily=n,e.textAlign="center",e.textBaseline="middle"}))}))}onLegendItemClick(e){const{legendItemName:t}=this.properties,{enabled:i,itemId:o,series:a}=e,s=null!=t&&t===e.legendItemName;(a.id===this.id||s)&&this.toggleSeriesItem(o,i)}onLegendItemDoubleClick(e){const{enabled:t,itemId:i,series:o,numVisibleItems:a}=e,{legendItemName:s}=this.properties,n=null!=s&&s===e.legendItemName;o.id===this.id||n||t&&1===a?this.toggleSeriesItem(i,!0):this.toggleSeriesItem(i,!1)}resetAnimation(){}getLabelData(){var e,t;return null!=(t=null==(e=this.contextNodeData)?void 0:e.labelData)?t:[]}getSeriesDomain(){return[NaN,NaN]}pickNodeClosestDatum(e){let t,{x:i,y:o}=e,a=1/0;return this.datumSelection.each(((e,s)=>{const n=e.distanceToPoint(i,o);n<a&&(a=n,t=s)})),null!=t?{datum:t,distance:a}:void 0}datumMidPoint(e){var t;const{_previousDatumMidPoint:i}=this;if((null==i?void 0:i.datum)===e)return i.point;const o=e.projectedGeometry,a=null!=o?kd(o):void 0,s=null!=a?null==(t=pd(a))?void 0:t.point:void 0,n=null!=s?{x:s[0],y:s[1]}:void 0;return this._previousDatumMidPoint={datum:e,point:n},n}getLegendData(e){var t,i,o,a;const{processedData:s,dataModel:n}=this;if(null==s||null==n)return[];const{title:r,legendItemName:l,idKey:h,idName:d,colorKey:c,colorName:u,colorRange:p,stroke:y,strokeWidth:g,strokeOpacity:m,lineDash:x,visible:f}=this.properties;if("gradient"===e&&null!=c&&null!=p){const e=s.domain.values[n.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:f,seriesId:this.id,colorName:u,colorRange:p,colorDomain:e}]}if("category"===e){return[{legendType:"category",id:this.id,itemId:null!=(i=null!=(t=null!=l?l:r)?t:d)?i:h,seriesId:this.id,enabled:f,label:{text:null!=(a=null!=(o=null!=l?l:r)?o:d)?a:h},marker:{fill:y,fillOpacity:m,stroke:void 0,strokeWidth:0,strokeOpacity:0,enabled:!1},line:{stroke:y,strokeOpacity:m,strokeWidth:g,lineDash:x},legendItemName:l}]}return[]}getTooltipHtml(e){var t,i,a,s,n;const{id:r,processedData:l,properties:h,ctx:{callbackCache:d}}=this;if(!l||!h.isValid())return o._ModuleSupport.EMPTY_TOOLTIP_CONTENT;const{legendItemName:c,idKey:u,idName:p,colorKey:y,colorName:m,sizeKey:x,sizeName:f,labelKey:v,labelName:S,formatter:M,tooltip:D}=h,{datum:b,stroke:N,idValue:I,colorValue:k,sizeValue:T,labelValue:A,itemId:O}=e,L=null!=(i=Cc(null!=(t=h.title)?t:c))?i:"",E=[];E.push(Cc((null!=p?`${p}: `:"")+I)),null!=k&&E.push(Cc((null!=m?m:y)+": "+k)),null!=T&&E.push(Cc((null!=f?f:x)+": "+T)),null!=A&&v!==u&&E.push(Cc((null!=S?S:v)+": "+A));const _=E.join("<br>");let R;M&&(R=d.call(M,{seriesId:r,datum:b,idKey:u,stroke:N,strokeWidth:this.getStrokeWidth(null!=(a=e.strokeWidth)?a:h.strokeWidth),highlighted:!1}));const C=null!=(n=null!=(s=null==R?void 0:R.stroke)?s:N)?n:h.stroke;return D.toTooltipHtml({title:L,content:_,backgroundColor:C},g({seriesId:r,datum:b,idKey:u,title:L,color:C,itemId:O,sizeKey:x,colorKey:y,colorName:m,idName:p,labelKey:v,labelName:S,sizeName:f},this.getModuleTooltipParams()))}computeFocusBounds(e){return rc(this,e)}};Pc.className="MapLineSeries",Pc.type="map-line",f([Oc(Vd,{optional:!0,property:"topology"})],Pc.prototype,"_chartTopology",2);var{DEFAULT_DIVERGING_SERIES_COLOUR_RANGE:zc,EXTENDS_SERIES_DEFAULTS:Kc,DEFAULT_FONT_FAMILY:Vc,DEFAULT_LABEL_COLOUR:Bc,singleSeriesPaletteFactory:Fc}=o._Theme,Uc={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-line",instanceConstructor:Pc,themeTemplate:m(g({},ld),{series:{__extends__:Kc,strokeWidth:1,maxStrokeWidth:3,lineDash:[0],lineDashOffset:0,label:{enabled:!0,fontStyle:void 0,fontWeight:void 0,fontSize:12,fontFamily:Vc,color:Bc}}}),paletteFactory:e=>{const{takeColors:t,colorsCount:i,userPalette:o,themeTemplateParameters:a}=e,{fill:s}=Fc(e),{properties:n}=a,r=n.get(zc),{fills:l}=t(i);return{colorRange:o?[l[0],l[1]]:r,stroke:s}}};function jc(e,t,i){const o=xd(e[0],void 0);if(null==o)return;const a=(o.lon0+o.lon1)/2,s=(o.lat0+o.lat1)/2,n=Math.abs(o.lon1-o.lon0),r=Math.abs(o.lat1-o.lat0),l=function(e){if(0===e.length)return;let t=0,i=0,o=0,[a,s]=e[e.length-1];for(const[n,r]of e){const e=a*r-n*s;o+=e,t+=(a+n)*e,i+=(s+r)*e,a=n,s=r}return o*=3,[t/o,i/o]}(e[0]),[h,d]=l,c=-fd(e,h,d);let u;const p=(e,t)=>e-.5*Math.max(t-c,0),y=(t,o,a)=>{const{distance:s,maxDistance:n}=i(e,t,o,a),r=Math.hypot(h-t,d-o),l=Math.min(Math.max(h,t-a/2),t+a/2),c=Math.min(Math.max(d,o-a/2),o+a/2),u=Math.hypot(h-l,d-c);return{distance:s,maxDistance:n,value:p(s,r),maxValue:p(n,u),x:t,y:o,stride:a}},g=(e,t,i,o)=>{const a=y(t,i,o);a.maxDistance>=0&&e.push(a)},m=Math.min(n,r)/2;let x={value:y(a,s,m),next:null};for(;null!=x;){const e=x.value,{distance:i,value:o,maxValue:a,x:s,y:n,stride:r}=e;if(x=x.next,i>0&&(null==u||o>u.value)&&(u=e),null!=u&&a-u.value<=t)continue;const l=r/2,h=[];g(h,s-l,n-l,l),g(h,s+l,n-l,l),g(h,s-l,n+l,l),g(h,s+l,n+l,l),h.sort(Wc),x=md(x,h,Wc)}if(null==u)return;const{distance:f,x:v,y:S}=u;return{x:v,y:S,distance:f}}var Wc=(e,t)=>t.maxValue-e.maxValue;function Yc(e,t){const i=jc(e,t,((e,t,i,o)=>{const a=-fd(e,t,i);return{distance:a,maxDistance:a+o*Math.SQRT2}}));if(null==i)return;const{x:o,y:a}=i;return[o,a]}function Gc(e,t){var i,o;let a;switch(e.type){case"GeometryCollection":return e.geometries.flatMap((e=>Gc(e,t)));case"MultiPoint":return e.coordinates;case"Point":return[e.coordinates];case"MultiPolygon":{const i=Id(e);a=null!=i?Yc(i,t):void 0;break}case"Polygon":{const i=e.coordinates;a=null!=i?Yc(i,t):void 0;break}case"MultiLineString":{const t=kd(e);a=null!=t?null==(i=pd(t))?void 0:i.point:void 0;break}case"LineString":a=null==(o=pd(e.coordinates))?void 0:o.point;break}return null!=a?[a]:[]}var{AND:Hc,ARRAY:Xc,COLOR_STRING:Qc,COLOR_STRING_ARRAY:$c,FUNCTION:Zc,NUMBER_ARRAY:qc,OBJECT:Jc,POSITIVE_NUMBER:eu,RATIO:tu,STRING:iu,MARKER_SHAPE:ou,Validate:au,SeriesProperties:su,SeriesTooltip:nu}=o._ModuleSupport,{Label:ru,Circle:lu}=o._Scene,{Logger:hu}=o._Util,du=class extends ru{constructor(){super(...arguments),this.placement="bottom"}};f([au(iu)],du.prototype,"placement",2);var cu=class extends su{constructor(){super(...arguments),this.topology=void 0,this.idKey=void 0,this.topologyIdKey="name",this.idName=void 0,this.latitudeKey=void 0,this.latitudeName=void 0,this.longitudeKey=void 0,this.longitudeName=void 0,this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.shape=lu,this.size=6,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.label=new du,this.tooltip=new nu}isValid(){const e=super.isValid(),t=null!=this.idKey,i=null!=this.latitudeKey&&null!=this.longitudeKey;return t||i?e:(hu.warnOnce("Either both [topology] and [idKey] or both [latitudeKey] and [longitudeKey] must be set to render a map marker series."),!1)}};f([au(Vd,{optional:!0})],cu.prototype,"topology",2),f([au(iu,{optional:!0})],cu.prototype,"title",2),f([au(iu,{optional:!0})],cu.prototype,"legendItemName",2),f([au(iu,{optional:!0})],cu.prototype,"idKey",2),f([au(iu)],cu.prototype,"topologyIdKey",2),f([au(iu,{optional:!0})],cu.prototype,"idName",2),f([au(iu,{optional:!0})],cu.prototype,"latitudeKey",2),f([au(iu,{optional:!0})],cu.prototype,"latitudeName",2),f([au(iu,{optional:!0})],cu.prototype,"longitudeKey",2),f([au(iu,{optional:!0})],cu.prototype,"longitudeName",2),f([au(iu,{optional:!0})],cu.prototype,"labelKey",2),f([au(iu,{optional:!0})],cu.prototype,"labelName",2),f([au(iu,{optional:!0})],cu.prototype,"sizeKey",2),f([au(iu,{optional:!0})],cu.prototype,"sizeName",2),f([au(iu,{optional:!0})],cu.prototype,"colorKey",2),f([au(iu,{optional:!0})],cu.prototype,"colorName",2),f([au(Hc($c,Xc.restrict({minLength:1})),{optional:!0})],cu.prototype,"colorRange",2),f([au(ou)],cu.prototype,"shape",2),f([au(eu)],cu.prototype,"size",2),f([au(eu,{optional:!0})],cu.prototype,"maxSize",2),f([au(qc,{optional:!0})],cu.prototype,"sizeDomain",2),f([au(Qc,{optional:!0})],cu.prototype,"fill",2),f([au(tu)],cu.prototype,"fillOpacity",2),f([au(Qc,{optional:!0})],cu.prototype,"stroke",2),f([au(eu)],cu.prototype,"strokeWidth",2),f([au(tu)],cu.prototype,"strokeOpacity",2),f([au(Zc,{optional:!0})],cu.prototype,"formatter",2),f([au(Jc)],cu.prototype,"label",2),f([au(Jc)],cu.prototype,"tooltip",2);var{Validate:uu,fromToMotion:pu,StateMachine:yu,getMissCount:gu,createDatumId:mu,DataModelSeries:xu,SeriesNodePickMode:fu,Layers:vu,valueProperty:Su,computeMarkerFocusBounds:Mu}=o._ModuleSupport,{ColorScale:Du,LinearScale:bu}=o._Scale,{Group:Nu,Selection:Iu,Text:ku,getMarker:Tu}=o._Scene,{sanitizeHtml:Au,Logger:Ou}=o._Util,Lu=class extends xu{constructor(e){super({moduleCtx:e,contentGroupVirtual:!0,useLabelLayer:!0,pickModes:[fu.EXACT_SHAPE_MATCH,fu.NEAREST_NODE]}),this.properties=new cu,this._chartTopology=void 0,this.colorScale=new Du,this.sizeScale=new bu,this.markerGroup=this.contentGroup.appendChild(new Nu({name:"markerGroup",layer:!0,isVirtual:!1,zIndex:vu.SERIES_LAYER_ZINDEX,zIndexSubOrder:this.getGroupZIndexSubOrder("marker")})),this.labelSelection=Iu.select(this.labelGroup,ku,!1),this.markerSelection=Iu.select(this.markerGroup,(()=>this.markerFactory()),!1),this.highlightMarkerSelection=Iu.select(this.highlightNode,(()=>this.markerFactory())),this.animationState=new yu("empty",{empty:{update:{target:"ready",action:()=>this.animateMarkers()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.resetAllAnimation(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateMarkers()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:()=>this.resetAllAnimation()},reset:"empty",skip:"ready"}},(()=>this.checkProcessedDataAnimatable()))}getNodeData(){var e;return null==(e=this.contextNodeData)?void 0:e.nodeData}get topology(){var e;return null!=(e=this.properties.topology)?e:this._chartTopology}get hasData(){const e=null!=this.properties.latitudeKey&&null!=this.properties.longitudeKey;return super.hasData&&(null!=this.topology||e)}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager.addListener("legend-item-click",(e=>{this.onLegendItemClick(e)})),this.ctx.chartEventManager.addListener("legend-item-double-click",(e=>{this.onLegendItemDoubleClick(e)})))}isLabelEnabled(){return null!=this.properties.labelKey&&this.properties.label.enabled}markerFactory(){const{shape:e}=this.properties;return new(Tu(e))}processData(e){return S(this,null,(function*(){var t,i;if(null==this.data||!this.properties.isValid())return;const{data:o,topology:a,sizeScale:s,colorScale:n}=this,{topologyIdKey:r,idKey:l,latitudeKey:h,longitudeKey:d,sizeKey:c,colorKey:u,labelKey:p,sizeDomain:y,colorRange:g}=this.properties,m=new Map;null==a||a.features.forEach((e=>{var t;const i=null==(t=e.properties)?void 0:t[r];null!=i&&m.set(i,e)}));const x=this.sizeScale.type,f=this.colorScale.type,v=null==(t=this.scale)?void 0:t.type,S=null!=h&&null!=d,{dataModel:M,processedData:D}=yield this.requestDataModel(e,o,{props:[...null!=l?[Su(l,v,{id:"idValue",includeProperty:!1}),Su(l,v,{id:"featureValue",includeProperty:!1,processor:()=>e=>m.get(e)})]:[],...S?[Su(h,v,{id:"latValue"}),Su(d,v,{id:"lonValue"})]:[],...p?[Su(p,"band",{id:"labelValue"})]:[],...c?[Su(c,x,{id:"sizeValue"})]:[],...u?[Su(u,f,{id:"colorValue"})]:[]]}),b=null!=l?M.resolveProcessedDataIndexById(this,"featureValue"):void 0,N=S?M.resolveProcessedDataIndexById(this,"latValue"):void 0,I=S?M.resolveProcessedDataIndexById(this,"lonValue"):void 0;if(this.topologyBounds=D.data.reduce(((e,t)=>{let{values:i}=t;const o=null!=b?i[b]:void 0,a=null==o?void 0:o.geometry;if(null!=a&&(e=Nd(a,e)),null!=N&&null!=I){const t=i[I],o=i[N];e=gd(e,t,o,t,o)}return e}),void 0),null!=c){const e=M.resolveProcessedDataIndexById(this,"sizeValue"),t=null!=(i=D.domain.values[e])?i:[];s.domain=null!=y?y:t}if(null!=g&&this.isColorScaleValid()){const e=M.resolveProcessedDataIndexById(this,"colorValue");n.domain=D.domain.values[e],n.range=g,n.update()}this.animationState.transition("updateData")}))}isColorScaleValid(){const{colorKey:e}=this.properties;if(!e)return!1;const{dataModel:t,processedData:i}=this;if(!t||!i)return!1;const o=t.resolveProcessedDataIndexById(this,"colorValue"),a=i.data.length,s=gu(this,i.defs.values[o].missing);return!(0===a||a===s)}getLabelDatum(e,t,i,o,a,s){if(null==t)return;const{idKey:n,idName:r,latitudeKey:l,latitudeName:h,longitudeKey:d,longitudeName:c,sizeKey:u,sizeName:p,colorKey:y,colorName:g,labelKey:m,labelName:x,label:f}=this.properties,{placement:v}=f,S=this.getLabelText(f,{value:t,datum:e,idKey:n,idName:r,latitudeKey:l,latitudeName:h,longitudeKey:d,longitudeName:c,sizeKey:u,sizeName:p,colorKey:y,colorName:g,labelKey:m,labelName:x});if(null==S)return;const{width:M,height:D}=ku.getTextSize(String(S),s);return{point:{x:i,y:o,size:a},label:{width:M,height:D,text:S},marker:Tu(this.properties.shape),placement:v}}createNodeData(){return S(this,null,(function*(){var e;const{id:t,dataModel:i,processedData:o,colorScale:a,sizeScale:s,properties:n,scale:r}=this,{idKey:l,latitudeKey:h,longitudeKey:d,sizeKey:c,colorKey:u,labelKey:p,label:y}=n;if(null==i||null==o||null==r)return;const g=this.isColorScaleValid(),m=null!=h&&null!=d,x=null!=l?i.resolveProcessedDataIndexById(this,"idValue"):void 0,f=null!=l?i.resolveProcessedDataIndexById(this,"featureValue"):void 0,v=m?i.resolveProcessedDataIndexById(this,"latValue"):void 0,S=m?i.resolveProcessedDataIndexById(this,"lonValue"):void 0,M=null!=p?i.resolveProcessedDataIndexById(this,"labelValue"):void 0,D=null!=c?i.resolveProcessedDataIndexById(this,"sizeValue"):void 0,b=null!=u?i.resolveProcessedDataIndexById(this,"colorValue"):void 0,N=null!=(e=n.maxSize)?e:n.size;s.range=[Math.min(n.size,N),N];const I=y.getFont();let k;null!=x&&null!=f&&(k=new Map,o.data.forEach((e=>{let{values:t}=e;var i;const o=t[x],a=null==(i=t[f])?void 0:i.geometry,s=null!=a&&null!=r?Ad(a,r):void 0;null!=o&&null!=s&&k.set(o,s)})));const T=[],A=[],O=[];o.data.forEach((e=>{let{datum:t,values:i}=e;const o=null!=x?i[x]:void 0,l=null!=S?i[S]:void 0,d=null!=v?i[v]:void 0,c=null!=b?i[b]:void 0,u=null!=D?i[D]:void 0,p=null!=M?i[M]:void 0,y=g&&null!=c?a.convert(c):void 0,m=null!=u?s.convert(u,{clampMode:"clamped"}):n.size,f=null!=o?null==k?void 0:k.get(o):void 0;if(null!=o&&null==Ad&&O.push(o),null!=l&&null!=d){const[e,i]=r.convert([l,d]),a=this.getLabelDatum(t,p,e,i,m,I);a&&A.push(a),T.push({series:this,itemId:h,datum:t,index:-1,fill:y,idValue:o,lonValue:l,latValue:d,labelValue:p,sizeValue:u,colorValue:c,point:{x:e,y:i,size:m},midPoint:{x:e,y:i}})}else null!=f&&Gc(f,1).forEach(((e,i)=>{let[a,s]=e;const n=this.getLabelDatum(t,p,a,s,m,I);n&&A.push(n),T.push({series:this,itemId:h,datum:t,index:i,fill:y,idValue:o,lonValue:l,latValue:d,labelValue:p,sizeValue:u,colorValue:c,point:{x:a,y:s,size:m},midPoint:{x:a,y:s}})}))}));if(O.length>10){const e=O.length-10;O.length=10,O.push(`(+${e} more)`)}return O.length>0&&Ou.warnOnce("some data items do not have matches in the provided topology",O),{itemId:t,nodeData:T,labelData:A}}))}updateSelections(){return S(this,null,(function*(){this.nodeDataRefresh&&(this.contextNodeData=yield this.createNodeData(),this.nodeDataRefresh=!1)}))}update(e){return S(this,arguments,(function(e){var t=this;let{seriesRect:i}=e;return function*(){var e,o,a;const{labelSelection:s,markerSelection:n,highlightMarkerSelection:r}=t;yield t.updateSelections(),t.contentGroup.visible=t.visible,t.contentGroup.opacity=t.getOpacity();let l=null==(e=t.ctx.highlightManager)?void 0:e.getActiveHighlight();null==l||l.series===t&&null!=l.datum||(l=void 0);const h=null!=(a=null==(o=t.contextNodeData)?void 0:o.nodeData)?a:[];t.labelSelection=yield t.updateLabelSelection({labelSelection:s}),yield t.updateLabelNodes({labelSelection:s}),t.markerSelection=yield t.updateMarkerSelection({markerData:h,markerSelection:n}),yield t.updateMarkerNodes({markerSelection:n,isHighlight:!1,highlightedDatum:l}),t.highlightMarkerSelection=yield t.updateMarkerSelection({markerData:null!=l?[l]:[],markerSelection:r}),yield t.updateMarkerNodes({markerSelection:r,isHighlight:!0,highlightedDatum:l});t.checkResize(i)&&t.animationState.transition("resize"),t.animationState.transition("update")}()}))}updateLabelSelection(e){return S(this,null,(function*(){var t,i;const o=null!=(i=this.isLabelEnabled()?null==(t=this.chart)?void 0:t.placeLabels().get(this):void 0)?i:[];return e.labelSelection.update(o)}))}updateLabelNodes(e){return S(this,null,(function*(){const{labelSelection:t}=e,{color:i,fontStyle:o,fontWeight:a,fontSize:s,fontFamily:n}=this.properties.label;t.each(((e,t)=>{let{x:r,y:l,width:h,height:d,text:c}=t;e.visible=!0,e.x=r+h/2,e.y=l+d/2,e.text=c,e.fill=i,e.fontStyle=o,e.fontWeight=a,e.fontSize=s,e.fontFamily=n,e.textAlign="center",e.textBaseline="middle"}))}))}updateMarkerSelection(e){return S(this,null,(function*(){const{markerData:t,markerSelection:i}=e;return i.update(t,void 0,(e=>mu([e.index,e.idValue,e.lonValue,e.latValue])))}))}updateMarkerNodes(e){return S(this,null,(function*(){const{id:t,properties:i,ctx:{callbackCache:o}}=this,{markerSelection:a,isHighlight:s,highlightedDatum:n}=e,{idKey:r,latitudeKey:l,longitudeKey:h,labelKey:d,sizeKey:c,colorKey:u,fill:p,fillOpacity:y,stroke:g,strokeOpacity:m,formatter:x}=i,f=s?i.highlightStyle.item:void 0,v=this.getStrokeWidth(i.strokeWidth);a.each(((e,i)=>{var a,S,M,D,b,N,I,k,T,A,O;const{datum:L,point:E}=i;let _;if(null!=x){const e={seriesId:t,datum:i.datum,itemId:i.itemId,size:E.size,idKey:r,latitudeKey:l,longitudeKey:h,labelKey:d,sizeKey:c,colorKey:u,fill:p,fillOpacity:y,stroke:g,strokeWidth:v,strokeOpacity:m,highlighted:s};_=o.call(x,e)}e.size=E.size,e.fill=null!=(M=null!=(S=null!=(a=null==f?void 0:f.fill)?a:null==_?void 0:_.fill)?S:i.fill)?M:p,e.fillOpacity=null!=(b=null!=(D=null==f?void 0:f.fillOpacity)?D:null==_?void 0:_.fillOpacity)?b:y,e.stroke=null!=(I=null!=(N=null==f?void 0:f.stroke)?N:null==_?void 0:_.stroke)?I:g,e.strokeWidth=null!=(T=null!=(k=null==f?void 0:f.strokeWidth)?k:null==_?void 0:_.strokeWidth)?T:v,e.strokeOpacity=null!=(O=null!=(A=null==f?void 0:f.strokeOpacity)?A:null==_?void 0:_.strokeOpacity)?O:m,e.translationX=E.x,e.translationY=E.y,e.zIndex=s||null==n||L!==n.datum?0:1}))}))}onLegendItemClick(e){const{legendItemName:t}=this.properties,{enabled:i,itemId:o,series:a}=e,s=null!=t&&t===e.legendItemName;(a.id===this.id||s)&&this.toggleSeriesItem(o,i)}onLegendItemDoubleClick(e){const{enabled:t,itemId:i,series:o,numVisibleItems:a}=e,{legendItemName:s}=this.properties,n=null!=s&&s===e.legendItemName;o.id===this.id||n||t&&1===a?this.toggleSeriesItem(i,!0):this.toggleSeriesItem(i,!1)}isProcessedDataAnimatable(){return!0}resetAnimation(e){"initial"===e?this.animationState.transition("reset"):"ready"===e&&this.animationState.transition("skip")}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),this.ctx.animationManager.skipCurrentBatch(),this.labelSelection.cleanup(),this.markerSelection.cleanup(),this.highlightMarkerSelection.cleanup()}animateMarkers(){const{animationManager:e}=this.ctx,t={fromFn:(e,t,i)=>"removed"===i?{scalingX:1,scalingY:1}:null==e.previousDatum?{scalingX:0,scalingY:0}:{scalingX:e.scalingX,scalingY:e.scalingY},toFn:(e,t,i)=>"removed"===i?{scalingX:0,scalingY:0}:{scalingX:1,scalingY:1}};pu(this.id,"markers",e,[this.markerSelection,this.highlightMarkerSelection],t)}getLabelData(){var e,t;return null!=(t=null==(e=this.contextNodeData)?void 0:e.labelData)?t:[]}getSeriesDomain(){return[NaN,NaN]}pickNodeClosestDatum(e){var t;const{x:i,y:o}=this.rootGroup.transformPoint(e.x,e.y);let a,s=1/0;return null==(t=this.contextNodeData)||t.nodeData.forEach((e=>{const{x:t,y:n,size:r}=e.point,l=Math.max(Math.abs(t-i)-r,0),h=Math.max(Math.abs(n-o)-r,0),d=l*l+h*h;d<s&&(s=d,a=e)})),null!=a?{datum:a,distance:Math.sqrt(s)}:void 0}getLegendData(e){var t,i,o,a,s,n;const{processedData:r,dataModel:l}=this;if(null==r||null==l)return[];const{title:h,legendItemName:d,idName:c,idKey:u,colorKey:p,colorName:y,colorRange:g,visible:m,shape:x,fill:f,stroke:v,fillOpacity:S,strokeOpacity:M,strokeWidth:D}=this.properties;if("gradient"===e&&null!=p&&null!=g){const e=r.domain.values[l.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:m,seriesId:this.id,colorName:y,colorRange:g,colorDomain:e}]}if("category"===e){return[{legendType:"category",id:this.id,itemId:null!=(o=null!=(i=null!=(t=null!=d?d:h)?t:c)?i:u)?o:this.id,seriesId:this.id,enabled:m,label:{text:null!=(n=null!=(s=null!=(a=null!=d?d:h)?a:c)?s:u)?n:this.id},marker:{shape:x,fill:f,fillOpacity:S,stroke:v,strokeWidth:D,strokeOpacity:M},legendItemName:d}]}return[]}getTooltipHtml(e){var t,i,a,s;const{id:n,processedData:r,ctx:{callbackCache:l},properties:h}=this;if(!r||!this.properties.isValid())return o._ModuleSupport.EMPTY_TOOLTIP_CONTENT;const{legendItemName:d,idKey:c,idName:u,latitudeKey:p,longitudeKey:y,sizeKey:m,sizeName:x,colorKey:f,colorName:v,labelKey:S,labelName:M,formatter:D,tooltip:b,latitudeName:N,longitudeName:I}=h,{datum:k,fill:T,idValue:A,latValue:O,lonValue:L,sizeValue:E,colorValue:_,labelValue:R,itemId:C}=e,w=null!=(i=Au(null!=(t=h.title)?t:d))?i:"",P=[];null!=A&&P.push(Au((null!=u?`${u}: `:"")+A)),null!=_&&P.push(Au((null!=v?v:f)+": "+_)),null!=E&&P.push(Au((null!=x?x:m)+": "+E)),null==R||null!=c&&c===S||P.push(Au((null!=M?M:S)+": "+R)),null!=O&&null!=L&&P.push(Au(`${Math.abs(O).toFixed(4)}\xb0 ${O>=0?"N":"S"}, ${Math.abs(L).toFixed(4)}\xb0 ${O>=0?"W":"E"}`));const z=P.join("<br>");let K;D&&(K=l.call(D,{seriesId:n,datum:k,latitudeKey:p,longitudeKey:y,fill:T,highlighted:!1}));const V=null!=(s=null!=(a=null==K?void 0:K.fill)?a:T)?s:h.fill;return b.toTooltipHtml({title:w,content:z,backgroundColor:V},g({seriesId:n,datum:k,idKey:c,latitudeKey:p,longitudeKey:y,title:w,color:V,colorKey:f,colorName:v,idName:u,itemId:C,labelKey:S,labelName:M,latitudeName:N,longitudeName:I,sizeKey:m,sizeName:x},this.getModuleTooltipParams()))}getFormattedMarkerStyle(e){const{id:t,properties:i,ctx:{callbackCache:o}}=this,{datum:a,point:s}=e,{idKey:n,latitudeKey:r,longitudeKey:l,labelKey:h,sizeKey:d,colorKey:c,fill:u,fillOpacity:p,stroke:y,strokeOpacity:g,formatter:m}=i,x=this.getStrokeWidth(i.strokeWidth),f={seriesId:t,datum:a.datum,itemId:a.itemId,size:s.size,idKey:n,latitudeKey:r,longitudeKey:l,labelKey:h,sizeKey:d,colorKey:c,fill:u,fillOpacity:p,stroke:y,strokeWidth:x,strokeOpacity:g,highlighted:!0};if(void 0!==m){const e=o.call(m,f);if(void 0!==(null==e?void 0:e.size))return{size:e.size}}return{size:e.point.size}}computeFocusBounds(e){return Mu(this,e)}};Lu.className="MapMarkerSeries",Lu.type="map-marker",f([uu(Vd,{optional:!0,property:"topology"})],Lu.prototype,"_chartTopology",2);var{EXTENDS_SERIES_DEFAULTS:Eu,DEFAULT_LABEL_COLOUR:_u,DEFAULT_DIVERGING_SERIES_COLOUR_RANGE:Ru,singleSeriesPaletteFactory:Cu}=o._Theme,wu={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-marker",instanceConstructor:Lu,themeTemplate:m(g({},ld),{series:{__extends__:Eu,maxSize:30,fillOpacity:.5,label:{color:_u}}}),paletteFactory:e=>{const{takeColors:t,colorsCount:i,userPalette:o,themeTemplateParameters:a}=e,{fill:s,stroke:n}=Cu(e),{properties:r}=a,l=r.get(Ru),{fills:h}=t(i);return{fill:s,stroke:n,colorRange:o?[h[0],h[1]]:l}}},{COLOR_STRING:Pu,LINE_DASH:zu,OBJECT:Ku,POSITIVE_NUMBER:Vu,RATIO:Bu,Validate:Fu,SeriesProperties:Uu,SeriesTooltip:ju}=o._ModuleSupport,Wu=class extends Uu{constructor(){super(...arguments),this.topology=void 0,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.tooltip=new ju}};f([Fu(Vd,{optional:!0})],Wu.prototype,"topology",2),f([Fu(Pu)],Wu.prototype,"fill",2),f([Fu(Bu)],Wu.prototype,"fillOpacity",2),f([Fu(Pu)],Wu.prototype,"stroke",2),f([Fu(Bu)],Wu.prototype,"strokeOpacity",2),f([Fu(Vu)],Wu.prototype,"strokeWidth",2),f([Fu(zu)],Wu.prototype,"lineDash",2),f([Fu(Vu)],Wu.prototype,"lineDashOffset",2),f([Fu(Ku)],Wu.prototype,"tooltip",2);var{createDatumId:Yu,Series:Gu,SeriesNodePickMode:Hu,Validate:Xu}=o._ModuleSupport,{Selection:Qu,Group:$u,PointerEvents:Zu}=o._Scene,{Logger:qu}=o._Util,Ju=class extends Gu{constructor(e){super({moduleCtx:e,contentGroupVirtual:!1,useLabelLayer:!0,pickModes:[Hu.EXACT_SHAPE_MATCH]}),this.properties=new Wu,this._chartTopology=void 0,this.itemGroup=this.contentGroup.appendChild(new $u({name:"itemGroup"})),this.datumSelection=Qu.select(this.itemGroup,(()=>this.nodeFactory()))}get topology(){var e;return null!=(e=this.properties.topology)?e:this._chartTopology}setOptionsData(){}setChartData(){}get hasData(){return!1}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}nodeFactory(){const e=new bd;return e.renderMode=1,e.lineJoin="round",e.pointerEvents=Zu.None,e}processData(){return S(this,null,(function*(){const{topology:e}=this;this.topologyBounds=null==e?void 0:e.features.reduce(((e,t)=>{const i=t.geometry;return null==i?e:Nd(i,e)}),void 0),null==e&&qu.warnOnce("no topology was provided for [MapShapeBackgroundSeries]; nothing will be rendered.")}))}createNodeData(){return S(this,null,(function*(){const{id:e,topology:t,scale:i}=this;if(null==t)return;const o=[];return t.features.forEach(((e,t)=>{const{geometry:a}=e,s=null!=a&&null!=i?Ad(a,i):void 0;null!=s&&o.push({series:this,itemId:t,datum:e,index:t,projectedGeometry:s})})),{itemId:e,nodeData:o,labelData:[]}}))}updateSelections(){return S(this,null,(function*(){this.nodeDataRefresh&&(this.contextNodeData=yield this.createNodeData(),this.nodeDataRefresh=!1)}))}update(){return S(this,null,(function*(){var e;const{datumSelection:t}=this;yield this.updateSelections(),this.contentGroup.visible=this.visible;const{nodeData:i=[]}=null!=(e=this.contextNodeData)?e:{};this.datumSelection=yield this.updateDatumSelection({nodeData:i,datumSelection:t}),yield this.updateDatumNodes({datumSelection:t})}))}updateDatumSelection(e){return S(this,null,(function*(){return e.datumSelection.update(e.nodeData,void 0,(e=>Yu(e.index)))}))}updateDatumNodes(e){return S(this,null,(function*(){const{properties:t}=this,{datumSelection:i}=e,{fill:o,fillOpacity:a,stroke:s,strokeOpacity:n,lineDash:r,lineDashOffset:l}=t,h=this.getStrokeWidth(t.strokeWidth);i.each(((e,t)=>{const{projectedGeometry:i}=t;if(null==i)return e.visible=!1,void(e.projectedGeometry=void 0);e.visible=!0,e.projectedGeometry=i,e.fill=o,e.fillOpacity=a,e.stroke=s,e.strokeWidth=h,e.strokeOpacity=n,e.lineDash=r,e.lineDashOffset=l}))}))}resetAnimation(){}getLabelData(){return[]}getSeriesDomain(){return[NaN,NaN]}getLegendData(){return[]}getTooltipHtml(){return o._ModuleSupport.EMPTY_TOOLTIP_CONTENT}pickFocus(e){}};Ju.className="MapShapeBackgroundSeries",Ju.type="map-shape-background",f([Xu(Vd,{optional:!0,property:"topology"})],Ju.prototype,"_chartTopology",2);var{DEFAULT_BACKGROUND_COLOUR:ep,DEFAULT_HIERARCHY_FILLS:tp}=o._Theme,ip={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-shape-background",instanceConstructor:Ju,themeTemplate:m(g({},ld),{series:{stroke:ep,strokeWidth:1}}),paletteFactory:e=>{let{themeTemplateParameters:t}=e;var i;const{properties:o}=t;return{fill:null==(i=o.get(tp))?void 0:i[1]}}};function op(e,t){let{aspectRatio:i,precision:o}=t;const a=jc(e,o,((e,t,o,a)=>{const s=function(e,t,i,o){let a=!1,s=1/0;for(const n of e){let e=n[n.length-1],[r,l]=e;for(const h of n){const[n,d]=h;d>i!==l>i&&t<(r-n)*(i-d)/(l-d)+n&&(a=!a);const c=ap(e,h,t,i,o);s=Math.min(s,c),e=h,r=n,l=d}}return(a?1:-1)*s}(e,t,o,i),n=s+2*a*i;return{distance:s*Math.SQRT2,maxDistance:n*Math.SQRT2}}));if(null==a)return;const{x:s,y:n,distance:r}=a;return{x:s,y:n,maxWidth:r/Math.SQRT2}}function ap(e,t,i,o,a){const[s,n]=e,[r,l]=t,h=1/a,d=r-s,c=l-n,[u,p]=n<=l?e:t,[y,g]=s<=r?e:t,[m,x]=n<=l?t:e,[f,v]=s<=r?t:e;let S=1/0;if(0!==d){const e=c/d;for(let t=0;t<=1;t+=1){const a=0===t?h:-h,r=(e*s-n-a*i+o)/(e-a);if(r>=y&&r<=f){const e=2*Math.abs(i-r);S=Math.min(S,e)}}}else for(let k=0;k<=1;k+=1){const e=(0===k?h:-h)*(s-i)+o;if(e>=p&&e<=x){const t=2*Math.abs(o-e)*a;S=Math.min(S,t)}}const M=a,D=Math.abs((u-i)/(p-o)),b=Math.abs((m-i)/(x-o));if(x<o&&b<M){const e=2*Math.abs(o-x)*a;S=Math.min(S,e)}else if(p>o&&D<M){const e=2*Math.abs(o-p)*a;S=Math.min(S,e)}const N=Math.abs((g-o)/(y-i)),I=Math.abs((v-o)/(f-i));if(f<i&&I<h){const e=2*Math.abs(i-f);S=Math.min(S,e)}else if(y>i&&N<h){const e=2*Math.abs(i-y);S=Math.min(S,e)}return S}function sp(e,t,i){i>=t&&(e.maxX=Math.min(e.maxX,i-t)),i<=t&&(e.minX=Math.max(e.minX,i-t))}function np(e,t,i,o,a,s){const n=a-s/2,r=a+s/2,[l,h]=t,[d,c]=i,u=d-l,p=c-h,[y,g]=l<=d?t:i,[m,x]=l<=d?i:t;if(0!==u){const t=p/u;for(let i=0;i<=1;i+=1){const a=((0===i?n:r)-h)/t+l;a>=y&&a<=m&&sp(e,o,a)}}else Math.max(n,Math.min(h,c))<=Math.min(r,Math.max(h,c))&&sp(e,o,l);return m<o&&x>=n&&x<=r?sp(e,o,m):y>o&&g>=n&&g<=r&&sp(e,o,y),e}var{AND:rp,ARRAY:lp,COLOR_STRING:hp,COLOR_STRING_ARRAY:dp,FUNCTION:cp,LINE_DASH:up,OBJECT:pp,POSITIVE_NUMBER:yp,RATIO:gp,STRING:mp,Validate:xp,SeriesProperties:fp,SeriesTooltip:vp}=o._ModuleSupport,Sp=class extends fp{constructor(){super(...arguments),this.topology=void 0,this.idKey="",this.idName=void 0,this.topologyIdKey="name",this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.padding=0,this.label=new bh,this.tooltip=new vp}};f([xp(Vd,{optional:!0})],Sp.prototype,"topology",2),f([xp(mp,{optional:!0})],Sp.prototype,"title",2),f([xp(mp,{optional:!0})],Sp.prototype,"legendItemName",2),f([xp(mp)],Sp.prototype,"idKey",2),f([xp(mp,{optional:!0})],Sp.prototype,"idName",2),f([xp(mp)],Sp.prototype,"topologyIdKey",2),f([xp(mp,{optional:!0})],Sp.prototype,"labelKey",2),f([xp(mp,{optional:!0})],Sp.prototype,"labelName",2),f([xp(mp,{optional:!0})],Sp.prototype,"colorKey",2),f([xp(mp,{optional:!0})],Sp.prototype,"colorName",2),f([xp(rp(dp,lp.restrict({minLength:1})),{optional:!0})],Sp.prototype,"colorRange",2),f([xp(hp)],Sp.prototype,"fill",2),f([xp(gp)],Sp.prototype,"fillOpacity",2),f([xp(hp)],Sp.prototype,"stroke",2),f([xp(gp)],Sp.prototype,"strokeOpacity",2),f([xp(yp)],Sp.prototype,"strokeWidth",2),f([xp(up)],Sp.prototype,"lineDash",2),f([xp(yp)],Sp.prototype,"lineDashOffset",2),f([xp(yp)],Sp.prototype,"padding",2),f([xp(cp,{optional:!0})],Sp.prototype,"formatter",2),f([xp(pp)],Sp.prototype,"label",2),f([xp(pp)],Sp.prototype,"tooltip",2);var{getMissCount:Mp,createDatumId:Dp,DataModelSeries:bp,SeriesNodePickMode:Np,valueProperty:Ip,Validate:kp}=o._ModuleSupport,{ColorScale:Tp}=o._Scale,{Group:Ap,Selection:Op,Text:Lp,PointerEvents:Ep}=o._Scene,{sanitizeHtml:_p,Logger:Rp}=o._Util,Cp=o._ModuleSupport.MercatorScale.fixedScale(),wp=class extends bp{constructor(e){super({moduleCtx:e,contentGroupVirtual:!1,useLabelLayer:!0,pickModes:[Np.EXACT_SHAPE_MATCH,Np.NEAREST_NODE]}),this.properties=new Sp,this._chartTopology=void 0,this.colorScale=new Tp,this.itemGroup=this.contentGroup.appendChild(new Ap({name:"itemGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new Ap({name:"itemLabelGroup"})),this.datumSelection=Op.select(this.itemGroup,(()=>this.nodeFactory())),this.labelSelection=Op.select(this.itemLabelGroup,Lp),this.highlightDatumSelection=Op.select(this.highlightNode,(()=>this.nodeFactory())),this.previousLabelLayouts=void 0,this._previousDatumMidPoint=void 0,this.itemLabelGroup.pointerEvents=Ep.None,this.showFocusBox=!1}getNodeData(){var e;return null==(e=this.contextNodeData)?void 0:e.nodeData}get topology(){var e;return null!=(e=this.properties.topology)?e:this._chartTopology}get hasData(){return super.hasData&&null!=this.topology}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager.addListener("legend-item-click",(e=>{this.onLegendItemClick(e)})),this.ctx.chartEventManager.addListener("legend-item-double-click",(e=>{this.onLegendItemDoubleClick(e)})))}isLabelEnabled(){return null!=this.properties.labelKey&&this.properties.label.enabled}nodeFactory(){const e=new bd;return e.renderMode=1,e.lineJoin="round",e}processData(e){return S(this,null,(function*(){var t;if(null==this.data||!this.properties.isValid())return;const{data:i,topology:o,colorScale:a}=this,{topologyIdKey:s,idKey:n,colorKey:r,labelKey:l,colorRange:h}=this.properties,d=new Map;null==o||o.features.forEach((e=>{var t;const i=null==(t=e.properties)?void 0:t[s];null!=i&&Td(e.geometry,1)&&d.set(i,e)}));const c=this.colorScale.type,u=null==(t=this.scale)?void 0:t.type,{dataModel:p,processedData:y}=yield this.requestDataModel(e,i,{props:[Ip(n,u,{id:"idValue",includeProperty:!1}),Ip(n,u,{id:"featureValue",includeProperty:!1,processor:()=>e=>d.get(e)}),...l?[Ip(l,"band",{id:"labelValue"})]:[],...r?[Ip(r,c,{id:"colorValue"})]:[]]}),g=p.resolveProcessedDataIndexById(this,"featureValue");if(this.topologyBounds=y.data.reduce(((e,t)=>{let{values:i}=t;const o=i[g],a=null==o?void 0:o.geometry;return null==a?e:Nd(a,e)}),void 0),null!=h&&this.isColorScaleValid()){const e=p.resolveProcessedDataIndexById(this,"colorValue");a.domain=y.domain.values[e],a.range=h,a.update()}null==o&&Rp.warnOnce("no topology was provided for [MapShapeSeries]; nothing will be rendered.")}))}isColorScaleValid(){const{colorKey:e}=this.properties;if(!e)return!1;const{dataModel:t,processedData:i}=this;if(!t||!i)return!1;const o=t.resolveProcessedDataIndexById(this,"colorValue"),a=i.data.length,s=Mp(this,i.defs.values[o].missing);return!(0===a||a===s)}getLabelLayout(e,t,i,o,a){if(null==t||null==o)return;const{idKey:s,idName:n,colorKey:r,colorName:l,labelKey:h,labelName:d,padding:c,label:u}=this.properties,p=this.getLabelText(u,{value:t,datum:e,idKey:s,idName:n,colorKey:r,colorName:l,labelKey:h,labelName:d});if(null==p)return;const y=Lp.getTextSize(String(p),i),g=p.split("\n").length,m=(y.width+2*c)/(g*Dh.lineHeight(u.fontSize)+2*c);if((null==a?void 0:a.geometry)===o&&(null==a?void 0:a.labelText)===p&&(null==a?void 0:a.aspectRatio)===m)return a;const x=Id(Ad(o,Cp));if(null==x)return;const f=op(x,{aspectRatio:m,precision:.001});if(null==f)return;const{x:v,y:S,maxWidth:M}=f;return{geometry:o,labelText:p,aspectRatio:m,x:v,y:S,maxWidth:M,fixedPolygon:x}}getLabelDatum(e,t){const{scale:i}=this;if(null==i)return;const{padding:o,label:a}=this.properties,{labelText:s,aspectRatio:n,x:r,y:l,maxWidth:h,fixedPolygon:d}=e,c={width:Math.ceil(h*t),height:Math.ceil(h*t/n),meta:r},u=Ih(s,a,{padding:o},((e,i)=>{if(!i)return c;const o=function(e,t,i,o){const a={minX:-1/0,maxX:1/0};for(const r of e){let e=r[r.length-1];for(const s of r)np(a,e,s,t,i,o),e=s}const{minX:s,maxX:n}=a;return Number.isFinite(s)&&Number.isFinite(n)?{x:t+(s+n)/2,width:n-s}:{x:t,width:0}}(d,r,l,e/t);return{width:o.width*t,height:e,meta:o.x}}));if(null==u)return;const[{text:p,fontSize:y,lineHeight:g,width:m},x]=u;if(p===Lp.ellipsis)return;const f=m<c.width?r:x,v=this.scale.convert(Cp.invert([f,l]));return{x:v[0],y:v[1],text:p,fontSize:y,lineHeight:g}}createNodeData(){return S(this,null,(function*(){const{id:e,dataModel:t,processedData:i,colorScale:o,properties:a,scale:s,previousLabelLayouts:n}=this,{idKey:r,colorKey:l,labelKey:h,label:d,fill:c}=a;if(null==t||null==i)return;const u=null!=s?(s.range[1][0]-s.range[0][0])/s.bounds.width:NaN,p=this.isColorScaleValid(),y=t.resolveProcessedDataIndexById(this,"idValue"),g=t.resolveProcessedDataIndexById(this,"featureValue"),m=null!=h?t.resolveProcessedDataIndexById(this,"labelValue"):void 0,x=null!=l?t.resolveProcessedDataIndexById(this,"colorValue"):void 0,f=d.getFont(),v=new Map;this.previousLabelLayouts=v;const S=[],M=[],D=[];i.data.forEach((e=>{let{datum:t,values:i}=e;var a;const l=i[y],h=null!=x?i[x]:void 0,d=null!=m?i[m]:void 0,b=null==(a=i[g])?void 0:a.geometry;null==b&&D.push(l);const N=p&&null!=h?o.convert(h):void 0,I=this.getLabelLayout(t,d,f,b,null==n?void 0:n.get(l));null!=I&&v.set(l,I);const k=null!=I&&null!=s?this.getLabelDatum(I,u):void 0;null!=k&&M.push(k);const T=null!=b&&null!=s?Ad(b,s):void 0;S.push({series:this,itemId:r,datum:t,idValue:l,colorValue:h,labelValue:d,fill:null!=N?N:c,projectedGeometry:T})}));if(D.length>10){const e=D.length-10;D.length=10,D.push(`(+${e} more)`)}return D.length>0&&Rp.warnOnce("some data items do not have matches in the provided topology",D),{itemId:e,nodeData:S,labelData:M}}))}updateSelections(){return S(this,null,(function*(){this.nodeDataRefresh&&(this.contextNodeData=yield this.createNodeData(),this.nodeDataRefresh=!1)}))}update(){return S(this,null,(function*(){var e,t,i,o,a;const{datumSelection:s,labelSelection:n,highlightDatumSelection:r}=this;yield this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let l=null==(e=this.ctx.highlightManager)?void 0:e.getActiveHighlight();null==l||l.series===this&&null!=l.datum||(l=void 0);const h=null!=(i=null==(t=this.contextNodeData)?void 0:t.nodeData)?i:[],d=null!=(a=null==(o=this.contextNodeData)?void 0:o.labelData)?a:[];this.datumSelection=yield this.updateDatumSelection({nodeData:h,datumSelection:s}),yield this.updateDatumNodes({datumSelection:s,isHighlight:!1}),this.labelSelection=yield this.updateLabelSelection({labelData:d,labelSelection:n}),yield this.updateLabelNodes({labelSelection:n}),this.highlightDatumSelection=yield this.updateDatumSelection({nodeData:null!=l?[l]:[],datumSelection:r}),yield this.updateDatumNodes({datumSelection:r,isHighlight:!0})}))}updateDatumSelection(e){return S(this,null,(function*(){return e.datumSelection.update(e.nodeData,void 0,(e=>Dp(e.idValue)))}))}updateDatumNodes(e){return S(this,null,(function*(){const{id:t,properties:i,ctx:{callbackCache:o}}=this,{datumSelection:a,isHighlight:s}=e,{idKey:n,colorKey:r,labelKey:l,fillOpacity:h,stroke:d,strokeOpacity:c,lineDash:u,lineDashOffset:p,formatter:y}=i,g=s?i.highlightStyle.item:void 0,m=this.getStrokeWidth(i.strokeWidth);a.each(((e,i)=>{var a,x,f,v,S,M,D,b,N,I,k,T,A,O;const{projectedGeometry:L}=i;if(null==L)return e.visible=!1,void(e.projectedGeometry=void 0);let E;if(null!=y){const e={seriesId:t,datum:i.datum,itemId:i.itemId,idKey:n,colorKey:r,labelKey:l,fill:i.fill,fillOpacity:h,strokeOpacity:c,stroke:d,strokeWidth:m,lineDash:u,lineDashOffset:p,highlighted:s};E=o.call(y,e)}e.visible=!0,e.projectedGeometry=L,e.fill=null!=(x=null!=(a=null==g?void 0:g.fill)?a:null==E?void 0:E.fill)?x:i.fill,e.fillOpacity=null!=(v=null!=(f=null==g?void 0:g.fillOpacity)?f:null==E?void 0:E.fillOpacity)?v:h,e.stroke=null!=(M=null!=(S=null==g?void 0:g.stroke)?S:null==E?void 0:E.stroke)?M:d,e.strokeWidth=null!=(b=null!=(D=null==g?void 0:g.strokeWidth)?D:null==E?void 0:E.strokeWidth)?b:m,e.strokeOpacity=null!=(I=null!=(N=null==g?void 0:g.strokeOpacity)?N:null==E?void 0:E.strokeOpacity)?I:c,e.lineDash=null!=(T=null!=(k=null==g?void 0:g.lineDash)?k:null==E?void 0:E.lineDash)?T:u,e.lineDashOffset=null!=(O=null!=(A=null==g?void 0:g.lineDashOffset)?A:null==E?void 0:E.lineDashOffset)?O:p}))}))}updateLabelSelection(e){return S(this,null,(function*(){const t=this.isLabelEnabled()?e.labelData:[];return e.labelSelection.update(t)}))}updateLabelNodes(e){return S(this,null,(function*(){const{labelSelection:t}=e,{color:i,fontStyle:o,fontWeight:a,fontFamily:s}=this.properties.label;t.each(((e,t)=>{let{x:n,y:r,text:l,fontSize:h,lineHeight:d}=t;e.visible=!0,e.x=n,e.y=r,e.text=l,e.fill=i,e.fontStyle=o,e.fontWeight=a,e.fontSize=h,e.lineHeight=d,e.fontFamily=s,e.textAlign="center",e.textBaseline="middle"}))}))}onLegendItemClick(e){const{legendItemName:t}=this.properties,{enabled:i,itemId:o,series:a}=e,s=null!=t&&t===e.legendItemName;(a.id===this.id||s)&&this.toggleSeriesItem(o,i)}onLegendItemDoubleClick(e){const{enabled:t,itemId:i,series:o,numVisibleItems:a}=e,{legendItemName:s}=this.properties,n=null!=s&&s===e.legendItemName;o.id===this.id||n||t&&1===a?this.toggleSeriesItem(i,!0):this.toggleSeriesItem(i,!1)}resetAnimation(){}getLabelData(){return[]}getSeriesDomain(){return[NaN,NaN]}pickNodeClosestDatum(e){let t,{x:i,y:o}=e,a=1/0;return this.datumSelection.each(((e,s)=>{const n=e.distanceToPoint(i,o);n<a&&(a=n,t=s)})),null!=t?{datum:t,distance:a}:void 0}datumMidPoint(e){const{_previousDatumMidPoint:t}=this;if((null==t?void 0:t.datum)===e)return t.point;const i=e.projectedGeometry,o=null!=i?Id(i):void 0,a=null!=o?Yc(o,2):void 0,s=null!=a?{x:a[0],y:a[1]}:void 0;return this._previousDatumMidPoint={datum:e,point:s},s}getLegendData(e){var t,i,o,a;const{processedData:s,dataModel:n}=this;if(null==s||null==n)return[];const{title:r,legendItemName:l,idKey:h,idName:d,fill:c,fillOpacity:u,stroke:p,strokeWidth:y,strokeOpacity:g,colorKey:m,colorName:x,colorRange:f,visible:v}=this.properties;if("gradient"===e&&null!=m&&null!=f){const e=s.domain.values[n.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:v,seriesId:this.id,colorName:x,colorRange:f,colorDomain:e}]}if("category"===e){return[{legendType:"category",id:this.id,itemId:null!=(i=null!=(t=null!=l?l:r)?t:d)?i:h,seriesId:this.id,enabled:v,label:{text:null!=(a=null!=(o=null!=l?l:r)?o:d)?a:h},marker:{fill:c,fillOpacity:u,stroke:p,strokeWidth:y,strokeOpacity:g},legendItemName:l}]}return[]}getTooltipHtml(e){var t,i,a;const{id:s,processedData:n,ctx:{callbackCache:r},properties:l}=this;if(!n||!l.isValid())return o._ModuleSupport.EMPTY_TOOLTIP_CONTENT;const{legendItemName:h,idKey:d,idName:c,colorKey:u,colorName:p,labelKey:y,labelName:m,stroke:x,strokeWidth:f,formatter:v,tooltip:S}=l,{datum:M,fill:D,idValue:b,colorValue:N,labelValue:I,itemId:k}=e,T=null!=(i=_p(null!=(t=l.title)?t:h))?i:"",A=[];A.push(_p((null!=c?`${c}: `:"")+b)),null!=N&&A.push(_p((null!=p?p:u)+": "+N)),null!=I&&y!==d&&A.push(_p((null!=m?m:y)+": "+I));const O=A.join("<br>");let L;v&&(L=r.call(v,{seriesId:s,datum:M,idKey:d,fill:D,stroke:x,strokeWidth:this.getStrokeWidth(f),highlighted:!1}));const E=null!=(a=null==L?void 0:L.fill)?a:D;return S.toTooltipHtml({title:T,content:O,backgroundColor:E},g({seriesId:s,datum:M,idKey:d,title:T,color:E,colorKey:u,colorName:p,idName:c,itemId:k,labelKey:y,labelName:m},this.getModuleTooltipParams()))}computeFocusBounds(e){return rc(this,e)}};wp.className="MapShapeSeries",wp.type="map-shape",f([kp(Vd,{optional:!0,property:"topology"})],wp.prototype,"_chartTopology",2);var{EXTENDS_SERIES_DEFAULTS:Pp,DEFAULT_INVERTED_LABEL_COLOUR:zp,DEFAULT_DIVERGING_SERIES_COLOUR_RANGE:Kp,DEFAULT_BACKGROUND_COLOUR:Vp,singleSeriesPaletteFactory:Bp}=o._Theme,Fp={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-shape",instanceConstructor:wp,themeTemplate:m(g({},ld),{series:{__extends__:Pp,fillOpacity:1,strokeWidth:1,lineDash:[0],lineDashOffset:0,padding:2,label:{color:zp,fontWeight:"bold",overflowStrategy:"hide"}}}),paletteFactory:e=>{const{takeColors:t,colorsCount:i,userPalette:o,themeTemplateParameters:a}=e,{fill:s}=Bp(e),{properties:n}=a,r=n.get(Kp),{fills:l}=t(i);return{fill:s,stroke:n.get(Vp),colorRange:o?[l[0],l[1]]:r}}},{isDefined:Up,ChartAxisDirection:jp,PolarAxis:Wp,diff:Yp,fixNumericExtent:Gp,groupAccumulativeValueProperty:Hp,keyProperty:Xp,normaliseGroupTo:Qp,resetLabelFn:$p,seriesLabelFadeInAnimation:Zp,seriesLabelFadeOutAnimation:qp,valueProperty:Jp,animationValidation:ey,isFiniteNumber:ty,SeriesNodePickMode:iy,computeSectorFocusBounds:oy}=o._ModuleSupport,{BandScale:ay}=o._Scale,{motion:sy}=o._Scene,{isNumber:ny,normalizeAngle360:ry,sanitizeHtml:ly}=o._Util,hy=class extends o._ModuleSupport.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.angleKey=o.properties.angleKey,this.radiusKey=o.properties.radiusKey}},dy=class extends o._ModuleSupport.PolarSeries{constructor(e,t){let{animationResetFns:i}=t;super({moduleCtx:e,useLabelLayer:!0,canHaveAxes:!0,pickModes:[iy.EXACT_SHAPE_MATCH],animationResetFns:m(g({},i),{label:$p})}),this.NodeEvent=hy,this.groupScale=new ay,this.circleCache={r:0,cx:0,cy:0}}addChartEventListeners(){var e,t;this.destroyFns.push(null==(e=this.ctx.chartEventManager)?void 0:e.addListener("legend-item-click",(e=>this.onLegendItemClick(e))),null==(t=this.ctx.chartEventManager)?void 0:t.addListener("legend-item-double-click",(e=>this.onLegendItemDoubleClick(e))))}getSeriesDomain(e){const{axes:t,dataModel:i,processedData:o}=this;if(!o||!i)return[];if(e===jp.X)return i.getDomain(this,"angleValue","key",o);{const e=t[jp.Y],a=i.getDomain(this,"radiusValue-end","value",o),s=[a[0]>0?0:a[0],a[1]<0?0:a[1]];return Gp(s,e)}}processData(e){return S(this,null,(function*(){var t,i;const{angleKey:o,radiusKey:a,normalizedTo:s,visible:n}=this.properties,r=!this.ctx.animationManager.isSkipped();if(!this.properties.isValid()||!n&&!r)return;const l=this.getStackId(),h=`${l}-trailing`,d=[];Up(s)&&d.push(Qp([l,h],Math.abs(s),"range")),r&&this.processedData&&d.push(Yp(this.processedData)),r&&d.push(ey());const c=n||!r?{}:{forceValue:0},u=null==(t=this.axes[jp.Y])?void 0:t.scale.type,p=null==(i=this.axes[jp.X])?void 0:i.scale.type;yield this.requestDataModel(e,this.data,{props:[Xp(o,p,{id:"angleValue"}),Jp(a,u,g({id:"radiusValue-raw",invalidValue:null},c)),...Hp(a,"normal","current",g({id:"radiusValue-end",rangeId:"radiusValue-range",invalidValue:null,groupId:l,separateNegative:!0},c),u),...Hp(a,"trailing","current",g({id:"radiusValue-start",invalidValue:null,groupId:h,separateNegative:!0},c),u),...d]}),this.animationState.transition("updateData")}))}didCircleChange(){const e=this.radius,t=this.centerX,i=this.centerY,o=this.circleCache;return(e!==o.r||t!==o.cx||i!==o.cy)&&(this.circleCache={r:e,cx:t,cy:i},!0)}isRadiusAxisReversed(){var e;return null==(e=this.axes[jp.Y])?void 0:e.isReversed()}maybeRefreshNodeData(){return S(this,null,(function*(){var e;if(!this.didCircleChange()&&!this.nodeDataRefresh)return;const{nodeData:t=[]}=null!=(e=yield this.createNodeData())?e:{};this.nodeData=t,this.nodeDataRefresh=!1}))}getAxisInnerRadius(){const e=this.axes[jp.Y];return e instanceof Wp?this.radius*e.innerRadiusRatio:0}createNodeData(){return S(this,null,(function*(){var e;const{processedData:t,dataModel:i,groupScale:o}=this;if(!t||!i||!this.properties.isValid())return;const a=this.axes[jp.X],s=this.axes[jp.Y],n=null==a?void 0:a.scale,r=null==s?void 0:s.scale;if(!n||!r)return;const l=i.resolveProcessedDataIndexById(this,"radiusValue-start"),h=i.resolveProcessedDataIndexById(this,"radiusValue-end"),d=i.resolveProcessedDataIndexById(this,"radiusValue-range"),c=i.resolveProcessedDataIndexById(this,"radiusValue-raw");let u=0,p=0;a instanceof be&&(u=a.groupPaddingInner,p=a.paddingInner);const y=(null!=(e=n.bandwidth)?e:0)*(1-p),{index:g,visibleGroupCount:m}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);o.domain=Array.from({length:m}).map(((e,t)=>String(t))),o.range=[-y/2,y/2],o.paddingInner=m>1?u:0;const x=this.isRadiusAxisReversed(),f=x?this.radius:this.getAxisInnerRadius(),v=x?this.getAxisInnerRadius():this.radius,S=v+f,{angleKey:M,radiusKey:D,angleName:b,radiusName:N,label:I}=this.properties,k=(e,t,i,o)=>{const a=this.getLabelText(I,{value:t,datum:e,angleKey:M,radiusKey:D,angleName:b,radiusName:N},(e=>ty(e)?e.toFixed(2):String(e)));if(a)return{x:i,y:o,text:a,textAlign:"center",textBaseline:"middle"}},T=[],A={itemId:D,nodeData:T,labelData:T};return this.visible?(t.data.forEach(((e,t,i)=>{var a;const{datum:s,keys:u,values:p,aggValues:y}=e,m=u[0],M=p[c],D=M>=0&&!Object.is(M,-0),b=p[l],N=p[h],I=null!=(a=null==y?void 0:y[d][D?1:0])?a:0,A=D===x;if(void 0===b||void 0===N)return;let O,L;if(1===i.length)O=-.5*Math.PI,L=1.5*Math.PI;else{const e=n.convert(m);O=ry(e+o.convert(String(g))),L=ry(O+o.bandwidth)}const E=O+o.bandwidth/2,_=S-r.convert(b),R=S-r.convert(N),C=(_+R)/2,w=S-r.convert(0),P=S-r.convert(I),z=Math.cos(E)*C,K=Math.sin(E)*C,V=this.properties.label.enabled?k(s,M,z,K):void 0,B=this.getColumnWidth(O,L);T.push({series:this,datum:s,point:{x:z,y:K,size:0},midPoint:{x:z,y:K},label:V,angleValue:m,radiusValue:M,negative:A,innerRadius:_,outerRadius:R,stackInnerRadius:w,stackOuterRadius:P,startAngle:O,endAngle:L,axisInnerRadius:f,axisOuterRadius:v,columnWidth:B,index:t})})),{itemId:D,nodeData:T,labelData:T}):A}))}getColumnWidth(e,t){return NaN}update(e){return S(this,arguments,(function(e){var t=this;let{seriesRect:i}=e;return function*(){const e=t.checkResize(i);yield t.maybeRefreshNodeData(),t.contentGroup.translationX=t.centerX,t.contentGroup.translationY=t.centerY,t.highlightGroup.translationX=t.centerX,t.highlightGroup.translationY=t.centerY,t.labelGroup&&(t.labelGroup.translationX=t.centerX,t.labelGroup.translationY=t.centerY),t.updateSectorSelection(t.itemSelection,!1),t.updateSectorSelection(t.highlightSelection,!0),t.updateLabels(),e&&t.animationState.transition("resize"),t.animationState.transition("update")}()}))}updateSectorSelection(e,t){var i,o,a,s,n;let r=[];if(t){const e=null==(i=this.ctx.highlightManager)?void 0:i.getActiveHighlight();(null==e?void 0:e.datum)&&e.series===this&&(r=[e])}else r=this.nodeData;const l=t?this.properties.highlightStyle.item:void 0,h=null!=(o=null==l?void 0:l.fill)?o:this.properties.fill,d=null!=(a=null==l?void 0:l.fillOpacity)?a:this.properties.fillOpacity,c=null!=(s=null==l?void 0:l.stroke)?s:this.properties.stroke,u=this.properties.strokeOpacity,p=null!=(n=null==l?void 0:l.strokeWidth)?n:this.properties.strokeWidth;e.update(r,void 0,(e=>e.angleValue)).each(((e,i)=>{var o,a,s,n;const r=this.properties.formatter?this.ctx.callbackCache.call(this.properties.formatter,{datum:i,fill:h,stroke:c,strokeWidth:p,highlighted:t,angleKey:this.properties.angleKey,radiusKey:this.properties.radiusKey,seriesId:this.id}):void 0;this.updateItemPath(e,i,t,r),e.fill=null!=(o=null==r?void 0:r.fill)?o:h,e.fillOpacity=null!=(a=null==r?void 0:r.fillOpacity)?a:d,e.stroke=null!=(s=null==r?void 0:r.stroke)?s:c,e.strokeOpacity=u,e.strokeWidth=null!=(n=null==r?void 0:r.strokeWidth)?n:p,e.lineDash=this.properties.lineDash,e.lineJoin="round"}))}updateLabels(){const{label:e}=this.properties;this.labelSelection.update(this.nodeData).each(((t,i)=>{e.enabled&&i.label?(t.x=i.label.x,t.y=i.label.y,t.fill=e.color,t.fontFamily=e.fontFamily,t.fontSize=e.fontSize,t.fontStyle=e.fontStyle,t.fontWeight=e.fontWeight,t.text=i.label.text,t.textAlign=i.label.textAlign,t.textBaseline=i.label.textBaseline,t.visible=!0):t.visible=!1}))}animateEmptyUpdateReady(){const{labelSelection:e}=this,t=this.getColumnTransitionFunctions();sy.fromToMotion(this.id,"datums",this.ctx.animationManager,[this.itemSelection],t),Zp(this,"labels",this.ctx.animationManager,e)}animateClearingUpdateEmpty(){const{itemSelection:e}=this,{animationManager:t}=this.ctx,i=this.getColumnTransitionFunctions();sy.fromToMotion(this.id,"datums",t,[e],i),qp(this,"labels",t,this.labelSelection)}getTooltipHtml(e){var t;const{id:i,axes:a,dataModel:s}=this,{angleKey:n,radiusKey:r,angleName:l,radiusName:h,fill:d,stroke:c,strokeWidth:u,formatter:p,tooltip:y}=this.properties,{angleValue:g,radiusValue:m,datum:x,itemId:f}=e,v=a[jp.X],S=a[jp.Y];if(!this.properties.isValid()||!(v&&S&&ny(m))||!s)return o._ModuleSupport.EMPTY_TOOLTIP_CONTENT;const M=v.formatDatum(g),D=S.formatDatum(m),b=ly(h),N=ly(`${M}: ${D}`),{fill:I}=null!=(t=p&&this.ctx.callbackCache.call(p,{seriesId:i,datum:x,fill:d,stroke:c,strokeWidth:u,highlighted:!1,angleKey:n,radiusKey:r}))?t:{fill:d};return y.toTooltipHtml({title:b,backgroundColor:d,content:N},{seriesId:i,datum:x,color:I,title:b,angleKey:n,radiusKey:r,angleName:l,radiusName:h,angleValue:g,itemId:f,radiusValue:m})}pickNodeClosestDatum(e){return this.pickNodeNearestDistantObject(e,this.itemSelection.nodes())}getLegendData(e){var t;if(!(null==(t=this.data)?void 0:t.length)||!this.properties.isValid()||"category"!==e)return[];const{radiusKey:i,radiusName:o,fill:a,stroke:s,fillOpacity:n,strokeOpacity:r,strokeWidth:l,visible:h}=this.properties;return[{legendType:"category",id:this.id,itemId:i,seriesId:this.id,enabled:h,label:{text:null!=o?o:i},marker:{fill:null!=a?a:"rgba(0, 0, 0, 0)",stroke:null!=s?s:"rgba(0, 0, 0, 0)",fillOpacity:null!=n?n:1,strokeOpacity:null!=r?r:1,strokeWidth:l}}]}onLegendItemClick(e){const{enabled:t,itemId:i,series:o}=e;o.id===this.id&&this.toggleSeriesItem(i,t)}onLegendItemDoubleClick(e){const{enabled:t,itemId:i,series:o,numVisibleItems:a}=e,s=o.id===this.id||t&&1===a;this.toggleSeriesItem(i,s)}computeLabelsBBox(){return null}computeFocusBounds(e){return oy(this,e)}},{Label:cy}=o._Scene,{SeriesProperties:uy,SeriesTooltip:py,Validate:yy,COLOR_STRING:gy,DEGREE:my,FUNCTION:xy,LINE_DASH:fy,NUMBER:vy,OBJECT:Sy,POSITIVE_NUMBER:My,RATIO:Dy,STRING:by}=o._ModuleSupport,Ny=class extends uy{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.rotation=0,this.label=new cy,this.tooltip=new py}};f([yy(by)],Ny.prototype,"angleKey",2),f([yy(by,{optional:!0})],Ny.prototype,"angleName",2),f([yy(by)],Ny.prototype,"radiusKey",2),f([yy(by,{optional:!0})],Ny.prototype,"radiusName",2),f([yy(gy)],Ny.prototype,"fill",2),f([yy(Dy)],Ny.prototype,"fillOpacity",2),f([yy(gy)],Ny.prototype,"stroke",2),f([yy(My)],Ny.prototype,"strokeWidth",2),f([yy(Dy)],Ny.prototype,"strokeOpacity",2),f([yy(fy)],Ny.prototype,"lineDash",2),f([yy(My)],Ny.prototype,"lineDashOffset",2),f([yy(xy,{optional:!0})],Ny.prototype,"formatter",2),f([yy(my)],Ny.prototype,"rotation",2),f([yy(by,{optional:!0})],Ny.prototype,"stackGroup",2),f([yy(vy,{optional:!0})],Ny.prototype,"normalizedTo",2),f([yy(Sy)],Ny.prototype,"label",2),f([yy(Sy)],Ny.prototype,"tooltip",2);var{Validate:Iy,POSITIVE_NUMBER:ky}=o._ModuleSupport,Ty=class extends Ny{constructor(){super(...arguments),this.cornerRadius=0}};f([Iy(ky)],Ty.prototype,"cornerRadius",2);var{motion:Ay}=o._Scene;function Oy(){const e={startAngle:new Map,endAngle:new Map},t=["startAngle","endAngle"],i=(t,i)=>({startAngle:e.startAngle.get(t)[i],endAngle:e.endAngle.get(t)[i]});return{calculate:(i,o,a)=>{t.forEach((t=>{var s,n;const r=e[t];let l=("removed"===a||"updated"===a?i:o)[t],h=("removed"===a?i:o)[t];isNaN(h)&&(h=null!=(n=null==(s=i.previousDatum)?void 0:s[t])?n:NaN);const d=l-h;Math.abs(d)>Math.PI&&(l-=2*Math.sign(d)*Math.PI),r.set(o,{from:l,to:h})}))},from:e=>i(e,"from"),to:e=>i(e,"to")}}function Ly(e,t,i){if("updated"===i){if(null==e.previousDatum||isNaN(e.previousDatum.startAngle)||isNaN(e.previousDatum.endAngle))return"added";if(isNaN(t.startAngle)||isNaN(t.endAngle))return"removed"}return"added"===i&&null!=e.previousDatum?"updated":i}function Ey(e,t){let{innerRadius:i,outerRadius:o,columnWidth:a,axisInnerRadius:s,axisOuterRadius:n,startAngle:r,endAngle:l}=t;return{innerRadius:i,outerRadius:o,columnWidth:a,axisInnerRadius:s,axisOuterRadius:n,startAngle:r,endAngle:l}}var{SectorBox:_y,motion:Ry}=o._Scene;function Cy(e){const{negative:t,innerRadius:i,outerRadius:o,stackInnerRadius:a,stackOuterRadius:s}=e;return{innerRadius:t?s:a,outerRadius:t?a:s,clipInnerRadius:t?o:i,clipOuterRadius:t?i:o}}function wy(e,t){const{startAngle:i,endAngle:o}=t,{innerRadius:a,outerRadius:s,clipInnerRadius:n,clipOuterRadius:r}=Cy(t);return{innerRadius:a,outerRadius:s,startAngle:i,endAngle:o,clipSector:new _y(i,o,n,r)}}var{Sector:Py,SectorBox:zy}=o._Scene,Ky=class extends dy{constructor(e){super(e,{animationResetFns:{item:wy}}),this.properties=new Ty}getStackId(){var e,t;return`nightingale-stack-${null!=(t=null==(e=this.seriesGrouping)?void 0:e.groupIndex)?t:this.id}-yValues`}nodeFactory(){return new Py}updateItemPath(e,t,i,o){const{negative:a}=t;if(e.centerX=0,e.centerY=0,e.startOuterCornerRadius=a?0:this.properties.cornerRadius,e.endOuterCornerRadius=a?0:this.properties.cornerRadius,e.startInnerCornerRadius=a?this.properties.cornerRadius:0,e.endInnerCornerRadius=a?this.properties.cornerRadius:0,i){const{startAngle:i,endAngle:o}=t,{innerRadius:a,outerRadius:s,clipInnerRadius:n,clipOuterRadius:r}=Cy(t);e.innerRadius=a,e.outerRadius=s,e.startAngle=i,e.endAngle=o,e.clipSector=new zy(i,o,n,r)}}getColumnTransitionFunctions(){return function(e){const t=Oy();return{toFn:(i,o,a)=>{const{startAngle:s,endAngle:n}=t.to(o);let r,l,h;if("removed"===a)r=e,l=e,h=new _y(s,n,r,l);else{let t,i;({innerRadius:r,outerRadius:l,clipInnerRadius:t,clipOuterRadius:i}=Cy(o)),isNaN(r)&&(r=e),isNaN(l)&&(l=e),isNaN(t)&&(t=e),isNaN(i)&&(i=e),h=new _y(s,n,t,i)}return{innerRadius:r,outerRadius:l,startAngle:s,endAngle:n,clipSector:h}},fromFn:(i,o,a)=>{a=Ly(i,o,a),t.calculate(i,o,a);const{startAngle:s,endAngle:n}=t.from(o);let r,l,h;return"removed"===a||"updated"===a?(r=i.innerRadius,l=i.outerRadius,h=i.clipSector):(r=e,l=e),null!=h||(h=new _y(s,n,r,l)),{innerRadius:r,outerRadius:l,startAngle:s,endAngle:n,clipSector:h,phase:Ry.NODE_UPDATE_STATE_TO_PHASE_MAPPING[a]}}}}(this.isRadiusAxisReversed()?this.radius:this.getAxisInnerRadius())}};Ky.className="NightingaleSeries",Ky.type="nightingale";var Vy={series:{__extends__:o._Theme.EXTENDS_SERIES_DEFAULTS,strokeWidth:1,label:{enabled:!1,fontSize:12,fontFamily:o._Theme.DEFAULT_FONT_FAMILY,color:o._Theme.DEFAULT_LABEL_COLOUR}},axes:{[o._Theme.POLAR_AXIS_TYPE.ANGLE_CATEGORY]:{shape:o._Theme.POLAR_AXIS_SHAPE.CIRCLE,groupPaddingInner:0,paddingInner:0,label:{padding:10}},[o._Theme.POLAR_AXIS_TYPE.RADIUS_NUMBER]:{shape:o._Theme.POLAR_AXIS_SHAPE.CIRCLE}}},By={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"nightingale",instanceConstructor:Ky,defaultAxes:[{type:o._Theme.POLAR_AXIS_TYPE.ANGLE_CATEGORY},{type:o._Theme.POLAR_AXIS_TYPE.RADIUS_NUMBER}],themeTemplate:Vy,paletteFactory(e){let{takeColors:t,userPalette:i}=e;const{fills:[a],strokes:[s]}=t(1);return{fill:a,stroke:i?s:o._Theme.DEFAULT_POLAR_SERIES_STROKE}},stackable:!0,groupable:!0,stackedByDefault:!0},Fy=class extends Dl{constructor(){super(),this.append([new o._Scene.Line({tag:0}),new o._Scene.Line({tag:1}),new o._Scene.Line({tag:2})])}updateCoordinates(){const{x:e,y:t,yBottom:i,yHigh:a,yLow:s,width:n,height:r,datum:{itemId:l}}=this,h=o._Scene.Selection.select(this,o._Scene.Rect),[d]=h.selectByTag(0),[c]=h.selectByTag(1),[u]=h.selectByTag(2);if(0===n||0===r)return d.visible=!1,c.visible=!1,void(u.visible=!1);d.visible=!0,c.visible=!0,u.visible=!0;const p=n/2;d.setProperties({x1:Math.floor(e+p),x2:Math.floor(e+p),y1:a,y2:s});const y="up"===l,g=y?i:t,m=y?t:i;c.setProperties({x1:Math.floor(e),x2:Math.floor(e+p),y:Math.round(g)}),u.setProperties({x1:Math.floor(e+p),x2:Math.floor(e+n),y:Math.round(m)})}updateDatumStyles(e,t){const i=o._Scene.Selection.select(this,o._Scene.Rect),[a]=i.selectByTag(0),[s]=i.selectByTag(1),[n]=i.selectByTag(2);a.setProperties(t),s.setProperties(t),n.setProperties(t)}},{BaseProperties:Uy,Validate:jy,COLOR_STRING:Wy,FUNCTION:Yy,LINE_DASH:Gy,OBJECT:Hy,POSITIVE_NUMBER:Xy,RATIO:Qy}=o._ModuleSupport,$y=class extends Uy{constructor(){super(...arguments),this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};f([jy(Wy)],$y.prototype,"stroke",2),f([jy(Xy)],$y.prototype,"strokeWidth",2),f([jy(Qy)],$y.prototype,"strokeOpacity",2),f([jy(Gy)],$y.prototype,"lineDash",2),f([jy(Xy)],$y.prototype,"lineDashOffset",2),f([jy(Yy,{optional:!0})],$y.prototype,"formatter",2);var Zy=class extends Uy{constructor(){super(...arguments),this.up=new $y,this.down=new $y}};f([jy(Hy)],Zy.prototype,"up",2),f([jy(Hy)],Zy.prototype,"down",2);var qy=class extends rh{constructor(){super(new Zy)}},{mergeDefaults:Jy}=o._ModuleSupport,eg=class extends Gl{constructor(e){super(e,kl),this.properties=new qy}createNodeData(){return S(this,null,(function*(){const e=this.createBaseNodeData();if(!e)return;const t=e.nodeData.map((e=>{const{stroke:t,strokeWidth:i,strokeOpacity:o,lineDash:a,lineDashOffset:s}=this.getItemConfig(e.itemId);return m(g({},e),{stroke:t,strokeWidth:i,strokeOpacity:o,lineDash:a,lineDashOffset:s})}));return m(g({},e),{nodeData:t})}))}nodeFactory(){return new Fy}getFormatterParams(e){return e}getSeriesStyles(e){const{stroke:t,strokeWidth:i,strokeOpacity:o,lineDash:a,lineDashOffset:s}=e;return{stroke:t,strokeWidth:i,strokeOpacity:o,lineDash:a,lineDashOffset:s}}getActiveStyles(e,t){const i=this.getFormattedStyles(e,t);return t?Jy(this.properties.highlightStyle.item,i):i}computeFocusBounds(e){return Ol(this,e)}};eg.className="ohlc",eg.type="ohlc";var tg={series:{__extends__:o._Theme.EXTENDS_SERIES_DEFAULTS,direction:"vertical"},animation:{enabled:!1},axes:{[o._Theme.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{snap:!1}},[o._Theme.CARTESIAN_AXIS_TYPE.ORDINAL_TIME]:{groupPaddingInner:0,crosshair:{enabled:!0}}}},ig={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"ohlc",instanceConstructor:eg,defaultAxes:[{type:o._Theme.CARTESIAN_AXIS_TYPE.NUMBER,position:o._Theme.POSITION.LEFT},{type:o._Theme.CARTESIAN_AXIS_TYPE.ORDINAL_TIME,position:o._Theme.POSITION.BOTTOM}],themeTemplate:tg,groupable:!1,paletteFactory:e=>{let{takeColors:t,colorsCount:i,userPalette:a,themeTemplateParameters:s}=e;const{strokes:[n]}=t(i),{strokes:r}=s.properties.get(o._Theme.DEFAULT_COLOURS);return{item:{up:{stroke:a?n:r.GREEN},down:{stroke:a?n:r.RED}}}}},og={series:{__extends__:o._Theme.EXTENDS_SERIES_DEFAULTS,label:{enabled:!1,fontSize:12,fontFamily:o._Theme.DEFAULT_FONT_FAMILY,color:o._Theme.DEFAULT_LABEL_COLOUR},marker:{enabled:!0,fillOpacity:1,shape:"circle",size:6,strokeOpacity:1,strokeWidth:0}},axes:{[o._Theme.POLAR_AXIS_TYPE.ANGLE_CATEGORY]:{label:{padding:10}}}},ag=o._ModuleSupport.mergeDefaults({series:{strokeWidth:2}},og),sg=o._ModuleSupport.mergeDefaults({series:{fillOpacity:.8,strokeWidth:2,marker:{enabled:!1}}},og),{Label:ng}=o._Scene,{SeriesMarker:rg,SeriesProperties:lg,SeriesTooltip:hg,Validate:dg,BOOLEAN:cg,COLOR_STRING:ug,DEGREE:pg,FUNCTION:yg,LINE_DASH:gg,OBJECT:mg,POSITIVE_NUMBER:xg,RATIO:fg,STRING:vg}=o._ModuleSupport,Sg=class extends lg{constructor(){super(...arguments),this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.rotation=0,this.marker=new rg,this.label=new ng,this.tooltip=new hg,this.connectMissingData=!1}};f([dg(vg)],Sg.prototype,"angleKey",2),f([dg(vg)],Sg.prototype,"radiusKey",2),f([dg(vg,{optional:!0})],Sg.prototype,"angleName",2),f([dg(vg,{optional:!0})],Sg.prototype,"radiusName",2),f([dg(ug)],Sg.prototype,"stroke",2),f([dg(xg)],Sg.prototype,"strokeWidth",2),f([dg(fg)],Sg.prototype,"strokeOpacity",2),f([dg(gg)],Sg.prototype,"lineDash",2),f([dg(xg)],Sg.prototype,"lineDashOffset",2),f([dg(yg,{optional:!0})],Sg.prototype,"formatter",2),f([dg(pg)],Sg.prototype,"rotation",2),f([dg(mg)],Sg.prototype,"marker",2),f([dg(mg)],Sg.prototype,"label",2),f([dg(mg)],Sg.prototype,"tooltip",2),f([dg(cg)],Sg.prototype,"connectMissingData",2);var{ChartAxisDirection:Mg,PolarAxis:Dg,SeriesNodePickMode:bg,valueProperty:Ng,fixNumericExtent:Ig,seriesLabelFadeInAnimation:kg,markerFadeInAnimation:Tg,resetMarkerFn:Ag,animationValidation:Og,isFiniteNumber:Lg,computeMarkerFocusBounds:Eg}=o._ModuleSupport,{BBox:_g,Group:Rg,Path:Cg,PointerEvents:wg,Selection:Pg,Text:zg,getMarker:Kg}=o._Scene,{extent:Vg,isNumberEqual:Bg,sanitizeHtml:Fg,toFixed:Ug}=o._Util,jg=class extends o._ModuleSupport.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.angleKey=o.properties.angleKey,this.radiusKey=o.properties.radiusKey}},Wg=class extends o._ModuleSupport.PolarSeries{constructor(e){super({moduleCtx:e,useLabelLayer:!0,pickModes:[bg.NEAREST_NODE,bg.EXACT_SHAPE_MATCH],canHaveAxes:!0,animationResetFns:{item:Ag}}),this.properties=new Sg,this.NodeEvent=jg,this.resetInvalidToZero=!1,this.seriesItemEnabled=[],this.circleCache={r:0,cx:0,cy:0};const t=new Rg;this.contentGroup.append(t),this.lineSelection=Pg.select(t,Cg),t.zIndexSubOrder=[()=>this._declarationOrder,1]}nodeFactory(){const{shape:e}=this.properties.marker;return new(Kg(e))}addChartEventListeners(){var e,t;this.destroyFns.push(null==(e=this.ctx.chartEventManager)?void 0:e.addListener("legend-item-click",(e=>this.onLegendItemClick(e))),null==(t=this.ctx.chartEventManager)?void 0:t.addListener("legend-item-double-click",(e=>this.onLegendItemDoubleClick(e))))}getSeriesDomain(e){const{dataModel:t,processedData:i}=this;if(!i||!t)return[];if(e===Mg.X)return t.getDomain(this,"angleValue","value",i);{const e=t.getDomain(this,"radiusValue","value",i),o=Vg(0===e.length?e:[0].concat(e));return Ig(o)}}processData(e){return S(this,null,(function*(){var t,i;if(!this.properties.isValid())return;const{angleKey:o,radiusKey:a}=this.properties,s=[];this.ctx.animationManager.isSkipped()||s.push(Og());const n=null==(t=this.axes[Mg.Y])?void 0:t.scale.type,r=null==(i=this.axes[Mg.X])?void 0:i.scale.type;yield this.requestDataModel(e,this.data,{props:[Ng(o,r,{id:"angleValue"}),Ng(a,n,{id:"radiusValue",invalidValue:void 0}),...s]}),this.animationState.transition("updateData")}))}didCircleChange(){const e=this.radius,t=this.centerX,i=this.centerY,o=this.circleCache;return(e!==o.r||t!==o.cx||i!==o.cy)&&(this.circleCache={r:e,cx:t,cy:i},!0)}getAxisInnerRadius(){const e=this.axes[Mg.Y];return e instanceof Dg?this.radius*e.innerRadiusRatio:0}maybeRefreshNodeData(){return S(this,null,(function*(){var e;if(!this.didCircleChange()&&!this.nodeDataRefresh)return;const{nodeData:t=[]}=null!=(e=yield this.createNodeData())?e:{};this.nodeData=t,this.nodeDataRefresh=!1}))}createNodeData(){return S(this,null,(function*(){var e,t;const{processedData:i,dataModel:a}=this;if(!i||!a||!this.properties.isValid())return;const{angleKey:s,radiusKey:n,angleName:r,radiusName:l,marker:h,label:d}=this.properties,c=null==(e=this.axes[Mg.X])?void 0:e.scale,u=null==(t=this.axes[Mg.Y])?void 0:t.scale;if(!c||!u)return;const p=a.resolveProcessedDataIndexById(this,"angleValue"),y=a.resolveProcessedDataIndexById(this,"radiusValue"),g=this.getAxisInnerRadius(),{seriesItemEnabled:m}=this;m.length=0;const x=i.data.map((e=>{const{datum:t,values:i}=e,a=i[p],x=i[y],f=c.convert(a),v=this.radius+g-u.convert(x);o._Util.isNumber(f)&&o._Util.isNumber(v)?m.push(!0):m.push(!1);const S=Math.cos(f),M=Math.sin(f),D=S*v,b=M*v;let N;if(d.enabled){const e=this.getLabelText(d,{value:x,datum:t,angleKey:s,radiusKey:n,angleName:r,radiusName:l},(e=>Lg(e)?e.toFixed(2):String(e)));if(e){let t="right";Bg(S,0)?t="center":S>0&&(t="left");let i="bottom";Bg(M,0)?i="middle":M>0&&(i="top"),N={x:D+S*h.size,y:b+M*h.size,text:e,textAlign:t,textBaseline:i}}}return{series:this,datum:t,point:{x:D,y:b,size:h.size},midPoint:{x:D,y:b},label:N,angleValue:a,radiusValue:x}}));return{itemId:n,nodeData:x,labelData:x}}))}update(e){return S(this,arguments,(function(e){var t=this;let{seriesRect:i}=e;return function*(){var e,o;const a=t.checkResize(i),s=!t.ctx.animationManager.isSkipped(),{series:n}=null!=(o=null==(e=t.ctx.highlightManager)?void 0:e.getActiveHighlight())?o:{};t.highlightGroup.visible=(s||t.visible)&&!(n!==t),yield t.maybeRefreshNodeData(),t.contentGroup.translationX=t.centerX,t.contentGroup.translationY=t.centerY,t.highlightGroup.translationX=t.centerX,t.highlightGroup.translationY=t.centerY,t.labelGroup&&(t.labelGroup.translationX=t.centerX,t.labelGroup.translationY=t.centerY),t.updatePathSelections(),t.updateMarkerSelection(),t.updateMarkers(t.itemSelection,!1),t.updateMarkers(t.highlightSelection,!0),t.updateLabels(),a&&t.animationState.transition("resize"),t.animationState.transition("update")}()}))}updatePathSelections(){const e=this.visible?[!0]:[];this.lineSelection.update(e)}updateMarkerSelection(){this.properties.marker.isDirty()&&(this.itemSelection.clear(),this.itemSelection.cleanup(),this.itemSelection=Pg.select(this.itemGroup,(()=>this.nodeFactory()),!1)),this.itemSelection.update(this.properties.marker.enabled?this.nodeData:[])}getMarkerFill(e){var t;return null!=(t=null==e?void 0:e.fill)?t:this.properties.marker.fill}updateMarkers(e,t){var i;const{angleKey:o,radiusKey:a,marker:s,visible:n}=this.properties;let r=[];if(n&&s.shape&&s.enabled)if(t){const e=null==(i=this.ctx.highlightManager)?void 0:i.getActiveHighlight();(null==e?void 0:e.datum)&&(r=[e])}else r=this.nodeData;const l=t?this.properties.highlightStyle.item:void 0;e.update(r).each(((e,i)=>{var r,h,d,c,u,p,y,g,m,x,f,v,S;const M=this.getMarkerFill(l),D=null!=(h=null!=(r=null==l?void 0:l.stroke)?r:s.stroke)?h:this.properties.stroke,b=null!=(u=null!=(c=null!=(d=null==l?void 0:l.strokeWidth)?d:s.strokeWidth)?c:this.properties.strokeWidth)?u:1,N=s.formatter?this.ctx.callbackCache.call(s.formatter,{datum:i.datum,angleKey:o,radiusKey:a,fill:M,stroke:D,strokeWidth:b,size:s.size,highlighted:t,seriesId:this.id}):void 0;e.fill=null!=(p=null==N?void 0:N.fill)?p:M,e.stroke=null!=(y=null==N?void 0:N.stroke)?y:D,e.strokeWidth=null!=(g=null==N?void 0:N.strokeWidth)?g:b,e.fillOpacity=null!=(x=null!=(m=null==l?void 0:l.fillOpacity)?m:s.fillOpacity)?x:1,e.strokeOpacity=null!=(v=null!=(f=s.strokeOpacity)?f:this.properties.strokeOpacity)?v:1,e.size=null!=(S=null==N?void 0:N.size)?S:s.size;const{x:I,y:k}=i.point;e.translationX=I,e.translationY=k,e.visible=n&&e.size>0&&!isNaN(I)&&!isNaN(k)}))}updateLabels(){const{label:e}=this.properties;this.labelSelection.update(this.nodeData).each(((t,i)=>{e.enabled&&i.label?(t.x=i.label.x,t.y=i.label.y,t.fill=e.color,t.fontFamily=e.fontFamily,t.fontSize=e.fontSize,t.fontStyle=e.fontStyle,t.fontWeight=e.fontWeight,t.text=i.label.text,t.textAlign=i.label.textAlign,t.textBaseline=i.label.textBaseline,t.visible=!0):t.visible=!1}))}getTooltipHtml(e){var t;if(!this.properties.isValid())return o._ModuleSupport.EMPTY_TOOLTIP_CONTENT;const{id:i}=this,{angleKey:a,radiusKey:s,angleName:n,radiusName:r,marker:l,tooltip:h}=this.properties,{datum:d,angleValue:c,radiusValue:u,itemId:p}=e,y="number"===typeof c?Ug(c):String(c),g="number"===typeof u?Ug(u):String(u),m=Fg(r),x=Fg(`${y}: ${g}`),{formatter:f,fill:v,stroke:S,strokeWidth:M,size:D}=l,b=null!=M?M:this.properties.strokeWidth,{fill:N}=null!=(t=f&&this.ctx.callbackCache.call(f,{datum:d,angleKey:a,radiusKey:s,fill:v,stroke:S,strokeWidth:b,size:D,highlighted:!1,seriesId:i}))?t:{fill:v};return h.toTooltipHtml({title:m,content:x,backgroundColor:N},{datum:d,angleKey:a,angleName:n,radiusKey:s,radiusName:r,title:m,color:N,seriesId:i,itemId:p})}getLegendData(e){var t,i,o,a,s,n,r,l,h,d;if(!(null==(t=this.data)?void 0:t.length)||!this.properties.isValid()||"category"!==e)return[];const{radiusKey:c,radiusName:u,stroke:p,strokeWidth:y,strokeOpacity:g,lineDash:m,visible:x,marker:f}=this.properties;return[{legendType:"category",id:this.id,itemId:c,seriesId:this.id,enabled:x,label:{text:null!=u?u:c},marker:{shape:f.shape,fill:null!=(a=null!=(o=null!=(i=this.getMarkerFill())?i:f.stroke)?o:p)?a:"rgba(0, 0, 0, 0)",stroke:null!=(n=null!=(s=f.stroke)?s:p)?n:"rgba(0, 0, 0, 0)",fillOpacity:null!=(r=f.fillOpacity)?r:1,strokeOpacity:null!=(h=null!=(l=f.strokeOpacity)?l:g)?h:1,strokeWidth:null!=(d=f.strokeWidth)?d:0,enabled:f.enabled||y<=0},line:{stroke:p,strokeOpacity:g,strokeWidth:y,lineDash:m}}]}onLegendItemClick(e){const{enabled:t,itemId:i,series:o}=e;o.id===this.id&&this.toggleSeriesItem(i,t)}onLegendItemDoubleClick(e){const{enabled:t,itemId:i,series:o,numVisibleItems:a}=e,s=o.id===this.id||t&&1===a;this.toggleSeriesItem(i,s)}pickNodeClosestDatum(e){var t,i;const{x:o,y:a}=e,{rootGroup:s,nodeData:n,centerX:r,centerY:l}=this,h=s.transformPoint(o,a),d=this.radius;if(Math.sqrt(p(o-r,2)+p(a-l,2))>d+this.properties.marker.size)return;let c,u=1/0;for(const y of n){const{point:{x:e=NaN,y:t=NaN}={}}=y;if(isNaN(e)||isNaN(t))continue;const i=Math.sqrt(p(h.x-e-r,2)+p(h.y-t-l,2));i<u&&(u=i,c=y)}if(c){return{datum:c,distance:Math.max(u-(null!=(i=null==(t=c.point)?void 0:t.size)?i:0),0)}}}computeLabelsBBox(){return S(this,null,(function*(){const{label:e}=this.properties;yield this.maybeRefreshNodeData();const t=[],i=new zg;return this.nodeData.forEach((o=>{if(!e.enabled||!o.label)return;i.text=o.label.text,i.x=o.label.x,i.y=o.label.y,i.setFont(e),i.setAlign(o.label);const a=i.computeBBox();t.push(a)})),0===t.length?null:_g.merge(t)}))}getLineNode(){return this.lineSelection.nodes()[0]}beforePathAnimation(){const e=this.getLineNode();e.fill=void 0,e.lineJoin="round",e.lineCap="round",e.pointerEvents=wg.None,e.stroke=this.properties.stroke,e.strokeWidth=this.getStrokeWidth(this.properties.strokeWidth),e.strokeOpacity=this.properties.strokeOpacity,e.lineDash=this.properties.lineDash,e.lineDashOffset=this.properties.lineDashOffset}getLinePoints(){const{nodeData:e,resetInvalidToZero:t}=this,{connectMissingData:i}=this.properties;if(0===e.length)return[];const o=this.axes[Mg.Y],a=this.axes[Mg.X],s=null==a?void 0:a.isReversed(),n=(null==o?void 0:o.isReversed())&&!s?[...e].reverse():e,r=[];let l,h=!1;return n.forEach(((e,o)=>{let{x:a,y:s}=e.point;const n=isNaN(a)||isNaN(s);n||null!=l||(l=e),n&&!i&&(a=0,s=0);const d=0===o||!t&&!i&&(n||h);r.push({x:a,y:s,moveTo:d}),h=n})),void 0!==l&&r.push({x:l.point.x,y:l.point.y,moveTo:!1}),r}animateSinglePath(e,t,i){const{path:o}=e;o.clear(!0);const a=this.getAxisInnerRadius(),s=this.axes[Mg.Y],n=(null==s?void 0:s.isReversed())?this.radius+a-(null==s?void 0:s.scale.convert(0)):a;t.forEach((e=>{const{x:t,y:a,arc:s,radius:r=0,startAngle:l=0,endAngle:h=0,moveTo:d}=e,c=Math.atan2(a,t),u=n*Math.cos(c),p=n*Math.sin(c),y=u*(1-i)+t*i,g=p*(1-i)+a*i;s?o.arc(t,a,r,l,h):d?o.moveTo(y,g):o.lineTo(y,g)})),e.checkPathDirty()}animatePaths(e){const t=this.getLinePoints();this.animateSinglePath(this.getLineNode(),t,e)}animateEmptyUpdateReady(){const{itemSelection:e,labelSelection:t}=this,{animationManager:i}=this.ctx;this.beforePathAnimation(),i.animate({id:`${this.id}_'path`,groupId:this.id,from:0,to:1,phase:"initial",collapsable:!1,onUpdate:e=>this.animatePaths(e),onStop:()=>this.animatePaths(1)}),Tg(this,i,"added",e),kg(this,"labels",i,t)}animateWaitingUpdateReady(e){super.animateWaitingUpdateReady(e),this.resetPaths()}animateReadyResize(e){super.animateReadyResize(e),this.resetPaths()}resetPaths(){const e=this.getLineNode();if(e){const{path:t}=e,i=this.getLinePoints();e.fill=void 0,e.stroke=this.properties.stroke,e.strokeWidth=this.getStrokeWidth(this.properties.strokeWidth),e.strokeOpacity=this.properties.strokeOpacity,e.lineDash=this.properties.lineDash,e.lineDashOffset=this.properties.lineDashOffset,t.clear(!0),i.forEach((e=>{let{x:i,y:o,moveTo:a}=e;a?t.moveTo(i,o):t.lineTo(i,o)})),e.checkPathDirty()}}getFormattedMarkerStyle(e){const{angleKey:t,radiusKey:i}=this.properties;return this.getMarkerStyle(this.properties.marker,{datum:e,angleKey:t,radiusKey:i,highlighted:!0})}computeFocusBounds(e){return Eg(this,e)}};Wg.className="RadarSeries";var{RATIO:Yg,COLOR_STRING:Gg,Validate:Hg}=o._ModuleSupport,Xg=class extends Sg{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1}};f([Hg(Gg)],Xg.prototype,"fill",2),f([Hg(Yg)],Xg.prototype,"fillOpacity",2);var{Group:Qg,Path:$g,PointerEvents:Zg,Selection:qg}=o._Scene,{ChartAxisDirection:Jg}=o._ModuleSupport,em=class extends Wg{constructor(e){super(e),this.properties=new Xg,this.resetInvalidToZero=!0;const t=new Qg;t.zIndexSubOrder=[()=>this._declarationOrder,0],this.contentGroup.append(t),this.areaSelection=qg.select(t,$g)}updatePathSelections(){const e=this.visible?[!0]:[];this.areaSelection.update(e),super.updatePathSelections()}getAreaNode(){return this.areaSelection.nodes()[0]}getMarkerFill(e){var t,i;return null!=(i=null!=(t=null==e?void 0:e.fill)?t:this.properties.marker.fill)?i:this.properties.fill}beforePathAnimation(){super.beforePathAnimation();const e=this.getAreaNode();e.fill=this.properties.fill,e.fillOpacity=this.properties.fillOpacity,e.pointerEvents=Zg.None,e.stroke=void 0}animatePaths(e){super.animatePaths(e),this.animateSinglePath(this.getAreaNode(),this.getAreaPoints(),e)}getAreaPoints(){var e,t;const i=this.getLinePoints(),a=e=>{const t=this.axes[e];return t instanceof o._ModuleSupport.PolarAxis?t:void 0},s=a(Jg.Y),n=a(Jg.X);if(!(null==s?void 0:s.isReversed()))return i;const{points:r=[]}=null!=(t=null==(e=null==n?void 0:n.getAxisLinePoints)?void 0:e.call(n))?t:{};return i.concat(...r)}resetPaths(){super.resetPaths();const e=this.getAreaNode();if(e){const{path:t}=e,i=this.getAreaPoints();e.fill=this.properties.fill,e.fillOpacity=this.properties.fillOpacity,e.stroke=void 0,e.lineDash=this.properties.lineDash,e.lineDashOffset=this.properties.lineDashOffset,e.lineJoin=e.lineCap="round",t.clear(!0),i.forEach((e=>{let{x:i,y:o,moveTo:a,arc:s,radius:n=0,startAngle:r=0,endAngle:l=0}=e;s?t.arc(i,o,n,r,l):a?t.moveTo(i,o):t.lineTo(i,o)})),t.closePath(),e.checkPathDirty()}}};em.className="RadarAreaSeries",em.type="radar-area";var{markerPaletteFactory:tm}=o._ModuleSupport,im={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radar-area",instanceConstructor:em,defaultAxes:[{type:o._Theme.POLAR_AXIS_TYPE.ANGLE_CATEGORY},{type:o._Theme.POLAR_AXIS_TYPE.RADIUS_NUMBER}],themeTemplate:sg,paletteFactory:e=>{const{marker:t}=tm(e);return{stroke:t.stroke,fill:t.fill,marker:t}}},om=class extends Wg{updatePathSelections(){this.lineSelection.update(this.visible?[!0]:[])}};om.className="RadarLineSeries",om.type="radar-line";var am={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radar-line",instanceConstructor:om,defaultAxes:[{type:o._Theme.POLAR_AXIS_TYPE.ANGLE_CATEGORY},{type:o._Theme.POLAR_AXIS_TYPE.RADIUS_NUMBER}],themeTemplate:ag,paletteFactory:e=>{let{takeColors:t}=e;const{fills:[i],strokes:[o]}=t(1);return{stroke:i,marker:{fill:i,stroke:o}}}},{Label:sm}=o._Scene,{SeriesProperties:nm,SeriesTooltip:rm,Validate:lm,COLOR_STRING:hm,DEGREE:dm,FUNCTION:cm,LINE_DASH:um,NUMBER:pm,OBJECT:ym,POSITIVE_NUMBER:gm,RATIO:mm,STRING:xm}=o._ModuleSupport,fm=class extends nm{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.label=new sm,this.tooltip=new rm}};f([lm(xm)],fm.prototype,"angleKey",2),f([lm(xm)],fm.prototype,"radiusKey",2),f([lm(xm,{optional:!0})],fm.prototype,"angleName",2),f([lm(xm,{optional:!0})],fm.prototype,"radiusName",2),f([lm(hm)],fm.prototype,"fill",2),f([lm(mm)],fm.prototype,"fillOpacity",2),f([lm(hm)],fm.prototype,"stroke",2),f([lm(gm)],fm.prototype,"strokeWidth",2),f([lm(mm)],fm.prototype,"strokeOpacity",2),f([lm(um)],fm.prototype,"lineDash",2),f([lm(gm)],fm.prototype,"lineDashOffset",2),f([lm(gm)],fm.prototype,"cornerRadius",2),f([lm(cm,{optional:!0})],fm.prototype,"formatter",2),f([lm(dm)],fm.prototype,"rotation",2),f([lm(xm,{optional:!0})],fm.prototype,"stackGroup",2),f([lm(pm,{optional:!0})],fm.prototype,"normalizedTo",2),f([lm(ym)],fm.prototype,"label",2),f([lm(ym)],fm.prototype,"tooltip",2);var{SectorBox:vm,motion:Sm}=o._Scene;function Mm(e){return{toFn:(t,i,o)=>{let a,s,n,r,l;return"removed"===o?(a=e,s=e,n=i.innerRadius,r=i.outerRadius,l=new vm(a,s,n,r)):(a=i.startAngle,s=i.endAngle,n=isNaN(i.innerRadius)?t.innerRadius:i.innerRadius,r=isNaN(i.outerRadius)?t.outerRadius:i.outerRadius,l=i.clipSector),{startAngle:a,endAngle:s,innerRadius:n,outerRadius:r,clipSector:l}},fromFn:(t,i,o)=>{let a,s,n,r,l;o=function(e,t,i){if("updated"===i){if(null==e.previousDatum||isNaN(e.previousDatum.innerRadius)||isNaN(e.previousDatum.outerRadius))return"added";if(isNaN(t.innerRadius)||isNaN(t.outerRadius))return"removed"}return"added"===i&&null!=e.previousDatum?"updated":i}(t,i,o),"removed"===o||"updated"===o?(a=t.startAngle,s=t.endAngle,n=t.innerRadius,r=t.outerRadius,l=t.clipSector):(a=e,s=e,n=i.innerRadius,r=i.outerRadius),null!=l||(l=new vm(a,s,n,r));return{startAngle:a,endAngle:s,innerRadius:n,outerRadius:r,clipSector:l,phase:Sm.NODE_UPDATE_STATE_TO_PHASE_MAPPING[o]}}}}function Dm(e,t){return{centerX:0,centerY:0,innerRadius:t.innerRadius,outerRadius:t.outerRadius,startAngle:t.startAngle,endAngle:t.endAngle,clipSector:t.clipSector}}var{ChartAxisDirection:bm,PolarAxis:Nm,diff:Im,isDefined:km,groupAccumulativeValueProperty:Tm,keyProperty:Am,normaliseGroupTo:Om,valueProperty:Lm,fixNumericExtent:Em,resetLabelFn:_m,seriesLabelFadeInAnimation:Rm,seriesLabelFadeOutAnimation:Cm,animationValidation:wm,isFiniteNumber:Pm,computeSectorFocusBounds:zm}=o._ModuleSupport,{BandScale:Km}=o._Scale,{Sector:Vm,SectorBox:Bm,motion:Fm}=o._Scene,{angleBetween:Um,isNumber:jm,sanitizeHtml:Wm}=o._Util,Ym=class extends o._ModuleSupport.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.angleKey=o.properties.angleKey,this.radiusKey=o.properties.radiusKey}},Gm=class extends o._ModuleSupport.PolarSeries{constructor(e){super({moduleCtx:e,useLabelLayer:!0,canHaveAxes:!0,animationResetFns:{item:Dm,label:_m}}),this.properties=new fm,this.NodeEvent=Ym,this.groupScale=new Km,this.circleCache={r:0,cx:0,cy:0}}nodeFactory(){return new Vm}addChartEventListeners(){var e,t;this.destroyFns.push(null==(e=this.ctx.chartEventManager)?void 0:e.addListener("legend-item-click",(e=>this.onLegendItemClick(e))),null==(t=this.ctx.chartEventManager)?void 0:t.addListener("legend-item-double-click",(e=>this.onLegendItemDoubleClick(e))))}getSeriesDomain(e){const{axes:t,dataModel:i,processedData:o}=this;if(!o||!i)return[];if(e===bm.X){const e=t[bm.X],a=i.getDomain(this,"angleValue-end","value",o),s=[a[0]>0?0:a[0],a[1]<0?0:a[1]];return Em(s,e)}return i.getDomain(this,"radiusValue","key",o)}processData(e){return S(this,null,(function*(){var t,i;const{angleKey:o,radiusKey:a,normalizedTo:s,visible:n}=this.properties,r=!this.ctx.animationManager.isSkipped();if(!this.properties.isValid()||!n&&!r)return;const l=this.getStackId(),h=`${l}-trailing`,d=[];km(s)&&d.push(Om([l,h],Math.abs(s),"range")),r&&(this.processedData&&d.push(Im(this.processedData)),d.push(wm()));const c=this.visible||!r?{}:{forceValue:0},u=null==(t=this.axes[bm.Y])?void 0:t.scale.type,p=null==(i=this.axes[bm.X])?void 0:i.scale.type;yield this.requestDataModel(e,this.data,{props:[Am(a,u,{id:"radiusValue"}),Lm(o,p,g({id:"angleValue-raw",invalidValue:null},c)),...Tm(o,"normal","current",g({id:"angleValue-end",rangeId:"angleValue-range",invalidValue:null,groupId:l,separateNegative:!0},c),p),...Tm(o,"trailing","current",g({id:"angleValue-start",invalidValue:null,groupId:h,separateNegative:!0},c),p),...d]}),this.animationState.transition("updateData")}))}didCircleChange(){const e=this.radius,t=this.centerX,i=this.centerY,o=this.circleCache;return(e!==o.r||t!==o.cx||i!==o.cy)&&(this.circleCache={r:e,cx:t,cy:i},!0)}maybeRefreshNodeData(){return S(this,null,(function*(){var e;if(!this.didCircleChange()&&!this.nodeDataRefresh)return;const{nodeData:t=[]}=null!=(e=yield this.createNodeData())?e:{};this.nodeData=t,this.nodeDataRefresh=!1}))}getAxisInnerRadius(){const e=this.axes[bm.Y];return e instanceof Nm?this.radius*e.innerRadiusRatio:0}createNodeData(){return S(this,null,(function*(){var e;const{processedData:t,dataModel:i}=this;if(!t||!i||!this.properties.isValid())return;const o=this.axes[bm.X],a=this.axes[bm.Y],s=null==o?void 0:o.scale,n=null==a?void 0:a.scale;if(!s||!n)return;const r=i.resolveProcessedDataIndexById(this,"angleValue-start"),l=i.resolveProcessedDataIndexById(this,"angleValue-end"),h=i.resolveProcessedDataIndexById(this,"angleValue-range"),d=i.resolveProcessedDataIndexById(this,"angleValue-raw");let c=0;a instanceof Vt&&(c=a.groupPaddingInner);const{groupScale:u}=this,{index:p,visibleGroupCount:y}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);u.domain=Array.from({length:y}).map(((e,t)=>String(t))),u.range=[0,Math.abs(null!=(e=n.bandwidth)?e:0)],u.paddingInner=y>1?c:0;const g=u.bandwidth>=1?u.bandwidth:u.rawBandwidth,m=o.isReversed(),x=a.isReversed(),f=x?this.radius:this.getAxisInnerRadius(),v=(x?this.getAxisInnerRadius():this.radius)+f,{angleKey:S,radiusKey:M,angleName:D,radiusName:b,label:N}=this.properties,I=(e,t,i,o)=>{const a=this.getLabelText(N,{value:t,datum:e,angleKey:S,radiusKey:M,angleName:D,radiusName:b},(e=>Pm(e)?e.toFixed(2):String(e)));if(a)return{x:i,y:o,text:a,textAlign:"center",textBaseline:"middle"}},k=[],T={itemId:M,nodeData:k,labelData:k};return this.visible?(t.data.forEach(((e,t)=>{var i;const{datum:o,keys:a,values:c,aggValues:y}=e,x=a[0],f=c[d],S=f>=0&&!Object.is(f,-0),M=c[r],D=c[l],b=null!=(i=null==y?void 0:y[h][S?1:0])?i:0,N=S===m;let T=s.convert(M,{clampMode:"clamped"}),A=s.convert(D,{clampMode:"clamped"}),O=s.convert(0,{clampMode:"clamped"}),L=s.convert(b,{clampMode:"clamped"});N&&([O,L]=[L,O],[T,A]=[A,T]);const E=v-n.convert(x)+u.convert(String(p)),_=E+g,R=(E+_)/2,C=T+Um(T,A)/2,w=Math.cos(C)*R,P=Math.sin(C)*R,z=this.properties.label.enabled?I(o,f,w,P):void 0,K=new Bm(T,A,E,_);k.push({series:this,datum:o,point:{x:w,y:P,size:0},midPoint:{x:w,y:P},label:z,angleValue:f,radiusValue:x,innerRadius:E,outerRadius:_,startAngle:O,endAngle:L,clipSector:K,reversed:N,index:t})})),T):T}))}update(e){return S(this,arguments,(function(e){var t=this;let{seriesRect:i}=e;return function*(){const e=t.checkResize(i);yield t.maybeRefreshNodeData(),t.contentGroup.translationX=t.centerX,t.contentGroup.translationY=t.centerY,t.highlightGroup.translationX=t.centerX,t.highlightGroup.translationY=t.centerY,t.labelGroup&&(t.labelGroup.translationX=t.centerX,t.labelGroup.translationY=t.centerY),t.updateSectorSelection(t.itemSelection,!1),t.updateSectorSelection(t.highlightSelection,!0),t.updateLabels(),e&&t.animationState.transition("resize"),t.animationState.transition("update")}()}))}updateSectorSelection(e,t){var i,o,a,s,n;let r=[];if(t){const e=null==(i=this.ctx.highlightManager)?void 0:i.getActiveHighlight();(null==e?void 0:e.datum)&&e.series===this&&(r=[e])}else r=this.nodeData;const l=t?this.properties.highlightStyle.item:void 0,h=null!=(o=null==l?void 0:l.fill)?o:this.properties.fill,d=null!=(a=null==l?void 0:l.fillOpacity)?a:this.properties.fillOpacity,c=null!=(s=null==l?void 0:l.stroke)?s:this.properties.stroke,u=this.properties.strokeOpacity,p=null!=(n=null==l?void 0:l.strokeWidth)?n:this.properties.strokeWidth,y=this.properties.cornerRadius;e.update(r,void 0,(e=>e.radiusValue)).each(((e,i)=>{var o,a,s,n,r;const l=this.properties.formatter?this.ctx.callbackCache.call(this.properties.formatter,{datum:i,fill:h,stroke:c,strokeWidth:p,highlighted:t,angleKey:this.properties.angleKey,radiusKey:this.properties.radiusKey,seriesId:this.id}):void 0;e.fill=null!=(o=null==l?void 0:l.fill)?o:h,e.fillOpacity=null!=(a=null==l?void 0:l.fillOpacity)?a:d,e.stroke=null!=(s=null==l?void 0:l.stroke)?s:c,e.strokeOpacity=u,e.strokeWidth=null!=(n=null==l?void 0:l.strokeWidth)?n:p,e.lineDash=this.properties.lineDash,e.lineJoin="round",e.inset=null!=c?(null!=(r=null==l?void 0:l.strokeWidth)?r:p)/2:0,e.startInnerCornerRadius=i.reversed?y:0,e.startOuterCornerRadius=i.reversed?y:0,e.endInnerCornerRadius=i.reversed?0:y,e.endOuterCornerRadius=i.reversed?0:y,t&&(e.startAngle=i.startAngle,e.endAngle=i.endAngle,e.clipSector=i.clipSector,e.innerRadius=i.innerRadius,e.outerRadius=i.outerRadius)}))}updateLabels(){const{label:e}=this.properties;this.labelSelection.update(this.nodeData).each(((t,i)=>{e.enabled&&i.label?(t.x=i.label.x,t.y=i.label.y,t.fill=e.color,t.fontFamily=e.fontFamily,t.fontSize=e.fontSize,t.fontStyle=e.fontStyle,t.fontWeight=e.fontWeight,t.text=i.label.text,t.textAlign=i.label.textAlign,t.textBaseline=i.label.textBaseline,t.visible=!0):t.visible=!1}))}getBarTransitionFunctions(){var e;const t=null==(e=this.axes[bm.X])?void 0:e.scale;let i=0;if(!t)return Mm(i);const o=Math.min(t.domain[0],t.domain[1]),a=Math.max(t.domain[0],t.domain[1]);return o<=0&&a>=0&&(i=t.convert(0)),Mm(i)}animateEmptyUpdateReady(){const{labelSelection:e}=this,t=this.getBarTransitionFunctions();Fm.fromToMotion(this.id,"datums",this.ctx.animationManager,[this.itemSelection],t),Rm(this,"labels",this.ctx.animationManager,e)}animateClearingUpdateEmpty(){const{itemSelection:e}=this,{animationManager:t}=this.ctx,i=this.getBarTransitionFunctions();Fm.fromToMotion(this.id,"datums",t,[e],i),Cm(this,"labels",t,this.labelSelection)}getTooltipHtml(e){var t;const{id:i,axes:a,dataModel:s}=this,{angleKey:n,angleName:r,radiusKey:l,radiusName:h,fill:d,stroke:c,strokeWidth:u,formatter:p,tooltip:y}=this.properties,{angleValue:g,radiusValue:m,datum:x,itemId:f}=e,v=a[bm.X],S=a[bm.Y];if(!this.properties.isValid()||!(v&&S&&jm(g))||!s)return o._ModuleSupport.EMPTY_TOOLTIP_CONTENT;const M=v.formatDatum(g),D=S.formatDatum(m),b=Wm(r),N=Wm(`${D}: ${M}`),{fill:I}=null!=(t=p&&this.ctx.callbackCache.call(p,{datum:x,fill:d,stroke:c,strokeWidth:u,highlighted:!1,angleKey:n,radiusKey:l,seriesId:i}))?t:{fill:d};return y.toTooltipHtml({title:b,backgroundColor:d,content:N},{seriesId:i,datum:x,color:I,title:b,angleKey:n,radiusKey:l,angleName:r,radiusName:h,angleValue:g,itemId:f,radiusValue:m})}getLegendData(e){var t;if(!(null==(t=this.data)?void 0:t.length)||!this.properties.isValid()||"category"!==e)return[];const{angleKey:i,angleName:o,fill:a,stroke:s,fillOpacity:n,strokeOpacity:r,strokeWidth:l,visible:h}=this.properties;return[{legendType:"category",id:this.id,itemId:i,seriesId:this.id,enabled:h,label:{text:null!=o?o:i},marker:{fill:null!=a?a:"rgba(0, 0, 0, 0)",stroke:null!=s?s:"rgba(0, 0, 0, 0)",fillOpacity:null!=n?n:1,strokeOpacity:null!=r?r:1,strokeWidth:l}}]}onLegendItemClick(e){const{enabled:t,itemId:i,series:o}=e;o.id===this.id&&this.toggleSeriesItem(i,t)}onLegendItemDoubleClick(e){const{enabled:t,itemId:i,series:o,numVisibleItems:a}=e,s=o.id===this.id||t&&1===a;this.toggleSeriesItem(i,s)}computeLabelsBBox(){return null}getStackId(){var e,t;return`radialBar-stack-${null!=(t=null==(e=this.seriesGrouping)?void 0:e.groupIndex)?t:this.id}-xValues`}computeFocusBounds(e){return zm(this,e)}};Gm.className="RadialBarSeries",Gm.type="radial-bar";var Hm={series:{__extends__:o._Theme.EXTENDS_SERIES_DEFAULTS,strokeWidth:0,label:{enabled:!1,fontSize:12,fontFamily:o._Theme.DEFAULT_FONT_FAMILY,color:o._Theme.DEFAULT_INVERTED_LABEL_COLOUR}},axes:{[o._Theme.POLAR_AXIS_TYPE.RADIUS_CATEGORY]:{innerRadiusRatio:.2,groupPaddingInner:.2,paddingInner:.2,paddingOuter:.1}}},Xm={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radial-bar",instanceConstructor:Gm,defaultAxes:[{type:o._Theme.POLAR_AXIS_TYPE.ANGLE_NUMBER},{type:o._Theme.POLAR_AXIS_TYPE.RADIUS_CATEGORY}],themeTemplate:Hm,paletteFactory:e=>{let{takeColors:t}=e;const{fills:[i],strokes:[o]}=t(1);return{fill:i,stroke:o}},stackable:!0,groupable:!0},{Validate:Qm,RATIO:$m}=o._ModuleSupport,Zm=class extends Ny{};f([Qm($m,{optional:!0})],Zm.prototype,"columnWidthRatio",2),f([Qm($m,{optional:!0})],Zm.prototype,"maxColumnWidthRatio",2);var{ChartAxisDirection:qm,PolarAxis:Jm}=o._ModuleSupport,{RadialColumnShape:ex,getRadialColumnWidth:tx}=o._Scene,ix=class extends dy{constructor(e){super(e,{animationResetFns:{item:Ey}}),this.properties=new Zm}getStackId(){var e,t;return`radarColumn-stack-${null!=(t=null==(e=this.seriesGrouping)?void 0:e.groupIndex)?t:this.id}-yValues`}nodeFactory(){return new ex}getColumnTransitionFunctions(){return function(e){const t=Oy();return{toFn:(i,o,a)=>{const{startAngle:s,endAngle:n}=t.to(o);let r,l,h,d,c;return"removed"===a?(r=i.innerRadius,l=i.innerRadius,h=i.columnWidth,d=i.axisInnerRadius,c=i.axisOuterRadius):(r=isNaN(o.innerRadius)?e:o.innerRadius,l=isNaN(o.outerRadius)?e:o.outerRadius,h=isNaN(o.columnWidth)?i.columnWidth:o.columnWidth,d=o.axisInnerRadius,c=o.axisOuterRadius),{innerRadius:r,outerRadius:l,columnWidth:h,axisInnerRadius:d,axisOuterRadius:c,startAngle:s,endAngle:n}},fromFn:(i,o,a)=>{a=Ly(i,o,a),t.calculate(i,o,a);const{startAngle:s,endAngle:n}=t.from(o);let r,l,h,d,c;return"removed"===a||"updated"===a?(r=i.innerRadius,l=i.outerRadius,h=i.columnWidth,d=i.axisInnerRadius,c=i.axisOuterRadius):(r=e,l=e,h=o.columnWidth,d=o.axisInnerRadius,c=o.axisOuterRadius),{innerRadius:r,outerRadius:l,columnWidth:h,axisInnerRadius:d,axisOuterRadius:c,startAngle:s,endAngle:n,phase:Ay.NODE_UPDATE_STATE_TO_PHASE_MAPPING[a]}}}}(this.isRadiusAxisReversed()?this.radius:this.getAxisInnerRadius())}isRadiusAxisCircle(){const e=this.axes[qm.Y];return e instanceof Jm&&"circle"===e.shape}updateItemPath(e,t,i){e.isBeveled=this.isRadiusAxisCircle(),e.isRadiusAxisReversed=this.isRadiusAxisReversed(),i&&(e.innerRadius=t.innerRadius,e.outerRadius=t.outerRadius,e.startAngle=t.startAngle,e.endAngle=t.endAngle,e.columnWidth=t.columnWidth,e.axisInnerRadius=t.axisInnerRadius,e.axisOuterRadius=t.axisOuterRadius)}getColumnWidth(e,t){const{columnWidthRatio:i=.5,maxColumnWidthRatio:o=.5}=this.properties;return tx(e,t,this.radius,i,o)}};ix.className="RadialColumnSeries",ix.type="radial-column";var ox={series:{__extends__:o._Theme.EXTENDS_SERIES_DEFAULTS,columnWidthRatio:.5,maxColumnWidthRatio:.5,strokeWidth:0,label:{enabled:!1,fontSize:12,fontFamily:o._Theme.DEFAULT_FONT_FAMILY,color:o._Theme.DEFAULT_LABEL_COLOUR}},axes:{[o._Theme.POLAR_AXIS_TYPE.ANGLE_CATEGORY]:{shape:o._Theme.POLAR_AXIS_SHAPE.CIRCLE,groupPaddingInner:0,paddingInner:0,label:{padding:10}},[o._Theme.POLAR_AXIS_TYPE.RADIUS_NUMBER]:{shape:o._Theme.POLAR_AXIS_SHAPE.CIRCLE,innerRadiusRatio:.5}}},ax={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radial-column",instanceConstructor:ix,defaultAxes:[{type:o._Theme.POLAR_AXIS_TYPE.ANGLE_CATEGORY},{type:o._Theme.POLAR_AXIS_TYPE.RADIUS_NUMBER}],themeTemplate:ox,paletteFactory:e=>{let{takeColors:t}=e;const{fills:[i],strokes:[o]}=t(1);return{fill:i,stroke:o}},stackable:!0,groupable:!0},{DropShadow:sx,Label:nx}=o._Scene,{CartesianSeriesProperties:rx,SeriesMarker:lx,SeriesTooltip:hx,Validate:dx,BOOLEAN:cx,COLOR_STRING:ux,LINE_DASH:px,OBJECT:yx,PLACEMENT:gx,POSITIVE_NUMBER:mx,RATIO:xx,STRING:fx}=o._ModuleSupport,vx=class extends nx{constructor(){super(...arguments),this.placement="outside",this.padding=6}};f([dx(gx)],vx.prototype,"placement",2),f([dx(mx)],vx.prototype,"padding",2);var Sx=class extends rx{constructor(){super(...arguments),this.fill="#99CCFF",this.fillOpacity=1,this.stroke="#99CCFF",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.shadow=(new sx).set({enabled:!1}),this.marker=new lx,this.label=new vx,this.tooltip=new hx,this.connectMissingData=!1}};f([dx(fx)],Sx.prototype,"xKey",2),f([dx(fx)],Sx.prototype,"yLowKey",2),f([dx(fx)],Sx.prototype,"yHighKey",2),f([dx(fx,{optional:!0})],Sx.prototype,"xName",2),f([dx(fx,{optional:!0})],Sx.prototype,"yName",2),f([dx(fx,{optional:!0})],Sx.prototype,"yLowName",2),f([dx(fx,{optional:!0})],Sx.prototype,"yHighName",2),f([dx(ux)],Sx.prototype,"fill",2),f([dx(xx)],Sx.prototype,"fillOpacity",2),f([dx(ux)],Sx.prototype,"stroke",2),f([dx(mx)],Sx.prototype,"strokeWidth",2),f([dx(xx)],Sx.prototype,"strokeOpacity",2),f([dx(px)],Sx.prototype,"lineDash",2),f([dx(mx)],Sx.prototype,"lineDashOffset",2),f([dx(yx)],Sx.prototype,"shadow",2),f([dx(yx)],Sx.prototype,"marker",2),f([dx(yx)],Sx.prototype,"label",2),f([dx(yx)],Sx.prototype,"tooltip",2),f([dx(cx)],Sx.prototype,"connectMissingData",2);var{valueProperty:Mx,keyProperty:Dx,ChartAxisDirection:bx,mergeDefaults:Nx,updateLabelNode:Ix,fixNumericExtent:kx,AreaSeriesTag:Tx,buildResetPathFn:Ax,resetLabelFn:Ox,resetMarkerFn:Lx,resetMarkerPositionFn:Ex,pathSwipeInAnimation:_x,resetMotion:Rx,markerSwipeScaleInAnimation:Cx,seriesLabelFadeInAnimation:wx,animationValidation:Px,diff:zx,updateClipPath:Kx,isFiniteNumber:Vx,computeMarkerFocusBounds:Bx}=o._ModuleSupport,{getMarker:Fx,PointerEvents:Ux}=o._Scene,{sanitizeHtml:jx,extent:Wx}=o._Util,Yx=class extends o._ModuleSupport.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.xKey=o.properties.xKey,this.yLowKey=o.properties.yLowKey,this.yHighKey=o.properties.yHighKey}},Gx=class extends o._ModuleSupport.CartesianSeries{constructor(e){super({moduleCtx:e,hasMarkers:!0,pathsPerSeries:2,directionKeys:{[bx.X]:["xKey"],[bx.Y]:["yLowKey","yHighKey"]},directionNames:{[bx.X]:["xName"],[bx.Y]:["yLowName","yHighName","yName"]},animationResetFns:{path:Ax({getOpacity:()=>this.getOpacity()}),label:Ox,marker:(e,t)=>g(g({},Lx(e)),Ex(e,t))}}),this.properties=new Sx,this.NodeEvent=Yx}processData(e){return S(this,null,(function*(){var t,i;if(!this.properties.isValid()||!this.visible)return;const{xKey:o,yLowKey:a,yHighKey:s}=this.properties,n=null==(t=this.axes[bx.X])?void 0:t.scale,r=null==(i=this.axes[bx.Y])?void 0:i.scale,{xScaleType:l,yScaleType:h}=this.getScaleInformation({xScale:n,yScale:r}),d=[],c=!this.ctx.animationManager.isSkipped();!this.ctx.animationManager.isSkipped()&&this.processedData&&d.push(zx(this.processedData)),c&&d.push(Px()),yield this.requestDataModel(e,this.data,{props:[Dx(o,l,{id:"xValue"}),Mx(a,h,{id:"yLowValue",invalidValue:void 0}),Mx(s,h,{id:"yHighValue",invalidValue:void 0}),...d]}),this.animationState.transition("updateData")}))}getSeriesDomain(e){const{processedData:t,dataModel:i,axes:o}=this;if(!t||!i)return[];const{domain:{keys:[a],values:s}}=t;if(e===bx.X){const e=i.resolveProcessedDataDefById(this,"xValue"),t=o[bx.X];return"key"===(null==e?void 0:e.def.type)&&"category"===e.def.valueType?a:kx(Wx(a),t)}{const e=s[i.resolveProcessedDataIndexById(this,"yLowValue")],t=s[i.resolveProcessedDataIndexById(this,"yHighValue")],o=[e[0]>t[0]?t[0]:e[0],t[1]<e[1]?e[1]:t[1]];return kx(o)}}createNodeData(){return S(this,null,(function*(){var e,t;const{data:i,dataModel:o,axes:a,visible:s}=this,n=a[bx.X],r=a[bx.Y];if(!(i&&s&&n&&r&&o))return;const l=n.scale,h=r.scale,{xKey:d,yLowKey:c,yHighKey:u,connectMissingData:p,marker:y}=this.properties,f=`${c}-${u}`,v=(null!=(e=l.bandwidth)?e:0)/2,S=o.resolveProcessedDataDefsByIds(this,["xValue","yHighValue","yLowValue"]),M=(e,t,i)=>{const o=l.convert(e)+v,a=h.convert(t),s=h.convert(i);return[{point:{x:o,y:a},size:y.size,itemId:"high",yValue:t,xValue:e},{point:{x:o,y:s},size:y.size,itemId:"low",yValue:i,xValue:e}]},D=e=>{const t=e,{point:i}=t,o=x(t,["point"]);return m(g({},o),{point:m(g({},i),{moveTo:!0})})},b=[],N=[],I={itemId:f,points:[]},k={itemId:f,points:[]},T={itemId:f,labelData:b,nodeData:N,fillData:k,strokeData:I,scales:this.calculateScaling(),visible:this.visible};if(!this.visible)return T;const A=k.points,O=[],L=I.points,E=[];let _,R=-1/0,C=-1/0;return null==(t=this.processedData)||t.data.forEach(((e,t)=>{let{keys:i,datum:a,values:s}=e;const n=o.resolveProcessedDataDefsValues(S,{keys:i,values:s}),{xValue:r,yHighValue:l,yLowValue:h}=n,y=null==l||null==h?[]:M(r,l,h),g=h>l;y.forEach((e=>{let{point:{x:i,y:o},size:s,itemId:n="",yValue:p}=e;N.push({index:t,series:this,itemId:n,datum:a,midPoint:{x:i,y:o},yHighValue:l,yLowValue:h,xValue:r,xKey:d,yLowKey:c,yHighKey:u,point:{x:i,y:o,size:s}});const y=this.createLabelData({point:{x:i,y:o},value:p,yLowValue:h,yHighValue:l,itemId:n,inverted:g,datum:a,series:this});b.push(y)}));const m=null!=R&&null!=C,x=null!=_&&m,f=null!=r,v=null!=l&&null!=h;let[I,k]=M(r,null!=l?l:0,null!=h?h:0);if(!p)if(v){if(!m){const[e,t]=M(r,0,0);A.push(e),O.push(t)}}else{const[e,t]=M(_,0,0);A.push(e),O.push(t)}f&&v&&(A.push(I),O.push(k));f&&v&&!x&&!p&&t>0&&(I=D(I),k=D(k)),f&&v&&(L.push(I),E.push(k)),_=r,R=l,C=h})),A.length>0&&(A[0]=D(A[0])),A.push(...O.reverse()),E.length>0&&(E[0]=D(E[0])),L.push(...E),T}))}createLabelData(e){let{point:t,value:i,itemId:o,inverted:a,datum:s,series:n}=e;const{xKey:r,yLowKey:l,yHighKey:h,xName:d,yName:c,yLowName:u,yHighName:p,label:y}=this.properties,{placement:g,padding:m=10}=y;let x=o;a&&(x="low"===o?"high":"low");const f="outside"===g&&"high"===x||"inside"===g&&"low"===x?-1:1;return{x:t.x,y:t.y+m*f,series:n,itemId:o,datum:s,text:this.getLabelText(y,{value:i,datum:s,itemId:o,xKey:r,yLowKey:l,yHighKey:h,xName:d,yLowName:u,yHighName:p,yName:c},(e=>Vx(e)?e.toFixed(2):String(e))),textAlign:"center",textBaseline:-1===f?"bottom":"top"}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}markerFactory(){const{shape:e}=this.properties.marker;return new(Fx(e))}updatePathNodes(e){return S(this,null,(function*(){const{opacity:t,visible:i}=e,[o,a]=e.paths,s=this.getStrokeWidth(this.properties.strokeWidth);a.setProperties({tag:Tx.Stroke,fill:void 0,lineJoin:a.lineCap="round",pointerEvents:Ux.None,stroke:this.properties.stroke,strokeWidth:s,strokeOpacity:this.properties.strokeOpacity,lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset,opacity:t,visible:i}),o.setProperties({tag:Tx.Fill,stroke:void 0,lineJoin:"round",pointerEvents:Ux.None,fill:this.properties.fill,fillOpacity:this.properties.fillOpacity,lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset,strokeOpacity:this.properties.strokeOpacity,fillShadow:this.properties.shadow,strokeWidth:s,opacity:t,visible:i}),Kx(this,a),Kx(this,o)}))}updatePaths(e){return S(this,null,(function*(){this.updateAreaPaths(e.paths,e.contextData)}))}updateAreaPaths(e,t){this.updateFillPath(e,t),this.updateStrokePath(e,t)}updateFillPath(e,t){const{fillData:i}=t,[o]=e,{path:a}=o;a.clear(!0);for(const{point:s}of i.points)s.moveTo?a.moveTo(s.x,s.y):a.lineTo(s.x,s.y);a.closePath(),o.checkPathDirty()}updateStrokePath(e,t){const{strokeData:i}=t,[,o]=e,{path:a}=o;a.clear(!0);for(const{point:s}of i.points)s.moveTo?a.moveTo(s.x,s.y):a.lineTo(s.x,s.y);o.checkPathDirty()}updateMarkerSelection(e){return S(this,null,(function*(){const{nodeData:t,markerSelection:i}=e;return this.properties.marker.isDirty()&&(i.clear(),i.cleanup()),i.update(this.properties.marker.enabled?t:[])}))}updateMarkerNodes(e){return S(this,null,(function*(){const{markerSelection:t,isHighlight:i}=e,{xKey:o,yLowKey:a,yHighKey:s,marker:n,fill:r,stroke:l,strokeWidth:h,fillOpacity:d,strokeOpacity:c}=this.properties,u=Nx(i&&this.properties.highlightStyle.item,n.getStyle(),{fill:r,fillOpacity:d,stroke:l,strokeWidth:h,strokeOpacity:c});t.each(((e,t)=>{this.updateMarkerStyle(e,n,{datum:t,highlighted:i,xKey:o,yHighKey:s,yLowKey:a},u)})),i||this.properties.marker.markClean()}))}updateLabelSelection(e){return S(this,null,(function*(){const{labelData:t,labelSelection:i}=e;return i.update(t,(e=>{e.tag=Tx.Label,e.pointerEvents=Ux.None}))}))}updateLabelNodes(e){return S(this,null,(function*(){e.labelSelection.each(((e,t)=>{Ix(e,this.properties.label,t)}))}))}getHighlightLabelData(e,t){const i=e.filter((e=>e.datum===t.datum));return i.length>0?i:void 0}getHighlightData(e,t){const i=e.filter((e=>e.datum===t.datum));return i.length>0?i:void 0}getTooltipHtml(e){const t=this.axes[bx.X],i=this.axes[bx.Y];if(!this.properties.isValid()||!t||!i)return o._ModuleSupport.EMPTY_TOOLTIP_CONTENT;const{id:a}=this,{xKey:s,yLowKey:n,yHighKey:r,xName:l,yName:h,yLowName:d,yHighName:c,fill:u,tooltip:p}=this.properties,{datum:y,itemId:g,xValue:m,yLowValue:x,yHighValue:f}=e,v=null!=u?u:"gray",S=jx(t.formatDatum(m)),M=jx(i.formatDatum(x)),D=jx(i.formatDatum(f)),b=null!=l?l:s,N=null!=d?d:n,I=null!=c?c:r,k=jx(h),T=h?`<b>${jx(b)}</b>: ${S}<br><b>${jx(N)}</b>: ${M}<br><b>${jx(I)}</b>: ${D}<br>`:`${S}: ${M} - ${D}`;return p.toTooltipHtml({title:k,content:T,backgroundColor:v},{seriesId:a,itemId:g,datum:y,xKey:s,yLowKey:n,yHighKey:r,xName:l,yLowName:d,yHighName:c,yName:h,color:v,title:k,yHighValue:f,yLowValue:x})}getLegendData(e){var t,i;if("category"!==e)return[];const{yLowKey:o,yHighKey:a,yName:s,yLowName:n,yHighName:r,fill:l,stroke:h,strokeWidth:d,strokeOpacity:c,lineDash:u,visible:p,marker:y}=this.properties,g=null!=s?s:`${null!=n?n:o} - ${null!=r?r:a}`;return[{legendType:"category",id:this.id,itemId:`${o}-${a}`,seriesId:this.id,enabled:p,label:{text:`${g}`},marker:{shape:y.shape,fill:null!=(t=y.fill)?t:l,stroke:null!=(i=y.stroke)?i:h,fillOpacity:y.fillOpacity,strokeOpacity:y.strokeOpacity,strokeWidth:y.strokeWidth},line:{stroke:h,strokeOpacity:c,strokeWidth:d,lineDash:u}}]}isLabelEnabled(){return this.properties.label.enabled}onDataChange(){}nodeFactory(){return new o._Scene.Group}animateEmptyUpdateReady(e){const{markerSelection:t,labelSelection:i,contextData:o,paths:a}=e,{animationManager:s}=this.ctx;this.updateAreaPaths(a,o),_x(this,s,...a),Rx([t],Ex),Cx(this,s,t),wx(this,"labels",s,i)}animateReadyResize(e){const{contextData:t,paths:i}=e;this.updateAreaPaths(i,t),super.animateReadyResize(e)}animateWaitingUpdateReady(e){const{contextData:t,paths:i}=e;super.animateWaitingUpdateReady(e),this.updateAreaPaths(i,t)}getFormattedMarkerStyle(e){const{xKey:t,yLowKey:i,yHighKey:o}=this.properties;return this.getMarkerStyle(this.properties.marker,{datum:e,xKey:t,yLowKey:i,yHighKey:o,highlighted:!0})}computeFocusBounds(e){return Bx(this,e)}};Gx.className="RangeAreaSeries",Gx.type="range-area";var Hx={series:{__extends__:o._Theme.EXTENDS_SERIES_DEFAULTS,fillOpacity:.7,nodeClickRange:"nearest",marker:{__extends__:o._Theme.EXTENDS_CARTESIAN_MARKER_DEFAULTS,enabled:!1,fillOpacity:1,strokeWidth:2,size:6},label:{enabled:!1,placement:"outside",padding:10,fontSize:12,fontFamily:o._Theme.DEFAULT_FONT_FAMILY,color:o._Theme.DEFAULT_LABEL_COLOUR}},axes:{[o._Theme.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{enabled:!0,snap:!1}}}},{markerPaletteFactory:Xx}=o._ModuleSupport,Qx={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"range-area",instanceConstructor:Gx,defaultAxes:[{type:o._Theme.CARTESIAN_AXIS_TYPE.NUMBER,position:o._Theme.POSITION.LEFT},{type:o._Theme.CARTESIAN_AXIS_TYPE.CATEGORY,position:o._Theme.POSITION.BOTTOM}],themeTemplate:Hx,paletteFactory:e=>{const{marker:t}=Xx(e);return{fill:t.fill,stroke:t.stroke,marker:t}}},{DropShadow:$x,Label:Zx}=o._Scene,{AbstractBarSeriesProperties:qx,SeriesTooltip:Jx,Validate:ef,COLOR_STRING:tf,FUNCTION:of,LINE_DASH:af,OBJECT:sf,PLACEMENT:nf,POSITIVE_NUMBER:rf,RATIO:lf,STRING:hf}=o._ModuleSupport,df=class extends Zx{constructor(){super(...arguments),this.placement="inside",this.padding=6}};f([ef(nf)],df.prototype,"placement",2),f([ef(rf)],df.prototype,"padding",2);var cf=class extends qx{constructor(){super(...arguments),this.fill="#99CCFF",this.fillOpacity=1,this.stroke="#99CCFF",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.shadow=(new $x).set({enabled:!1}),this.label=new df,this.tooltip=new Jx}};f([ef(hf)],cf.prototype,"xKey",2),f([ef(hf)],cf.prototype,"yLowKey",2),f([ef(hf)],cf.prototype,"yHighKey",2),f([ef(hf,{optional:!0})],cf.prototype,"xName",2),f([ef(hf,{optional:!0})],cf.prototype,"yName",2),f([ef(hf,{optional:!0})],cf.prototype,"yLowName",2),f([ef(hf,{optional:!0})],cf.prototype,"yHighName",2),f([ef(tf)],cf.prototype,"fill",2),f([ef(lf)],cf.prototype,"fillOpacity",2),f([ef(tf)],cf.prototype,"stroke",2),f([ef(rf)],cf.prototype,"strokeWidth",2),f([ef(lf)],cf.prototype,"strokeOpacity",2),f([ef(af)],cf.prototype,"lineDash",2),f([ef(rf)],cf.prototype,"lineDashOffset",2),f([ef(rf)],cf.prototype,"cornerRadius",2),f([ef(of,{optional:!0})],cf.prototype,"formatter",2),f([ef(sf)],cf.prototype,"shadow",2),f([ef(sf)],cf.prototype,"label",2),f([ef(sf)],cf.prototype,"tooltip",2);var{SeriesNodePickMode:uf,valueProperty:pf,keyProperty:yf,ChartAxisDirection:gf,getRectConfig:mf,updateRect:xf,checkCrisp:ff,updateLabelNode:vf,SMALLEST_KEY_INTERVAL:Sf,diff:Mf,prepareBarAnimationFunctions:Df,midpointStartingBarPosition:bf,resetBarSelectionsFn:Nf,fixNumericExtent:If,seriesLabelFadeInAnimation:kf,resetLabelFn:Tf,animationValidation:Af,createDatumId:Of,isFiniteNumber:Lf,computeBarFocusBounds:Ef}=o._ModuleSupport,{Rect:_f,PointerEvents:Rf,motion:Cf}=o._Scene,{sanitizeHtml:wf,isNumber:Pf,extent:zf}=o._Util,{ContinuousScale:Kf}=o._Scale,Vf=class extends o._ModuleSupport.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.xKey=o.properties.xKey,this.yLowKey=o.properties.yLowKey,this.yHighKey=o.properties.yHighKey}},Bf=class extends o._ModuleSupport.AbstractBarSeries{constructor(e){super({moduleCtx:e,pickModes:[uf.EXACT_SHAPE_MATCH],hasHighlightedLabels:!0,directionKeys:{x:["xKey"],y:["yLowKey","yHighKey"]},directionNames:{x:["xName"],y:["yLowName","yHighName","yName"]},datumSelectionGarbageCollection:!1,animationResetFns:{datum:Nf,label:Tf}}),this.properties=new cf,this.NodeEvent=Vf}processData(e){return S(this,null,(function*(){var t,i,o;if(!this.properties.isValid())return;const{xKey:a,yLowKey:s,yHighKey:n}=this.properties,r=null==(t=this.getCategoryAxis())?void 0:t.scale,l=null==(i=this.getValueAxis())?void 0:i.scale,{isContinuousX:h,xScaleType:d,yScaleType:c}=this.getScaleInformation({xScale:r,yScale:l}),u=[];this.ctx.animationManager.isSkipped()||(this.processedData&&u.push(Mf(this.processedData)),u.push(Af()));const p=this.visible?{}:{forceValue:0},{processedData:y}=yield this.requestDataModel(e,this.data,{props:[yf(a,d,{id:"xValue"}),pf(s,c,g({id:"yLowValue"},p)),pf(n,c,g({id:"yHighValue"},p)),...h?[Sf]:[],...u],groupByKeys:!0});this.smallestDataInterval=null==(o=y.reduced)?void 0:o.smallestKeyInterval,this.animationState.transition("updateData")}))}getSeriesDomain(e){var t;const{processedData:i,dataModel:o,smallestDataInterval:a}=this;if(!i||!o)return[];const{domain:{keys:[s],values:n}}=i;if(e===this.getCategoryDirection()){const e=o.resolveProcessedDataDefById(this,"xValue");if("key"===(null==e?void 0:e.def.type)&&"category"===(null==e?void 0:e.def.valueType))return s;const i=Lf(a)?a:0,n=null!=(t=zf(s))?t:[NaN,NaN],r=this.getCategoryAxis(),l=n[0]+-i,h=n[1]+i;return If([l,h],r)}{const e=n[o.resolveProcessedDataIndexById(this,"yLowValue")],t=n[o.resolveProcessedDataIndexById(this,"yHighValue")],i=[e[0]>t[0]?t[0]:e[0],t[1]<e[1]?e[1]:t[1]];return If(i)}}createNodeData(){return S(this,null,(function*(){const{data:e,dataModel:t,groupScale:i,processedData:a,properties:{visible:s}}=this,n=this.getCategoryAxis(),r=this.getValueAxis();if(!(e&&n&&r&&t))return;const l=n.scale,h=r.scale,d=this.getBarDirection()===gf.X,{xKey:c,yLowKey:u,yHighKey:p,fill:y,stroke:g,strokeWidth:m}=this.properties,x=`${u}-${p}`,f={itemId:x,nodeData:[],labelData:[],scales:this.calculateScaling(),visible:this.visible};if(!s)return f;const v=t.resolveProcessedDataIndexById(this,"yLowValue"),S=t.resolveProcessedDataIndexById(this,"yHighValue"),M=t.resolveProcessedDataIndexById(this,"xValue"),{barWidth:D,groupIndex:b}=this.updateGroupScale(n),N=Kf.is(l)?-.5*D:0;return null==a||a.data.forEach(((e,t)=>{let{keys:a,datum:s,values:n}=e;n.forEach(((e,n)=>{const r=a[M],I=Math.round(l.convert(r))+i.convert(String(b))+N,k=e[v],T=e[S];if(!o._Util.isNumber(T)||!o._Util.isNumber(k))return;const A=Math.min(k,T),O=Math.max(k,T),L=Math.round(h.convert(A)),E=Math.round(h.convert(O)),_=L,R=Math.max(m,Math.abs(_-E)),C={x:d?Math.min(E,_):I,y:d?I:Math.min(E,_),width:d?R:D,height:d?D:R},w={x:C.x+C.width/2,y:C.y+C.height/2},P=this.createLabelData({rect:C,barAlongX:d,yLowValue:A,yHighValue:O,datum:s[n],series:this}),z={index:t,valueIndex:n,series:this,itemId:x,datum:s[n],xValue:r,yLowValue:k,yHighValue:T,yLowKey:u,yHighKey:p,xKey:c,x:C.x,y:C.y,width:C.width,height:C.height,midPoint:w,fill:y,stroke:g,strokeWidth:m,opacity:1,labels:P};f.nodeData.push(z),f.labelData.push(...P)}))})),f}))}createLabelData(e){let{rect:t,barAlongX:i,yLowValue:o,yHighValue:a,datum:s,series:n}=e;const{xKey:r,yLowKey:l,yHighKey:h,xName:d,yLowName:c,yHighName:u,yName:p,label:y}=this.properties,m={datum:s,xKey:r,yLowKey:l,yHighKey:h,xName:d,yLowName:c,yHighName:u,yName:p},{placement:x,padding:f}=y,v=f*("outside"===x?1:-1),S={x:t.x+(i?-v:t.width/2),y:t.y+(i?t.height/2:t.height+v),textAlign:i?"left":"center",textBaseline:i?"middle":"bottom",text:this.getLabelText(y,g({itemId:"low",value:o},m),(e=>Lf(e)?e.toFixed(2):String(e))),itemId:"low",datum:s,series:n},M={x:t.x+(i?t.width+v:t.width/2),y:t.y+(i?t.height/2:-v),textAlign:i?"right":"center",textBaseline:i?"middle":"top",text:this.getLabelText(y,g({itemId:"high",value:a},m),(e=>Pf(e)?e.toFixed(2):"")),itemId:"high",datum:s,series:n};return"outside"===x&&(S.textAlign=i?"right":"center",S.textBaseline=i?"middle":"top",M.textAlign=i?"left":"center",M.textBaseline=i?"middle":"bottom"),[S,M]}nodeFactory(){return new _f}updateDatumSelection(e){return S(this,null,(function*(){const{nodeData:t,datumSelection:i}=e,o=null!=t?t:[];return i.update(o,void 0,(e=>this.getDatumId(e)))}))}updateDatumNodes(e){return S(this,null,(function*(){const{datumSelection:t,isHighlight:i}=e,{id:o,ctx:a}=this,{yLowKey:s,yHighKey:n,highlightStyle:{item:r}}=this.properties,l=this.axes[gf.X],h=ff(null==l?void 0:l.visibleRange),d=this.getCategoryDirection()===gf.X;t.each(((e,t)=>{const{fillOpacity:l,strokeOpacity:c,strokeWidth:u,lineDash:p,lineDashOffset:y,formatter:g,shadow:m}=this.properties,x={fill:t.fill,stroke:t.stroke,fillOpacity:l,strokeOpacity:c,lineDash:p,lineDashOffset:y,fillShadow:m,strokeWidth:this.getStrokeWidth(u),cornerRadius:this.properties.cornerRadius},f=d?t.width>0:t.height>0,v=mf({datum:t,lowValue:t.yLowValue,highValue:t.yHighValue,isHighlighted:i,style:x,highlightStyle:r,formatter:g,seriesId:o,itemId:t.itemId,ctx:a,yLowKey:s,yHighKey:n});v.crisp=h,v.visible=f,xf({rect:e,config:v})}))}))}getHighlightLabelData(e,t){const i=e.filter((e=>e.datum===t.datum));return i.length>0?i:void 0}updateLabelSelection(e){return S(this,null,(function*(){const t=this.properties.label.enabled?e.labelData:[];return e.labelSelection.update(t,(e=>{e.pointerEvents=Rf.None}))}))}updateLabelNodes(e){return S(this,null,(function*(){e.labelSelection.each(((e,t)=>{vf(e,this.properties.label,t)}))}))}getTooltipHtml(e){var t,i;const{id:a,ctx:{callbackCache:s}}=this,n=this.getCategoryAxis(),r=this.getValueAxis();if(!this.properties.isValid()||!n||!r)return o._ModuleSupport.EMPTY_TOOLTIP_CONTENT;const{xKey:l,yLowKey:h,yHighKey:d,xName:c,yLowName:u,yHighName:p,yName:y,fill:g,strokeWidth:m,formatter:x,tooltip:f}=this.properties,{datum:v,itemId:S,xValue:M,yLowValue:D,yHighValue:b}=e;let N;x&&(N=s.call(x,{datum:v,xKey:l,yLowKey:h,yHighKey:d,fill:g,strokeWidth:m,highlighted:!1,seriesId:a,itemId:S}));const I=null!=(i=null!=(t=null==N?void 0:N.fill)?t:g)?i:"gray",k=wf(n.formatDatum(M)),T=wf(r.formatDatum(D)),A=wf(r.formatDatum(b)),O=null!=c?c:l,L=null!=u?u:h,E=null!=p?p:d,_=wf(y),R={title:_,content:y?`<b>${wf(O)}</b>: ${k}<br><b>${wf(L)}</b>: ${T}<br><b>${wf(E)}</b>: ${A}<br>`:`${k}: ${T} - ${A}`,backgroundColor:I};return f.toTooltipHtml(R,{datum:v,xKey:l,xName:c,yLowKey:h,yLowName:u,yHighKey:d,yHighName:p,yName:y,color:I,seriesId:a,itemId:S,title:_,yHighValue:b,yLowValue:D})}getLegendData(e){const{id:t,visible:i}=this;if("category"!==e)return[];const{fill:o,stroke:a,strokeWidth:s,fillOpacity:n,strokeOpacity:r,yName:l,yLowName:h,yHighName:d,yLowKey:c,yHighKey:u}=this.properties;return[{legendType:"category",id:t,itemId:`${c}-${u}`,seriesId:t,enabled:i,label:{text:`${null!=l?l:`${null!=h?h:c} - ${null!=d?d:u}`}`},marker:{fill:o,stroke:a,fillOpacity:n,strokeOpacity:r,strokeWidth:s}}]}animateEmptyUpdateReady(e){let{datumSelection:t,labelSelection:i}=e;const o=Df(bf(this.isVertical(),"normal"));Cf.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],o),kf(this,"labels",this.ctx.animationManager,i)}animateWaitingUpdateReady(e){var t;const{datumSelection:i,labelSelection:o}=e,{processedData:a}=this,s=null==(t=null==a?void 0:a.reduced)?void 0:t.diff;this.ctx.animationManager.stopByAnimationGroupId(this.id);const n=Df(bf(this.isVertical(),"fade"));Cf.fromToMotion(this.id,"datums",this.ctx.animationManager,[i],n,((e,t)=>Of(t.xValue,t.valueIndex)),s),kf(this,"labels",this.ctx.animationManager,o)}getDatumId(e){return`${e.xValue}-${e.valueIndex}`}isLabelEnabled(){return this.properties.label.enabled}onDataChange(){}computeFocusBounds(e){let{datumIndex:t,seriesRect:i}=e;var o;return Ef(null==(o=this.contextNodeData)?void 0:o.nodeData[t],this.contentGroup,i)}};Bf.className="RangeBarSeries",Bf.type="range-bar";var Ff={series:{__extends__:o._Theme.EXTENDS_SERIES_DEFAULTS,direction:"vertical",strokeWidth:0,label:{enabled:!1,fontSize:12,fontFamily:o._Theme.DEFAULT_FONT_FAMILY,color:o._Theme.DEFAULT_INSIDE_SERIES_LABEL_COLOUR,placement:"inside"}},axes:{[o._Theme.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{enabled:!0,snap:!1}}}},Uf={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"range-bar",instanceConstructor:Bf,defaultAxes:[{type:o._Theme.CARTESIAN_AXIS_TYPE.CATEGORY,position:o._Theme.POSITION.BOTTOM},{type:o._Theme.CARTESIAN_AXIS_TYPE.NUMBER,position:o._Theme.POSITION.LEFT}],themeTemplate:Ff,paletteFactory:e=>{let{takeColors:t}=e;const{fills:[i],strokes:[o]}=t(1);return{fill:i,stroke:o}},groupable:!0,swapDefaultAxesCondition:e=>{let{direction:t}=e;return"horizontal"===t}},{HierarchySeriesProperties:jf,HighlightStyle:Wf,SeriesTooltip:Yf,Validate:Gf,COLOR_STRING:Hf,FUNCTION:Xf,NUMBER:Qf,OBJECT:$f,POSITIVE_NUMBER:Zf,RATIO:qf,STRING:Jf}=o._ModuleSupport,ev=class extends Wf{constructor(){super(...arguments),this.label=new Dh,this.secondaryLabel=new Dh}};f([Gf(Jf,{optional:!0})],ev.prototype,"fill",2),f([Gf(qf,{optional:!0})],ev.prototype,"fillOpacity",2),f([Gf(Hf,{optional:!0})],ev.prototype,"stroke",2),f([Gf(Zf,{optional:!0})],ev.prototype,"strokeWidth",2),f([Gf(qf,{optional:!0})],ev.prototype,"strokeOpacity",2),f([Gf($f)],ev.prototype,"label",2),f([Gf($f)],ev.prototype,"secondaryLabel",2);var tv=class extends jf{constructor(){super(...arguments),this.fillOpacity=1,this.strokeWidth=0,this.strokeOpacity=1,this.cornerRadius=0,this.highlightStyle=new ev,this.label=new Dh,this.secondaryLabel=new bh,this.tooltip=new Yf}};f([Gf(Jf,{optional:!0})],tv.prototype,"sizeName",2),f([Gf(Jf,{optional:!0})],tv.prototype,"labelKey",2),f([Gf(Jf,{optional:!0})],tv.prototype,"secondaryLabelKey",2),f([Gf(qf)],tv.prototype,"fillOpacity",2),f([Gf(Zf)],tv.prototype,"strokeWidth",2),f([Gf(qf)],tv.prototype,"strokeOpacity",2),f([Gf(Zf)],tv.prototype,"cornerRadius",2),f([Gf(Qf,{optional:!0})],tv.prototype,"sectorSpacing",2),f([Gf(Qf,{optional:!0})],tv.prototype,"padding",2),f([Gf(Xf,{optional:!0})],tv.prototype,"formatter",2),f([Gf($f)],tv.prototype,"highlightStyle",2),f([Gf($f)],tv.prototype,"label",2),f([Gf($f)],tv.prototype,"secondaryLabel",2),f([Gf($f)],tv.prototype,"tooltip",2);var{fromToMotion:iv}=o._ModuleSupport,{Sector:ov,Group:av,Selection:sv,Text:nv}=o._Scene,{sanitizeHtml:rv}=o._Util,lv=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2*Math.PI/e.sumSize,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Array.from(e,(()=>{})),a=t;for(const s of e.children){const e=a,t=a+s.sumSize*i;o[s.index]={start:e,end:t},lv(s,e,i,o),a=t}return o},hv=class e extends o._ModuleSupport.HierarchySeries{constructor(){super(...arguments),this.properties=new tv,this.groupSelection=sv.select(this.contentGroup,av),this.highlightSelection=sv.select(this.highlightGroup,av),this.angleData=[]}processData(){return S(this,null,(function*(){const{childrenKey:t,colorKey:i,colorName:o,labelKey:a,secondaryLabelKey:s,sizeKey:n,sizeName:r}=this.properties;yield v(e.prototype,this,"processData").call(this),this.angleData=lv(this.rootNode);const l=e=>"number"===typeof e?e.toFixed(2):"string"===typeof e?e:"";this.labelData=Array.from(this.rootNode,(e=>{let h,d,{datum:c,depth:u}=e;if(null!=c&&null!=u&&null!=a){const e=c[a];h=this.getLabelText(this.properties.label,{depth:u,datum:c,childrenKey:t,colorKey:i,colorName:o,labelKey:a,secondaryLabelKey:s,sizeKey:n,sizeName:r,value:e},l)}if(""===h&&(h=void 0),null!=c&&null!=u&&null!=s){const e=c[s];d=this.getLabelText(this.properties.secondaryLabel,{depth:u,datum:c,childrenKey:t,colorKey:i,colorName:o,labelKey:a,secondaryLabelKey:s,sizeKey:n,sizeName:r,value:e},l)}return""===d&&(d=void 0),null!=h||null!=d?{label:h,secondaryLabel:d}:void 0}))}))}updateSelections(){return S(this,null,(function*(){if(!this.nodeDataRefresh)return;this.nodeDataRefresh=!1;const{chart:e}=this;if(null==e)return;if(null==e.seriesRect)return;const t=Array.from(this.rootNode),i=e=>{e.append([new ov,new nv({tag:0}),new nv({tag:1})])};this.groupSelection.update(t,i,(e=>this.getDatumId(e))),this.highlightSelection.update(t,i,(e=>this.getDatumId(e)))}))}updateNodes(){return S(this,null,(function*(){var e;const{chart:t,data:i,maxDepth:o,labelData:a}=this;if(null==t||null==i||null==a)return;const{width:s,height:n}=t.seriesRect,{sectorSpacing:r=0,padding:l=0,cornerRadius:h,highlightStyle:d}=this.properties;this.contentGroup.translationX=s/2,this.contentGroup.translationY=n/2,this.highlightGroup.translationX=s/2,this.highlightGroup.translationY=n/2;const c=.5*r,u=Math.min(s,n)/2/(o+1),y=-Math.PI/2,g=null==(e=this.ctx.highlightManager)?void 0:e.getActiveHighlight();(new nv).setFont(this.properties.label),this.rootNode.walk((e=>{const t=this.angleData[e.index];if(null!=e.depth&&null!=t){const i=t.end-t.start,o=(e.depth+.5)*u;e.midPoint.x=Math.cos(i)*o,e.midPoint.y=Math.sin(i)*o}}));const m=(e,t,i)=>{var o,a,s,n,r,l,p,g,m,x;const{depth:f}=e,v=this.angleData[e.index];if(null==f||null==v)return void(t.visible=!1);let S,M,D,b,N;t.visible=!0,i&&(S=d.fill,M=d.fillOpacity,D=d.stroke,b=d.strokeWidth,N=d.strokeOpacity);const I=this.getSectorFormat(e,i),k=null!=(a=null!=(o=null==I?void 0:I.fill)?o:S)?a:e.fill,T=null!=(n=null!=(s=null==I?void 0:I.fillOpacity)?s:M)?n:this.properties.fillOpacity,A=null!=(l=null!=(r=null==I?void 0:I.stroke)?r:D)?l:e.stroke,O=null!=(g=null!=(p=null==I?void 0:I.strokeWidth)?p:b)?g:this.properties.strokeWidth,L=null!=(x=null!=(m=null==I?void 0:I.strokeOpacity)?m:N)?x:this.properties.strokeOpacity;t.fill=k,t.fillOpacity=T,t.stroke=A,t.strokeWidth=O,t.strokeOpacity=L,t.centerX=0,t.centerY=0,t.innerRadius=f*u,t.outerRadius=(f+1)*u,t.startAngle=v.start+y,t.endAngle=v.end+y,t.inset=c+.5*O,t.cornerRadius=h};this.groupSelection.selectByClass(ov).forEach((e=>{m(e.datum,e,!1)})),this.highlightSelection.selectByClass(ov).forEach((e=>{const t=e.datum,i=g===t;e.visible=i,e.visible&&m(e.datum,e,i)}));const x=Array.from(this.rootNode,((e,t)=>{const{depth:i}=e,o=a[t],s=this.angleData[t];if(null==i||null==s)return;const n=i*u+c,r=(i+1)*u-c,h=n>c?c/n:c,d=r>c?c/r:c,g=s.start+h,m=s.end+h-g,x=s.start+d,f=s.end+d-x,v=Th(null==o?void 0:o.label,this.properties.label,null==o?void 0:o.secondaryLabel,this.properties.secondaryLabel,{padding:l},(t=>{var o;if(0===i&&(null==(o=e.parent)?void 0:o.sumSize)===e.sumSize){return{width:2*Math.sqrt(p(r,2)-p(.5*t,2)),height:t,meta:0}}const a=t,s=2*Math.sqrt(p(r,2)-p(n+a,2)),l=m<Math.PI?2*n*Math.tan(.5*m):1/0,h=Math.min(s,l);let d,c;return 0===i?(d=t,c=Math.sqrt(p(r,2)-p(d/2,2))-t/(2*Math.tan(.5*f))):(d=2*n*Math.tan(.5*m),c=Math.sqrt(p(r,2)-p(d/2,2))-n),h>=c?{width:h,height:a,meta:1}:{width:c,height:d,meta:2}}));if(null==v)return;const{width:S,height:M,meta:D,label:b,secondaryLabel:N}=v,I=y+(s.start+s.end)/2,k=(Math.sin(I)>=0?3:12)&(Math.cos(I)>=0?6:9);let T;switch(D){case 0:T=0;break;case 1:{const e=r-(u-M)*.58,t=Math.sqrt(p(r-l,2)-p(S/2,2));T=Math.min(e,t);break}case 2:if(0===i){T=.5*(M/(2*Math.tan(.5*m))+.5*S+(Math.sqrt(p(r,2)-p(.5*M,2))-.5*S))}else T=.5*(n+r)}return{width:S,height:M,labelPlacement:D,circleQuarter:k,radius:T,theta:I,label:b,secondaryLabel:N}})),f=(e,t,i,o)=>{const{index:a,depth:s}=e,n=null==x?void 0:x[a],r=0===i?this.properties.label:this.properties.secondaryLabel,l=0===i?null==n?void 0:n.label:null==n?void 0:n.secondaryLabel;if(null==s||null==n||null==l)return void(t.visible=!1);const{height:h,labelPlacement:d,circleQuarter:c,radius:u,theta:p}=n;let y;if(o){y=(0===i?this.properties.highlightStyle.label:this.properties.highlightStyle.secondaryLabel).color}switch(t.text=l.text,t.fontSize=l.fontSize,t.lineHeight=l.lineHeight,t.fontStyle=r.fontStyle,t.fontFamily=r.fontFamily,t.fontWeight=r.fontWeight,t.fill=null!=y?y:r.color,d){case 0:t.textAlign="center",t.textBaseline="top",t.translationX=0,t.translationY=(0===i?0:h-l.height)-.5*h,t.rotation=0;break;case 1:{const e=0!==(3&c),o=0===i===!e?u:u-(h-l.height);t.textAlign="center",t.textBaseline=e?"bottom":"top",t.translationX=Math.cos(p)*o,t.translationY=Math.sin(p)*o,t.rotation=e?p-.5*Math.PI:p+.5*Math.PI;break}case 2:{const e=0!==(6&c),o=0===i===!e?.5*(h-l.height):.5*(l.height-h);t.textAlign="center",t.textBaseline="middle",t.translationX=Math.cos(p)*u+Math.cos(p+Math.PI/2)*o,t.translationY=Math.sin(p)*u+Math.sin(p+Math.PI/2)*o,t.rotation=e?p:p+Math.PI;break}}t.visible=!0};this.groupSelection.selectByClass(nv).forEach((e=>{f(e.datum,e,e.tag,!1)})),this.highlightSelection.selectByClass(nv).forEach((e=>{const t=e.datum,i=g===t;e.visible=i,e.visible&&f(e.datum,e,e.tag,i)}))}))}getSectorFormat(e,t){const{datum:i,fill:o,stroke:a,depth:s}=e,{ctx:{callbackCache:n},properties:{formatter:r}}=this;if(!r||null==i||null==s)return{};const{colorKey:l,labelKey:h,sizeKey:d,strokeWidth:c}=this.properties,u=n.call(r,{seriesId:this.id,depth:s,datum:i,colorKey:l,labelKey:h,sizeKey:d,fill:o,stroke:a,strokeWidth:c,highlighted:t});return null!=u?u:{}}getTooltipHtml(e){var t;const{id:i}=this,{tooltip:a,colorKey:s,colorName:n=s,labelKey:r,secondaryLabelKey:l,sizeKey:h,sizeName:d=h,childrenKey:c}=this.properties,{datum:u,depth:p}=e;if(null==u||null==p)return o._ModuleSupport.EMPTY_TOOLTIP_CONTENT;const y=null!=r?u[r]:void 0,g=this.getSectorFormat(e,!1),m=null!=(t=null==g?void 0:g.fill)?t:e.fill;if(!a.renderer&&!y)return o._ModuleSupport.EMPTY_TOOLTIP_CONTENT;const x=[],f=null!=l?u[l]:void 0;null!=f&&l!==s&&l!==h&&x.push(rv(f));const v=null!=h?u[h]:void 0;null!=v&&x.push(`${d}: ${rv(v)}`);const S=null!=s?u[s]:void 0;null!=S&&x.push(`${n}: ${rv(S)}`);const M=x.join("<br>"),D={title:y,color:this.properties.label.color,backgroundColor:m,content:M};return a.toTooltipHtml(D,{depth:p,datum:u,colorKey:s,labelKey:r,secondaryLabelKey:l,sizeKey:h,title:y,color:m,seriesId:i,childrenKey:c,colorName:n,itemId:void 0,sizeName:d})}createNodeData(){return S(this,null,(function*(){}))}pickNodeClosestDatum(e){return this.pickNodeNearestDistantObject(e,this.groupSelection.selectByClass(ov))}animateEmptyUpdateReady(e){let{datumSelections:t}=e;iv(this.id,"nodes",this.ctx.animationManager,t,{toFn:(e,t,i)=>({scalingX:1,scalingY:1}),fromFn:(e,t,i)=>"unknown"===i&&null!=t&&null==e.previousDatum?{scalingX:0,scalingY:0}:{scalingX:1,scalingY:1}})}};hv.className="SunburstSeries",hv.type="sunburst";var dv=hv,{EXTENDS_SERIES_DEFAULTS:cv,DEFAULT_INSIDE_SERIES_LABEL_COLOUR:uv}=o._Theme,pv={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["hierarchy"],identifier:"sunburst",instanceConstructor:dv,solo:!0,themeTemplate:{series:{__extends__:cv,label:{fontSize:14,minimumFontSize:9,color:uv,overflowStrategy:"ellipsis",wrapping:"never",spacing:2},secondaryLabel:{fontSize:8,minimumFontSize:7,color:uv,overflowStrategy:"ellipsis",wrapping:"never"},sectorSpacing:2,padding:3,highlightStyle:{label:{color:uv},secondaryLabel:{color:uv},stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2}},gradientLegend:{enabled:!0}},paletteFactory:e=>{let{takeColors:t,colorsCount:i,themeTemplateParameters:a}=e;const{properties:s}=a,{fills:n,strokes:r}=t(i);return{fills:n,strokes:r,colorRange:s.get(o._Theme.DEFAULT_DIVERGING_SERIES_COLOUR_RANGE)}}},{Label:yv}=o._Scene,{BaseProperties:gv,HierarchySeriesProperties:mv,HighlightStyle:xv,SeriesTooltip:fv,Validate:vv,BOOLEAN:Sv,COLOR_STRING:Mv,FUNCTION:Dv,NUMBER:bv,OBJECT:Nv,POSITIVE_NUMBER:Iv,RATIO:kv,STRING:Tv,STRING_ARRAY:Av,TEXT_ALIGN:Ov,VERTICAL_ALIGN:Lv}=o._ModuleSupport,Ev=class extends yv{constructor(){super(...arguments),this.spacing=0}};f([vv(bv)],Ev.prototype,"spacing",2);var _v=class extends gv{constructor(){super(...arguments),this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.cornerRadius=0,this.textAlign="center",this.gap=0,this.padding=0,this.interactive=!0,this.label=new Ev}};f([vv(Tv,{optional:!0})],_v.prototype,"fill",2),f([vv(kv)],_v.prototype,"fillOpacity",2),f([vv(Mv,{optional:!0})],_v.prototype,"stroke",2),f([vv(Iv)],_v.prototype,"strokeWidth",2),f([vv(kv)],_v.prototype,"strokeOpacity",2),f([vv(Iv)],_v.prototype,"cornerRadius",2),f([vv(Ov)],_v.prototype,"textAlign",2),f([vv(Iv)],_v.prototype,"gap",2),f([vv(Iv)],_v.prototype,"padding",2),f([vv(Sv)],_v.prototype,"interactive",2),f([vv(Nv)],_v.prototype,"label",2);var Rv=class extends gv{constructor(){super(...arguments),this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.cornerRadius=0,this.textAlign="center",this.verticalAlign="middle",this.gap=0,this.padding=0,this.label=new Dh,this.secondaryLabel=new bh}};f([vv(Tv,{optional:!0})],Rv.prototype,"fill",2),f([vv(kv)],Rv.prototype,"fillOpacity",2),f([vv(Mv,{optional:!0})],Rv.prototype,"stroke",2),f([vv(Iv,{optional:!0})],Rv.prototype,"strokeWidth",2),f([vv(kv)],Rv.prototype,"strokeOpacity",2),f([vv(Iv)],Rv.prototype,"cornerRadius",2),f([vv(Ov)],Rv.prototype,"textAlign",2),f([vv(Lv)],Rv.prototype,"verticalAlign",2),f([vv(Iv)],Rv.prototype,"gap",2),f([vv(Iv)],Rv.prototype,"padding",2),f([vv(Nv)],Rv.prototype,"label",2),f([vv(Nv)],Rv.prototype,"secondaryLabel",2);var Cv=class extends gv{constructor(){super(...arguments),this.label=new Dh}};f([vv(Tv,{optional:!0})],Cv.prototype,"fill",2),f([vv(kv,{optional:!0})],Cv.prototype,"fillOpacity",2),f([vv(Mv,{optional:!0})],Cv.prototype,"stroke",2),f([vv(Iv,{optional:!0})],Cv.prototype,"strokeWidth",2),f([vv(kv,{optional:!0})],Cv.prototype,"strokeOpacity",2),f([vv(Nv)],Cv.prototype,"label",2);var wv=class extends gv{constructor(){super(...arguments),this.label=new Dh,this.secondaryLabel=new bh}};f([vv(Tv,{optional:!0})],wv.prototype,"fill",2),f([vv(kv,{optional:!0})],wv.prototype,"fillOpacity",2),f([vv(Mv,{optional:!0})],wv.prototype,"stroke",2),f([vv(Iv,{optional:!0})],wv.prototype,"strokeWidth",2),f([vv(kv,{optional:!0})],wv.prototype,"strokeOpacity",2),f([vv(Nv)],wv.prototype,"label",2),f([vv(Nv)],wv.prototype,"secondaryLabel",2);var Pv=class extends xv{constructor(){super(...arguments),this.group=new Cv,this.tile=new wv}};f([vv(Nv)],Pv.prototype,"group",2),f([vv(Nv)],Pv.prototype,"tile",2);var zv=class extends mv{constructor(){super(...arguments),this.highlightStyle=new Pv,this.tooltip=new fv,this.group=new _v,this.tile=new Rv,this.undocumentedGroupFills=[],this.undocumentedGroupStrokes=[]}};f([vv(Tv,{optional:!0})],zv.prototype,"sizeName",2),f([vv(Tv,{optional:!0})],zv.prototype,"labelKey",2),f([vv(Tv,{optional:!0})],zv.prototype,"secondaryLabelKey",2),f([vv(Dv,{optional:!0})],zv.prototype,"formatter",2),f([vv(Nv)],zv.prototype,"highlightStyle",2),f([vv(Nv)],zv.prototype,"tooltip",2),f([vv(Nv)],zv.prototype,"group",2),f([vv(Nv)],zv.prototype,"tile",2),f([vv(Av)],zv.prototype,"undocumentedGroupFills",2),f([vv(Av)],zv.prototype,"undocumentedGroupStrokes",2);var{Rect:Kv,Group:Vv,BBox:Bv,Selection:Fv,Text:Uv}=o._Scene,{Color:jv,Logger:Wv,isEqual:Yv,sanitizeHtml:Gv}=o._Util,Hv=new Uv;function Xv(e){if("string"===typeof e&&!jv.validColorString(e)){const t="black";return Wv.warnOnce(`invalid Treemap tile colour string "${e}". Affected treemap tiles will be coloured ${t}.`),t}return e}function Qv(e){return e.children.length>0?e.sumSize-e.size:e.size}var $v={left:0,center:.5,right:1},Zv={top:0,middle:.5,bottom:1},qv=class extends o._Scene.Group{distanceSquared(e,t){return this.computeBBox().distanceSquared(e,t)}},Jv=class e extends o._ModuleSupport.HierarchySeries{constructor(){super(...arguments),this.properties=new zv,this.groupSelection=Fv.select(this.contentGroup,qv),this.highlightSelection=Fv.select(this.highlightGroup,Vv)}groupTitleHeight(e,t){var i,o;const a=null==(o=null==(i=this.labelData)?void 0:i[e.index])?void 0:o.label,{label:s}=this.properties.group;if(null!=a&&!(s.fontSize>t.width/3||s.fontSize>t.height/3)){const{height:e}=function(e,t){const{fontStyle:i,fontWeight:o,fontSize:a,fontFamily:s}=t;Hv.setProperties({text:e,fontStyle:i,fontWeight:o,fontSize:a,fontFamily:s,textAlign:"left",textBaseline:"top"});const{width:n,height:r}=Hv.computeBBox();return{width:n,height:r}}(a,s);return Math.max(e,s.fontSize)}}getNodePadding(e,t){if(0===e.index)return{top:0,right:0,bottom:0,left:0};if(0===e.children.length){const{padding:e}=this.properties.tile;return{top:e,right:e,bottom:e,left:e}}const{label:{spacing:i},padding:o}=this.properties.group,a=this.groupTitleHeight(e,t);return{top:o+(null!=a?a+i:0),right:o,bottom:o,left:o}}processData(){return S(this,null,(function*(){var t;yield v(e.prototype,this,"processData").call(this);const{childrenKey:i,colorKey:o,colorName:a,labelKey:s,secondaryLabelKey:n,sizeKey:r,sizeName:l,tile:h,group:d}=this.properties;if(!(null==(t=this.data)?void 0:t.length))return void(this.labelData=void 0);const c=e=>"number"===typeof e?e.toFixed(2):"string"===typeof e?e:"";this.labelData=Array.from(this.rootNode,(e=>{let{datum:t,depth:u,children:p}=e;const y=0===p.length,g=y?h.label:d.label;let m,x;if(null!=t&&null!=u&&null!=s){const e=t[s];m=this.getLabelText(g,{depth:u,datum:t,childrenKey:i,colorKey:o,colorName:a,labelKey:s,secondaryLabelKey:n,sizeKey:r,sizeName:l,value:e},c)}if(""===m&&(m=void 0),y&&null!=t&&null!=u&&null!=n){const e=t[n];x=this.getLabelText(h.secondaryLabel,{depth:u,datum:t,childrenKey:i,colorKey:o,colorName:a,labelKey:s,secondaryLabelKey:n,sizeKey:r,sizeName:l,value:e},c)}return""===x&&(x=void 0),null!=m||null!=x?{label:m,secondaryLabel:x}:void 0}))}))}squarify(e,t,i,o){const{index:a,datum:s,children:n}=e;if(t.width<=0||t.height<=0)return i[a]=void 0,void(o[a]=void 0);const r=null!=s?this.getNodePadding(e,t):{top:0,right:0,bottom:0,left:0};i[a]=0===a?void 0:t,o[a]=0===a?void 0:r;const l=Array.from(n,((e,t)=>t)).filter((e=>Qv(n[e])>0)).sort(((e,t)=>Qv(n[t])-Qv(n[e]))),h=e=>{const t=l[e];return n[t]},d=l.every((e=>0===n[e].children.length)),c=t.width-r.left-r.right,u=t.height-r.top-r.bottom;if(c<=0||u<=0)return;const p=l.length;let y=0,g=0,m=1/0,x=l.reduce(((e,t)=>e+Qv(n[t])),0);const f=new Bv(t.x+r.left,t.y+r.top,c,u),v=f.clone();let S=0;for(;S<p;){const e=Qv(h(S)),t=Qv(h(g)),a=v.width<v.height;y+=e;const s=a?v.height:v.width,n=a?v.width:v.height,r=n*t/y;let l=s*y/x;const c=Math.max(r,l)/Math.min(r,l),u=Math.abs(1-c);if(u<m){m=u,S++;continue}y-=e,l=s*y/x;let p=a?v.x:v.y;for(let m=g;m<S;m++){const e=h(m),t=Qv(e),s=a?p:v.x,r=a?v.y:p,c=n*t/y,u=new Bv(s,r,a?c:l,a?l:c);this.applyGap(f,u,d),this.squarify(e,u,i,o),x-=t,p+=c}a?(v.y+=l,v.height-=l):(v.x+=l,v.width-=l),g=S,y=0,m=1/0}const M=v.width<v.height;let D=M?v.x:v.y;for(let b=g;b<p;b++){const e=h(b),t=M?D:v.x,a=M?v.y:D,s=Qv(e)/x,n=v.width*(M?s:1),r=v.height*(M?1:s),l=new Bv(t,a,n,r);this.applyGap(f,l,d),this.squarify(e,l,i,o),D+=M?n:r}}applyGap(e,t,i){const o=i?.5*this.properties.tile.gap:.5*this.properties.group.gap,a=e=>({left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height}),s=a(e),n=a(t);["top","right","bottom","left"].forEach((e=>{Yv(s[e],n[e])||t.shrink(o,e)}))}createNodeData(){return S(this,null,(function*(){}))}updateSelections(){return S(this,null,(function*(){var e;if(!this.nodeDataRefresh)return;this.nodeDataRefresh=!1;const{seriesRect:t}=null!=(e=this.chart)?e:{};if(!t)return;const i=Array.from(this.rootNode),o=e=>{e.append([new Kv,new Uv({tag:0}),new Uv({tag:1})])};this.groupSelection.update(i,o,(e=>this.getDatumId(e))),this.highlightSelection.update(i,o,(e=>this.getDatumId(e)))}))}getTileFormat(e,t){const{datum:i,depth:o,children:a}=e,{colorKey:s,labelKey:n,secondaryLabelKey:r,sizeKey:l,tile:h,group:d,formatter:c}=this.properties;if(!c||null==i||null==o)return{};const u=0===a.length,p=this.getNodeFill(e),y=this.getNodeStroke(e),g=u?h.strokeWidth:d.strokeWidth,m=this.ctx.callbackCache.call(c,{seriesId:this.id,depth:o,datum:i,colorKey:s,labelKey:n,secondaryLabelKey:r,sizeKey:l,fill:p,stroke:y,strokeWidth:g,highlighted:t});return null!=m?m:{}}getNodeFill(e){var t,i,o;if(0===e.children.length)return null!=(t=this.properties.tile.fill)?t:e.fill;const{undocumentedGroupFills:a}=this.properties,s=a[Math.min(null!=(i=e.depth)?i:0,a.length)];return null!=(o=this.properties.group.fill)?o:s}getNodeStroke(e){var t,i,o;if(0===e.children.length)return null!=(t=this.properties.tile.stroke)?t:e.stroke;const{undocumentedGroupStrokes:a}=this.properties,s=a[Math.min(null!=(i=e.depth)?i:0,a.length)];return null!=(o=this.properties.group.stroke)?o:s}updateNodes(){return S(this,null,(function*(){var e,t;const{rootNode:i,data:o}=this,{highlightStyle:a,tile:s,group:n}=this.properties,{seriesRect:r}=null!=(e=this.chart)?e:{};if(!r||!o)return;const{width:l,height:h}=r,d=Array.from(this.rootNode,(()=>{})),c=Array.from(this.rootNode,(()=>{}));this.squarify(i,new Bv(0,0,l,h),d,c);let u=null==(t=this.ctx.highlightManager)?void 0:t.getActiveHighlight();null==u||this.properties.group.interactive||0===u.children.length||(u=void 0),this.updateNodeMidPoint(d);const p=(e,t,i)=>{var o,r,l,h,u,p,y,g,m,x,f;const v=d[e.index];if(null==v)return void(t.visible=!1);const S=0===e.children.length;let M,D,b,N,I;if(i){const{tile:e,group:t}=a;M=S?e.fill:t.fill,D=S?e.fillOpacity:t.fillOpacity,b=S?e.stroke:t.stroke,N=S?e.strokeWidth:t.strokeWidth,I=S?e.strokeOpacity:t.strokeOpacity}const k=this.getTileFormat(e,i),T=null!=(r=null!=(o=null==k?void 0:k.fill)?o:M)?r:this.getNodeFill(e),A=null!=(h=null!=(l=null==k?void 0:k.fillOpacity)?l:D)?h:S?s.fillOpacity:n.fillOpacity,O=null!=(p=null!=(u=null==k?void 0:k.stroke)?u:b)?p:this.getNodeStroke(e),L=null!=(g=null!=(y=null==k?void 0:k.strokeWidth)?y:N)?g:S?s.strokeWidth:n.strokeWidth,E=null!=(x=null!=(m=null==k?void 0:k.strokeOpacity)?m:I)?x:S?s.strokeOpacity:n.strokeOpacity;t.crisp=!0,t.fill=Xv(T),t.fillOpacity=A,t.stroke=Xv(O),t.strokeWidth=L,t.strokeOpacity=E,t.cornerRadius=S?s.cornerRadius:n.cornerRadius;const _=null==(f=e.parent)?void 0:f.children.every((e=>0===e.children.length)),R=null!=e.parent?d[e.parent.index]:void 0,C=null!=e.parent?c[e.parent.index]:void 0;!0===_&&null!=R&&null!=C?(t.clipBBox=v,t.x=R.x+C.left,t.y=R.y+C.top,t.width=R.width-(C.left+C.right),t.height=R.height-(C.top+C.bottom)):(t.clipBBox=void 0,t.x=v.x,t.y=v.y,t.width=v.width,t.height=v.height),t.visible=!0};this.groupSelection.selectByClass(Kv).forEach((e=>p(e.datum,e,!1))),this.highlightSelection.selectByClass(Kv).forEach((e=>{var t;const i=e.datum===u;e.visible=i||null!=(t=null==u?void 0:u.contains(e.datum))&&t,e.visible&&p(e.datum,e,i)}));const y=Array.from(this.rootNode,(e=>{var t,i,o,a;const{index:r,children:l}=e,h=d[r],c=null==(t=this.labelData)?void 0:t[r];if(null!=h&&null!=c){if(0===l.length){const e={width:h.width,height:h.height,meta:null},t=Th(c.label,this.properties.tile.label,c.secondaryLabel,this.properties.tile.secondaryLabel,{padding:s.padding},(()=>e));if(null==t)return;const{height:a,label:n,secondaryLabel:r}=t,{textAlign:l,verticalAlign:d,padding:u}=s,p=null!=(i=$v[l])?i:.5,y=h.x+u+(h.width-2*u)*p,g=null!=(o=Zv[d])?o:.5,m=h.y+u+.5*a+(h.height-2*u-a)*g;return{label:null!=n?{text:n.text,fontSize:n.fontSize,lineHeight:n.lineHeight,style:this.properties.tile.label,x:y,y:m-.5*(a-n.height)}:void 0,secondaryLabel:null!=r?{text:r.text,fontSize:r.fontSize,lineHeight:r.fontSize,style:this.properties.tile.secondaryLabel,x:y,y:m+.5*(a-r.height)}:void 0,verticalAlign:"middle",textAlign:l}}if(null!=(null==c?void 0:c.label)){const{padding:t,textAlign:i}=n,o=this.groupTitleHeight(e,h);if(null==o)return;const s=h.width-2*t,{text:r}=Uv.wrap(c.label,h.width-2*t,1/0,n.label,"never"),l=null!=(a=$v[i])?a:.5;return{label:{text:r,fontSize:n.label.fontSize,lineHeight:Dh.lineHeight(n.label.fontSize),style:this.properties.group.label,x:h.x+t+s*l,y:h.y+t+.5*o},secondaryLabel:void 0,verticalAlign:"middle",textAlign:i}}}})),g=(e,t,i,o)=>{const s=0===e.children.length,n=y[e.index],r=0===i?null==n?void 0:n.label:null==n?void 0:n.secondaryLabel;if(null==n||null==r)return void(t.visible=!1);let l;if(o){const{tile:e,group:t}=a;l=e.secondaryLabel.color,s?0===i&&(l=e.label.color):l=t.label.color}t.text=r.text,t.fontSize=r.fontSize,t.lineHeight=r.lineHeight,t.fontStyle=r.style.fontStyle,t.fontFamily=r.style.fontFamily,t.fontWeight=r.style.fontWeight,t.fill=null!=l?l:r.style.color,t.textAlign=n.textAlign,t.textBaseline=n.verticalAlign,t.x=r.x,t.y=r.y,t.visible=!0};this.groupSelection.selectByClass(Uv).forEach((e=>{g(e.datum,e,e.tag,!1)})),this.highlightSelection.selectByClass(Uv).forEach((e=>{var t;const i=e.datum===u;e.visible=i||null!=(t=null==u?void 0:u.contains(e.datum))&&t,e.visible&&g(e.datum,e,e.tag,i)}))}))}updateNodeMidPoint(e){this.rootNode.walk((t=>{const i=e[t.index];null!=i&&(t.midPoint.x=i.x+i.width/2,t.midPoint.y=i.y)}))}pickNodeClosestDatum(e){return this.pickNodeNearestDistantObject(e,this.groupSelection.nodes())}getTooltipHtml(e){var t;const{datum:i,depth:a}=e,{id:s}=this,{tooltip:n,colorKey:r,colorName:l=r,labelKey:h,secondaryLabelKey:d,sizeKey:c,sizeName:u=c,childrenKey:p}=this.properties,y=0===e.children.length,g=y||this.properties.group.interactive;if(null==i||null==a||!g)return o._ModuleSupport.EMPTY_TOOLTIP_CONTENT;const m=null!=h?i[h]:void 0,x=this.getTileFormat(e,!1),f=null!=(t=null==x?void 0:x.fill)?t:this.getNodeFill(e);if(!n.renderer&&!m)return o._ModuleSupport.EMPTY_TOOLTIP_CONTENT;const v=[],S=null!=d?i[d]:void 0;null!=S&&d!==r&&d!==c&&v.push(Gv(S));const M=null!=c?i[c]:void 0;null!=M&&v.push(`${u}: ${Gv(M)}`);const D=null!=r?i[r]:void 0;null!=D&&v.push(`${l}: ${Gv(D)}`);const b=v.join("<br>"),N={title:m,color:y?this.properties.tile.label.color:this.properties.group.label.color,backgroundColor:f,content:b};return n.toTooltipHtml(N,{depth:a,datum:i,colorKey:r,labelKey:h,secondaryLabelKey:d,sizeKey:c,title:m,color:f,seriesId:s,childrenKey:p,colorName:l,itemId:void 0,sizeName:u})}};Jv.className="TreemapSeries",Jv.type="treemap";var eS=Jv,{DEFAULT_DIVERGING_SERIES_COLOUR_RANGE:tS,DEFAULT_FONT_FAMILY:iS,DEFAULT_HIERARCHY_FILLS:oS,DEFAULT_HIERARCHY_STROKES:aS,DEFAULT_INSIDE_SERIES_LABEL_COLOUR:sS,EXTENDS_SERIES_DEFAULTS:nS,DEFAULT_LABEL_COLOUR:rS,FONT_WEIGHT:lS}=o._Theme,hS={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["hierarchy"],identifier:"treemap",instanceConstructor:eS,solo:!0,themeTemplate:{series:{__extends__:nS,group:{label:{enabled:!0,color:rS,fontStyle:void 0,fontWeight:lS.NORMAL,fontSize:12,fontFamily:iS,spacing:4},fill:void 0,stroke:void 0,strokeWidth:1,padding:4,gap:2,textAlign:"left"},tile:{label:{enabled:!0,color:sS,fontStyle:void 0,fontWeight:lS.NORMAL,fontSize:18,minimumFontSize:10,fontFamily:iS,wrapping:"on-space",overflowStrategy:"ellipsis",spacing:2},secondaryLabel:{enabled:!0,color:sS,fontStyle:void 0,fontWeight:void 0,fontSize:12,minimumFontSize:10,fontFamily:iS,wrapping:"never",overflowStrategy:"ellipsis"},fill:void 0,stroke:void 0,strokeWidth:0,padding:3,gap:1},highlightStyle:{group:{label:{color:rS},fill:void 0,stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2},tile:{label:{color:sS},secondaryLabel:{color:sS},fill:void 0,stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2}}},gradientLegend:{enabled:!0}},paletteFactory:e=>{let{takeColors:t,colorsCount:i,themeTemplateParameters:o}=e;const{properties:a}=o,{fills:s,strokes:n}=t(i);return{fills:s,strokes:n,colorRange:a.get(tS),undocumentedGroupFills:a.get(oS),undocumentedGroupStrokes:a.get(aS)}}},{DropShadow:dS,Label:cS}=o._Scene,{AbstractBarSeriesProperties:uS,BaseProperties:pS,PropertiesArray:yS,SeriesTooltip:gS,Validate:mS,BOOLEAN:xS,COLOR_STRING:fS,FUNCTION:vS,LINE_DASH:SS,NUMBER:MS,OBJECT:DS,OBJECT_ARRAY:bS,POSITIVE_NUMBER:NS,RATIO:IS,STRING:kS,UNION:TS}=o._ModuleSupport,AS=class extends pS{};f([mS(TS(["subtotal","total"],"a total type"))],AS.prototype,"totalType",2),f([mS(MS)],AS.prototype,"index",2),f([mS(kS)],AS.prototype,"axisLabel",2);var OS=class extends pS{};f([mS(vS,{optional:!0})],OS.prototype,"renderer",2);var LS=class extends cS{constructor(){super(...arguments),this.placement="end",this.padding=6}};f([mS(TS(["start","end","inside"],"a placement"))],LS.prototype,"placement",2),f([mS(NS)],LS.prototype,"padding",2);var ES=class extends pS{constructor(){super(...arguments),this.fill="#c16068",this.stroke="#c16068",this.fillOpacity=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.strokeWidth=1,this.cornerRadius=0,this.shadow=(new dS).set({enabled:!1}),this.label=new LS,this.tooltip=new OS}};f([mS(kS,{optional:!0})],ES.prototype,"name",2),f([mS(fS)],ES.prototype,"fill",2),f([mS(fS)],ES.prototype,"stroke",2),f([mS(IS)],ES.prototype,"fillOpacity",2),f([mS(IS)],ES.prototype,"strokeOpacity",2),f([mS(SS)],ES.prototype,"lineDash",2),f([mS(NS)],ES.prototype,"lineDashOffset",2),f([mS(NS)],ES.prototype,"strokeWidth",2),f([mS(NS)],ES.prototype,"cornerRadius",2),f([mS(vS,{optional:!0})],ES.prototype,"formatter",2),f([mS(DS)],ES.prototype,"shadow",2),f([mS(DS)],ES.prototype,"label",2),f([mS(DS)],ES.prototype,"tooltip",2);var _S=class extends pS{constructor(){super(...arguments),this.enabled=!0,this.stroke="black",this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.strokeWidth=2}};f([mS(xS)],_S.prototype,"enabled",2),f([mS(fS)],_S.prototype,"stroke",2),f([mS(IS)],_S.prototype,"strokeOpacity",2),f([mS(SS)],_S.prototype,"lineDash",2),f([mS(NS)],_S.prototype,"lineDashOffset",2),f([mS(NS)],_S.prototype,"strokeWidth",2);var RS=class extends pS{constructor(){super(...arguments),this.positive=new ES,this.negative=new ES,this.total=new ES}};f([mS(DS)],RS.prototype,"positive",2),f([mS(DS)],RS.prototype,"negative",2),f([mS(DS)],RS.prototype,"total",2);var CS=class extends uS{constructor(){super(...arguments),this.item=new RS,this.totals=new yS(AS),this.line=new _S,this.tooltip=new gS}};f([mS(kS)],CS.prototype,"xKey",2),f([mS(kS)],CS.prototype,"yKey",2),f([mS(kS,{optional:!0})],CS.prototype,"xName",2),f([mS(kS,{optional:!0})],CS.prototype,"yName",2),f([mS(DS)],CS.prototype,"item",2),f([mS(bS)],CS.prototype,"totals",2),f([mS(DS)],CS.prototype,"line",2),f([mS(DS)],CS.prototype,"tooltip",2);var{adjustLabelPlacement:wS,SeriesNodePickMode:PS,fixNumericExtent:zS,valueProperty:KS,keyProperty:VS,accumulativeValueProperty:BS,trailingAccumulatedValueProperty:FS,ChartAxisDirection:US,getRectConfig:jS,updateRect:WS,checkCrisp:YS,updateLabelNode:GS,prepareBarAnimationFunctions:HS,collapsedStartingBarPosition:XS,resetBarSelectionsFn:QS,seriesLabelFadeInAnimation:$S,resetLabelFn:ZS,animationValidation:qS,DEFAULT_CARTESIAN_DIRECTION_KEYS:JS,DEFAULT_CARTESIAN_DIRECTION_NAMES:eM,isFiniteNumber:tM,computeBarFocusBounds:iM}=o._ModuleSupport,{Rect:oM,motion:aM}=o._Scene,{sanitizeHtml:sM,isContinuous:nM}=o._Util,{ContinuousScale:rM}=o._Scale,lM=class extends o._ModuleSupport.AbstractBarSeries{constructor(e){super({moduleCtx:e,directionKeys:JS,directionNames:eM,pickModes:[PS.EXACT_SHAPE_MATCH],pathsPerSeries:1,hasHighlightedLabels:!0,pathsZIndexSubOrderOffset:[-1,-1],animationResetFns:{datum:QS,label:ZS}}),this.properties=new CS,this.seriesItemTypes=new Set(["positive","negative","total"])}processData(e){return S(this,null,(function*(){var t,i,a;const{xKey:s,yKey:n,totals:r}=this.properties,{data:l=[]}=this;if(!this.properties.isValid()||!this.visible)return;const h={missingValue:void 0,invalidValue:void 0},d=[],c=r.reduce(((e,t)=>{const i=e.get(t.index);return i?i.push(t):e.set(t.index,[t]),e}),new Map);l.forEach(((e,t)=>{var i;d.push(e),null==(i=c.get(t))||i.forEach((e=>d.push(m(g({},e.toJson()),{[s]:e.axisLabel}))))}));const u=[];this.ctx.animationManager.isSkipped()||u.push(qS());const p=null==(t=this.getCategoryAxis())?void 0:t.scale,y=null==(i=this.getValueAxis())?void 0:i.scale,{isContinuousX:x,xScaleType:f,yScaleType:v}=this.getScaleInformation({xScale:p,yScale:y}),{processedData:S}=yield this.requestDataModel(e,d,{props:[VS(s,f,{id:"xValue"}),BS(n,v,m(g({},h),{id:"yCurrent"})),BS(n,v,m(g({},h),{missingValue:0,id:"yCurrentTotal"})),BS(n,v,m(g({},h),{id:"yCurrentPositive",validation:e=>nM(e)&&Number(e)>=0})),BS(n,v,m(g({},h),{id:"yCurrentNegative",validation:e=>nM(e)&&Number(e)<0})),FS(n,v,m(g({},h),{id:"yPrevious"})),KS(n,v,{id:"yRaw"}),KS("totalType","band",{id:"totalTypeValue",missingValue:void 0,validation:e=>"total"===e||"subtotal"===e}),...x?[o._ModuleSupport.SMALLEST_KEY_INTERVAL]:[],...u]});this.smallestDataInterval=null==(a=S.reduced)?void 0:a.smallestKeyInterval,this.updateSeriesItemTypes(),this.animationState.transition("updateData")}))}getSeriesDomain(e){var t;const{processedData:i,dataModel:a,smallestDataInterval:s}=this;if(!i||!a)return[];const{keys:[n],values:r}=i.domain,l=a.resolveProcessedDataDefById(this,"xValue");if(e===this.getCategoryDirection()){if("key"===(null==l?void 0:l.def.type)&&"category"===(null==l?void 0:l.def.valueType))return n;const i=tM(s)?s:0,a=null!=(t=o._ModuleSupport.extent(n))?t:[NaN,NaN],r=this.getCategoryAxis(),h=Boolean(null==r?void 0:r.isReversed()),d=e===US.Y,c=h===d?0:-i,u=h===d?i:0,p=a[0]+c,y=a[1]+u;return zS([p,y],r)}{const e=r[a.resolveProcessedDataIndexById(this,"yCurrent")],t=[Math.min(0,e[0]),Math.max(0,e[1])];return zS(t)}}createNodeData(){return S(this,null,(function*(){var e,t,i;const{data:o,dataModel:a,smallestDataInterval:s}=this,{line:n}=this.properties,r=this.getCategoryAxis(),l=this.getValueAxis();if(!(o&&r&&l&&a))return;const h=r.scale,d=l.scale,c=r.isReversed(),u=this.getBarDirection()===US.X,p=null!=(e=rM.is(h)?h.calcBandwidth(s):h.bandwidth)?e:10;if("ungrouped"!==(null==(t=this.processedData)?void 0:t.type))return;const y={itemId:this.properties.yKey,nodeData:[],labelData:[],pointData:[],scales:this.calculateScaling(),visible:this.visible};if(!this.visible)return y;const m=a.resolveProcessedDataIndexById(this,"yRaw"),x=a.resolveProcessedDataIndexById(this,"xValue"),f=a.resolveProcessedDataIndexById(this,"totalTypeValue"),v=[],S=a.resolveProcessedDataIndexById(this,"yCurrent"),M=a.resolveProcessedDataIndexById(this,"yPrevious"),D=a.resolveProcessedDataIndexById(this,"yCurrentTotal");let b=0;const{xKey:N,yKey:I,xName:k,yName:T}=this.properties;null==(i=this.processedData)||i.data.forEach(((e,t)=>{let{keys:i,datum:o,values:a}=e;const s=a[f],r=this.isSubtotal(s),l=this.isTotal(s),A=l||r,O=i[x],L=Math.round(h.convert(O)),E=a[m],{cumulativeValue:_,trailingValue:R}=function(e,t,i){return e||t?{cumulativeValue:i[D],trailingValue:t?b:0}:{cumulativeValue:i[S],trailingValue:i[M]}}(l,r,a);A&&(b=null!=_?_:0);const C=Math.round(d.convert(_)),w=Math.round(d.convert(R)),P=function(e,t,i,o,a){return e?o:t?(null!=o?o:0)-(null!=a?a:0):i}(l,r,E,_,R),z=(null!=P?P:0)>=0,K=this.getSeriesItemType(z,s),{fill:V,stroke:B,strokeWidth:F,label:U}=this.getItemConfig(K),j=z?C:w,W=z?w:C,Y=Math.max(F,Math.abs(W-j)),G={x:u?Math.min(j,W):L,y:u?L:Math.min(j,W),width:u?Y:p,height:u?p:Y},H={x:G.x+G.width/2,y:G.y+G.height/2},X=A?C:w,Q=Math.floor(n.strokeWidth)%2/2,$=c?C:X,Z=c?X:C;let q,J;u?(q={x:$+Q,y:G.y},J={x:Z+Q,y:G.y+G.height}):(q={x:G.x,y:$+Q},J={x:G.x+G.width,y:Z+Q});const ee={x:c?J.x:q.x,y:c?J.y:q.y,x2:c?q.x:J.x,y2:c?q.y:J.y,size:0};v.push(ee);const te=this.getLabelText(U,{itemId:"subtotal"===K?"total":K,value:P,datum:o,xKey:N,yKey:I,xName:k,yName:T},(e=>tM(e)?e.toFixed(2):String(e))),ie={index:t,series:this,itemId:K,datum:o,cumulativeValue:null!=_?_:0,xValue:O,yValue:P,yKey:I,xKey:N,x:G.x,y:G.y,width:G.width,height:G.height,midPoint:H,fill:V,stroke:B,strokeWidth:F,opacity:1,label:g({text:te},wS({isPositive:(null!=P?P:-1)>=0,isVertical:!u,placement:U.placement,padding:U.padding,rect:G}))};y.nodeData.push(ie),y.labelData.push(ie)}));const A=this.properties.line.enabled;return void 0!==S&&A&&(y.pointData=v),y}))}updateSeriesItemTypes(){var e,t;const{dataModel:i,seriesItemTypes:o,processedData:a}=this;if(!i||!a)return;o.clear();const s=i.resolveProcessedDataIndexById(this,"yCurrentPositive"),n=i.resolveProcessedDataIndexById(this,"yCurrentNegative"),r=i.resolveProcessedDataIndexById(this,"totalTypeValue"),l=null!=(e=a.domain.values[s])?e:[],h=null!=(t=a.domain.values[n])?t:[];l.length>0&&o.add("positive"),h.length>0&&o.add("negative");const d=null==a?void 0:a.domain.values[r];d&&d.forEach((e=>{"total"!==e&&"subtotal"!==e||o.add("total")}))}isSubtotal(e){return"subtotal"===e}isTotal(e){return"total"===e}nodeFactory(){return new oM}getSeriesItemType(e,t){return null!=t?t:e?"positive":"negative"}getItemConfig(e){switch(e){case"positive":return this.properties.item.positive;case"negative":return this.properties.item.negative;case"subtotal":case"total":return this.properties.item.total}}updateDatumSelection(e){return S(this,null,(function*(){const{nodeData:t,datumSelection:i}=e,o=null!=t?t:[];return i.update(o)}))}updateDatumNodes(e){return S(this,null,(function*(){const{datumSelection:t,isHighlight:i}=e,{id:o,ctx:a}=this,{yKey:s,highlightStyle:{item:n}}=this.properties,r=this.getCategoryAxis(),l=YS(null==r?void 0:r.visibleRange),h=this.getCategoryDirection()===US.X;t.each(((e,t)=>{const r=t.itemId,{fillOpacity:d,strokeOpacity:c,strokeWidth:u,lineDash:p,lineDashOffset:y,cornerRadius:g,formatter:m,shadow:x}=this.getItemConfig(r),f={fill:t.fill,stroke:t.stroke,fillOpacity:d,strokeOpacity:c,lineDash:p,lineDashOffset:y,fillShadow:x,strokeWidth:this.getStrokeWidth(u),cornerRadius:g},v=h?t.width>0:t.height>0,S=jS({datum:t,isHighlighted:i,style:f,highlightStyle:n,formatter:m,seriesId:o,itemId:t.itemId,ctx:a,value:t.yValue,yKey:s});S.crisp=l,S.visible=v,WS({rect:e,config:S})}))}))}updateLabelSelection(e){return S(this,null,(function*(){const{labelData:t,labelSelection:i}=e;if(0===t.length)return i.update([]);const o=t[0].itemId,{label:a}=this.getItemConfig(o),s=a.enabled?t:[];return i.update(s)}))}updateLabelNodes(e){return S(this,null,(function*(){e.labelSelection.each(((e,t)=>{GS(e,this.getItemConfig(t.itemId).label,t.label)}))}))}getTooltipHtml(e){var t,i,a;const s=this.getCategoryAxis(),n=this.getValueAxis();if(!this.properties.isValid()||!s||!n)return o._ModuleSupport.EMPTY_TOOLTIP_CONTENT;const{id:r}=this,{xKey:l,yKey:h,xName:d,yName:c,tooltip:u}=this.properties,{datum:p,itemId:y,xValue:g,yValue:m}=e,{fill:x,strokeWidth:f,name:v,formatter:S}=this.getItemConfig(y);let M;S&&(M=this.ctx.callbackCache.call(S,{datum:p,value:m,xKey:l,yKey:h,fill:x,strokeWidth:f,highlighted:!1,seriesId:r,itemId:e.itemId}));const D=null!=(i=null!=(t=null==M?void 0:M.fill)?t:x)?i:"gray",b=sM(s.formatDatum(g)),N=sM(n.formatDatum(m)),I=this.isTotal(y),k=this.isSubtotal(y);let T;T=I?"Total":k?"Subtotal":null!=(a=null!=v?v:c)?a:h;const A=sM(c),O=`<b>${sM(null!=d?d:l)}</b>: ${b}<br/><b>${sM(T)}</b>: ${N}`;return u.toTooltipHtml({title:A,content:O,backgroundColor:D},{seriesId:r,itemId:y,datum:p,xKey:l,yKey:h,xName:d,yName:c,color:D,title:A})}getLegendData(e){if("category"!==e)return[];const{id:t,seriesItemTypes:i}=this,o=[];return i.forEach((e=>{const{fill:i,stroke:a,fillOpacity:s,strokeOpacity:n,strokeWidth:r,name:l}=this.getItemConfig(e);var h;o.push({legendType:"category",id:t,itemId:e,seriesId:t,enabled:!0,label:{text:null!=l?l:(h=e,h.charAt(0).toUpperCase()+h.substring(1))},marker:{fill:i,stroke:a,fillOpacity:s,strokeOpacity:n,strokeWidth:r}})})),o}toggleSeriesItem(){}animateEmptyUpdateReady(e){let{datumSelection:t,labelSelection:i,contextData:o,paths:a}=e;const s=HS(XS(this.isVertical(),this.axes,"normal"));aM.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],s),$S(this,"labels",this.ctx.animationManager,i);const{pointData:n}=o;if(!n)return;const[r]=a;this.isVertical()?this.animateConnectorLinesVertical(r,n):this.animateConnectorLinesHorizontal(r,n)}animateConnectorLinesHorizontal(e,t){const{path:i}=e;this.updateLineNode(e);const a=this.getValueAxis(),s=null==a?void 0:a.isReversed(),n=s?(e,t)=>e<t:(e,t)=>e>t,r=null==a?void 0:a.scale.convert(0),l=t.reduce(((e,t)=>(n(t.x,e)&&(e=t.x),e)),s?1/0:0),h=(e,t,i,o,a)=>(e-t)/(i-t)*(a-o)+o;this.ctx.animationManager.animate({id:`${this.id}_connectors`,groupId:this.id,phase:"initial",from:r,to:l,ease:o._ModuleSupport.Motion.easeOut,collapsable:!1,onUpdate(o){i.clear(!0),t.forEach(((e,t)=>{const a=h(o,r,l,r,e.x),s=h(o,r,l,r,e.x2);0!==t&&i.lineTo(a,e.y),i.moveTo(s,e.y2)})),e.checkPathDirty()}})}animateConnectorLinesVertical(e,t){const{path:i}=e;this.updateLineNode(e);const a=this.getValueAxis(),s=null==a?void 0:a.isReversed(),n=s?(e,t)=>e>t:(e,t)=>e<t,r=null==a?void 0:a.scale.convert(0),l=t.reduce(((e,t)=>(n(t.y,e)&&(e=t.y),e)),s?0:1/0),h=(e,t,i,o,a)=>(e-t)/(i-t)*(a-o)+o;this.ctx.animationManager.animate({id:`${this.id}_connectors`,groupId:this.id,phase:"initial",from:r,to:l,ease:o._ModuleSupport.Motion.easeOut,collapsable:!1,onUpdate(o){i.clear(!0),t.forEach(((e,t)=>{const a=h(o,r,l,r,e.y),s=h(o,r,l,r,e.y2);0!==t&&i.lineTo(e.x,a),i.moveTo(e.x2,s)})),e.checkPathDirty()}})}animateReadyResize(e){super.animateReadyResize(e),this.resetConnectorLinesPath(e)}updatePaths(e){return S(this,null,(function*(){this.resetConnectorLinesPath({contextData:e.contextData,paths:e.paths})}))}resetConnectorLinesPath(e){let{contextData:t,paths:i}=e;if(0===i.length)return;const[o]=i;this.updateLineNode(o);const{path:a}=o;a.clear(!0);const{pointData:s}=t;s&&(s.forEach(((e,t)=>{0!==t&&a.lineTo(e.x,e.y),a.moveTo(e.x2,e.y2)})),o.checkPathDirty())}updateLineNode(e){const{stroke:t,strokeWidth:i,strokeOpacity:a,lineDash:s,lineDashOffset:n}=this.properties.line;e.setProperties({fill:void 0,stroke:t,strokeWidth:this.getStrokeWidth(i),strokeOpacity:a,lineDash:s,lineDashOffset:n,lineJoin:"round",pointerEvents:o._Scene.PointerEvents.None})}isLabelEnabled(){const{positive:e,negative:t,total:i}=this.properties.item;return e.label.enabled||t.label.enabled||i.label.enabled}onDataChange(){}computeFocusBounds(e){let{datumIndex:t,seriesRect:i}=e;var o;return iM(null==(o=this.contextNodeData)?void 0:o.nodeData[t],this.contentGroup,i)}};lM.className="WaterfallSeries",lM.type="waterfall";var hM={strokeWidth:0,label:{enabled:!1,fontStyle:void 0,fontWeight:o._Theme.FONT_WEIGHT.NORMAL,fontSize:12,fontFamily:o._Theme.DEFAULT_FONT_FAMILY,color:o._Theme.DEFAULT_LABEL_COLOUR,formatter:void 0,placement:"end"}},dM={series:{__extends__:o._Theme.EXTENDS_SERIES_DEFAULTS,item:{positive:hM,negative:hM,total:hM},line:{stroke:o._Theme.DEFAULT_WATERFALL_SERIES_CONNECTOR_LINE_STROKE,strokeOpacity:1,lineDash:[0],lineDashOffset:0,strokeWidth:2}},legend:{enabled:!0,item:{toggleSeriesVisible:!1}}},cM={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"waterfall",solo:!0,instanceConstructor:lM,defaultAxes:[{type:o._Theme.CARTESIAN_AXIS_TYPE.CATEGORY,position:o._Theme.POSITION.BOTTOM},{type:o._Theme.CARTESIAN_AXIS_TYPE.NUMBER,position:o._Theme.POSITION.LEFT}],themeTemplate:dM,swapDefaultAxesCondition:e=>{let{direction:t}=e;return"horizontal"===t},paletteFactory:e=>{let{takeColors:t,colorsCount:i,userPalette:a,themeTemplateParameters:s}=e;const{properties:n}=s,{fills:r,strokes:l}=t(i);return a?{item:{positive:{fill:r[0],stroke:l[0]},negative:{fill:r[1],stroke:l[1]},total:{fill:r[2],stroke:l[2]}}}:{item:{positive:n.get(o._Theme.DEFAULT_WATERFALL_SERIES_POSITIVE_COLOURS),negative:n.get(o._Theme.DEFAULT_WATERFALL_SERIES_NEGATIVE_COLOURS),total:n.get(o._Theme.DEFAULT_WATERFALL_SERIES_TOTAL_COLOURS)}}}};o._ModuleSupport.moduleRegistry.register(Ne,Ge,ii,zi,Ji,Vr,ph,ig,fl,co,Fo,Ho,Ma,Uc,nc,wu,Fp,ip,Ba,jn,rd,By,tt,im,am,Xm,ax,Bt,$t,Uf,Qx,pv,is,hS,cM,vn),o._ModuleSupport.enterpriseModule.isEnterprise=!0,o._ModuleSupport.enterpriseModule.licenseManager=e=>{var t,i;return new Xn(null!=(i=null==(t=e.container)?void 0:t.ownerDocument)?i:"undefined"===typeof document?void 0:document)},o._ModuleSupport.enterpriseModule.injectWatermark=qn}}]);